<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>设计模式：抽象工厂 (Abstract Factory) - MinCodes</title><meta name=Description content="MinCodes, Minimal but useful Codes"><meta property="og:title" content="设计模式：抽象工厂 (Abstract Factory)"><meta property="og:description" content="设计模式总目录请参考：设计模式所支持的设计的可变方面。 意图 提供一个接口以创建一系列相关或相互依赖的对象，而无须指定它们具体的类。 案例 前面在依"><meta property="og:type" content="article"><meta property="og:url" content="https://mincodes.com/posts/design-patterns-abstract-factory/"><meta property="og:image" content="https://mincodes.com/favicon.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-03T16:43:00+08:00"><meta property="article:modified_time" content="2023-07-03T18:04:53+08:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mincodes.com/favicon.svg"><meta name=twitter:title content="设计模式：抽象工厂 (Abstract Factory)"><meta name=twitter:description content="设计模式总目录请参考：设计模式所支持的设计的可变方面。 意图 提供一个接口以创建一系列相关或相互依赖的对象，而无须指定它们具体的类。 案例 前面在依"><meta name=application-name content="MinCodes"><meta name=apple-mobile-web-app-title content="MinCodes"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://mincodes.com/posts/design-patterns-abstract-factory/><link rel=prev href=https://mincodes.com/posts/design-patterns-factory-method/><link rel=next href=https://mincodes.com/posts/design-patterns-builder/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"设计模式：抽象工厂 (Abstract Factory)","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mincodes.com\/posts\/design-patterns-abstract-factory\/"},"genre":"posts","keywords":"design-pattern, architecture","wordcount":917,"url":"https:\/\/mincodes.com\/posts\/design-patterns-abstract-factory\/","datePublished":"2023-07-03T16:43:00+08:00","dateModified":"2023-07-03T18:04:53+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Min Deng"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=MinCodes><img class="lazyload logo" src=/svg/loading.min.svg data-src=/favicon.svg data-srcset="/favicon.svg, /favicon.svg 1.5x, /favicon.svg 2x" data-sizes=auto alt=/favicon.svg title=/favicon.svg><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>posts </a><a class=menu-item href=/tags/tools>tools </a><a class=menu-item href=/tags/>tags </a><a class=menu-item href=/about/>about </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=MinCodes><img class="lazyload logo" src=/svg/loading.min.svg data-src=/favicon.svg data-srcset="/favicon.svg, /favicon.svg 1.5x, /favicon.svg 2x" data-sizes=auto alt=/favicon.svg title=/favicon.svg><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>posts</a><a class=menu-item href=/tags/tools title>tools</a><a class=menu-item href=/tags/ title>tags</a><a class=menu-item href=/about/ title>about</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">设计模式：抽象工厂 (Abstract Factory)</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Min Deng</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-07-03>2023-07-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 917 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 2 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#意图>意图</a></li><li><a href=#案例>案例</a></li><li><a href=#适用性>适用性</a></li><li><a href=#优点>优点</a></li><li><a href=#缺点>缺点</a></li><li><a href=#相关模式>相关模式</a><ul><li><a href=#补上-singleton-链接><span class="org-todo todo TODO">TODO</span> 补上 Singleton 链接</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>设计模式总目录请参考：<a href=/posts/design-patterns/#设计模式所支持的设计的可变方面 rel>设计模式所支持的设计的可变方面</a>。</p><h2 id=意图>意图</h2><blockquote><p>提供一个接口以创建一系列相关或相互依赖的对象，而无须指定它们具体的类。</p></blockquote><h2 id=案例>案例</h2><p>前面在<a href=/posts/design-patterns/#dependency-inversion-principle-依赖倒置原则 rel>依赖倒置原则</a>中，其实已经举过一个贴纸的例子，可以视为抽象工厂的简化版本，其思路是一致的。</p><p>除了对 <code>Product</code> 和 <code>Factory</code> 进行抽象以外，抽象工厂方法还强调了​<strong>产品系列</strong>​的概念。比如《设计模式》一书中经典的例子，支持多种视感（look-and-feel）标准的用户界面，不同的视感风格为诸如滚动条、窗口和按钮等用户界面『窗口组件』定义不同的外观和行为。而某个特定视感风格下的一系列『窗口组件』，就是一个产品系列。我们不应该在 Motif 风格的窗口组件中，混入一个 PM 风格的窗口组件。</p><p>这里我们需要解决两个问题：</p><ul><li>如何确保软件不依赖某种具体的视感风格，以保证软件的可移植性。就像前面的案例中，
<code>Editor</code> 不应该直接依赖某个具体的 <code>StaticSticker</code> 一样；</li><li>如何确保我们不会在 Motif 视感中，错误的使用了一个 PM 风格的组件？</li></ul><p>我们可以通过抽象工厂模式，优雅地解决上述两个问题。看一下类图就明白了：</p><figure><img src=/ox-hugo/class-diagram-widget-factory.png></figure><p>每一种视感标准都对应一个具体的 <code>WidgetFactory</code> 子类，客户只需要通过 <code>WidgetFactory</code>
即可创建出一组特定风格的窗口组件，无需关心哪些类实现了特定风格的窗口组件，而且可以保证绝对不会错误的混用不同风格的窗口，因为 <code>WidgetFactory</code> 强化了同一类型风格组件之间的绑定关系。</p><h2 id=适用性>适用性</h2><ul><li>一个系统希望独立于它的产品的创建、组合和实现。</li><li>一个系统存在多个产品系列，在工作时需要选择其中一个产品系列来使用。</li><li>比较强调产品系列的概念，同一个系列的产品应该配合在引起使用，不同系列的产品不能混用。</li><li>提供一个产品类库，但只想暴露它们的接口而不是实现。</li></ul><h2 id=优点>优点</h2><ul><li>它分离了具体实现类</li><li>替换产品系列变得十分简单，只需替换一个 factory 即可</li><li>有利于产品的一致性，可以自动确保不同系列的产品之间不会混用</li></ul><h2 id=缺点>缺点</h2><p>该模式可以很轻易的扩展新的产品系列，但如果要扩展产品系列中的产品类型，例如上述案例中，增加一种新的窗口组件，会比较困难，因为会涉及 <code>AbstractFactory</code> 类及其所有子类的修改。</p><p>因此，使用该模式最好一开始就考虑清楚系统中有哪些产品类型，是否相对稳定，否则不太建议使用。</p><h2 id=相关模式>相关模式</h2><p>AbstractFactory 类通常用<a href=/posts/design-patterns-factory-method/ rel>工厂方法 (Factory Method)</a>来实现，也可以用<a href=/posts/design-patterns-prototype/ rel>原型
(Prototype)</a>来实现。</p><h3 id=补上-singleton-链接><span class="org-todo todo TODO">TODO</span> 补上 Singleton 链接</h3><p>一个具体的工厂可以作为一个单例 (Singleton) 存在。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2023-07-03</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://mincodes.com/posts/design-patterns-abstract-factory/ data-title="设计模式：抽象工厂 (Abstract Factory)" data-hashtags=design-pattern,architecture><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://mincodes.com/posts/design-patterns-abstract-factory/ data-hashtag=design-pattern><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://mincodes.com/posts/design-patterns-abstract-factory/ data-title="设计模式：抽象工厂 (Abstract Factory)"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://mincodes.com/posts/design-patterns-abstract-factory/ data-title="设计模式：抽象工厂 (Abstract Factory)"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://mincodes.com/posts/design-patterns-abstract-factory/ data-title="设计模式：抽象工厂 (Abstract Factory)"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/design-pattern/>design-pattern</a>,&nbsp;<a href=/tags/architecture/>architecture</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/design-patterns-factory-method/ class=prev rel=prev title="设计模式：工厂方法 (Factory Method)"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>设计模式：工厂方法 (Factory Method)</a>
<a href=/posts/design-patterns-builder/ class=next rel=next title="设计模式：生成器 (Builder)">设计模式：生成器 (Builder)<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Min Deng</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{},data:{"id-1":"MinCodes","id-2":"MinCodes"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EPY7LC720X",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-EPY7LC720X" async></script></body></html>